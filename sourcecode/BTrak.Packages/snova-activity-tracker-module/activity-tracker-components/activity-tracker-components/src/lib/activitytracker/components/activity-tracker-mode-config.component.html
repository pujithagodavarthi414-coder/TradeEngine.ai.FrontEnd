<div class="full-height" *ngIf="(canAccess_feature_ManageActivityModeConfig)">
  <mat-card class="p-0 canteen-manage m-0">
    <mat-card-title class="full-width data-table-header">
      <div fxLayout="row wrap" fxLayoutAlign="start center">
        <div class="card-title-text p-05 full-width ml-05" fxFlex fxLayoutAlign="start center">
          <span fxFlex="100" class="hide-content-overflow">
            {{'ACTIVITYAPPS.ACTIVITYMODE' | translate | titlecase}} </span>
        </div>
      </div>
      <mat-divider></mat-divider>
      <mat-progress-bar mode="indeterminate"
        *ngIf="loading || settingsLoader"></mat-progress-bar>
    </mat-card-title>
  </mat-card>

  <mat-card class="m-0 p-0" id="style-1" *ngIf="!(loading)">
    <div fxLayout="row wrap" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <span class="size">{{ 'ACTIVITYTRACKER.ENABLESTEALTHMODE' | translate }}</span>
      </div>
      <div fxFlex class="pl-05">
        <mat-slide-toggle [(ngModel)]="stealthMode">
        </mat-slide-toggle>
      </div>
    </div>
    <div fxLayout="row wrap" *ngIf="stealthMode" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <div class="row">
          <div class="col-6">
            <span class="size">{{ 'ACTIVITYTRACKER.SHIFTBASED' | translate }}</span>
          </div>
          <div class="col-6">
            <mat-slide-toggle [(ngModel)]="stealthShiftMode"
              (change)="this.stealthPunchCardBased = this.stealthShiftMode ? false : this.stealthPunchCardBased;upsertStealthModeConfig();">
            </mat-slide-toggle>
          </div>
        </div>
      </div>
    </div>
    <div fxLayout="row wrap" *ngIf="stealthMode" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <div class="row">
          <div class="col-6">
            <span class="size">{{ 'ACTIVITYTRACKER.PUNCHCARDBASED' | translate }}</span>
          </div>
          <div class="col-6">
            <mat-slide-toggle [(ngModel)]="stealthPunchCardBased"
              (change)="this.stealthShiftMode = this.stealthPunchCardBased ? false : this.stealthShiftMode;upsertStealthModeConfig();">
            </mat-slide-toggle>
          </div>
        </div>
      </div>
    </div>
    <div class="ml-1 mr-1" *ngIf="stealthMode" fxLayout="row wrap" style="display: contents;">
      <div fxFlex>
        <div fxLayout="row wrap" fxLayoutAlign="start center">
          <div fxFlex="30" fxFlex.md="30" fxFlex.sm="50" fxFlex.xs="50">
            <span class="size">{{ 'ACTIVITYTRACKER.STEALTHMODEROLES' | translate }}</span>
          </div>
          <div fxFlex>
            <label class="mt-1 full-width activity-selection" fxFlex.xs="100">
              <ng-select [searchable]="true" [clearable]="true" (blur)="upsertStealthModeConfig()" [multiple]="true"
                [(ngModel)]="stealthModeRoleIds">
                <ng-option [value]="role.roleId" *ngFor="let role of stealthModeRole"> {{role.roleName}}
                </ng-option>
              </ng-select>
            </label>
          </div>
        </div>
      </div>
    </div>
    <hr /> <!-- End of stealth mode -->
    <div fxLayout="row wrap" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <span class="size">{{ 'ACTIVITYTRACKER.ENABLEPRHMODE' | translate }}</span>
      </div>
      <div fxFlex class="pl-05">
        <mat-slide-toggle [(ngModel)]="prMode">
        </mat-slide-toggle>
      </div>
    </div>
    <div fxLayout="row wrap" *ngIf="prMode" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <div class="row">
          <div class="col-6">
            <span class="size">{{ 'ACTIVITYTRACKER.SHIFTBASED' | translate }}</span>
          </div>
          <div class="col-6">
            <mat-slide-toggle [(ngModel)]="prShiftMode"
              (change)="this.prPunchCardBased = this.prShiftMode ? false : this.prPunchCardBased;upsertPrModeConfig();">
            </mat-slide-toggle>
          </div>
        </div>
      </div>
    </div>
    <div fxLayout="row wrap" *ngIf="prMode" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <div class="row">
          <div class="col-6">
            <span class="size">{{ 'ACTIVITYTRACKER.PUNCHCARDBASED' | translate }}</span>
          </div>
          <div class="col-6">
            <mat-slide-toggle [(ngModel)]="prPunchCardBased"
              (change)="this.prShiftMode = this.prPunchCardBased ? false : this.prShiftMode;upsertPrModeConfig();">
            </mat-slide-toggle>
          </div>
        </div>
      </div>
    </div>
    <div class="ml-1 mr-1" *ngIf="prMode" fxLayout="row wrap" style="display: contents;">
      <div fxFlex>
        <div fxLayout="row wrap" fxLayoutAlign="start center">
          <div fxFlex="30" fxFlex.md="30" fxFlex.sm="50" fxFlex.xs="50">
            <span class="size">{{ 'ACTIVITYTRACKER.PRMODEROLES' | translate }}</span>
          </div>
          <div fxFlex>
            <label class="mt-1 full-width activity-selection" fxFlex.xs="100">
              <ng-select [searchable]="true" [clearable]="true" (blur)="upsertPrModeConfig()" [multiple]="true"
                [(ngModel)]="prModeRoleIds">
                <ng-option [value]="role.roleId" *ngFor="let role of prModeRole"> {{role.roleName}}
                </ng-option>
              </ng-select>
            </label>
          </div>
        </div>
      </div>
    </div>
    <hr /> <!-- End of pause/resume mode -->
    <div fxLayout="row wrap" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <span class="size">{{ 'ACTIVITYTRACKER.ENABLEPUNCHCARDMODE' | translate }}</span>
      </div>
      <div fxFlex class="pl-05">
        <mat-slide-toggle [(ngModel)]="punchCardMode">
        </mat-slide-toggle>
      </div>
    </div>
    <div fxLayout="row wrap" *ngIf="punchCardMode" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <div class="row">
          <div class="col-6">
            <span class="size">{{ 'ACTIVITYTRACKER.SHIFTBASED' | translate }}</span>
          </div>
          <div class="col-6">
            <mat-slide-toggle [(ngModel)]="punchCardShiftMode"
              (change)="this.punchCardPunchCardBased = this.punchCardShiftMode ? false : this.punchCardPunchCardBased;upsertPunchCardModeConfig();">
            </mat-slide-toggle>
          </div>
        </div>
      </div>
    </div>
    <div fxLayout="row wrap" *ngIf="punchCardMode" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <div class="row">
          <div class="col-6">
            <span class="size">{{ 'ACTIVITYTRACKER.PUNCHCARDBASED' | translate }}</span>
          </div>
          <div class="col-6">
            <mat-slide-toggle [(ngModel)]="punchCardPunchCardBased"
              (change)="this.punchCardShiftMode = this.punchCardPunchCardBased ? false : this.punchCardShiftMode;upsertPunchCardModeConfig();">
            </mat-slide-toggle>
          </div>
        </div>
      </div>
    </div>
    <div class="ml-1 mr-1" *ngIf="punchCardMode" fxLayout="row wrap" style="display: contents;">
      <div fxFlex>
        <div fxLayout="row wrap" fxLayoutAlign="start center">
          <div fxFlex="30" fxFlex.md="30" fxFlex.sm="50" fxFlex.xs="50">
            <span class="size">{{ 'ACTIVITYTRACKER.PUNCHCARDMODEROLES' | translate }}</span>
          </div>
          <div fxFlex>
            <label class="mt-1 full-width activity-selection" fxFlex.xs="100">
              <ng-select [searchable]="true" [clearable]="true" (blur)="upsertPunchCardModeConfig()" [multiple]="true"
                [(ngModel)]="punchCardModeRoleIds">
                <ng-option [value]="role.roleId" *ngFor="let role of punchCardModeRole"> {{role.roleName}}
                </ng-option>
              </ng-select>
            </label>
          </div>
        </div>
      </div>
    </div>
    <hr /> <!-- End of punch card mode -->
    <div fxLayout="row wrap" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <span class="size">{{ 'ACTIVITYTRACKER.ENABLEMESSENGERMODE' | translate }}</span>
      </div>
      <div fxFlex class="pl-05">
        <mat-slide-toggle [(ngModel)]="messengerMode">
        </mat-slide-toggle>
      </div>
    </div>
    <div fxLayout="row wrap" *ngIf="messengerMode" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <div class="row">
          <div class="col-6">
            <span class="size">{{ 'ACTIVITYTRACKER.SHIFTBASED' | translate }}</span>
          </div>
          <div class="col-6">
            <mat-slide-toggle [(ngModel)]="messengerShiftMode"
              (change)="this.messengerPunchCardBased = this.messengerShiftMode ? false :  this.messengerPunchCardBased;upsertMessengerModeConfig();">
            </mat-slide-toggle>
          </div>
        </div>
      </div>
    </div>
    <div fxLayout="row wrap" *ngIf="messengerMode" fxLayoutAlign="start center" class="m-1">
      <div fxFlex="30" fxFlex.md="35" fxFlex.sm="50" fxFlex.xs="50">
        <div class="row">
          <div class="col-6">
            <span class="size">{{ 'ACTIVITYTRACKER.PUNCHCARDBASED' | translate }}</span>
          </div>
          <div class="col-6">
            <mat-slide-toggle [(ngModel)]="messengerPunchCardBased"
              (change)="this.messengerShiftMode = this.messengerPunchCardBased ? false :  this.messengerShiftMode;upsertMessengerModeConfig();">
            </mat-slide-toggle>
          </div>
        </div>
      </div>
    </div>
    <div class="ml-1 mr-1" *ngIf="messengerMode" fxLayout="row wrap" style="display: contents;">
      <div fxFlex>
        <div fxLayout="row wrap" fxLayoutAlign="start center">
          <div fxFlex="30" fxFlex.md="30" fxFlex.sm="50" fxFlex.xs="50">
            <span class="size">{{ 'ACTIVITYTRACKER.MESSENGERMODEROLES' | translate }}</span>
          </div>
          <div fxFlex>
            <label class="mt-1 full-width activity-selection" fxFlex.xs="100">
              <ng-select [searchable]="true" [clearable]="true" (blur)="upsertMessengerModeConfig()" [multiple]="true"
                [(ngModel)]="messengerModeRoleIds">
                <ng-option [value]="role.roleId" *ngFor="let role of messengerModeRole"> {{role.roleName}}
                </ng-option>
              </ng-select>
            </label>
          </div>
        </div>
      </div>
    </div>
    <hr /> <!-- End of messenger mode -->
  </mat-card>
</div>

<app-common-message-box *ngIf="!(canAccess_feature_ManageActivityModeConfig)"
  textToDisplay="{{ 'PERMISSIONMESSAGE' | translate }}">
</app-common-message-box>