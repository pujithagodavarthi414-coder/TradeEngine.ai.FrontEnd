<div *ngIf="(canAccess_feature_ViewEmployeeWebAppUsage)">
    <mat-divider></mat-divider>
    <mat-card class="p-02 m-0">
        <div class="ml-08 mr-08" fxLayout="row wrap" fxLayout.xs="column" fxLayoutAlign.xs="center center" id="DV-2">
            <div fxFlex="40" fxLayoutAlign="start center" fxFlex.md="50" fxFlex.sm="60">
                <form [formGroup]="selectFilter" class="display-form-custom">
                    <div fxFlex="20" fxFlex.lg="20" fxFlex.md="25" fxFlex.sm="30" fxFlex.xs="100"
                        fxLayoutAlign="center center" class="mr-05">
                        <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                            <mat-select formControlName="branchIds" placeholder="{{'BRANCH.BRANCH' | translate}}"
                                multiple (selectionChange)="branchSelected();changeBranch($event.value)"
                                [(ngModel)]="branchId">
                                <mat-select-trigger>
                                    {{selectedBranch}}
                                </mat-select-trigger>
                                <mat-option #allBranchesSelected (click)="toggleAllBranchesSelected()" [value]="0">
                                    {{ 'PERMISSIONMANAGEMENT.SELECTALL' | translate }}</mat-option>
                                <mat-option [value]="branch.branchId" *ngFor="let branch of branchesList"
                                    #allBranchesSelected (click)="toggleBranchesPerOne()">
                                    {{branch.branchName}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div fxFlex="20" fxFlex.lg="20" fxFlex.md="25" fxFlex.sm="30" fxFlex.xs="100"
                        fxLayoutAlign="center center" class="mr-05">
                        <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                            <mat-select formControlName="roleIds" placeholder="{{'USERMANAGEMENT.ROLE' | translate}}"
                                multiple (selectionChange)="roleSelected();changeRole($event.value)"
                                [(ngModel)]="roleId">
                                <mat-select-trigger>
                                    {{selectedRole}}
                                </mat-select-trigger>
                                <mat-option #allRolesSelected (click)="toggleAllRolesSelected()" [value]="0"
                                    [hidden]="!userLength">
                                    {{ 'PERMISSIONMANAGEMENT.SELECTALL' | translate }}</mat-option>
                                <mat-option [value]="roles.roleId" *ngFor="let roles of rolesDropDown" #allRolesSelected
                                    (click)="toggleRolesPerOne()">
                                    {{roles.roleName}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div fxFlex="20" fxFlex.lg="20" fxFlex.md="25" fxFlex.sm="30" fxFlex.xs="100"
                        fxLayoutAlign="center center" class="mr-05">
                        <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                            <mat-select formControlName="userIds" placeholder="{{'ACTIVITYTRACKER.USER' | translate}}"
                                multiple (selectionChange)="userSelected();changeUser($event.value)"
                                [(ngModel)]="userId">
                                <mat-select-trigger>
                                    {{selectedUser}}
                                </mat-select-trigger>
                                <mat-option #allUsersSelected (click)="toggleAllUsersSelected()" [value]="0">
                                    {{ 'PERMISSIONMANAGEMENT.SELECTALL' | translate }}</mat-option>
                                <mat-option [value]="employees.teamMemberId" *ngFor="let employees of employeesDropDown"
                                    #allUsersSelected (click)="toggleUsersPerOne()">
                                    {{employees.teamMemberName}}<span *ngIf="employees.teamMemberId == loggedUser">
                                        (Myself)</span>
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </form>
            </div>
            <div fxFlex="20" fxLayoutAlign="center center" fxFlex.md="50" fxFlex.sm="40">
                <div fxLayout="row" *ngIf="day">
                    <div fxFlex="25" fxLayoutAlign="start center">
                        <fa-icon matTooltip="{{'TIMESHEET.ONEWEEKBACKWARD' | translate}}" *ngIf="(!isTrailExpired || !isPreviousDisable) && ((!isDetailedView && dayCount == 7) || (isDetailedView && dayCount == 30) || (isDetailedView && isTrailExpired && dayCount ==7))"
                            (click)="timeSheetDetailsForDay('backward','week')" class="mr-05 icon-button"
                            icon="angle-double-left">
                        </fa-icon>
                        <fa-icon matTooltip="{{'TIMESHEET.ONEDAYBACKWARD' | translate}}" *ngIf="(!isDetailedView && !isTrailExpired) || !isPreviousDisable"
                            (click)="timeSheetDetailsForDay('backward','day');previous()" class="mr-05 icon-button"
                            icon="chevron-left">
                        </fa-icon>
                    </div>
                    <div fxFlex="50" fxLayoutAlign="center center">
                        <input matInput [matDatepicker]="picker1" (dateChange)="onDateChange($event)" [max]="maxDate"
                            class="date-picker text-center" (click)="picker1.open()" [(ngModel)]="todayDate"
                            [readonly]="true" [min]="minDateOnTrailExpired">
                        <mat-datepicker #picker1></mat-datepicker>
                    </div>
                    <div fxFlex="25" fxLayoutAlign="end center" *ngIf="dispalyForward">
                        <fa-icon matTooltip="{{'TIMESHEET.ONEDAYFORWARD' | translate}}"
                            (click)="timeSheetDetailsForDay('forward','day');next()" class="ml-05 icon-button"
                            icon="chevron-right">
                        </fa-icon>
                        <fa-icon matTooltip="{{'TIMESHEET.ONEWEEKFORWARD' | translate}}"
                            (click)="timeSheetDetailsForDay('forward','week')" class="ml-05 icon-button"
                            icon="angle-double-right">
                        </fa-icon>
                    </div>
                </div>
                <div *ngIf="week">
                    <fa-icon (click)="getWeekBasedOnDate('left')" class="icon-button" icon="chevron-left" *ngIf="getEnableOrDisable()"></fa-icon>
                    <span
                        class="month-display-elsement">&nbsp;&nbsp;&nbsp;&nbsp;{{selectedWeek | date: "MMM-yyyy"}}&nbsp;&nbsp;</span><span
                        *ngIf="weekNumber" class="month-display-elsement">W{{weekNumber}}&nbsp;&nbsp;&nbsp;&nbsp;</span>
                    <fa-icon (click)="getWeekBasedOnDate('right')" class="icon-button" icon="chevron-right"
                        [hidden]="!dispalyForward">
                    </fa-icon>
                </div>
                <div *ngIf="month">
                    <fa-icon (click)="getDevQualityBasedOnDate('left')" class="icon-button" icon="chevron-left">
                    </fa-icon>
                    <span
                        class="month-display-elsement">&nbsp;&nbsp;&nbsp;&nbsp;{{selectedMonth | date: "MMM-yyyy"}}&nbsp;&nbsp;&nbsp;&nbsp;</span>
                    <fa-icon (click)="getDevQualityBasedOnDate('right')" class="icon-button" icon="chevron-right"
                        [hidden]="!dispalyForward">
                    </fa-icon>
                </div>
                <div *ngIf="dateRange" fxLayout="row" fxLayout.xs="column" fxLayoutAlign="center center"
                    fxLayoutGap="10px">
                    <div fxFlex="48" fxFlex.sm="50" fxFlex.xs="100">
                        <mat-form-field color="accent">
                            <mat-label>{{ 'PERMISSIONHISTORY.FROMDATE' | translate }}</mat-label>
                            <input matInput [matDatepicker]="picker2" autocomplete="off" (click)="picker2.open()" [min]="minDateOnTrailExpired"
                                (dateChange)="dateFromChanged($event)" class="date-picker" [(ngModel)]="fromDate"
                                [max]="maxDate" [readonly]="true">
                            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                            <mat-datepicker #picker2></mat-datepicker>
                        </mat-form-field>
                    </div>
                    <div fxFlex="47" fxFlex.sm="40" fxFlex.xs="100">
                        <mat-form-field color="accent">
                            <mat-label>{{ 'PERMISSIONHISTORY.TODATE' | translate }}</mat-label>
                            <input matInput [matDatepicker]="picker3" autocomplete="off" [min]="minDate"
                                (click)="picker3.open()" (dateChange)="dateToChanged($event)" class="date-picker"
                                [max]="maxDate" [(ngModel)]="toDate" [readonly]="true">
                            <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                            <mat-datepicker #picker3></mat-datepicker>
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div fxFlex="38" fxLayoutAlign="end center" fxFlex.md="100" fxFlex.sm="100" fxLayoutAlign.md="start center">
                <div class="mb-05">
                    <button mat-raised-button (click)="dayTypeForTimeUsage('day')"
                        color="{{primaryDay}}">{{'ACTIVITYTRACKER.DAY' | translate}}</button>
                </div>
                <div class="mb-05" *ngIf="!isTrailExpired">
                    <button mat-raised-button (click)="dayTypeForTimeUsage('week')"
                        color="{{primaryWeek}}">{{'ACTIVITYTRACKER.WEEK' | translate}}</button>
                </div>
                <div class="mb-05" *ngIf="false">
                    <button mat-raised-button (click)="dayTypeForTimeUsage('month')"
                        color="{{primaryMonth}}">{{'ACTIVITYTRACKER.MONTH' | translate}}</button>
                </div>
                <div class="mb-05">
                    <button mat-raised-button (click)="dayTypeForTimeUsage('daterange')"
                        color="{{primaryDateRange}}">{{'ACTIVITYTRACKER.DATERANGE' | translate}}
                    </button>
                </div>
            </div>
        </div>
        <mat-divider></mat-divider>
        <div class="ml-08 mr-08" id="DV-3">
            <div fxLayout="row wrap">
                <div fxFlex fxLayout="row wrap" fxLayout.xs="column">
                    <div fxFlex="20" fxFlex.lg="29" fxFlex.md="42" fxFlex.sm="45" fxFlex.xs="100" fxLayout="row"
                        fxLayoutAlign="start center" fxLayoutAlign.xs="center center">
                        <div>
                            <button mat-raised-button (click)="typeOfApplication('All')"
                                color="{{primaryAllColor}}">{{'ACTIVITYTRACKER.ALL' | translate}}</button>
                        </div>
                        <div>
                            <button mat-raised-button (click)="typeOfApplication('Websites')"
                                color="{{primaryWebsitesColor}}">{{'ACTIVITYTRACKER.WEBSITES' | translate}}</button>
                        </div>
                        <div>
                            <button mat-raised-button (click)="typeOfApplication('Applications')"
                                color="{{primaryApplicationsColor}}">{{'ACTIVITYTRACKER.APPLICATIONS' | translate}}</button>
                        </div>
                    </div>
                </div>
                <div fxFlex="40px" fxLayoutAlign="end center">
                    <mat-slide-toggle matTooltip="{{'ACTIVITYTRACKER.SWITCHTODETAILEDVIEW' | translate }}" class="mr-1 archive-switch"
                        [(ngModel)]="isDetailedView" [checked]="isDetailedView" (change)="getDetailedView()">
                    </mat-slide-toggle>
                </div>
                <div fxFlex="11" fxFlex.lg="14" fxFlex.md="20" fxFlex.sm="12" fxFlex.xs="100"
                    fxLayoutAlign="end center">
                    <mat-form-field class="full-width p-0">
                        <input matInput placeholder="{{'ACTIVITYTRACKER.SEARCH' | translate}}" [(ngModel)]="searchText"
                            (input)="search()">
                        <mat-icon *ngIf="!searchText" matSuffix>search</mat-icon>
                        <span class="act_close_icon">
                            <span *ngIf="!searchText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                            <mat-icon *ngIf="searchText" class="icon-button" aria-hidden="false" (click)="closeSearch()"
                                style="cursor:pointer">
                                close</mat-icon>
                        </span>
                    </mat-form-field>
                </div>
            </div>
            <mat-divider *ngIf="filterStatus()"></mat-divider>
            <div class="pt-2" *ngIf="filterStatus()" fxLayout="row wrap">
                <mat-chip disableRipple matRipple *ngIf="fromDate && dateRange" class="ml-05 m03">
                    <div>
                        <b>{{'PERMISSIONHISTORY.FROMDATE' | translate}}:</b>&nbsp;{{fromDate | date:"d MMM, y"}}
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="toDate && dateRange" class="ml-05 m03">
                    <div>
                        <b>{{'PERMISSIONHISTORY.TODATE' | translate}}:</b>&nbsp;{{toDate | date:"d MMM, y"}}
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="selectedBranch" class="ml-05 m03" fxLayout="row">
                    <div>
                        <b>{{'LOGTIMEREPORT.BRANCH' | translate}}:</b>&nbsp;{{selectedBranch}}
                    </div>
                    <div (click)="resetBranch()" class="cursor-pointer ml-01">
                        <fa-icon icon="times" class="times-on-hover"></fa-icon>
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="selectedRole" class="ml-05 m03" fxLayout="row">
                    <div>
                        <b>{{'USERMANAGEMENT.ROLE' | translate}}:</b>&nbsp;{{selectedRole}}
                    </div>
                    <div (click)="resetRole()" class="cursor-pointer ml-01">
                        <fa-icon icon="times" class="times-on-hover"></fa-icon>
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="selectedUser" class="ml-05 m03" fxLayout="row">
                    <div>
                        <b>{{'ACTIVITYTRACKER.USER' | translate}}:</b>&nbsp;{{selectedUser}}
                    </div>
                    <div (click)="resetUser()" class="cursor-pointer ml-01">
                        <fa-icon icon="times" class="times-on-hover"></fa-icon>
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="searchText" class="ml-05 m03" fxLayout="row">
                    <div>
                        <b>{{'SEARCH' | translate}}:</b>&nbsp;{{searchText}}
                    </div>
                    <div (click)="closeSearch()" class="cursor-pointer ml-01">
                        <fa-icon icon="times" class="times-on-hover"></fa-icon>
                    </div>
                </mat-chip>
            </div>
        </div>
    </mat-card>
    <mat-progress-bar mode="indeterminate" *ngIf="loading"></mat-progress-bar>
    <div fxLayout="column" fxLayout.xs="column" fxLayoutAlign.xs="start" fxLayoutGap="10px" id="DV-1">
        <ngx-datatable class="btrak" [ngClass]="[totalCount > 15 ? 'ngx-pagination' : '']" [rows]="webAppUsage" [headerHeight]="35" [footerHeight]="35" [rowHeight]="40"
            [loadingIndicator]="loadingIndicator" [limit]="pageSize" [columnMode]="'force'" [externalPaging]="true"
            [offset]="pageNumber" (sort)="onSort($event)" (page)='setPage($event)' [selectionType]="'single'"
            [count]="totalCount" [scrollbarH]="true" [virtualization]="false"
            [messages]="{emptyMessage:('NODATATODISPLAY' | translate), totalMessage: 'TOTAL' | translate}"
            [sorts]="[{prop: 'name', dir: 'asc'}]">
            <ngx-datatable-column name="{{'ACTIVITYTRACKER.USER' | translate | softLabelsPipe : softLabels}}"
                sortable="true" prop="name">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <div fxLayout="row wrap" fxLayoutAlign="start center" fxLayoutGap="10px">
                        <div fxFlex>
                            <img class="employee_img" style="margin: 0;width:25px;height: 25px;"
                                src="{{row.profileImage}}" *ngIf="row?.profileImage" />
                            <ngx-avatar name="{{ row?.name }}" *ngIf="!row?.profileImage" initialsSize="2"
                                [round]="true" size="25">
                            </ngx-avatar>
                        </div>
                        <div fxFlex>
                            <label class="assets-name-control hide-content-overflow activity-font-color mb-0 mt-05"
                                matTooltip="{{row?.name }}">{{ row?.name }}<span *ngIf="row.userId == loggedUser">
                                    (Myself)</span></label>
                        </div>
                    </div>
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="{{'ACTIVITYTRACKER.APPWEBSITE' | translate}}" sortable="true"
                prop="applicationName">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <label class="assets-name-control hide-content-overflow activity-font-color mb-0 mt-05"
                        matTooltip="{{row?.applicationName}}">{{ row?.applicationName }}</label>
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="{{'ACTIVITYTRACKER.LOGGEDTIME' | translate}}" sortable="true" prop="spentValue">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <label class="assets-name-control hide-content-overflow activity-font-color mb-0 mt-05"
                        matTooltip="{{ row?.spentValue | activityTimeFilter }}">{{ row?.spentValue | activityTimeFilter}}</label><label
                        for=""></label>
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="{{'ACTIVITYTRACKER.PRODUCTIVITY' | translate}}" sortable="true" prop="timeValue"
                [cellClass]="'productivity-custom-cell'">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <div class="app-usage-status">
                        <mat-progress-bar mode="determinate" value="{{ row?.timeValue }}"
                            [matTooltip]="getProductiveToolTip(row)"
                            [ngClass]="[row?.applicationTypeName == 'Productive' ? 'productive-color' : row?.applicationTypeName == 'UnProductive' ? 'unproductive-color' : 'neutral-color']"
                            [ngStyle]="{height:'8px', display: 'block', position: 'absolute', width: '22%'}">
                        </mat-progress-bar>
                    </div>
                </ng-template>
            </ngx-datatable-column>
        </ngx-datatable>
    </div>
    <!-- <div fxLayout="row wrap" fxLayoutAlign="end center" fxLayoutAlign.xs="start" class="chip-type mt-05 mr-8">
        <div class="mr-1">
            <mat-chip class="chip-productive ml-05"></mat-chip> &nbsp;
            <label class="activity-font-color"
                matTooltip="{{'ACTIVITYTRACKER.PRODUCTIVE' | translate}}">{{'ACTIVITYTRACKER.PRODUCTIVE' | translate}}</label>
        </div>
        <div class="mr-1">
            <mat-chip class="chip-unproductive ml-05"></mat-chip> &nbsp;
            <label class="activity-font-color"
                matTooltip="{{'ACTIVITYTRACKER.UNPRODUCTIVE' | translate}}">{{'ACTIVITYTRACKER.UNPRODUCTIVE' | translate}}</label>
        </div>
        <div class="mr-1">
            <mat-chip class="chip-neutral ml-05"></mat-chip> &nbsp;
            <label class="activity-font-color"
                matTooltip="{{'ACTIVITYTRACKER.NEUTRAL' | translate}}">{{'ACTIVITYTRACKER.NEUTRAL' | translate}}</label>
            &nbsp;
            &nbsp;
        </div>
    </div> -->
</div>
<app-common-message-box *ngIf="!( canAccess_feature_ViewEmployeeWebAppUsage )"
    textToDisplay="{{ 'PERMISSIONMESSAGE' | translate }}">
</app-common-message-box>