<div *ngIf="canAccess_feature_ViewActivityDashboard">
    <mat-card class="default" class="ml-0 p-0" id="step1-2">
        <mat-card-title class="full-width">
            <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="0" fxLayoutGap.xs="10px">
                <div fxFlex fxLayoutAlign="start center">
                    <button type="submit" mat-icon-button class="pull-right" (click)="filterClick()"
                        matTooltip=" {{'HRMANAGAMENT.ADVANCESEARCH' | translate}}">
                        <fa-icon icon="filter" class="filter mat-color-accent">
                        </fa-icon>
                    </button>
                </div>
                <div fxFill>
                    <div class="filter-section" [hidden]="!isOpen">
                        <ul>
                            <li class="p-0">
                                <button mat-icon-button matTooltip="{{'RESET' | translate}}"
                                    (click)="resetAllFilters()">
                                    <fa-icon class="filter mat-color-accent" icon="undo"></fa-icon>
                                </button>
                            </li>
                            <li [ngClass]="{ 'active': monthFilterActive }" [satPopoverAnchorFor]="namePopover"
                                hasBackdrop (click)="namePopover.toggle()" id="li-1">
                                <a>
                                    <mat-icon>arrow_drop_down</mat-icon>{{'LOGTIMEREPORT.DATE' | translate}}
                                </a>
                                <sat-popover #namePopover verticalAlign="below" hasBackdrop horizontalAlign="start">
                                    <mat-card class="filter-data">
                                        <div fxLayout="row wrap" fxLayoutGap="3">
                                            <div fxFlex="49" class="mr-05">
                                                <mat-form-field color="accent">
                                                    <mat-label>{{ 'PERMISSIONHISTORY.FROMDATE' | translate }}
                                                    </mat-label>
                                                    <input matInput [matDatepicker]="picker2" autocomplete="off"
                                                        (click)="picker2.open()" [max]="maxDate" [min]="minDateOnTrailExpired"
                                                        (dateChange)="dateFromChanged($event)" class="date-picker"
                                                        [(ngModel)]="fromDate" [readonly]="true">
                                                    <mat-datepicker-toggle matSuffix [for]="picker2">
                                                    </mat-datepicker-toggle>
                                                    <mat-datepicker #picker2></mat-datepicker>
                                                </mat-form-field>
                                            </div>
                                            <div fxFlex="45">
                                                <mat-form-field color="accent">
                                                    <mat-label>{{ 'PERMISSIONHISTORY.TODATE' | translate }}
                                                    </mat-label>
                                                    <input matInput [matDatepicker]="picker3" autocomplete="off"
                                                        [min]="fromDate" (click)="picker3.open()" [max]="maxDate"
                                                        (dateChange)="dateToChanged($event)" class="date-picker"
                                                        [(ngModel)]="toDate" [readonly]="true">
                                                    <mat-datepicker-toggle matSuffix [for]="picker3">
                                                    </mat-datepicker-toggle>
                                                    <mat-datepicker #picker3></mat-datepicker>
                                                </mat-form-field>
                                            </div>
                                        </div>
                                    </mat-card>
                                </sat-popover>
                            </li>
                            <li [ngClass]="{ 'active': selectBranchFilterIsActive }"
                                [satPopoverAnchorFor]="branchPopover" hasBackdrop (click)="branchPopover.toggle()" id="li-2">
                                <a>
                                    <mat-icon>arrow_drop_down</mat-icon>{{'LOGTIMEREPORT.BRANCH' | translate}}
                                </a>
                                <sat-popover #branchPopover verticalAlign="below" hasBackdrop
                                    horizontalAlign="start">
                                    <mat-card class="filter-data">
                                        <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                                            <mat-select [(ngModel)]="branchId"
                                                placeholder="{{'BRANCH.BRANCH' | translate}}" multiple>
                                                <mat-select-trigger>
                                                    {{selectedBranch}}
                                                </mat-select-trigger>
                                                <mat-option #allBranchesSelected
                                                    (click)="toggleAllBranchesSelected()" [value]="0">
                                                    {{ 'PERMISSIONMANAGEMENT.SELECTALL' | translate }}</mat-option>
                                                <mat-option [value]="branch.branchId"
                                                    (click)="toggleBranchesPerOne()"
                                                    *ngFor="let branch of branchesList">
                                                    {{branch.branchName}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </mat-card>
                                </sat-popover>
                            </li>
                            <li [ngClass]="{ 'active': selectRoleFilterIsActive }"
                                [satPopoverAnchorFor]="departmentPopover" hasBackdrop
                                (click)="departmentPopover.toggle()" id="li-3">
                                <a>
                                    <mat-icon>arrow_drop_down</mat-icon>{{'USERMANAGEMENT.ROLE' | translate }}
                                </a>
                                <sat-popover #departmentPopover verticalAlign="below" hasBackdrop
                                    horizontalAlign="start">
                                    <mat-card class="filter-data">
                                        <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                                            <mat-select [(ngModel)]="roleId"
                                                placeholder="{{'USERMANAGEMENT.ROLE' | translate}}" multiple>
                                                <mat-select-trigger>
                                                    {{selectedRole}}
                                                </mat-select-trigger>
                                                <mat-option #allRolesSelected (click)="toggleAllRolesSelected()"
                                                    [value]="0">
                                                    {{ 'PERMISSIONMANAGEMENT.SELECTALL' | translate }}</mat-option>
                                                <mat-option [value]="roles.roleId"
                                                    *ngFor="let roles of rolesDropDown"
                                                    (click)="toggleRolesPerOne()">
                                                    {{roles.roleName}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </mat-card>
                                </sat-popover>
                            </li>

                            <li [ngClass]="{ 'active': selectUserFilterIsActive }"
                                [satPopoverAnchorFor]="designationPopover" hasBackdrop
                                (click)="designationPopover.toggle()" id="li-4">
                                <a>
                                    <mat-icon>arrow_drop_down</mat-icon> {{'ACTIVITYTRACKER.USER' | translate }}
                                </a>
                                <sat-popover #designationPopover verticalAlign="below" hasBackdrop
                                    horizontalAlign="start">
                                    <mat-card class="filter-data">
                                        <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                                            <mat-select (selectionChange)="changeUser($event.value)"
                                                [(ngModel)]="userId"
                                                placeholder="{{'ACTIVITYTRACKER.USER' | translate}}">
                                                <mat-option [value]="employees.teamMemberId"
                                                    *ngFor="let employees of employeesDropDown">
                                                    <app-avatar class="employee_img" *ngIf="!employees?.profileImage" [name]="employees.teamMemberName | removeSpecialCharacters"
                                                        [isRound]="true" size="30">
                                                    </app-avatar>
                                                    <img class="employee_img" src="{{employees?.profileImage}}" style="float: none;" *ngIf="employees.profileImage" />
                                                    {{employees.teamMemberName}}<span
                                                        *ngIf="employees.teamMemberId == loggedUser">
                                                        (Myself)</span>
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </mat-card>
                                </sat-popover>
                            </li>
                            <li [ngClass]="{ 'active': searchIsActive }" [satPopoverAnchorFor]="searchPopover"
                                (click)="searchPopover.toggle()" id="li-5">
                                <a>
                                    <mat-icon>arrow_drop_down</mat-icon>{{'SEARCH' | translate}}
                                </a>
                                <sat-popover #searchPopover verticalAlign="below" hasBackdrop
                                    horizontalAlign="start">
                                    <mat-card class="filter-data">
                                        <div class="ml-05 mr-05 search_goalinput">
                                            <mat-form-field fxLayoutAlign="end center">
                                                <input class="search_goal" matInput
                                                    placeholder="{{'SEARCH' | translate}}" [(ngModel)]="searchText"
                                                    (input)="search()">
                                            </mat-form-field>
                                            <span class="close_icon">
                                                <span
                                                    *ngIf="!searchText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                <mat-icon *ngIf="searchText" class="icon-button" aria-hidden="false"
                                                    (click)="closeSearch()" style="cursor:pointer">
                                                    close</mat-icon>
                                            </span>
                                        </div>
                                    </mat-card>
                                </sat-popover>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <mat-divider></mat-divider>
            <div *ngIf="filterStatus()" fxLayout="row wrap">
                <mat-chip disableRipple matRipple *ngIf="fromDate" class="ml-05 m03">
                    <div>
                        <b>{{'PERMISSIONHISTORY.FROMDATE' | translate}}:</b>&nbsp;{{fromDate | date:"d MMM, y"}}
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="toDate" class="ml-05 m03">
                    <div>
                        <b>{{'PERMISSIONHISTORY.TODATE' | translate}}:</b>&nbsp;{{toDate | date:"d MMM, y"}}
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="selectedBranch" class="ml-05 m03" fxLayout="row">
                    <div>
                        <b>{{'LOGTIMEREPORT.BRANCH' | translate}}:</b>&nbsp;{{selectedBranch}}
                    </div>
                    <div (click)="changeBranch('')" class="cursor-pointer ml-01">
                        <fa-icon icon="times" class="times-on-hover"></fa-icon>
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="selectedRole" class="ml-05 m03" fxLayout="row">
                    <div>
                        <b>{{'USERMANAGEMENT.ROLE' | translate}}:</b>&nbsp;{{selectedRole}}
                    </div>
                    <div (click)="changeRole('')" class="cursor-pointer ml-01">
                        <fa-icon icon="times" class="times-on-hover"></fa-icon>
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="selectedUser" class="ml-05 m03" fxLayout="row">
                    <div>
                        <b>{{'ACTIVITYTRACKER.USER' | translate}}:</b>&nbsp;{{selectedUser}}
                    </div>
                    <div (click)="changeUser('')" class="cursor-pointer ml-01">
                        <fa-icon icon="times" class="times-on-hover"></fa-icon>
                    </div>
                </mat-chip>
                <mat-chip disableRipple matRipple *ngIf="searchText" class="ml-05 m03" fxLayout="row">
                    <div>
                        <b>{{'SEARCH' | translate}}:</b>&nbsp;{{searchText}}
                    </div>
                    <div (click)="closeSearch()" class="cursor-pointer ml-01">
                        <fa-icon icon="times" class="times-on-hover"></fa-icon>
                    </div>
                </mat-chip>
            </div>
        </mat-card-title>
    </mat-card>
    <app-fm-component-websites-and-applications [webAppUsageSearch] = "inputModel"></app-fm-component-websites-and-applications>
    <app-fm-component-app-usage-report [webAppUsageSearch] = "inputModel" [roleData]="rolesDropDown"></app-fm-component-app-usage-report>
</div>
<mat-card class="p-0" *ngIf="!(canAccess_feature_ViewActivityDashboard)">
    <app-common-message-box *ngIf="!(canAccess_feature_ViewActivityDashboard)"
        textToDisplay="{{ 'PERMISSIONMESSAGE' | translate }}">
    </app-common-message-box>
</mat-card>