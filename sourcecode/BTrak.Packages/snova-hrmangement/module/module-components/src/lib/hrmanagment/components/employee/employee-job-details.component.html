<mat-card class="m-0 p-0 edit_employee full-height"
  *ngIf="((canAccess_feature_ViewEmployeeJobDetails) && permission) || (canAccess_feature_CanEditOtherEmployeeDetails )">
  <mat-card-title *ngIf="isForm" class="data-table-header drag-handler">
    <div class="p-1"><b>{{'HRMANAGAMENT.EDITJOBDETAILS' | translate | titlecase}}</b></div>
    <mat-divider></mat-divider>
  </mat-card-title>
  <mat-card-title *ngIf="isView" class="data-table-header drag-handler">
    <div class="p-1" fxLayout="row wrap">
      <div fxFlex>
        <b>{{'HRMANAGAMENT.VIEWJOBDETAILS' | translate | titlecase}}</b>
      </div>
      <div fxFlex="20px" fxLayoutAlign="end center"
        *ngIf="((canAccess_feature_AddOrUpdateEmployeeJobDetails)&& permission) || (canAccess_feature_CanEditOtherEmployeeDetails )">
        <span *ngIf="!selectedEmployeeJobDetails" (click)="enableDisableForm()"
          matTooltip="{{'HRMANAGAMENT.ADDJOBDETAILS' | translate}}" class="mat-color-accent accordion-handle">
          <fa-icon icon="plus" class="mat-color-accent"></fa-icon>
        </span>
        <span *ngIf="selectedEmployeeJobDetails" (click)="enableDisableForm()"
          matTooltip="{{'HRMANAGAMENT.EDITJOBDETAILS' | translate}}" class="mat-color-accent accordion-handle">
          <fa-icon icon="edit" class="mat-color-accent"></fa-icon>
        </span>
      </div>
    </div>
    <mat-divider></mat-divider>
  </mat-card-title>
  <mat-card-content class="p-1 no-drag" id="widget-scroll-id">
    <div class="m-0 p-0" *ngIf="isForm">
      <form [formGroup]="employeeJobDetailsForm" novalidate #formDirective="ngForm"
        (submit)="employeeJobDetailsForm.valid && saveEmployeeJobDetails()">
        <div fxLayout="row" fxLayout.xs="column" fxLayoutGap.xs="0px" fxLayoutGap="15px">
          <div fxFlex="33.3" fxFlex.xs="100">
            <mat-form-field class="full-width">
              <mat-select formControlName="designationId" placeholder="{{'HRMANAGAMENT.DESIGNATION' | translate}}"
                required>
                <mat-option value="option" *ngFor="let designation of selectDesignationDropDownListData$ | async"
                  [value]="designation.designationId">
                  {{designation.designationName}}
                </mat-option>
              </mat-select>
              <mat-error>
                <span
                  *ngIf="employeeJobDetailsForm.get('designationId').hasError('required') && employeeJobDetailsForm.get('designationId').touched">
                  {{'HRMANAGAMENT.SELECTDESIGNATION' | translate}}</span>
              </mat-error>
            </mat-form-field>
          </div>
          <div fxFlex="33.3" fxFlex.xs="100">
            <mat-form-field class="full-width">
              <mat-select formControlName="employmentStatusId"
                placeholder="{{'HRMANAGAMENT.EMPLOYMENTSTATUS' | translate}}" required>
                <mat-option value="option"
                  *ngFor="let employmentStatus of selectEmploymentStatusDropDownListData$ | async"
                  [value]="employmentStatus.employmentStatusId">
                  {{employmentStatus.employmentStatusName}}
                </mat-option>
              </mat-select>
              <mat-error>
                <span
                  *ngIf="employeeJobDetailsForm.get('employmentStatusId').hasError('required') && employeeJobDetailsForm.get('employmentStatusId').touched">
                  {{'HRMANAGAMENT.SELECTEMPLOYMENTSTATUS' | translate}}</span>
              </mat-error>
            </mat-form-field>
          </div>
          <div fxFlex="33.3" fxFlex.xs="100">
            <mat-form-field class="full-width">
              <mat-select formControlName="jobCategoryId" placeholder="{{'HRMANAGAMENT.JOBCATEGORY' | translate}}"
                required>
                <mat-option value="option" *ngFor="let jobCategory of jobCategoryList$ | async"
                  [value]="jobCategory.jobCategoryId">
                  {{jobCategory.jobCategoryName}}
                </mat-option>
              </mat-select>
              <mat-error>
                <span
                  *ngIf="employeeJobDetailsForm.get('jobCategoryId').hasError('required') && employeeJobDetailsForm.get('jobCategoryId').touched">
                  {{'HRMANAGAMENT.SELECTJOBCATEGORY' | translate}}</span>
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div fxLayout="row" fxLayout.xs="column" fxLayoutGap.xs="0px" fxLayoutGap="15px">
            <div fxFlex="33.3" fxFlex.xs="100">
                <mat-form-field class="full-width">
                    <input matInput [matDatepicker]="picker" (click)="picker.open()"
                           placeholder="{{'HRMANAGAMENT.JOINEDDATE' | translate}}" formControlName="joinedDate" [min]="minDate"
                           autocomplete="off">
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                    <mat-error>
                        <span *ngIf="employeeJobDetailsForm.get('joinedDate').hasError('matDatepickerMin')">{{'HRMANAGAMENT.PLEASEENTERDATEGREATERTHAN' | translate}}</span>
                    </mat-error>
                </mat-form-field>
            </div>
            <div fxFlex="33.3" fxFlex.xs="100">
                <mat-form-field class="full-width">
                    <mat-select formControlName="departmentId" placeholder="{{'HRMANAGAMENT.DEPARTMENT' | translate}}"
                                required>
                        <mat-option value="option" *ngFor="let department of selectDepartmentDropDownListData$ | async"
                                    [value]="department.departmentId">
                            {{department.departmentName}}
                        </mat-option>
                    </mat-select>
                    <mat-error>
                        <span *ngIf="employeeJobDetailsForm.get('departmentId').hasError('required') && employeeJobDetailsForm.get('departmentId').touched">
                            {{'HRMANAGAMENT.SELECTDEPARTMENT' | translate}}
                        </span>
                    </mat-error>
                </mat-form-field>
            </div>
            <div fxFlex="33.3" fxFlex.xs="100">
                <mat-form-field class="full-width">
                    <mat-select formControlName="branchId" placeholder="{{'HRMANAGAMENT.LOCATION' | translate}}" required>
                        <mat-option value="option" *ngFor="let branch of branchList$ | async" [value]="branch.branchId">
                            {{branch.branchName}}
                        </mat-option>
                    </mat-select>
                    <mat-error>
                        <span *ngIf="employeeJobDetailsForm.get('branchId').hasError('required') && employeeJobDetailsForm.get('branchId').touched">
                            {{'HRMANAGAMENT.SELECTLOCATION' | translate}}
                        </span>
                    </mat-error>
                </mat-form-field>
            </div>
            <div fxFlex="33.3" fxFlex.xs="100">
                <mat-form-field class="full-width">
                    <!-- <mat-select formControlName="noticePeriodInMonths" placeholder="{{'HRMANAGAMENT.NOTICEPERIODINMONTHS' | translate}}"
                        required>
                <mat-option *ngFor="let option of noticePeriodOptions" [value]="option.value">
                    {{option.viewValue}}
                </mat-option>
            </mat-select> -->
                    <input type="number" matInput formControlName="noticePeriodInMonths" min="0" max="12" placeholder="{{'HRMANAGAMENT.NOTICEPERIODINMONTHS' | translate}}">
                </mat-form-field>
            </div>
        </div>
        <div class="text-center">
          <button mat-button type="submit" mat-raised-button color="primary" class="mr-1"
            [disabled]="!employeeJobDetailsForm.valid || (upsertEmployeeJobDetailsInProgress$ | async)">
            <mat-progress-bar color="primary" mode="indeterminate" *ngIf="upsertEmployeeJobDetailsInProgress$ | async">
            </mat-progress-bar>
            <span *ngIf="!selectedEmployeeJobDetails">
              <fa-icon class="mr-05" icon="save"></fa-icon> {{'SAVE' | translate }}
            </span>
            <span *ngIf="selectedEmployeeJobDetails">
              <fa-icon class="mr-05" icon="pen"></fa-icon> {{'UPDATE' | translate}}
            </span>
          </button>
          <button type="button" mat-button mat-raised-button (click)="resetEmployeeJobDetails(formDirective)"
            [disabled]="(upsertEmployeeJobDetailsInProgress$ | async)">
            <fa-icon class="mr-05" icon="undo" style="cursor: pointer;"></fa-icon>{{'RESET'|translate}}
          </button>
        </div>
      </form>
    </div>
    <ng-container *ngIf="isView">
      <app-hr-component-view-employee-job-details [jobDetailsData]="selectedEmployeeJobDetails">
      </app-hr-component-view-employee-job-details>
    </ng-container>
    <div *ngIf="isData && isView" class="p-1">
      <span>{{'NODATATODISPLAY' | translate }}</span>
    </div>
    <ng-container
      *ngIf="((((canAccess_feature_ViewEmploymentContractDetails) && permission) || (canAccess_feature_CanEditOtherEmployeeDetails )) && !isPermanent)">
      <app-hr-component-contract-details [selectedEmployeeId]="employeeId" [isPermission]="permission"
        [isPermanent]="isPermanent">
      </app-hr-component-contract-details>
    </ng-container>
  </mat-card-content>
</mat-card>

<mat-card class="p-0 m-0 edit_employee full-height"
  *ngIf="!(((canAccess_feature_ViewEmployeeJobDetails) && permission) || (canAccess_feature_CanEditOtherEmployeeDetails ))">
  <mat-card-title class="data-table-header drag-handler" *ngIf="isView">
    <div class="p-1" fxLayout="row wrap">
      <div fxFlex>
        {{'HRMANAGAMENT.VIEWJOBDETAILS' | translate}}
      </div>
    </div>
    <mat-divider></mat-divider>
  </mat-card-title>
  <mat-card-content>
    <app-common-message-box textToDisplay="{{ 'PERMISSIONMESSAGE' | translate }}">
    </app-common-message-box>
  </mat-card-content>
</mat-card>