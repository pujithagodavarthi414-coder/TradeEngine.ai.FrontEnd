<div class="custom-excel-upload-container">
    <mat-card class="p-0 canteen-manage m-0">
        <mat-progress-bar color="primary" mode="indeterminate" *ngIf="isLoading">
        </mat-progress-bar>
        <mat-card-title class="full-width data-table-header drag-handler">
            <div fxLayout="row wrap" fxLayout.xs="column">
                <div class="card-title-text p-05 ml-05" fxFlex fxLayoutAlign="start center">
                    <span fxFlex="100" class="hide-content-overflow">Custom App Records Excel Uploader</span>
                </div>
            </div>
            <mat-divider></mat-divider>
        </mat-card-title>
        <br />
        <div fxLayout="row wrap" #listElement>
            <div fxFlex="100" class="text-center">
                <!-- <h3><b>Portfolio Summary/Last 12 months</b></h3> -->
                <button style="width: 160px; float: right; margin: 20px;" class="ctm-tbl-data-btn excel-upload-button">
                    <fa-icon icon="plus" class="mat-color-accent"></fa-icon>
                    <span>Upload Excel</span>
                    <input type="file" accept=".xls,.xlsx" (change)="onFileSelect($event)" />
                </button>
            </div>
            <div class="d-flex justify-content-start contacts-tab-container w-100">
                <div class="d-flex tab-group align-items-end w-75 overflow-x-auto f-grow-1">
                    <div class="contacts-tab d-flex justify-space-between align-items-center padding-y-10 px-4 cursor-pointer overflow-hidden f-grow-1"
                        [ngClass]="{ 'active-tab':activeView == 'uploading-excels'}"
                        (click)="setActiveView('uploading-excels')">
                        <span class="overflow-elipsis">Uploading Excels</span>
                    </div>
                    <div class="contacts-tab d-flex justify-space-between align-items-center padding-y-10 px-4 cursor-pointer overflow-hidden f-grow-1"
                        [ngClass]="{ 'active-tab': activeView == 'uploaded-excels'}"
                        (click)="setActiveView('uploaded-excels')">
                        <span class="overflow-elipsis">Uploaded Excels</span>
                    </div>
                    <div class="contacts-tab d-flex justify-space-between align-items-center padding-y-10 px-4 cursor-pointer overflow-hidden f-grow-1"
                        [ngClass]="{ 'active-tab': activeView == 'excels-with-errors'}"
                        (click)="setActiveView('excels-with-errors')">
                        <span class="overflow-elipsis">Excels with errors</span>
                    </div>
                </div>
            </div>
        </div>
    </mat-card>
    <div class="p-0 mat-dialog-padding no-drag">
        <div fxLayout="column" fxLayoutGap="10px">
            <kendo-grid #grid [data]="excelDetailsGridData" [pageSize]="state.take" [skip]="state.skip"
                [sortable]="true" [pageable]="true" [filterable]="false" (dataStateChange)="dataStateChange($event)"
                [sort]="state.sort">
                <kendo-grid-column field="excelSheetName" title="Excel sheet name">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div class="cursor-pointer">{{ dataItem.excelSheetName }}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column field="uploaderName" title="Uploader name">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div class="cursor-pointer">{{ dataItem.uploaderName }}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column field="uploadedDateTime" title="Uploaded DateTime">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div class="cursor-pointer">{{ convertUtcToLocal(dataItem.uploadedDateTime) | date: 'dd MMM yyyy HH:mm' }}
                        </div>
                    </ng-template>
                </kendo-grid-column>
            </kendo-grid>
            <div [ngClass]="{'k-i-loading': isAnyOperationIsInprogress}"></div>
        </div>
    </div>
</div>
