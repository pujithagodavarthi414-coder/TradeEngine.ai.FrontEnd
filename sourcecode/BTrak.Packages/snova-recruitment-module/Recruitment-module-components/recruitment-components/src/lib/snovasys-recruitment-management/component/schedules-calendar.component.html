<div *ngIf="canAccess_feature_ViewRecruitmentSchedule">
  <kendo-scheduler #kendoScheduler [kendoSchedulerBinding]="solutionData" style="height: 95vh;" [selectedViewIndex]="0"
    [slotFill]="1" [selectedDate]="selectedDate">
    <kendo-scheduler-messages today="{{'ROSTER.TODAY' | translate}}" dayViewTitle="{{'ROSTER.DAY' | translate}}"
      weekViewTitle="{{'ROSTER.WEEK' | translate}}" monthViewTitle="{{'ROSTER.MONTH' | translate}}"
      agendaViewTitle="{{'ROSTER.AGENDA' | translate}}" showWorkDay="{{'ROSTER.SHOWBUSINESSHOURS' | translate}}"
      showFullDay="{{'ROSTER.SHOWFULLDAY' | translate}}">
    </kendo-scheduler-messages>

    <kendo-scheduler-day-view>
      <ng-template kendoSchedulerEventTemplate let-event="event" let-dataItem="dataItem">
        <div fxLayout="row wrap" class="pt-3" fxLayoutGap.xs="0px" fxLayoutGap="15px" id="style-1"
          style="overflow: auto;">
          <div class="full-width">
            <div *ngFor="let candidate of event.dataItem.dataItem" fxFlex>
              <mat-card class="p-0 canteen-manage m-0 ml-05 mr-05 mt-05" style="overflow: auto;" id="style-1">
                <mat-card-title class="full-width data-table-header">
                  <div fxFlex="210px" style="display: flex;">
                    <div> &nbsp; &nbsp; </div>
                    <div fxFlex="2" fxFlex.sm="4" class="goals_summary_member ml-02" style="padding: 10px !important">

                      <app-chip [matTooltip]="candidate.candidateName"
                        class="pull-right avatar-image goal-summary-image" [isNameRequired]="false"
                        [name]="candidate.candidateName | removeSpecialCharacters "
                        [src]="candidate.profileImage | fetchSizedAndCachedImage: '20':''" size="25">
                      </app-chip>
                    </div>
                    <div style="padding: 5px 2px 1px 2px">
                      {{candidate.candidateName}}
                    </div>

                    <div fxFlex="33px" class="text-center pull-right"
                      *ngIf="candidate.isConfirmed == false&& canAccess_feature_ViewScheduleConfirmation"
                      style="margin-inline-start: 10px !important;" [satPopoverAnchorFor]="confirmPopup"
                      #confirmPopover="satPopoverAnchor" (click)="getConfirm(confirmPopover,candidate)">
                      <fa-icon icon="thumbs-up" class="goal-cursor mat-color-accent"
                        matTooltip="{{ 'RECRUITMENTSCHEDULES.APPROVE' | translate }}">
                      </fa-icon>
                    </div>

                    <div fxFlex="33px" class="text-center pull-right"
                      *ngIf="candidate.isConfirmed == true&&canAccess_feature_ViewInterviewFeedback"
                      [satPopoverAnchorFor]="feedbackPopup" #feedbackPopover="satPopoverAnchor"
                      style="margin-inline-start: 10px !important;" (click)="getFeedback(feedbackPopover,candidate)">
                      <fa-icon icon="comment" class="goal-cursor mat-color-accent" matTooltip="Schedule feedback">
                      </fa-icon>
                    </div>

                  </div>


                </mat-card-title>
                <mat-card-content [style.background]="candidate.color">
                  <span> <b> {{ 'RECRUITMENTSCHEDULES.INTERVIEWTYPE' | translate }} </b>:
                    {{candidate.interviewTypeName}}</span><br>
                  <span> <b> {{ 'RECRUITMENTSCHEDULES.STARTTIME' | translate }} </b>:
                    {{candidate.startTime | time24to12Transform}}</span><br>
                  <span> <b> {{ 'RECRUITMENTSCHEDULES.ENDTIME' | translate }} </b>:
                    {{candidate.endTime | time24to12Transform}}</span>
                </mat-card-content>
              </mat-card>
            </div>
          </div>
        </div>
      </ng-template>
    </kendo-scheduler-day-view>

    <kendo-scheduler-week-view>
      <ng-template kendoSchedulerEventTemplate let-event="event" let-dataItem="dataItem">
        <div fxLayout="row wrap" class="pt-3" fxLayoutGap.xs="0px" fxLayoutGap="15px" id="style-1"
          style="overflow: auto;">
          <div class="full-width">
            <div *ngFor="let candidate of event.dataItem.dataItem" fxFlex>
              <mat-card class="p-0 canteen-manage m-0 ml-05 mr-05 mt-05" style="overflow: auto;" id="style-1">
                <mat-card-title class="full-width data-table-header" style=" width: 325px !important;">
                  <div style="display: flex; max-width: 20px;">
                    <div style="padding: 5px 2px 5px 20px">
                      <app-chip [matTooltip]="candidate.candidateName"
                        class="pull-right avatar-image goal-summary-image" [isNameRequired]="false"
                        [name]="candidate.candidateName | removeSpecialCharacters "
                        [src]="candidate.profileImage | fetchSizedAndCachedImage: '20':''" size="25">
                      </app-chip>
                    </div>
                    <div fxFlex="20" class="hide-content-overflow" style="padding: 5px 116px 1px 2px">
                      <span class="assets-name-control hide-content-overflow">{{candidate.candidateName}}</span>
                    </div>


                    <div fxFlex="33px" class="text-center"
                      *ngIf="candidate.isConfirmed == false&&canAccess_feature_ViewScheduleConfirmation"
                      style="margin-inline-start: 10px !important;" [satPopoverAnchorFor]="confirmPopup"
                      #confirmPopover="satPopoverAnchor" (click)="getConfirm(confirmPopover,candidate)">
                      <fa-icon icon="thumbs-up" class="goal-cursor mat-color-accent"
                        matTooltip="{{ 'RECRUITMENTSCHEDULES.APPROVE' | translate }}">
                      </fa-icon>
                    </div>
                    <div fxFlex="33px" class="text-center"
                      *ngIf="candidate.isConfirmed == true&&canAccess_feature_ViewInterviewFeedback"
                      [satPopoverAnchorFor]="feedbackPopup" #feedbackPopover="satPopoverAnchor"
                      style="margin-inline-start: 10px !important;" (click)="getFeedback(feedbackPopover,candidate)">
                      <fa-icon icon="comment" class="goal-cursor mat-color-accent"
                        matTooltip="{{ 'INTERVIEWPROCESS.FEEDBACK' | translate }}">
                      </fa-icon>
                    </div>

                  </div>

                </mat-card-title>
                <mat-card-content [style.background]="candidate.color">
                  <span> <b> {{ 'RECRUITMENTSCHEDULES.INTERVIEWTYPE' | translate }} </b>:
                    {{candidate.interviewTypeName}}</span><br>
                  <span> <b> {{ 'RECRUITMENTSCHEDULES.STARTTIME' | translate }} </b>:
                    {{candidate.startTime | time24to12Transform }}</span><br>
                  <span> <b> {{ 'RECRUITMENTSCHEDULES.ENDTIME' | translate }} </b>:
                    {{candidate.endTime | time24to12Transform }}</span>
                </mat-card-content>
              </mat-card>
            </div>
          </div>
        </div>
      </ng-template>
    </kendo-scheduler-week-view>

    <kendo-scheduler-month-view>
      <ng-template kendoSchedulerEventTemplate let-event="event" let-dataItem="dataItem">
        <div fxLayout="row wrap" class="pl-2" fxLayoutGap.xs="0px" fxLayoutGap="15px" id="style-1">
          <div class="full-width">
            <div *ngFor="let candidate of event.dataItem.dataItem" fxFlex>
              <div fxFlex="100" style="display: flex;">
                <div fxFlex="10" fxFlex.sm="4" class="goals_summary_member ml-02" style="padding: 3px !important">

                  <app-chip [matTooltip]="candidate.candidateName" class="pull-right avatar-image goal-summary-image"
                    [isNameRequired]="false" [name]="candidate.candidateName | removeSpecialCharacters "
                    [src]="candidate.profileImage | fetchSizedAndCachedImage: '20':''" size="20">
                  </app-chip>
                </div>
                <span style="color: black;" [style.background]="getColorInMonth(candidate.color)">
                  {{candidate.candidateName}}
                </span>

                <span fxFlex="33px" class="text-center"
                  *ngIf="candidate.isConfirmed == false&&canAccess_feature_ViewScheduleConfirmation"
                  [satPopoverAnchorFor]="confirmPopup" style="margin-inline-start: auto !important;"
                  #confirmPopover="satPopoverAnchor" (click)="getConfirm(confirmPopover,candidate)">
                  <fa-icon icon="thumbs-up" class="goal-cursor mat-color-accent"
                    matTooltip="{{ 'RECRUITMENTSCHEDULES.APPROVE' | translate }}">
                  </fa-icon>
                </span>

                <span fxFlex="33px" class="text-center"
                  *ngIf="candidate.isConfirmed == true&&canAccess_feature_ViewInterviewFeedback"
                  [satPopoverAnchorFor]="feedbackPopup" style="margin-inline-start: auto !important;"
                  #feedbackPopover="satPopoverAnchor" (click)="getFeedback(feedbackPopover,candidate)">
                  <fa-icon icon="comment" class="goal-cursor mat-color-accent"
                    matTooltip="{{ 'INTERVIEWPROCESS.FEEDBACK' | translate }}">
                  </fa-icon>
                </span>
              </div>
            </div>
          </div>
        </div>
      </ng-template>
    </kendo-scheduler-month-view>

    <kendo-scheduler-agenda-view [numberOfDays]="30">
      <ng-template kendoSchedulerEventTemplate let-event="event" let-dataItem="dataItem">
        <div fxLayout="row wrap" fxLayoutGap.xs="0px" fxLayoutGap="15px" id="style-1" style="overflow: auto;">
          <div class="full-width">
            <div *ngFor="let candidate of event.dataItem.dataItem" fxFlex>
              <div title="{{ candidate.description }}">
                <div fxLayout="row">
                  <div fxFlex="20" class="hide-content-overflow">
                    <span class="assets-name-control hide-content-overflow" style="color: black !important;"
                      [style.background]="candidate.color"> {{candidate.candidateName}} </span>
                  </div>
                  <div fxFlex="69">
                    <span fxFlex="33px" class="text-center"
                      *ngIf="candidate.isConfirmed == false&&canAccess_feature_ViewScheduleConfirmation"
                      style="margin-inline-start: auto !important;" [satPopoverAnchorFor]="confirmPopup"
                      #confirmPopover="satPopoverAnchor" (click)="getConfirm(confirmPopover,candidate)">
                      <fa-icon icon="thumbs-up" class="goal-cursor mat-color-accent"
                        matTooltip="{{ 'RECRUITMENTSCHEDULES.APPROVE' | translate }}">
                      </fa-icon>
                    </span>

                    <span fxFlex="33px" class="text-center"
                      *ngIf="candidate.isConfirmed == true&&canAccess_feature_ViewInterviewFeedback"
                      [satPopoverAnchorFor]="feedbackPopup" #feedbackPopover="satPopoverAnchor"
                      style="margin-inline-start: auto !important;" (click)="getFeedback(feedbackPopover,candidate)">
                      <fa-icon icon="comment" class="goal-cursor mat-color-accent"
                        matTooltip="{{ 'INTERVIEWPROCESS.FEEDBACK' | translate }}">
                      </fa-icon>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </ng-template>
    </kendo-scheduler-agenda-view>
  </kendo-scheduler>

  <div *ngIf="loadingInProgress" class="k-i-loading"></div>

</div>
<sat-popover #confirmPopup [autoFocus]="false" hasBackdrop backdropClass="backdrop-color" [restoreFocus]="false"
  [interactiveClose]="false" scrollStrategy="reposition" verticalAlign="below" horizontalAlign="before">
  <mat-card class="filter-data p-0">
    <button class="inline_edit_close btn" color="warn" (click)="openClosingPopup()">
      <fa-icon icon="times"></fa-icon>
    </button>
    <mat-card-title class="text-center">
      <div class="card-title-text mat-bg-primary p-05">
        <span>
          {{ 'RECRUITMENTSCHEDULES.APPROVE' | translate }} </span>
      </div>
    </mat-card-title>
    <p class="p-05 m-0"> {{ 'RECRUITMENTSCHEDULES.APPROVECONFIRMATION' | translate }} </p>
    <div class="text-center p-05">
      <button mat-raised-button color="primary" class="mr-05" (click)="approveSchedule(); $event.stopPropagation()"
        [disabled]="loadingInProgress">
        <mat-progress-bar color="primary" mode="indeterminate" *ngIf="loadingInProgress">
        </mat-progress-bar>
        <fa-icon icon="check" class="mr-05"></fa-icon> {{ 'YES' | translate }}
      </button>
      <button mat-raised-button (click)="cancelSchedule(); (false)" [disabled]="loadingInProgress">
        <fa-icon icon="times" class="mr-05"></fa-icon> {{ 'NO' | translate }}
      </button>
    </div>
  </mat-card>
</sat-popover>


<sat-popover #feedbackPopup [autoFocus]="false" hasBackdrop backdropClass="backdrop-color" [restoreFocus]="false"
  [interactiveClose]="false" scrollStrategy="reposition" verticalAlign="below" horizontalAlign="before">
  <mat-card class="filter-data p-0" style="width:500px !important">
    <button class="inline_edit_close btn" color="warn" (click)="closeFeedback(feedbackFormDirective)">
      <fa-icon icon="times"></fa-icon>
    </button>
    <mat-card-title class="text-center">
      <div class="card-title-text mat-bg-primary p-05"> {{ 'INTERVIEWPROCESS.FEEDBACK' | translate }}
      </div>
    </mat-card-title>
    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="anyOperationsInprogress">
    </mat-progress-bar>
    <form [formGroup]="feedForm" novalidate #feedbackFormDirective="ngForm" (submit)="upsertInterviewFeedback()">
      <div class="card-content p-05 mt-05" fxLayout="row" fxLayoutAlign="space-around center">
        <mat-form-field class="full-width ml-05" (click)="$event.stopPropagation();">
          <mat-select formControlName="rate" required placeholder="{{ 'SCHEDULE.SELECTRATING' | translate }}"
            (selectionChange)="changeRating($event.value)" [(ngModel)]="rateId">
            <mat-option [value]="rate.interviewRatingId" *ngFor="let rate of Rating">
              {{rate.interviewRatingName}}
            </mat-option>
          </mat-select>
          <mat-error
            *ngIf="feedForm.get('rate').hasError('required') && feedForm.get('rate').touched">
            {{ 'SCHEDULE.RATINGREQUIRED' | translate }}
          </mat-error>
        </mat-form-field>
        <fa-icon matTooltip="{{'RATINGTYPES.CREATERATINGTYPETOOLTIP' | translate }}"
          [satPopoverAnchorFor]="upsertRatingTypePopover" #upsertRatingTypePopUp="satPopoverAnchor"
          (click)="createRatingType(upsertRatingTypePopUp);clearForm()" icon="plus"
          class="filter mat-color-accent goal-cursor">
        </fa-icon>
        <span fxLayout="column" class="d-grid  ml-05">
          <span fxFlex></span>
          <span fxFlex>
            <fa-icon icon="image" class="filter mat-color-accent goal-cursor" [satPopoverAnchorFor]="FileUploadPopover"
              #FileUploadPopup="satPopoverAnchor" (click)="openFileUploadPopover(FileUploadPopup)">
            </fa-icon>
          </span>
        </span>
      </div>
      <div style="height: 300px; overflow: auto;" id="style-1">
        <div class="custom-hrm-dropzone">
          <app-custom-field-component [moduleTypeId]="moduleTypeId" [referenceTypeId]="referenceId"
            [referenceId]="referenceId" [isDeletePermission]="isrecruitment" [isEditFieldPermission]="isrecruitment"
            [isAddPermission]="isrecruitment">
          </app-custom-field-component>
        </div>
        <div class="unqiue-activity-tab comments-tabslist full-width" *ngIf="isShowcomments">
          <snovasys-crm [receiverId]="selectedInterviewSchedule" [canComment]="true" [canCall]="isPhoneCall"
            [canVideoCall]="isVideoCall" [canCreateRoom]="false" [canJoinRoomOnly]="false" [canPay]="false"
            [componentModel]="componentModel" [isMobileNuberOnly]="true" [isVideoCallFromPopup]="true"
            [isPermissionExists]="true" [isCRM]="true" [mobileNumber]="moblieNumber"></snovasys-crm>
        </div>
        <div class="unqiue-activity-tab comments-tabslist full-width" *ngIf="!isShowcomments">
          <snovasys-crm [receiverId]="selectedInterviewSchedule" [canComment]="true" [canCall]="isPhoneCall"
            [canVideoCall]="isVideoCall" [canCreateRoom]="false" [canJoinRoomOnly]="false" [canPay]="false"
            [componentModel]="componentModel" [isMobileNuberOnly]="true" [isVideoCallFromPopup]="true"
            [isPermissionExists]="true" [isCRM]="true" [mobileNumber]="moblieNumber"></snovasys-crm>
        </div>
      </div>
    </form>
  </mat-card>
</sat-popover>


<!--------dropzone dialog------>
<sat-popover #FileUploadPopover hasBackdrop [interactiveClose]="false" scrollStrategy="reposition">
  <mat-card class="p-0 mr-0 custom-hrm-dropzone">
    <mat-card-title>
      <div class="card-title-text mat-bg-primary p-05" fxLayout="row">
        <div fxFlex class="text-center">
          {{'TESTMANAGEMENT.UPLOADFILES' | translate}}
        </div>
        <div fxFlex="20px" fxLayoutAlign="end center">
          <button class="inline_edit_close_btn btn" (click)="closeFileUploadPopover()">
            <fa-icon icon="times"></fa-icon>
          </button>
        </div>
      </div>
    </mat-card-title>
    <div class="mobile-view-popover p-1">
      <app-dropzone [moduleTypeId]="moduleTypeId" [referenceTypeId]="referenceTypeId"
        [referenceId]="selectedInterviewSchedule" [selectedParentFolderId]="selectedInterviewSchedule"
        [selectedStoreId]="selectedStoreId" [isFromFeedback]="false" [isButtonVisible]="true"
        [getFilesByReferenceId]="true"></app-dropzone>
    </div>
  </mat-card>
</sat-popover>
<!--------dropzone dialog------>
<ng-container *ngIf="!canAccess_feature_ViewRecruitmentSchedule">
  <app-common-message-box textToDisplay="{{'DONTHAVEANYPERMISSIONS'|translate}}">
  </app-common-message-box>
</ng-container>


<sat-popover backdropClass="backdrop-color" #upsertRatingTypePopover [autoFocus]="false" hasBackdrop
  [restoreFocus]="false" [interactiveClose]="false" scrollStrategy="reposition" verticalAlign="below"
  horizontalAlign="end">
  <mat-card class="p-0 mr-0">
    <mat-card-title class="text-center">
      <div class="card-title-text  mat-bg-primary p-05 mb-1">{{ ratingTypeTitle }}
      </div>
    </mat-card-title>
    <mat-card-content class="P-05">
      <form [formGroup]="ratingTypeForm" #formDirective="ngForm" novalidate
        (submit)="ratingTypeForm.valid && upsertRatingType(formDirective)">
        <div>
          <mat-form-field class="full-width">
            <input matInput formControlName="interviewRatingName"
              placeholder="{{'RATINGTYPES.RATINGTYPENAME' | translate }}" required>
            <mat-error *ngIf="ratingTypeForm.get('interviewRatingName').hasError('maxlength')">
              {{ 'RATINGTYPES.NAMEMAXLENGTHERROR' | translate }}</mat-error>
            <mat-error
              *ngIf="ratingTypeForm.get('interviewRatingName').hasError('required') && ratingTypeForm.get('interviewRatingName').touched">
              {{ 'RATINGTYPES.NAMEREQUIREDERROR' | translate }}
            </mat-error>
          </mat-form-field>
          <mat-form-field class="full-width">
            <input matInput formControlName="value" placeholder="{{'RATINGTYPES.VALUE' | translate }}" type="number"
              min="0" required>
            <mat-error *ngIf="ratingTypeForm.get('value').hasError('required') && ratingTypeForm.get('value').touched">
              {{ 'LEAVEENCASHMENTSETTINGS.VALUEREQUIREDERROR' | translate }}
            </mat-error>
          </mat-form-field>
          <mat-error *ngIf="isThereAnError">{{ validationMessage }}</mat-error>
        </div>
        <div class="mt-1 text-center">
          <button mat-raised-button color="primary" class="mr-1"
            [disabled]="!ratingTypeForm.valid||isAnyOperationIsInprogress">
            <mat-progress-bar color="primary" mode="indeterminate" *ngIf="isAnyOperationIsInprogress">
            </mat-progress-bar>
            <fa-icon class="mr-05" icon="check"></fa-icon> {{ 'SAVE' | translate }}
          </button>
          <button mat-button mat-raised-button (click)="closeUpsertRatingTypePopUpPopup(formDirective)" type="button">
            <fa-icon class="mr-05" icon="times"></fa-icon>
            {{ 'CANCEL' | translate }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</sat-popover>