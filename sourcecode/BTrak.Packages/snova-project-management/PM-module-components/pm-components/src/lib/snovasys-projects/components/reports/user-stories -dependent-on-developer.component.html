<!-- <div class="card-title-text p-05">
    <h6><b>{{'GOALREPLANHISTORY.USERSTORYSTATUSREPORT' | translate | softLabelsPipe : softLabels}}</b></h6>
</div> -->
<div class="p-0"
    [ngClass]="dashboardFilters && (dashboardFilters.goalId || dashboardFilters.sprintId) ? 'full-height': ''">
    <!-- <mat-card class="default" class="p-0">
        <mat-card-title class="full-width">
            <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="0" fxLayoutGap.xs="10px">
                <div fxFlex fxLayoutAlign="start center">
                    <button type="submit" mat-icon-button class="pull-right" (click)="filterClick()">
                        <fa-icon icon="filter"  matTooltip=" {{'HRMANAGAMENT.ADVANCESEARCH' | translate}}" [ngClass]="{ 'filter-icon': !isOpen ,'mat-color-accent': isOpen }">
                        </fa-icon>
                    </button>
                </div>
                <div fxFill>
                    <div class="filter-section" [hidden]="!isOpen">
                        <ul>
                            <li class="p-0">
                                <button mat-icon-button
                                    (click)="resetAllFilters()">
                                    <fa-icon  matTooltip="{{'RESET' | translate}}" class="filter mat-color-accent" icon="undo"></fa-icon>
                                </button>
                            </li>
                            <li [ngClass]="{ 'active': selectEmployeeFilterIsActive }"
                                [satPopoverAnchorFor]="namePopover" hasBackdrop (click)="namePopover.toggle()">
                                <a>
                                    <mat-icon>arrow_drop_down</mat-icon>{{'WORKLOGGING.EMPLOYEE' | translate | softLabelsPipe : softLabels}}
                                </a>
                                <sat-popover #namePopover verticalAlign="below" hasBackdrop horizontalAlign="start">
                                    <mat-card class="filter-data">
                                        <mat-form-field>
                                            <mat-select placeholder="{{'WORKLOGGING.SELECTEMPLOYEENAME' | translate | softLabelsPipe : softLabels}}"
                                                [(ngModel)]="selectedEmployeeId"
                                                (selectionChange)="selectedEmployeesId($event.value)">
                                                <mat-option
                                                    *ngFor="let employee of (employeeList$ | async|assigneeFilter: 'id':userStories)"
                                                    [value]="employee.projectMember.id">
                                                    <app-avatar class="employee_img"
                                                        *ngIf="!employee.projectMember.profileImage"
                                                        [name]="employee.projectMember.name | removeSpecialCharacters"
                                                        [isRound]="true" size="30"></app-avatar>
                                                    <img class="employee_img"
                                                        *ngIf="employee.projectMember.profileImage"
                                                        src="{{employee.projectMember.profileImage}}">{{employee.projectMember.name}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </mat-card>
                                </sat-popover>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <mat-divider></mat-divider>
        </mat-card-title>
    </mat-card> -->

    <mat-card class="p-0 canteen-manage m-0 custom-box" fxLayout="column">
        <mat-card-title class="full-width data-table-header">
            <div fxLayout="row wrap" fxLayoutAlign="start center">
                <div class="card-title-text p-05 full-width ml-05 drag-handler" fxFlex fxLayoutAlign="start center">
                    <span class="hide-content-overflow"
                        matTooltip="{{'GOALREPLANHISTORY.USERSTORYSTATUSREPORT' | translate | softLabelsPipe : softLabels | titlecase}}">
                        {{'GOALREPLANHISTORY.USERSTORYSTATUSREPORT' | translate | softLabelsPipe : softLabels | titlecase}}
                    </span>
                </div>
                <div fxFlex="40px" fxLayoutAlign="end center"
                    *ngIf="dashboardFilters && (dashboardFilters.goalId || dashboardFilters.sprintId)">
                    <button mat-icon-button matTooltip="{{'RESET' | translate}}" (click)="resetAllFilters()">
                        <fa-icon class="filter mat-color-accent" icon="undo"></fa-icon>
                    </button>
                </div>
                <div fxFlex="40px" fxLayoutAlign="end center"
                    *ngIf="dashboardFilters && (dashboardFilters.goalId || dashboardFilters.sprintId)">
                    <button type="submit" mat-icon-button (click)="$event.stopPropagation()"
                        [matMenuTriggerFor]="filterMenu" matTooltip=" {{'HRMANAGAMENT.ADVANCESEARCH' | translate}}">
                        <fa-icon icon="filter" [ngClass]="{ 'filter-icon': !isOpen ,'mat-color-accent': isOpen }">
                        </fa-icon>
                    </button>
                </div>
                <mat-menu #filterMenu="matMenu" class="filter-panel" (click)="$event.stopPropagation()">
                    <!-- <button mat-menu-item [matMenuTriggerFor]="nameSearch">
                        {{'WORKLOGGING.EMPLOYEE' | translate | softLabelsPipe : softLabels}}</button> -->
                     <button mat-menu-item [matMenuTriggerFor]="dateFilter">
                        {{'WORKLOGGING.DATE' | translate | softLabelsPipe : softLabels}}</button> 
                </mat-menu>

                <mat-menu #nameSearch="matMenu">
                    <mat-card class="filter-data" (click)="$event.stopPropagation()">
                        <div fxFlex="180px" class="ml-05 mr-05">
                            <mat-form-field>
                                <mat-select
                                    placeholder="{{'WORKLOGGING.SELECTEMPLOYEENAME' | translate | softLabelsPipe : softLabels}}"
                                    [(ngModel)]="selectedEmployeeId"
                                    (selectionChange)="selectedEmployeesId($event.value, $event)">
                                    <mat-option
                                        *ngFor="let employee of (userStories$ | async | assigneeFilter: 'id':userStories | sortByComponent: 'ownerName')"
                                        [value]="employee.ownerUserId">
                                        <app-avatar class="employee_img" *ngIf="!employee.ownerProfileImage"
                                            [name]="employee.ownerName | removeSpecialCharacters" [isRound]="true"
                                            size="30"></app-avatar>
                                        <img class="employee_img" *ngIf="employee.ownerProfileImage"
                                            src="{{employee.ownerProfileImage}}">{{employee.ownerName}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </mat-card>
                </mat-menu>
                <mat-menu #dateFilter="matMenu">
                    <mat-card class="filter-data" (click)="$event.stopPropagation()">
                            <mat-form-field class="full-width">
                                <input [(ngModel)]="dateFrom" matInput [matDatepicker]="picker" (click)="picker.open()"
                                    placeholder="{{'ADVANCEDSEARCH.FROMDATE' | translate}}" [min]="fromDate"
                                    (dateChange)="getDateFrom($event.value)" />
                                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                <mat-datepicker #picker></mat-datepicker>
                            </mat-form-field>
                            <mat-form-field class="full-width">
                                <input [(ngModel)]="dateTo" matInput [matDatepicker]="deadlineDatePicker" autocomplete="false"
                                    placeholder="{{'ADVANCEDSEARCH.TODATE' | translate}}" [min] = "toMinDate"
                                    (dateChange)="getDateTo($event.value)" (click)="deadlineDatePicker.open()" />
                                <mat-datepicker-toggle matSuffix [for]="deadlineDatePicker"></mat-datepicker-toggle>
                                <mat-datepicker #deadlineDatePicker></mat-datepicker>
                            </mat-form-field>
                    </mat-card>
                </mat-menu> 
            </div>
            <mat-divider></mat-divider>
        </mat-card-title>
        <div fxFlex class="p-05" fxLayout="row"
            *ngIf="(employeeName && dashboardFilters && (dashboardFilters.goalId || dashboardFilters.sprintId)) || dateFrom || dateTo">
            <mat-chip disableRipple matRipple class="mr-08" *ngIf="employeeName">
                <b>{{'WORKLOGGING.EMPLOYEE' | translate | softLabelsPipe : softLabels}}:&nbsp;</b>
                {{ employeeName }}
                <fa-icon icon="times" class="ml-05 mat-color-accent cursor-pointer"
                    (click)="selectedEmployeesId('all',null)">
                </fa-icon>
            </mat-chip>
            <mat-chip disableRipple matRipple class="mr-08" *ngIf="dateFrom">
                <b>{{'WORKLOGGING.DATEFROM' | translate}} </b>: {{dateFrom | date: 'dd-MMM-yyyy' }}
                <fa-icon icon="times" class="ml-05 mat-color-accent cursor-pointer" (click)="clearDateFromFilter()">
                </fa-icon>
            </mat-chip>
            <mat-chip matRipple class="mr-08" *ngIf="dateTo">
                <b>{{'WORKLOGGING.DATETO' | translate}}</b> : {{dateTo | date: 'dd-MMM-yyyy' }}
                <fa-icon icon="times" class="ml-05 mat-color-accent cursor-pointer" (click)="clearDateToFilter()">
                </fa-icon>
            </mat-chip>
        </div>
    </mat-card>
    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="anyOperationInProgress"> </mat-progress-bar>
    <div class="no-drag" id="widget-scroll-id">
        <ejs-heatmap [attr.id]="dashboardId" class="heat-map" *ngIf="dashboardId && data"
            style="position: relative; display: block;" [dataSource]='dataSource' [xAxis]='xAxis' [yAxis]='yAxis'
            [paletteSettings]='paletteSettings2' [showTooltip]='showTooltip' [legendSettings]='legendSettings2'
            (tooltipRender)='tooltipRender($event)' [cellSettings]='cellSettings2' [height]='height'>
        </ejs-heatmap>
    </div>
    <div class="p-1" *ngIf="dashboardFilters && (dashboardFilters.goalId || dashboardFilters.sprintId) && !isVisible && !data">
        {{'NODATATOGENERATEREPORT' | translate}}</div>
    <div class="p-1"
        *ngIf="(!dashboardFilters || (!dashboardFilters.goalId && !isFromSprint) || (!dashboardFilters.sprintId && isFromSprint)) && !isVisible">
        <span>{{'PROJECTS.YOUCANTACCESSHERE' | translate}}
            <a class="add-test-case" (click)="navigateToProjects()">{{'TIMEPUNCHCARD.CLICKHERE' | translate}}</a>
            {{'PROJECTS.TONAVIGATETOPROJECTS' | translate | softLabelsPipe : softLabels}}
        </span>
    </div>
</div>