<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>ElementApp</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-alpha2/html2canvas.min.js"></script> -->
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script> -->
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script>
    var global = global || window;
    // var Buffer = Buffer || [];
    var process = process || {
      env: { DEBUG: undefined },
      version: []
    };
  </script>
  <script type="text/javascript">
    async function downloadimageTs(id) {
      /*var container = document.getElementById("image-wrap");*/ /*specific element on page*/
      window.scrollTo(0, 0);
      var container = document.getElementById(id); /* full page */
      // var useWidth = container.style.width;
      // var useHeight = container.style.height;
      // html2canvas(container, 
      // // {
      // //   scrollX: -window.scrollX,
      // //   scrollY: -window.scrollY,
      // //   windowWidth: document.documentElement.offsetWidth,
      // //   windowHeight: document.documentElement.offsetHeight
      // // }
      // ).then(function (canvas) {
      //   var link = document.createElement("a");
      //   document.body.appendChild(link);
      //   link.download = "html_image.jpg";
      //   link.href = canvas.toDataURL();
      //   link.target = '_blank';
      //   link.click();
      // });
      let canvas = await html2canvas(container);
      if(canvas) {
        var link = document.createElement("a");
        document.body.appendChild(link);
        link.download = "Daily Positions & P n L Reporting.jpg";
        link.href = canvas.toDataURL();
        link.target = '_blank';
        link.click();
      }
    }


    function downloadImageJquery(e) {
      // e.preventDefault();

      // var useWidth = $('#htmltoimage').prop('scrollWidth'); //document.getElementById("primary").style.width;
      // var useHeight = $('#htmltoimage').prop('scrollHeight'); //document.getElementById("primary").style.height;

      // html2canvas(document.getElementById("htmltoimage"), { width: useWidth, height: useHeight }).then(function (canvas) {
      //   //document.body.appendChild(canvas);

      //   var image = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");  // here is the most important part because if you dont replace you will get a DOM 18 exception.
      //   //var image = canvas.toDataURL("image/png");  // here is the most important part because if you dont replace you will get a DOM 18 exception.
      //   window.location.href = image; // it will save locally
      //   var link = document.createElement("a");
      //   document.body.appendChild(link);
      //   link.download = "html_image.jpg";
      //   link.href = canvas.toDataURL();
      //   link.target = '_blank';
      //   link.click();
      // })
      // .catch(err => alert(err));
      // $('.element').css('position', 'initial'); // Change absolute to initial
      $my_view = $('#ohhi');
      var useHeight = $('#ohhi').prop('scrollHeight'); 
      html2canvas($my_view[0], {
        height: useHeight,
        useCORS: true,
        allowTaint: true,
        // proxy: "your proxy url",
        onrendered: function (canvas) {
          var imgSrc = canvas.toDataURL();
          var popup = window.open(imgSrc);
          // $('.element').css('position', 'absolute');
        }
      });

    }
  </script>
 
</head>

<body class="egret-btrak">
  <app-root></app-root>
</body>

</html>