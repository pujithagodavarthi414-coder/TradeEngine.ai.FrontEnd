<div class="p-0 m-0 full-height">
    <mat-card class="p-0 m-0">
        <mat-card-title class="data-table-header drag-handler">
            <div fxLayout="row wrap" fxLayoutGap="0">
                <div fxFlex fxLayoutAlign="start center">
                    <div class="card-title-text pl-05 ml-05" matTooltipClass="tooltipClass-mat" matTooltip="{{ 'KYCCONFIG.KYCCONFIGURATIONS' | translate |
                    titlecase}}">{{ 'KYCCONFIG.KYCCONFIGURATIONS' | translate |
                        titlecase}}
                    </div>
                </div>
                <div fxFlex="250px" fxLayout="row" fxLayout.xs="column">
                    <div fxFlex="210px" fxFlex.xs="60px" class="search_goalinput ml-1" fxLayoutAlign="end center"
                        fxLayoutAlign.xs="start center">
                        <div fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
                            <mat-form-field class="full-width">
                                <input class="search_goal" matInput placeholder="Search"
                                    [(ngModel)]="searchText" (input)="filterByName($event)">
                            </mat-form-field>
                        </div>
                        <span class="mr-1 shift-timing-close" fxLayoutAlign="end center"
                            fxLayoutAlign.xs="start center">
                            <span *ngIf="!searchText"></span>
                            <mat-icon *ngIf="searchText" class="icon-button mr-05" aria-hidden="false"
                                (click)="closeSearch()" style="cursor:pointer">
                                close</mat-icon>
                        </span>
                        <button mat-icon-button matTooltipClass="tooltipClass-mat" *ngIf="(canAccess_feature_ConfigureKYC)"
                            matTooltip="{{ 'KYCCONFIG.ADDNEWCONFIGURATION' | translate }}" style="margin-left:34px !important"
                            (click)="openAddNewConfiguration(null,true)" class="mt-02">
                            <fa-icon icon="plus" class="filter mat-color-accent">
                            </fa-icon>
                        </button>
                    </div>
                </div>
            </div>
            <mat-divider></mat-divider>
        </mat-card-title>
    </mat-card>
    <div *ngIf="performanceConfigurations.length > 0 && (canAccess_feature_ConfigureKYC)" class="no-drag">
        <kendo-grid [data]="performanceConfigurationsList" [pageSize]="state.take" [skip]="state.skip" [pageable]="true"
            [sortable]="true" [sort]="state.sort" [filterable]="false" [loading]="isAnyOperationIsInprogress"
            (dataStateChange)="dataStateChange($event)">
            <kendo-grid-column field="clientKycName" title="{{'KYCCONFIG.KYCCONFIGENAME' | translate}}">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <b>
                        {{ dataItem.clientKycName }}
                    </b>
                </ng-template>
            </kendo-grid-column>
            <!-- <kendo-grid-column field="clientTypeName"
                title="{{'CLIENTS.CLIENTS' | translate | softLabelsPipe : softLabels}} {{'KYCCONFIG.TYPE' | translate | softLabelsPipe : softLabels}}">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <b>
                        {{ dataItem.clientTypeName }}
                    </b>
                </ng-template>
            </kendo-grid-column> -->
            <!-- <kendo-grid-column field="legalEntityNames" title="Legal entities">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <b>
                        {{ dataItem.legalEntityNames }}
                    </b>
                </ng-template>
            </kendo-grid-column> -->
            <kendo-grid-column field="isDraft" title="{{'KYCCONFIG.ISDRAFT' | translate}}">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <div *ngIf="dataItem.isDraft == false">
                        {{ 'ROSTER.NO' | translate }}
                    </div>
                    <div *ngIf="dataItem.isDraft == true">
                        {{ 'YES' | translate }}
                    </div>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column field="roleNames" title="{{'ACTIVITYAPPS.ROLES' | translate}}">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <div>
                        {{ dataItem.roleNames }}
                    </div>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column field="createdBy" title="{{'KYCCONFIG.CREATEDBY' | translate}}">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <div>
                        {{ dataItem.createdBy }}
                    </div>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column field="createdOn" title="{{'KYCCONFIG.CREATEDON' | translate}}">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <div>
                        {{ dataItem.createdDatetime | utcToLocalTime | date: 'dd-MMM-yyyy HH:mm' }}
                    </div>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-command-column title="{{'KYCCONFIG.ACTIONS' | translate}}">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <fa-icon class="action-icon-color cursor-pointer mr-1" icon="eye" matTooltipClass="tooltipClass-mat"
                        matTooltip="{{ 'KYCCONFIG.PREVIEWFORM' | translate}}"
                        (click)="openAddNewConfiguration(dataItem,false)"></fa-icon>
                    <fa-icon class="action-icon-color cursor-pointer mr-1" icon="edit"
                        matTooltipClass="tooltipClass-mat" matTooltip="{{ 'KYCCONFIG.EDITCONFIGURATION' | translate}}"
                        (click)="openAddNewConfiguration(dataItem,true)"></fa-icon>
                    <fa-icon class="action-icon-color cursor-pointer mr-1"
                        [satPopoverAnchorFor]="deleteConfigurationPopover" #deleteConfigurationPopup="satPopoverAnchor"
                        matTooltipClass="tooltipClass-mat" matTooltip="{{ 'KYCCONFIG.DELETECONFIGURATION' | translate}}"
                        (click)="openDeletePopup(dataItem,deleteConfigurationPopup)" icon="trash">
                    </fa-icon>
                </ng-template>
            </kendo-grid-command-column>
        </kendo-grid>
    </div>
    <app-common-message-box class="no-drag"
        *ngIf="!isAnyOperationIsInprogress && performanceConfigurations.length === 0 && (canAccess_feature_ConfigureKYC)"
        textToDisplay="{{'KYCCONFIG.YOUDONTHAVEANYCREATEDCONFIGURATIONS' | translate}}">
        <ng-template ng-message-tmp>
            <button mat-button mat-raised-button class="glossy-button-button mr-05 text-center mt-1" color="primary"
                (click)="openAddNewConfiguration(null,true)">
                <fa-icon class="mr-05" icon="plus"></fa-icon>{{'KYCCONFIG.CREATENEWCONFIGURATION' | translate}}
            </button>
        </ng-template>
    </app-common-message-box>
</div>

<sat-popover #deleteConfigurationPopover hasBackdrop horizontalAlign="end">
    <mat-card class="p-1">
        <mat-card-title class="text-center">
            <div class="card-title-text mb-1">{{ 'KYCCONFIG.AREYOUSUREWANTTODELETETHECONFIGURATION' | translate }}
            </div>
        </mat-card-title>
        <div class="text-center">
            <button class="glossy-button-button mr-1" mat-button mat-raised-button color="primary"
                (click)="deleteConfiguration();">
                <fa-icon icon="check" class="mr-05"> </fa-icon> {{ 'YES' | translate }} &nbsp;
            </button>
            <button class="glossy-button-button" mat-button mat-raised-button color="primary"
                (click)="closeDeletePopup();">
                <fa-icon style="color: white;" class="mr-05" icon="times"></fa-icon> {{ 'ROSTER.NO' | translate }}
            </button>
        </div>
    </mat-card>
</sat-popover>

<ng-template #uniqueKycDialog let-data>
    <addKycDialog-dialog [data]=[data]></addKycDialog-dialog>
</ng-template>

<app-common-message-box *ngIf="!(canAccess_feature_ConfigureKYC)  && !(roleFeaturesIsInProgress$|async)"
    textToDisplay="{{ 'PERMISSIONMESSAGE' | translate }}">
</app-common-message-box>