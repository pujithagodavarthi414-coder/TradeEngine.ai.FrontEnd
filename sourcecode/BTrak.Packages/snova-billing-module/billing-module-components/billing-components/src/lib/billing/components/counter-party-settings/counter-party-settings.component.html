<div fxLayout="column" *ngIf="canAccess_feature_ManageClientSettings">
    <mat-card class="p-0 canteen-manage m-0">
        <mat-card-title class="full-width data-table-header drag-handler">
            <div fxLayout="row wrap" fxLayout.xs="column">
                <div class="card-title-text p-05 ml-05" fxFlex="30" fxLayoutAlign="start center">
                    <span fxFlex="100" class="hide-content-overflow"
                        matTooltip="{{'CLIENTSETTINGS.CLIENTSETTINGS' | translate | softLabelsPipe : softLabels}}">{{'CLIENTSETTINGS.CLIENTSETTINGS'
                        | translate | softLabelsPipe : softLabels}}</span>
                </div>
                <div fxFlex fxLayout="row" fxLayout.xs="column">
                    <div fxFlex="calc(100% - 220px)" fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
                    </div>
                    <!-- <div fxFlex="210px" fxFlex.xs="60px" class="search_goalinput ml-1" fxLayoutAlign="end center"
                        style="right:10px;" fxLayoutAlign.xs="start center">
                        <div fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
                            <mat-form-field class="full-width">
                                <input class="search_goal" matInput placeholder="{{'HRMANAGAMENT.SEARCH' | translate}}"
                                    [(ngModel)]="searchText" (input)="filterByName($event)">
                            </mat-form-field>
                        </div>
                        <span class="softlabels-close" fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
                            <span *ngIf="!searchText"></span>
                            <mat-icon *ngIf="searchText" class="icon-button mr-05" aria-hidden="false"
                                (click)="closeSearch()" style="cursor:pointer">
                                close</mat-icon>
                        </span>
                    </div> -->
                </div>
            </div>
            <mat-divider></mat-divider>
        </mat-card-title>
    </mat-card>
    <div fxFlex="row wrap">
        <mat-card style="height: calc(100vh - 100px);" class="p-0">
            <mat-card fxFlex="20" class="pl-0 pr-0 pt-0 mt-02">
                <mat-card-content class="listof_roles tag-card pt-1">
                    <mat-list class="compact-list">
                        <div fxLayout="column" fxLayoutGap="5px" fxLayoutAlign="space-around" class="role-card pt-02"
                            [ngClass]="{ active: isEmail == true }" (click)="emailSelect()">
                            <div fxLayout="row" fxLayoutGap="5px" fxLayoutAlign="space-between center"
                                class="entity-role">
                                <i class="fa fa-history mat-accent-color" style="font-size: 19px;"></i>
                                <span fxFlex class="hide-content-overflow" style="margin-left: 5px !important;"
                                    matTooltipClass="tooltip-overflow">
                                    Settings</span>
                            </div>
                        </div>
                        <div fxLayout="column" fxLayoutGap="5px" fxLayoutAlign="space-around" class="role-card"
                            [ngClass]="{ active: isEmailTemplate == true }" (click)="emailSelect()">
                            <div fxLayout="row" fxLayoutGap="5px" fxLayoutAlign="space-between center"
                                class="entity-role">
                                <i class="fa fa-history mat-accent-color" style="font-size: 19px;"></i>
                                <span fxFlex class="hide-content-overflow" style="margin-left: 5px !important;"
                                    matTooltipClass="tooltip-overflow" matTooltip="Email Template Configuration">
                                    Email Template Configuration</span>
                            </div>
                        </div>
                    </mat-list>
                </mat-card-content>
            </mat-card>
            <mat-card fxFlex class="p-0 mb-md-1" fxFlex="row wrap">
                <div fxFlex="49" class="m-1">
                    <mat-card-title class="text-center mat-bg-primary">
                        <div class="card-title-text p-05">Emails
                        </div>
                    </mat-card-title>
                    <mat-card-content class="p-05" style="width: 100%;">
                        <div fxLayout="row wrap">
                            <mat-form-field class="full-width tags-popup mb-1"
                                hintLabel="{{ 'EXPENSEMANAGEMENT.PLEASEPRESSCOMMAORENTERFORNEXTMAIL' | translate }}">
                                <mat-chip-list #tagsList1>
                                    <mat-chip *ngFor="let tags of toMailsList" [selectable]="selectable"
                                        [removable]="removable" (removed)="removeToMailId(tags)" class="userstory-tags">
                                        <span class="hide-content-overflow" matTooltip="{{ tags }}"
                                            matTooltipClass="tooltip-overflow">
                                            {{tags}}
                                        </span>
                                        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                                    </mat-chip>
                                    <input placeholder="KYC submission emails" [matChipInputFor]="tagsList1"
                                        [(ngModel)]="toMail" [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                        (matChipInputTokenEnd)="addToMailIds($event)">
                                    <!-- <fa-icon icon="spinner" *ngIf="(tagsOperationInProgress$ | async)"></fa-icon> -->
                                </mat-chip-list>
                                <mat-error *ngIf="count == 0">
                                    Please atleast one email
                                </mat-error>

                            </mat-form-field>
                            <mat-form-field class="full-width">
                                <input matInput placeholder="{{ 'COMPANYSETTINGS.DESCRIPTION' | translate }}"
                                    [(ngModel)]="description">
                                <mat-error *ngIf="!description">
                                    Description is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="text-center">
                            <button class="mr-1" mat-button mat-raised-button color="primary"
                                [disabled]="loadingInProgress || (count == 0) || !description"
                                (click)="saveSettings('KYCSubmissionEmails')">
                                <mat-progress-bar color="primary" mode="indeterminate" *ngIf="loadingInProgress">
                                </mat-progress-bar>
                                <fa-icon class="mr-05" icon="check"></fa-icon>{{ 'SAVE' | translate }}
                            </button>
                            <button mat-button mat-raised-button (click)="resetEmails()">
                                <fa-icon class="mr-05" icon="times"></fa-icon> {{'TESTMANAGEMENT.CANCEL' | translate}}
                            </button>
                        </div>
                    </mat-card-content>
                </div>
                <div fxFlex="49" class="m-1">
                    <mat-card-title class="text-center mat-bg-primary">
                        <div class="card-title-text p-05">KYC Duration
                        </div>
                    </mat-card-title>
                    <mat-card-content class="p-05">
                        <form [formGroup]="kycForm" #formDirective="ngForm" novalidate
                            (submit)="kycForm.valid && saveSettings('KYCDuration')">
                            <div>
                                <mat-form-field class="full-width">
                                    <input type="number" matInput formControlName="settingValue"
                                        placeholder="KYC duration" required>
                                    <mat-error>
                                        <span *ngIf="kycForm.get('settingValue').hasError('min')">KYC expiry days should
                                            be
                                            minimun of one day </span>
                                        <span *ngIf="kycForm.get('settingValue').hasError('max')">KYC expiry days should
                                            be
                                            less than two years</span>
                                        <span *ngIf="kycForm.get('settingValue').hasError('required')">KYC duration is
                                            required</span>
                                    </mat-error>
                                </mat-form-field>
                                <mat-form-field class="full-width">
                                    <input matInput formControlName="description"
                                        placeholder="{{ 'COMPANYSETTINGS.DESCRIPTION' | translate }}" required>
                                    <mat-error
                                        *ngIf="kycForm.get('description').hasError('required') && kycForm.get('description').touched">
                                        Description is required
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="mt-1 text-center">
                                <button mat-raised-button color="primary" class="mr-1"
                                    [disabled]="!kycForm.valid||loadingInProgress">
                                    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="loadingInProgress">
                                    </mat-progress-bar>
                                    <fa-icon class="mr-05" icon="check"></fa-icon> {{ 'SAVE' | translate }}
                                </button>
                                <button mat-button mat-raised-button (click)="resetKyc()" type="button">
                                    <fa-icon class="mr-05" icon="times"></fa-icon>
                                    {{ 'CANCEL' | translate }}
                                </button>
                            </div>
                        </form>
                    </mat-card-content>
                </div>
            </mat-card>
        </mat-card>
    </div>
</div>

<app-common-message-box *ngIf="!(canAccess_feature_ManageClientSettings)"
    textToDisplay="{{ 'PERMISSIONMESSAGE' | translate}}">
</app-common-message-box>