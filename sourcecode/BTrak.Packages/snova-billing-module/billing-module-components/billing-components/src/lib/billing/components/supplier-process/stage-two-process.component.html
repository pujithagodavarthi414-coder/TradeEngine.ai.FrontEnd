<div class="custom-dialog">
    <div class="custom-close" mat-dialog-close (click)="onNoClick()">
        <fa-icon icon="times" class="project-dialog"></fa-icon>
    </div>
</div>
<mat-card class="filter-data p-0">
    <mat-card-title class="text-center">
        <div class="card-title-text mat-bg-primary p-05">
            Bill of Entry Details</div>
    </mat-card-title>
    <div class="p-1">
        <form [formGroup]="shipmentStageTwoForm" novalidate #formDirective="ngForm"
            (submit)="shipmentStageTwoForm.valid && saveBlDetails()">
            <div fxLayout="column" style="height: calc(100vh - 215px);" id="style-1" class="pr-05">
                <mat-progress-bar color="primary" mode="indeterminate" *ngIf="isInProgress">
                </mat-progress-bar>
                <div class="masonry-with-columns" fxLayoutAlign="space-between none">
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <mat-select formControlName="chaId" placeholder="{{ 'PURCHASE.CHANAME' |  translate }}">
                                <mat-option value="option" *ngFor="let client of clientData" [value]="client.clientId">
                                    {{client.fullName}}
                                </mat-option>
                            </mat-select>
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('chaId').hasError('required') && shipmentStageTwoForm.get('chaId').touched">
                                    Please select counter party name
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <mat-select formControlName="isDocumentsSent"
                                placeholder="{{ 'PURCHASE.DOCUMENTSSENTTOCHA' |  translate }}">
                                <mat-option value="option" *ngFor="let decision of decisionList"
                                    [value]="decision.value">
                                    {{decision.key}}
                                </mat-option>
                            </mat-select>
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('isDocumentsSent').hasError('required') && shipmentStageTwoForm.get('isDocumentsSent').touched">
                                    Please select documents sent to CHA
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input matInput [matDatepicker]="sentDate" formControlName="sentDate"
                                (click)="sentDate.open();" placeholder="{{ 'PURCHASE.SENTDATE' |  translate }}">
                            <mat-datepicker-toggle matSuffix [for]="sentDate"></mat-datepicker-toggle>
                            <mat-datepicker #sentDate></mat-datepicker>
                            <mat-error class="P-06"
                                *ngIf="shipmentStageTwoForm.get('sentDate').hasError('required') && shipmentStageTwoForm.get('sentDate').touched">
                                Please selected sent date
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24"></div>
                </div>
                <div class="mb-1">
                    <h3>{{ 'PURCHASE.BILLOFENTRYDRAFTDETAILS' | translate }}</h3>
                </div>
                <div class="masonry-with-columns" fxLayoutAlign="space-between none">
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input matInput [matDatepicker]="draftEntryDate" formControlName="draftEntryDate"
                                (click)="draftEntryDate.open();"
                                placeholder="{{ 'PURCHASE.BILLOFENTRYDATE' |  translate }}">
                            <mat-datepicker-toggle matSuffix [for]="draftEntryDate"></mat-datepicker-toggle>
                            <mat-datepicker #draftEntryDate></mat-datepicker>
                            <mat-error class="P-06"
                                *ngIf="shipmentStageTwoForm.get('draftEntryDate').hasError('required') && shipmentStageTwoForm.get('draftEntryDate').touched">
                                Please selected bill of entry date
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="draftBLNumber" matInput
                                placeholder="{{ 'PURCHASE.BILLOFENTRYNUMBER' |  translate }}">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('draftBLNumber').hasError('required') && shipmentStageTwoForm.get('draftBLNumber').touched">Please
                                    enter bill of entry number
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="draftBLDescription" matInput
                                placeholder="{{ 'PURCHASE.BILLOFENTRYDESCRIPTION' |  translate }}">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('draftBLDescription').hasError('required') && shipmentStageTwoForm.get('draftBLDescription').touched">Please
                                    enter bill of entry description
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="draftBasicCustomsDuty" matInput
                                placeholder="{{ 'PURCHASE.BASICSCUSTOMDUTY' |  translate }}">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('draftBasicCustomsDuty').hasError('required') && shipmentStageTwoForm.get('draftBasicCustomsDuty').touched">Please
                                    enter basics custom duty
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="draftSWC" matInput placeholder="{{ 'PURCHASE.SWC' |  translate }}"
                                (keyup)="draftTotal()" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('draftSWC').hasError('required') && shipmentStageTwoForm.get('draftSWC').touched">Please
                                    enter SWC
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="draftIGST" matInput placeholder="{{ 'PURCHASE.IGST' |  translate }}"
                                (keyup)="draftTotal()" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('draftIGST').hasError('required') && shipmentStageTwoForm.get('draftIGST').touched">Please
                                    enter IGST
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="draftEduCess" matInput
                                placeholder="{{ 'PURCHASE.EDUCESS' |  translate }}" (keyup)="draftTotal()" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('draftEduCess').hasError('required') && shipmentStageTwoForm.get('draftEduCess').touched">Please
                                    enter Edu Cess
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="draftOthers" matInput
                                placeholder="{{ 'PURCHASE.OTHERS' |  translate }}" (keyup)="draftTotal()" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('draftOthers').hasError('required') && shipmentStageTwoForm.get('draftOthers').touched">Please
                                    enter other
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="draftTotal" matInput
                                placeholder="{{ 'PURCHASE.TOTAL' |  translate }}" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('draftTotal').hasError('required') && shipmentStageTwoForm.get('draftTotal').touched">Please
                                    enter other
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                    </div>
                </div>
                <app-dropzone [referenceTypeId]="referenceTypeId" [getFilesByReferenceId]="getFilesByReferenceId"
                    class="full-width" [moduleTypeId]="moduleTypeId" [isToUploadFiles]="isToUploadFiles"
                    [referenceId]="purchaseShipmentBLId" [selectedParentFolderId]="selectedParentFolderId"
                    [selectedStoreId]="selectedStoreId" [isButtonVisible]="false" (isFilesExist)="filesExist($event)"
                    [placeHolder]="'Upload bill of entry document'" (closeFilePopup)="onNoClick()">
                </app-dropzone>
                <div class="masonry-with-columns" fxLayoutAlign="space-between none">
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <mat-select formControlName="isConfirmedBill"
                                placeholder="{{ 'PURCHASE.CONFIRMBILLOFENTRY' |  translate }}"
                                (selectionChange)="openMailPopUp($event.value)">
                                <mat-option value="option" *ngFor="let decision of decisionList"
                                    [value]="decision.value">
                                    {{decision.key}}
                                </mat-option>
                            </mat-select>
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('isConfirmedBill').hasError('required') && shipmentStageTwoForm.get('isConfirmedBill').touched">
                                    Please select confirm bill of entry
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input matInput [matDatepicker]="confirmationDate" formControlName="confirmationDate"
                                (click)="confirmationDate.open();"
                                placeholder="{{ 'PURCHASE.PLEASESELECTEDCONFIRMATIONDATE' |  translate }}">
                            <mat-datepicker-toggle matSuffix [for]="confirmationDate"></mat-datepicker-toggle>
                            <mat-datepicker #confirmationDate></mat-datepicker>
                            <mat-error class="P-06"
                                *ngIf="shipmentStageTwoForm.get('confirmationDate').hasError('required') && shipmentStageTwoForm.get('confirmationDate').touched">
                                Please selected confirmation date
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                    </div>
                </div>
                <div class="mb-1">
                    <h3>Bill of Entry Final Details</h3>
                </div>
                <div class="masonry-with-columns" fxLayoutAlign="space-between none">

                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input matInput [matDatepicker]="confoEntryDate" formControlName="confoEntryDate"
                                (click)="confoEntryDate.open();"
                                placeholder="{{ 'PURCHASE.BILLOFENTRYDATE' |  translate }}">
                            <mat-datepicker-toggle matSuffix [for]="confoEntryDate"></mat-datepicker-toggle>
                            <mat-datepicker #confoEntryDate></mat-datepicker>
                            <mat-error class="P-06"
                                *ngIf="shipmentStageTwoForm.get('confoEntryDate').hasError('required') && shipmentStageTwoForm.get('confoEntryDate').touched">
                                Please selected bill of entry date
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="confoBLNumber" matInput
                                placeholder="{{ 'PURCHASE.BILLOFENTRYNUMBER' |  translate }}">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('confoBLNumber').hasError('required') && shipmentStageTwoForm.get('confoBLNumber').touched">Please
                                    enter bill of entry number
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <!-- <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="confoBLDescription" matInput
                                placeholder="Bill of Entry Description">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('confoBLDescription').hasError('required') && shipmentStageTwoForm.get('confoBLDescription').touched">Please
                                    enter bill of entry description
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div> -->
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="confoBasicCustomsDuty" matInput
                                placeholder="{{ 'PURCHASE.BASICSCUSTOMDUTY' |  translate }}">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('confoBasicCustomsDuty').hasError('required') && shipmentStageTwoForm.get('confoBasicCustomsDuty').touched">Please
                                    enter basics custom duty
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="confoSWC" matInput placeholder="{{ 'PURCHASE.SWC' |  translate }}"
                                (keyup)="confoTotal()" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('confoSWC').hasError('required') && shipmentStageTwoForm.get('confoSWC').touched">Please
                                    enter SWC
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="confoIGST" matInput placeholder="{{ 'PURCHASE.IGST' |  translate }}"
                                (keyup)="confoTotal()" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('confoIGST').hasError('required') && shipmentStageTwoForm.get('confoIGST').touched">Please
                                    enter IGST
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="confoEduCess" matInput
                                placeholder="{{ 'PURCHASE.EDUCESS' |  translate }}" (keyup)="confoTotal()" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('confoEduCess').hasError('required') && shipmentStageTwoForm.get('confoEduCess').touched">Please
                                    enter Edu Cess
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="confoOthers" matInput
                                placeholder="{{ 'PURCHASE.OTHERS' |  translate }}" (keyup)="confoTotal()" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('confoOthers').hasError('required') && shipmentStageTwoForm.get('confoOthers').touched">Please
                                    enter other
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input formControlName="confoTotal" matInput
                                placeholder="{{ 'PURCHASE.TOTAL' |  translate }}" mask="separator.2" thousandSeparator=",">
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('confoTotal').hasError('required') && shipmentStageTwoForm.get('confoTotal').touched">Please
                                    enter other
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24"></div>
                </div>
                <div fxFlex="50">
                    <mat-form-field class="full-width">
                        <textarea matInput formControlName="confoBLDescription" rows="1"
                            placeholder="{{ 'PURCHASE.BILLOFENTRYDESCRIPTION' |  translate }}"></textarea>
                        <mat-error>
                            <span
                                *ngIf="shipmentStageTwoForm.get('confoBLDescription').hasError('required') && shipmentStageTwoForm.get('confoBLDescription').touched">Please
                                enter bill of entry description
                            </span>
                        </mat-error>
                    </mat-form-field>
                </div>
                <div fxFlex="50">
                    <app-dropzone [referenceTypeId]="referenceConfirmTypeId"
                        [getFilesByReferenceId]="getFilesByReferenceConfirmId" class="full-width"
                        [moduleTypeId]="moduleTypeId" [isToUploadFiles]="isToUploadConfirmFiles"
                        [referenceId]="purchaseShipmentBLId" [selectedParentFolderId]="selectedConfirmParentFolderId"
                        [selectedStoreId]="selectedConfirmStoreId" [isButtonVisible]="false"
                        (isFilesExist)="filesConfirmExist($event)" [placeHolder]="'Upload final bill of entry document'"
                        (closeFilePopup)="onNoClick()">
                    </app-dropzone>
                </div>
                <div class="masonry-with-columns" fxLayoutAlign="space-between none">
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <mat-select formControlName="confoIsPaymentDone"
                                placeholder="{{ 'PURCHASE.PAYMENTDONE?' |  translate }}">
                                <mat-option value="option" *ngFor="let decision of decisionList"
                                    [value]="decision.value">
                                    {{decision.key}}
                                </mat-option>
                            </mat-select>
                            <mat-error>
                                <span
                                    *ngIf="shipmentStageTwoForm.get('confoIsPaymentDone').hasError('required') && shipmentStageTwoForm.get('confoIsPaymentDone').touched">
                                    Please select documents sent to CHA
                                </span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24">
                        <mat-form-field class="full-width">
                            <input matInput [matDatepicker]="confoPaymentDate" formControlName="confoPaymentDate"
                                (click)="confoPaymentDate.open();"
                                placeholder="{{ 'PURCHASE.PAYMENTDATE' |  translate }}">
                            <mat-datepicker-toggle matSuffix [for]="confoPaymentDate"></mat-datepicker-toggle>
                            <mat-datepicker #confoPaymentDate></mat-datepicker>
                            <mat-error class="P-06"
                                *ngIf="shipmentStageTwoForm.get('confoPaymentDate').hasError('required') && shipmentStageTwoForm.get('confoPaymentDate').touched">
                                Please selected bill of entry date
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24"></div>
                    <div fxFlex.lt-md="100" fxFlex.md="49" fxFlex.lg="32.6" fxFlex="24"></div>
                </div>
            </div>
            <div class="text-center" style="margin-bottom: 15px;">
                <button mat-button mat-raised-button type="submit" color="primary" class="mr-1"
                    [disabled]="!shipmentStageTwoForm.valid || (isInProgress)">
                    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="isInProgress">
                    </mat-progress-bar>
                    <span>
                        <fa-icon class="mr-05" icon="save"></fa-icon>{{'SAVE' | translate }}
                    </span>
                </button>
            </div>
        </form>
    </div>
</mat-card>