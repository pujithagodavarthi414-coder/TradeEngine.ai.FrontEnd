<div *ngIf="(canAccess_feature_AssetComment)">
    <div [ngClass]="isUsingAssetId ? '' : 'full-height'">
        <mat-card class="p-0" [ngClass]="isUsingAssetId ? '' : 'full-height'">
            <mat-card-title class="data-table-header drag-handler">
                <div class="card-title-text p-05 ml-05" *ngIf="isUsingAssetId">
                    {{'ASSETS.COMMENTSANDHISTORY' | translate}}
                </div>
                <div class="card-title-text p-05 ml-05" *ngIf="!isUsingAssetId">
                    {{'ASSETS.ASSETSHISTORY' | translate}}
                </div>
                <mat-divider></mat-divider>
            </mat-card-title>
            <div class="no-drag">
                <!-- [ngClass]="isUsingAssetId ? totalAssetsCommentsCount < 20 ? 'assets-comments-height' : 'assets-comments-height-pagination' : ''" -->
                <mat-card-content class="p-0 mb-0" id="style-1" class="assets-histary"
                    [ngStyle]="{ 'max-height': isUsingAssetId ? 'calc(100vh - 428px)' : 'calc(100vh - 267px)' }">
                    <ng-container *ngIf="!(loadingCommentsAndHistory$ | async)">
                        <div *ngFor="let comment of (assetComments$ | async)" class="history-tab">
                            <div fxLayout="row" fxLayoutGap="10px" class="p-05">
                                <div mat-card-avatar fxFlex="40px" (click)="goToUserProfile(comment.createdByUserId)"
                                    class="icon-button">
                                    <app-avatar [name]="comment.fullName | removeSpecialCharacters"
                                        [src]="comment.profileImage | fetchSizedAndCachedImage: '40':''"
                                        [isRound]="true" size="40">
                                    </app-avatar>
                                </div>
                                <div fxlayout="column" fxFlex="calc(100% - 50px)">
                                    <div fxLayout="row">
                                        <div fxFlex="50" fxFlex.gt-lg="20" fxFlex.lg="30" fxFlex.md="45">
                                            <b>{{comment.fullName}}</b>
                                        </div>
                                        <div fxFlex fxLayoutAlign="end start">
                                            <span class="pull-right" matTooltip="{{comment.createdDateTime| date:'dd-MMM-yyyy, h:mm a' }}">{{comment.createdDateTime | timeago: 'live'
                                                }}</span>
                                        </div>
                                    </div>
                                    <div *ngIf="comment.assetsFieldsChangedList">
                                        <div *ngFor="let description of comment.assetsFieldsChangedList">
                                            <span [innerHTML]="removespaces(description.historyDescription)"
                                                class="assets-comments"></span>
                                        </div>
                                    </div>
                                    <div *ngIf="comment.comment">
                                        <span class="assets-comments">{{ 'GOALACTIVITY.ADDEDCOMMENT' | translate }}
                                            <b>{{comment.comment}}</b></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="(loadingCommentsAndHistory$ | async)">
                        <div *ngFor="let item of [1,2,3]">
                            <div fxLayout="row" fxLayoutGap="10px" class="p-05">
                                <div mat-card-avatar fxFlex="5" fxFlex.md="7" fxFlex.gt-lg="3" fxFlex.xs="13">
                                    <span class="app-user-img"><img class="employee_img"
                                            src="../../../../assets/images/faces/18.png"></span>
                                </div>
                                <div fxFlex fxLayout="column" fxLayoutGap="5px">
                                    <div fxLayout="row" fxLayoutGap="5px">
                                        <div fxFlex="85" fxFlex.gt-xs="80">
                                            <div fxFlex="25">
                                                <p class="mat-body-1 empty-text loading-bg"></p>
                                            </div>
                                            <div fxFlex="75" class="text-center"> </div>
                                        </div>
                                        <div fxFlex="15">
                                            <p class="mat-body-1 empty-text loading-bg"></p>
                                        </div>
                                    </div>
                                    <div fxLayout="row" fxLayoutGap="5px">
                                        <div fxFlex="50">
                                            <p class="mat-body-1 empty-text loading-bg"></p>
                                        </div>
                                        <div fxFlex="50" class="text-center"> </div>
                                    </div>
                                    <div fxLayout="row" fxLayoutGap="5px">
                                        <div fxFlex="70">
                                            <p class="mat-body-1 empty-text loading-bg"></p>
                                        </div>
                                        <div fxFlex="30" class="text-center"> </div>
                                    </div>
                                </div>
                            </div>
                            <mat-divider></mat-divider>
                        </div>
                    </ng-container>
                    <app-common-message-box *ngIf="noCommentsAndHistory"
                        textToDisplay="{{ 'NODATATODISPLAY' | translate }}">
                    </app-common-message-box>
                </mat-card-content>
                <ng-container *ngIf="!(totalAssetsCommentsCount < 20)">
                    <mat-divider></mat-divider>
                    <mat-paginator class="mr-8" [length]="totalAssetsCommentsCount" [pageSize]="pageSize" [pageIndex]="pageIndex"
                        [pageSizeOptions]="pageSizeOptions" (page)="getFilteredAssetComments($event)">
                    </mat-paginator>
                </ng-container>
            </div>
        </mat-card>
    </div>
</div>

<app-common-message-box *ngIf="!(canAccess_feature_AssetComment)" textToDisplay="{{ 'PERMISSIONMESSAGE' | translate }}">
</app-common-message-box>