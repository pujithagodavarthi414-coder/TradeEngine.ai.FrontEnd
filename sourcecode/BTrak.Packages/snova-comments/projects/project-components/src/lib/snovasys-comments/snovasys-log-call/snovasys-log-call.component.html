<div id="snovasys-logcall" class="p-05">
  <form [formGroup]="logCallFormGroup" novalidate (submit)="logCallFormGroup.valid && insertCallLogForm()">
    <div class="card-content">
      <mat-form-field class="full-width">
        <mat-label>{{ 'COMMENTS.CALLER'  | translate}}</mat-label>
        <mat-select placeholder="{{ 'COMMENTS.CALLER' | translate }}" formControlName="callConnectedTo" width="100%" required>
          <mat-option *ngFor="let caller of callerList" [value]="caller.MobileNumber">
            {{caller.Name}}
          </mat-option>
        </mat-select>
        <mat-error
          *ngIf="logCallFormGroup.get('callConnectedTo').hasError('required') && logCallFormGroup.get('callConnectedTo').touched ">
          {{ 'COMMENTS.PLEASEFILLCALLCONNECTEDTO' | translate }}
        </mat-error>
      </mat-form-field>

      <mat-form-field class="full-width">
        <mat-label>{{ 'COMMENTS.OUTCOME'  | translate}}</mat-label>
        <mat-select placeholder="{{ 'COMMENTS.OUTCOME' | translate }}" formControlName="callOutcomeCode" width="100%" required>
          <mat-option *ngFor="let outcome of callOutcomeList" [value]="outcome.outcomeCode">
            {{outcome.outcomeName}}
          </mat-option>
        </mat-select>
        <mat-error
          *ngIf="logCallFormGroup.get('callOutcomeCode').hasError('required') && logCallFormGroup.get('callOutcomeCode').touched ">
          {{ 'COMMENTS.PLEASEFILLCALLOUTCOME' | translate }}
        </mat-error>
      </mat-form-field>

      <div class="full-width">
        <editor formControlName="callDescription" class="dfree-header custom-logtime-comment"
          apiKey="ewi2adl9u4cmc1lic9wcz3zq03696a3ihlodo4n1oaveo3kk" placeholder="Description" menubar="false"
          [init]="initSettings" background="white" *ngIf="isPermissionExists"
          (onKeyUp)="buttonDisabledInProgress($event)">
        </editor>
        <mat-error
          *ngIf="logCallFormGroup.get('callDescription').hasError('required') && logCallFormGroup.get('callDescription').touched ">
          {{ 'COMMENTS.PLEASEFILLCALLDESCRIPTION' | translate }}
        </mat-error>
        <mat-error *ngIf="logCallFormGroup.get('callDescription').hasError('maxlength') || isCommentsTextValidation">
          {{ 'COMMENTS.CALLDESCRIPTIONEXCEED1000CHARACTERS' | translate }}
        </mat-error>
      </div>

      <mat-form-field class="full-width">
        <mat-label>{{ 'COMMENTS.CALLLOGDATE'  | translate}}</mat-label>
        <input matInput formControlName="callLoggedDate" [matDatepicker]="inputpicker1" (click)="inputpicker1.open()"
          readonly [max]="maxDate" placeholder="{{'COMMENTS.CALLLOGDATE' | translate}}" autocomplete="off" required>
        <mat-datepicker-toggle matSuffix [for]="inputpicker1"></mat-datepicker-toggle>
        <mat-datepicker #inputpicker1></mat-datepicker>
        <mat-error
          *ngIf="logCallFormGroup.get('callLoggedDate').hasError('required') && logCallFormGroup.get('callLoggedDate').touched ">
          {{ 'COMMENTS.PLEASEFILLCALLLOGDATE' | translate }}
        </mat-error>
      </mat-form-field>

      <mat-form-field class="full-width">
        <mat-label>{{ 'COMMENTS.CALLLOGTIME'  | translate}}</mat-label>
        <input matInput formControlName="callLoggedTime" placeholder="{{'COMMENTS.CALLLOGTIME' | translate}}"
          aria-label="24hr format" [ngxTimepicker]="fromTime" [format]="24" readonly required/>
        <ngx-material-timepicker #fromTime [cancelBtnTmpl]="cancelBtn" [confirmBtnTmpl]="confirmBtn">
        </ngx-material-timepicker>
        <mat-error
          *ngIf="logCallFormGroup.get('callLoggedTime').hasError('required') && logCallFormGroup.get('callLoggedTime').touched ">
          {{ 'COMMENTS.PLEASEFILLCALLLOGTIME' | translate }}
        </mat-error>
      </mat-form-field>

      <ng-template #cancelBtn>
        <p class="feedtimesheet-datepicker-button" style="margin-right: 10px;">
          {{'CANCEL' | translate}}</p>
      </ng-template>
      <ng-template #confirmBtn>
        <p class="feedtimesheet-datepicker-button">{{'COMMENTS.OK' | translate}}</p>
      </ng-template>
    </div>
    <div class="text-center">
      <button class="mr-1" mat-button mat-raised-button color="primary" type="submit"
        [disabled]="!logCallFormGroup.valid || isAnyOperationIsInProgress">
        <mat-progress-bar color="primary" mode="indeterminate" *ngIf="isAnyOperationIsInProgress">
        </mat-progress-bar>
        <fa-icon class="mr-05" icon="save"></fa-icon> {{ 'CRM.SAVEFORM' | translate }}
      </button>
      <button mat-button mat-raised-button type="button" (click)="closeLogCallFormDialog(false)">
        <fa-icon class="mr-05" icon="times"></fa-icon> {{ 'CANCEL' | translate }}
      </button>
    </div>
  </form>
</div>
