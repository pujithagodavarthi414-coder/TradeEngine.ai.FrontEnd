<div *ngIf="(canAccess_feature_LateEmployeesCountVsDate)">
  <mat-card class="m-0 p-0">
    <mat-card-title class="full-width data-table-header drag-handler">
      <div fxLayout="row wrap" fxLayoutGap="0" fxLayoutGap.xs="10px">
        <div fxFlex fxLayoutAlign="start center" class="card-title-text p-05 full-width">
          <span fxFlex="100" class="hide-content-overflow"
            matTooltip="{{'LATEEMPLOYEECOUNTVSDATE.LUNCHBREAKLATEEMPLOYEESCOUNTVSDATESUMMARY' | translate | softLabelsPipe : softLabels | titlecase}}">{{'LATEEMPLOYEECOUNTVSDATE.LUNCHBREAKLATEEMPLOYEESCOUNTVSDATESUMMARY' | translate | softLabelsPipe : softLabels | titlecase}}
          </span>
        </div>

        <div fxFlex="40px" fxFlex.xs="25px" fxLayoutAlign="end center" class="ml-02">
          <button mat-icon-button matTooltip="{{'RESET' | translate}}" (click)="resetAllFilters()">
            <fa-icon class="filter mat-color-accent" icon="undo"></fa-icon>
          </button>
        </div>
        <div fxFlex="40px" fxFlex.xs="25px" fxLayoutAlign="end center">
          <button type="submit" mat-icon-button class="pull-right" (click)="filterClick()"
            [matMenuTriggerFor]="filterMenu" matTooltip=" {{'HRMANAGAMENT.ADVANCESEARCH' | translate}}">
            <fa-icon icon="filter" [ngClass]="{ 'filter-icon': !isOpen ,'mat-color-accent': isOpen }">
            </fa-icon>
          </button>
        </div>

        <mat-menu #filterMenu="matMenu" class="filter-panel" (click)="$event.stopPropagation()">
          <button mat-menu-item [ngClass]="{ 'active': selectBranchFilterIsActive }" [matMenuTriggerFor]="branchSearch"
            *ngIf="entities?.length > 1">
            {{'LOGTIMEREPORT.ENTITY' | translate}}</button>
          <button mat-menu-item [ngClass]="{ 'active': selectDepartmentFilterIsActive }"
            [matMenuTriggerFor]="departmentSearch"> {{'LOGTIMEREPORT.DEPARTMENT' | translate }}</button>
          <button mat-menu-item [ngClass]="{ 'active': selectDesignationFilterIsActive }"
            [matMenuTriggerFor]="designationSearch">{{'LOGTIMEREPORT.DESIGNATION' | translate }}</button>
          <button mat-menu-item [hidden]="!(lineManager?.length > 0)" [ngClass]="{ 'active': selectLineManagerfilter }"
            [matMenuTriggerFor]="linemanagerSearch">{{'LOGTIMEREPORT.LINEMANAGER'|translate}}</button>
          <button mat-menu-item [ngClass]="{ 'active': fromDateIsActive }"
            [matMenuTriggerFor]="fromDateSearch">{{'MYPROFILE.FROMDATE' | translate}}</button>
          <button mat-menu-item [ngClass]="{ 'active': toDateFilter }"
            [matMenuTriggerFor]="toDateSearch">{{'MYPROFILE.TODATE' | translate}}</button>
        </mat-menu>
        <mat-menu #branchSearch="matMenu">
          <mat-card class="filter-data" (click)="$event.stopPropagation()">
            <mat-form-field>
              <mat-select placeholder="{{ 'WIDGETS.SELECTBRANCH' | translate }}" [(ngModel)]="selectedEntity"
                (selectionChange)="entityValues($event.value)">
                <mat-option *ngFor="let entity of entities" [value]="entity.id">
                  {{entity.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </mat-card>
        </mat-menu>
        <mat-menu #departmentSearch="matMenu">
          <mat-card class="filter-data" (click)="$event.stopPropagation()">
            <mat-form-field>
              <mat-select placeholder="{{'LOGTIMEREPORT.SELECTDEPARTMENT' | translate }}" [(ngModel)]="departmentId"
                (selectionChange)="selectedDepartmentId($event.value)">
                <mat-option value="0">{{'ADVANCEDSEARCH.SELECTALL' | translate}}</mat-option>
                <mat-option *ngFor="let department of departments" [value]="department.departmentId">
                  {{department.departmentName}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </mat-card>
        </mat-menu>
        <mat-menu #designationSearch="matMenu">
          <mat-card class="filter-data" (click)="$event.stopPropagation()">
            <mat-form-field>
              <mat-select placeholder="{{'LOGTIMEREPORT.SELECTDESIGNATION' | translate }}" [(ngModel)]="designationId"
                (selectionChange)="selectedDesignationId($event.value)">
                <mat-option value="0">{{'ADVANCEDSEARCH.SELECTALL' | translate}}</mat-option>
                <mat-option *ngFor="let designation of designations" [value]="designation.designationId">
                  {{designation.designationName}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </mat-card>
        </mat-menu>
        <mat-menu #linemanagerSearch="matMenu">
          <mat-card class="filter-data" (click)="$event.stopPropagation()">
            <mat-form-field>
              <mat-select placeholder="{{'LOGTIMEREPORT.SELECTLINEMANAGER'|translate}}" [(ngModel)]="teamLeadId"
                (selectionChange)="selectedLineManagerId($event.value)">
                <mat-option value="0">{{'ADVANCEDSEARCH.ALL' | translate}}</mat-option>
                <mat-option [value]="person.userId" *ngFor="let person of lineManager">
                  <app-avatar class="employee_img" *ngIf="!person.profileImage"
                    [name]="person.userName | removeSpecialCharacters" [isRound]="true" size="30"></app-avatar>
                  <img class="employee_img" *ngIf="person.profileImage"
                    src="{{person.profileImage}}">{{person.userName}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </mat-card>
        </mat-menu>
        <mat-menu #fromDateSearch="matMenu">
          <mat-card class="filter-data" (click)="$event.stopPropagation()">
            <mat-form-field>
              <mat-label>{{'MYPROFILE.FROMDATE' | translate}}</mat-label>
              <input matInput [matDatepicker]="picker1" [(ngModel)]="fromDate" (click)="picker1.open()"
                autocomplete="off" (input)="onDateFromChange($event)" (dateChange)="onDateFromChange($event)"
                [min]="minDate" class="date-picker" [readonly]="true">
              <mat-datepicker-toggle matSuffix [for]="picker1">
              </mat-datepicker-toggle>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
          </mat-card>
        </mat-menu>
        <mat-menu #toDateSearch="matMenu">
          <mat-card class="filter-data" (click)="$event.stopPropagation()">
            <mat-form-field>
              <mat-label>{{'MYPROFILE.TODATE' | translate}}</mat-label>
              <input matInput [matDatepicker]="picker2" [(ngModel)]="toDate" (click)="picker2.open()" autocomplete="off"
                [readonly]="true" class="date-picker" (dateChange)="onDateToChange($event)" [min]="minstartdate"
                [(ngModel)]="dateTo" [readonly]="true">
              <mat-datepicker-toggle matSuffix [for]="picker2">
              </mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </mat-card>
        </mat-menu>
      </div>
      <mat-divider></mat-divider>
    </mat-card-title>
  </mat-card>
  <google-chart [data]="columnChart" (chartReady)="ready()" (chartError)='error()'></google-chart>

</div>
<app-common-message-box *ngIf="!(canAccess_feature_LateEmployeesCountVsDate) && !(roleFeaturesIsInProgress$|async)"
  textToDisplay="{{ 'PERMISSIONMESSAGE' | translate }}">
</app-common-message-box>
