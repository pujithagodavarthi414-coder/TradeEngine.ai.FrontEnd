<div class="custom-dialog">
  <div class="custom-close" mat-dialog-close (click)="closeDialog()">
    <fa-icon icon="times" class="project-dialog"></fa-icon>
  </div>
</div>
<div *ngIf="!isGrpIndex">
  <mat-card class="p-0 mr-0" style="margin-left: 0px !important;margin-bottom: -1px !important;">
    <mat-card-title class="full-width data-table-header drag-handler">
      <div fxLayout="row wrap">
        <div fxFlex fxLayoutAlign="start center" class="card-title-text p-05 full-width">
          <span fxFlex="100" class="hide-content-overflow">
            {{'DrillDownReport.USERSTORYLIST'| translate | softLabelsPipe : softLabels | titlecase}}
          </span>
        </div>
        <div fxFlex.gt-xs="180px" fxFlex.xs="100px" class="ml-05 mr-05 search_goalinput" fxLayoutAlign="end center"
          fxLayoutAlign.xs="center center">
          <mat-form-field ngClass.xs="full-width">
            <input class="search_goal" matInput placeholder="{{'SEARCH' | translate}}" [(ngModel)]="searchText"
              (input)="searchRecords()">
          </mat-form-field>
          <span class="close_icon" style="margin-top: -4px !important;
                  margin-right: -30px !important;">
            <span
              *ngIf="!searchText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
            <mat-icon *ngIf="searchText" class="icon-button" aria-hidden="false" (click)="closeSearch()"
              style="cursor:pointer">
              close</mat-icon>
          </span>
        </div>
        <div fxFlex="40px" fxLayoutAlign="end center" *ngIf="isFromEmployeeIndex">
          <button mat-icon-button (click)="exportToExcel()" matTooltip="{{ 'APP.EXPORTDATATOEXCEL' | translate }}">
            <mat-progress-bar color="primary" mode="indeterminate" *ngIf="excelDrillDownLoading">
            </mat-progress-bar>
            <fa-icon class="mat-color-accent cursor-pointer" icon="file-excel">
            </fa-icon>
          </button>
        </div>
      </div>
    </mat-card-title>
  </mat-card>
  <div class="activity-data filter-margin m-0 app-height-search-2 no-drag" id="style-1">
    <kendo-grid [data]="gridView" style="min-height: 150px;max-height: 670px;" [filter]="state.filter" [skip]="skip"
      [sort]="sortBy" [sortable]="true" [scrollable]="true" [pageSize]="pageSize" [pageable]="true"
      (pageChange)="pageChange($event)" (cellClick)="navigateToUserStoriesPage($event)"
      (sortChange)="sortChange($event)">
      <kendo-grid-column field="userStoryName" width="330"
        title="{{'DrillDownReport.USERSTORYNAME'| translate | softLabelsPipe : softLabels}}">
      </kendo-grid-column>
      <kendo-grid-column field="userStoryUniqueName"
        title="{{'DrillDownReport.USERSTORYUNIQUENAME'| translate | softLabelsPipe : softLabels}}" width="140">
      </kendo-grid-column>
      <kendo-grid-column field="goalName"
        title="{{'DrillDownReport.GOALNAME'| translate | softLabelsPipe : softLabels}}" width="100">
      </kendo-grid-column>
      <kendo-grid-column field="sprintName"
        title="{{'DrillDownReport.SPRINTNAME'| translate | softLabelsPipe : softLabels}}" width="100">
      </kendo-grid-column>
      <kendo-grid-column field="projectName"
        title="{{'DrillDownReport.PROJECTNAME'| translate | softLabelsPipe : softLabels}}" width="100">
      </kendo-grid-column>
      <kendo-grid-column field="estimatedTime"
        title="{{'DrillDownReport.ESTIMATEDTIME'| translate | softLabelsPipe : softLabels}}" width="100">
        <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
          {{dataItem?.estimatedTime?dataItem.estimatedTime:0}}
        </ng-template>
      </kendo-grid-column>
    </kendo-grid>
  </div>
</div>

<div *ngIf="isGrpIndex">
  <mat-card class="p-0 mr-0" style="margin-left: 0px !important;margin-bottom: -1px !important;">
    <mat-card-title class="full-width data-table-header drag-handler">
      <div fxLayout="row wrap">
        <div fxFlex fxLayoutAlign="start center" class="card-title-text p-05 full-width">
          <span fxFlex="100" class="hide-content-overflow">
            {{'DrillDownReport.GRPINDEX'| translate | softLabelsPipe : softLabels}}
          </span>
        </div>
        <div fxFlex.gt-xs="180px" fxFlex.xs="100px" class="ml-05 mr-05 search_goalinput" fxLayoutAlign="end center"
          fxLayoutAlign.xs="center center">
          <mat-form-field ngClass.xs="full-width">
            <input class="search_goal" matInput placeholder="{{'SEARCH' | translate}}" [(ngModel)]="searchText"
              (input)="searchRecords()">
          </mat-form-field>
          <span class="close_icon" style="margin-top: -4px !important;
              margin-right: -30px !important;">
            <span
              *ngIf="!searchText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
            <mat-icon *ngIf="searchText" class="icon-button" aria-hidden="false" (click)="closeSearch()"
              style="cursor:pointer;">
              close</mat-icon>
          </span>
        </div>
        <div fxFlex="40px" fxLayoutAlign="end center" *ngIf="isFromEmployeeIndex">
          <button mat-icon-button (click)="exportToExcel()" matTooltip="{{ 'APP.EXPORTDATATOEXCEL' | translate }}">
            <mat-progress-bar color="primary" mode="indeterminate" *ngIf="excelDrillDownLoading">
            </mat-progress-bar>
            <fa-icon class="mat-color-accent cursor-pointer" icon="file-excel">
            </fa-icon>
          </button>
        </div>
      </div>
    </mat-card-title>
  </mat-card>

  <kendo-grid [data]="gridView" style="min-height: 150px;max-height: 580px;" [filter]="state.filter" [skip]="skip"
    [sort]="sortBy" [sortable]="true" [scrollable]="true" [pageSize]="pageSize" [pageable]="true"
    (pageChange)="pageChange($event)" (cellClick)="navigateToGoalPage($event)" (sortChange)="sortChange($event)">
    <kendo-grid-column field="goalName" title="{{'DrillDownReport.GOALNAME'| translate | softLabelsPipe : softLabels}}"
      width="150">
    </kendo-grid-column>
    <kendo-grid-column field="goalGrpTotal"
      title="{{'DrillDownReport.GRPINDEX'| translate | softLabelsPipe : softLabels}}" width="150">
    </kendo-grid-column>
  </kendo-grid>

</div>