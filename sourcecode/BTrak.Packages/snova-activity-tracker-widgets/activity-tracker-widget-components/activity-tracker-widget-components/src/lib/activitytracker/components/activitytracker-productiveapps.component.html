<div class="full-height" *ngIf="canAccess_feature_ManageAppsAndUrls">
    <mat-card class="p-0 canteen-manage m-0 drag-handler">
        <mat-card-title class="full-width data-table-header">
            <div fxLayout="row wrap" fxLayoutAlign="start center">
                <div class="card-title-text p-05 full-width ml-05" fxFlex fxLayoutAlign="start center"
                    matTooltip=" {{'ACTIVITYTRACKER.PRODUCTIVEAPPS' | translate | titlecase}}">
                    <span fxFlex="100" class="hide-content-overflow">
                        {{'ACTIVITYTRACKER.PRODUCTIVEAPPS' | translate | titlecase}} </span>
                </div>
                <!-- <div fxFlex="40px" fxLayoutAlign="end center">
                    <div class="ml-05 mr-05 search_goalinput">
                        <mat-form-field class="full-width">
                            <input class="search_goal" matInput placeholder="{{'SEARCH' | translate}}"
                                [(ngModel)]="searchText" (input)="search($event)">
                        </mat-form-field>
                        <span class="close_icon">
                            <span *ngIf="!searchText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                            <mat-icon *ngIf="searchText" class="icon-button" aria-hidden="false" (click)="closeSearch()"
                                style="cursor:pointer">
                                close</mat-icon>
                        </span>
                    </div>
                </div>
                <div fxFlex="40px" fxLayoutAlign="end center">
                    <button mat-icon-button matTooltip="{{'ACTIVITYTRACKER.ADDAPPLICATION' | translate}}"
                        [satPopoverAnchorFor]="addIsProductivePopover" #addIsProductivePopup="satPopoverAnchor"
                        (click)="addProductiveAppPopup(addIsProductivePopup);formValidate()">
                        <fa-icon class="filter mat-color-accent" icon="plus"></fa-icon>
                    </button>
                </div> -->
                <div fxFlex="210px" fxFlex.xs="60px" class="search_goalinput ml-1 mr-05" fxLayoutAlign="end center"
                    fxLayoutAlign.xs="start center">
                    <div fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
                        <mat-form-field class="full-width">
                            <input class="search_goal" matInput placeholder="{{'HRMANAGAMENT.SEARCH' | translate}}"
                                [(ngModel)]="searchText" (input)="search($event)">
                        </mat-form-field>
                    </div>
                    <span class="close_icon_search masterdata-search-close" fxLayoutAlign="end center"
                        fxLayoutAlign.xs="start center" style="right: 0px !important">
                        <span *ngIf="!searchText"></span>
                        <mat-icon *ngIf="searchText" class="icon-button mr-05" aria-hidden="false"
                            (click)="closeSearch()" style="cursor:pointer">
                            close</mat-icon>
                    </span>
                    <!-- <button mat-icon-button matTooltip="{{'ACTIVITYTRACKER.ADDAPPLICATION' | translate}}"
                        [satPopoverAnchorFor]="addIsProductivePopover" #addIsProductivePopup="satPopoverAnchor"
                        (click)="addProductiveAppPopup(addIsProductivePopup);formValidate()">
                        <fa-icon class="filter mat-color-accent" icon="plus"></fa-icon>
                    </button> -->
                </div>
            </div>
            <mat-divider></mat-divider>
        </mat-card-title>
    </mat-card>
    <mat-progress-bar mode="indeterminate" *ngIf="loading"></mat-progress-bar>
    <div class="activity-data custom-table-height pagination-move-left" id="style-1" [ngClass] = "rowData.length == 0 ? 'productive-count' : ''">
        <ngx-datatable class="btrak" [columnMode]="'force'" [headerHeight]="35" [footerHeight]="35" [rowHeight]="40"
            [scrollbarH]="true" [messages]="{emptyMessage:('NODATATODISPLAY' | translate), totalMessage: 'TOTAL' | translate}"
            [rows]="rowData">
            <ngx-datatable-column name="{{ 'ACTIVITYTRACKER.APPICON' | translate }}" [flexGrow]="1" [sortable]="false"
                [width]="250"> 
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                    <div *ngIf="row?.appUrlImage" style="cursor: pointer;">
                        <!-- <button mat-icon-button class="img-button productive-app-img"> -->
                        <app-avatar [src]="row?.appUrlImage" [isRound]="true" size="30"
                            (click)="openModal(row?.appUrlImage)">
                        </app-avatar>
                        <!-- </button> -->
                    </div>
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="{{'ACTIVITYTRACKER.APPLICATIONNAME' | translate}}" [flexGrow]="1"
                prop='appUrlName' [width]="300">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <label class="assets-name-control hide-content-overflow activity-font-color mb-0 mt-05"
                        matTooltip="{{ row?.appUrlName }}">{{ row?.appUrlName }}</label>
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="{{'ACTIVITYTRACKER.APPLICATIONCATEGORYNAME'|translate}}" [flexGrow]="1"
                [sortable]="true" prop="applicationCategoryName" [width]="280">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    {{ row?.applicationCategoryName }}
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="{{'ACTIVITYTRACKER.PRODUCTIVEROLES' | translate}}" [flexGrow]="1" prop='role'
                [sortable]="false" [width]="330">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <label class="assets-name-control hide-content-overflow activity-font-color mb-0 mt-05"
                        matTooltip="{{ row?.productiveRoleNames }}" matTooltipClass="tooltip-overflow">{{
                        row?.productiveRoleNames }}</label>
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="{{'ACTIVITYTRACKER.UNPRODUCTIVEROLES' | translate}}" [flexGrow]="1" prop='role'
                [sortable]="false" [width]="330">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <label class="assets-name-control hide-content-overflow activity-font-color mb-0 mt-05"
                        matTooltip="{{ row?.unproductiveRoleNames }}" matTooltipClass="tooltip-overflow">{{
                        row?.unproductiveRoleNames }}</label>
                </ng-template>
            </ngx-datatable-column>
            <!-- <ngx-datatable-column name="{{'ACTIVITYTRACKER.ISPRODUCTIVE' | translate}}" [flexGrow]="1"
                prop='isProductive'>
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <label *ngIf="row?.isProductive"
                        class="assets-name-control hide-content-overflow activity-font-color mb-0 mt-05"
                        matTooltip="Yes">Yes</label>
                    <label *ngIf="!row?.isProductive"
                        class="assets-name-control hide-content-overflow activity-font-color mb-0 mt-05"
                        matTooltip="No">No</label>
                </ng-template>
            </ngx-datatable-column> -->
            <ngx-datatable-column name="{{'ACTIVITYTRACKER.ACTION' | translate}}" [flexGrow]="1" [sortable]="false"
                [width]="300">
                <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                    <fa-icon class="icon-button mat-color-accent mr-05" icon="edit"
                        matTooltip="{{'ACTIVITYTRACKER.EDITAPPLIACTION' | translate}}"
                        [satPopoverAnchorFor]="addIsProductivePopover" #addIsProductivePopup="satPopoverAnchor"
                        (click)="editAppUrls(row,addIsProductivePopup)">
                    </fa-icon>
                    <fa-icon class="icon-button mat-color-accent mr-05" icon="trash"
                        matTooltip="{{'ACTIVITYTRACKER.DELETEAPPLICATION' | translate}}"
                        [satPopoverAnchorFor]="deleteIsProductivePopover" #deleteIsProductivePopup="satPopoverAnchor"
                        (click)="deleteAppUrls(row,deleteIsProductivePopup)">
                    </fa-icon>
                </ng-template>
            </ngx-datatable-column>
        </ngx-datatable>
    </div>

    <!-- <div class="floating-right-fab-button">
        <div class="handle">
            <button mat-fab color="accent" matTooltip="{{'ACTIVITYTRACKER.ADDAPPLICATION' | translate}}"
                [satPopoverAnchorFor]="addIsProductivePopover" #addIsProductivePopup="satPopoverAnchor"
                (click)="addProductiveAppPopup(addIsProductivePopup);formValidate()">
                <mat-icon>add</mat-icon>
            </button>
        </div>
    </div> -->
</div>
<sat-popover #addIsProductivePopover [autoFocus]="false" hasBackdrop backdropClass="backdrop-color"
    [restoreFocus]="false" [interactiveClose]="false" scrollStrategy="reposition" verticalAlign="center"
    horizontalAlign="before">
    <mat-card class="filter-data p-0" fxFlex="320px">
        <mat-card-title class="text-center">
            <div class="card-title-text mat-bg-primary p-05">{{application}}
            </div>
        </mat-card-title>
        <form [formGroup]="addProductiveAppForm" novalidate #passwordFormDirective="ngForm"
            (submit)="addProductiveApp(passwordFormDirective)">
            <div class="card-content p-05 mt-05" fxLayout="column">
                <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                    <input matInput formControlName="appUrlName"
                        placeholder="{{'ACTIVITYTRACKER.APPLICATIONNAME' | translate}}" required />
                    <mat-error>
                        <span
                            *ngIf="addProductiveAppForm.get('appUrlName').hasError('required') && addProductiveAppForm.get('appUrlName').touched">
                            {{'ACTIVITYTRACKER.PLEASEENTERAPPLICATIONNAME' | translate}}</span>
                        <span
                            *ngIf="addProductiveAppForm.get('appUrlName').hasError('required') && addProductiveAppForm.get('appUrlName').untouched">
                            {{'ACTIVITYTRACKER.PLEASEENTERAPPLICATIONNAME' | translate}}</span>
                        <span *ngIf="addProductiveAppForm.get('appUrlName').hasError('maxlength')">
                            {{'ACTIVITYTRACKER.APPLICATIONNAMEHASEXCEEDEDTHEMAXIMUMLENTH' | translate}}</span>
                    </mat-error>
                </mat-form-field>
                <div class="ml-1" [hidden]="isDropzone" fxFlex>
                    <!-- <app-avatar [src]="imageUrl" [isRound]="true" value="0" size="30">
                    </app-avatar> -->
                    <img class="app-image-preview" src="{{imageUrl}}" />
                    <a class="image_close" (click)="enableDropZone()"
                        style="right: 23px; top: 53px; border-radius: 12px;background-color: #7f7777db !important;">
                        <fa-icon icon="times" style="color: #292929 !important;"></fa-icon>
                    </a>
                </div>
                <div [hidden]="!isDropzone">
                    <!-- <ngx-dropzone #fileDropzone fxFlex="100" [ngStyle]="{'height':'150px','overflow':'hidden'}"
                        [accept]="'image/png,image/jpeg,image/jpg'" [multiple]="false" (change)="onSelect($event)"
                        [maxFileSize]="5514432">
                        <ngx-dropzone-label>{{'ACTIVITYTRACKER.ADDAPPICON' | translate}}</ngx-dropzone-label>
                        <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" *ngFor="let f of selectedFiles"
                            [file]="f" [removable]="true" (removed)="onRemove(f)">
                            <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                        </ngx-dropzone-image-preview>
                    </ngx-dropzone> -->
                    <ngx-dropzone #fileDropzone fxFlex="100" [ngStyle]="{'height':'150px','overflow':'hidden'}"
                        [accept]="'image/png,image/jpeg,image/jpg'" [multiple]="false" (change)="onSelect($event)"
                        [maxFileSize]="5514432">
                        <ngx-dropzone-label>{{'ACTIVITYTRACKER.ADDAPPICON' | translate}}</ngx-dropzone-label>
                        <ngx-dropzone-preview *ngFor="let f of selectedFiles" [file]="f" [removable]="true"
                            (removed)="onRemove(f)">
                            <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                        </ngx-dropzone-preview>
                    </ngx-dropzone>
                </div>
                <!-- <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="10px" fxLayoutGap.xs="0px">
                    <div>
                        <label>{{'ACTIVITYTRACKER.APPLICATIONTYPE' | translate}} : </label>
                    </div>
                    <div fxFlex>
                        <mat-radio-group aria-label="Select the type"
                            name="{{'ACTIVITYTRACKER.APPLICATIONTYPE' | translate}}" formControlName="isApp"
                            (change)="onChange($event)" required>
                            <div fxLayout="row" fxLayoutAlign="space-around center">
                                <mat-radio-button value="1">{{'ACTIVITYTRACKER.APPLICATION' | translate}}
                                </mat-radio-button>
                                <mat-radio-button value="0">{{'ACTIVITYTRACKER.WEBSITE' | translate}}
                                </mat-radio-button>
                            </div>
                        </mat-radio-group>
                        <mat-error>
                            <span *ngIf="isRequired">
                                {{'ACTIVITYTRACKER.PLEASESELECTAPPLICATIONTYPE' | translate}}</span>
                        </mat-error>

                    </div>
                </div> -->
                <!-- <div fxFlex>
                    <mat-checkbox formControlName="isProductive" [(ngModel)]="isProductive" class="full-width mt-1">
                        {{'ACTIVITYTRACKER.ISPRODUCTIVE' | translate }}</mat-checkbox>
                </div> -->
                <div fxLayout="row">
                    <div fxFlex>
                        <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                            <mat-select formControlName="applicationCategoryId"
                                placeholder="{{ 'ACTIVITYTRACKER.APPLICATIONCATEGORY' | translate }}">
                                <mat-option value="option" *ngFor="let category of applicationCategories"
                                    [value]="category.applicationCategoryId">
                                    {{ category.applicationCategoryName }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div fxFlex="40px" *ngIf="canAccess_feature_ManageApplicationCategory"
                        matTooltip="{{'EXPENSEMANAGEMENT.ADDCATEGORY'|translate}}">
                        <mat-icon class="icon-button cursor-pointer mat-bg-primary plus_icon ml-08" aria-hidden="false"
                            (click)="createAppCategory()">
                            add</mat-icon>
                    </div>
                </div>
                <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                    <mat-select formControlName="productiveRoleIds" [required]="productiveRequired"
                        [disabled]="!productiveRequired" placeholder="{{'ACTIVITYTRACKER.PRODUCTIVEROLES' | translate}}"
                        multiple>
                        <mat-option #allSelected (click)="toggleAllRolesSelected()" [value]="0">
                            {{ 'PERMISSIONMANAGEMENT.SELECTALL' | translate }}</mat-option>
                        <mat-option [value]="roles.roleId" *ngFor="let roles of productiveRoles" #allSelected
                            (click)="toggleRolesPerOne()">
                            {{roles.roleName}}
                        </mat-option>
                    </mat-select>
                    <mat-error>
                        <span
                            *ngIf="addProductiveAppForm.get('productiveRoleIds').hasError('required')  && addProductiveAppForm.get('productiveRoleIds').touched">
                            {{'ACTIVITYTRACKER.PLEASESELECTROLE' | translate}}</span>
                        <span
                            *ngIf="addProductiveAppForm.get('productiveRoleIds').hasError('required')  && addProductiveAppForm.get('productiveRoleIds').untouched">
                            {{'ACTIVITYTRACKER.PLEASESELECTROLE' | translate}}</span>
                    </mat-error>
                </mat-form-field>
                <mat-form-field class="full-width" (click)="$event.stopPropagation();">
                    <mat-select formControlName="unproductiveRoleIds" [required]="unproductiveRequired"
                        [disabled]="!unproductiveRequired"
                        placeholder="{{'ACTIVITYTRACKER.UNPRODUCTIVEROLES' | translate}}" multiple>
                        <mat-option #allSelected1 (click)="toggleAllRolesSelectedUnproductive()" [value]="0">
                            {{ 'PERMISSIONMANAGEMENT.SELECTALL' | translate }}</mat-option>
                        <mat-option [value]="roles.roleId" *ngFor="let roles of unProductiveRoles" #allSelected1
                            (click)="toggleRolesPerOneUnproductive()">
                            {{roles.roleName}}
                        </mat-option>
                    </mat-select>
                    <mat-error>
                        <span
                            *ngIf="addProductiveAppForm.get('unproductiveRoleIds').hasError('required')  && addProductiveAppForm.get('unproductiveRoleIds').touched">
                            {{'ACTIVITYTRACKER.PLEASESELECTROLE' | translate}}</span>
                        <span
                            *ngIf="addProductiveAppForm.get('unproductiveRoleIds').hasError('required')  && addProductiveAppForm.get('unproductiveRoleIds').untouched">
                            {{'ACTIVITYTRACKER.PLEASESELECTROLE' | translate}}</span>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="text-center mb-1 mt-05">
                <button type="submit" [disabled]="!this.addProductiveAppForm.valid" mat-button mat-raised-button
                    class="mr-05" color="primary">
                    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="savingInProgress">
                    </mat-progress-bar>
                    <fa-icon class="mr-05" icon="save"></fa-icon> {{saveOrUpdate}}
                </button>
                <button mat-button mat-raised-button (click)="closeUpsertAddAppUrl(passwordFormDirective)">
                    <fa-icon class="mr-05" icon="times"></fa-icon> {{'CANCEL' | translate}}
                </button>
            </div>
        </form>
    </mat-card>
</sat-popover>
<sat-popover #deleteIsProductivePopover [autoFocus]="false" hasBackdrop backdropClass="backdrop-color"
    [restoreFocus]="false" [interactiveClose]="false" scrollStrategy="reposition" verticalAlign="below"
    horizontalAlign="end">
    <mat-card class="filter-data p-0" fxFlex="320px">
        <mat-card-title class="text-center">
            <div class="card-title-text mat-bg-primary p-05">{{'ACTIVITYTRACKER.DELETEAPPLICATION' | translate}}
            </div>
        </mat-card-title>
        <form [formGroup]="addProductiveAppForm" novalidate #psFormDirective="ngForm"
            (submit)="deleteAppUrl(psFormDirective)">
            <div class="card-content p-05 mt-05">
                {{'ACTIVITYTRACKER.ARETOUSUREDOYOUWANTTODELETEAPP' | translate}}
            </div>
            <div class="text-center mb-1 mt-05">
                <button type="submit" [disabled]="!this.addProductiveAppForm.valid" mat-button mat-raised-button
                    class="mr-05" color="primary">
                    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="savingInProgress">
                    </mat-progress-bar>
                    <fa-icon class="mr-05" icon="trash"></fa-icon> {{'ACTIVITYTRACKER.DELETE' | translate}}
                </button>
                <button type="button" mat-button mat-raised-button (click)="closedeleteAddAppUrl(psFormDirective)">
                    <fa-icon class="mr-05" icon="times"></fa-icon> {{'CANCEL' | translate}}
                </button>
            </div>
        </form>
    </mat-card>
</sat-popover>

<!-- <sat-popover backdropClass="backdrop-color" #showReceiptsPopover hasBackdrop backdropClass="backdrop-color"
    verticalAlign="below" horizontalAlign="end" [interactiveClose]="false">
    <mat-card class="p-0">
        <button class="inline_edit_close btn" (click)="closeReceiptsPopup()">
            <fa-icon icon="times"></fa-icon>
        </button>
        <mat-card-title class="text-center mat-bg-primary">
            <div class="card-title-text p-05">
                {{'ACTIVITYTRACKER.APPICON' | translate}}</div>
        </mat-card-title>
        <mat-card-content class="p-05">
            <ngx-gallery [options]="galleryOptions" [images]="galleryImages"></ngx-gallery>
        </mat-card-content>
    </mat-card>
</sat-popover> -->
<div id="myModal" class="custom-application-modal">
    <button class="pull-right" (click)="closeModal()" matTooltip="{{ 'TIMEPUNCHCARD.CANCEL' | translate }}"
        mat-icon-button>
        <fa-icon icon="times" class="mat-color-accent"></fa-icon>
    </button>
    <div class="application-modal-content mt-4">
        <div class="mySlides">
            <img src="{{ screenImg }}" style="width:100%;height:100%">
        </div>
    </div>
</div>

<ng-template #uniqueAppIcon let-data>
    <app-fm-component-activitytracker-productiveapps-icon [data]=[data]>
    </app-fm-component-activitytracker-productiveapps-icon>
</ng-template>

<mat-card class="p-0" *ngIf="!( canAccess_feature_ManageAppsAndUrls )">
    <app-common-message-box *ngIf="!( canAccess_feature_ManageAppsAndUrls )"
        textToDisplay="{{ 'PERMISSIONMESSAGE' | translate }}">
    </app-common-message-box>
</mat-card>

<ng-template #AppCatogoryDialogComponent let-data>
    <application-category-dailog [data]=[data]></application-category-dailog>
</ng-template>