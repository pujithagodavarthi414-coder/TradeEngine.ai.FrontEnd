/*!
 *
 * Bryntum Scheduler 3.1.2
 *
 * Copyright(c) 2020 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("scheduler",[],t):"object"==typeof exports?exports.scheduler=t():(e.bryntum=e.bryntum||{},e.bryntum.scheduler=t())}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=278)}([function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(219);function i(t,n,o){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},i(t,n,o||t)}e.exports=i},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(206);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(15),i=n(117);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},function(e,t,n){var r=n(165),i=n(65),o=n(233);r||i(Object.prototype,"toString",o,{unsafe:!0})},function(e,t,n){"use strict";var r=n(65),i=n(30),o=n(41),a=n(172),s=RegExp.prototype,l=s.toString,c=o((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),u="toString"!=l.name;(c||u)&&r(RegExp.prototype,"toString",(function(){var e=i(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in s)?a.call(e):n)}),{unsafe:!0})},function(e,t,n){var r=n(19),i=n(57),o=n(50),a=n(30),s=n(48),l=n(114),c=n(235),u=n(41),d=i("Reflect","construct"),f=u((function(){function e(){}return!(d((function(){}),[],e)instanceof e)})),h=!u((function(){d((function(){}))})),g=f||h;r({target:"Reflect",stat:!0,forced:g,sham:g},{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(h&&!f)return d(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(c.apply(e,r))}var i=n.prototype,u=l(s(i)?i:Object.prototype),g=Function.apply.call(e,u,t);return s(g)?g:u}})},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){e.exports=n(54)},function(e,t,n){var r=n(241),i=n(242),o=n(218),a=n(243);e.exports=function(e){return r(e)||i(e)||o(e)||a()}},function(e,t,n){"use strict";var r=n(19),i=n(197);r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},function(e,t,n){"use strict";var r=n(19),i=n(41),o=n(144),a=n(48),s=n(66),l=n(62),c=n(121),u=n(162),d=n(134),f=n(51),h=n(163),g=f("isConcatSpreadable"),v=h>=51||!i((function(){var e=[];return e[g]=!1,e.concat()[0]!==e})),p=d("concat"),y=function(e){if(!a(e))return!1;var t=e[g];return void 0!==t?!!t:o(e)};r({target:"Array",proto:!0,forced:!v||!p},{concat:function(e){var t,n,r,i,o,a=s(this),d=u(a,0),f=0;for(t=-1,r=arguments.length;t<r;t++)if(o=-1===t?a:arguments[t],y(o)){if(f+(i=l(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,f++)n in o&&c(d,f,o[n])}else{if(f>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(d,f++,o)}return d.length=f,d}})},function(e,t,n){var r=n(47),i=n(203),o=n(197),a=n(105);for(var s in i){var l=r[s],c=l&&l.prototype;if(c&&c.forEach!==o)try{a(c,"forEach",o)}catch(e){c.forEach=o}}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){var r=n(244),i=n(245),o=n(218),a=n(246);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()}},function(e,t,n){var r=n(19),i=n(198);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(e,t,n){var r=n(219),i=n(9);function o(e,t,n,a){return(o="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,o){var a,s=r(e,t);if(s){if((a=Object.getOwnPropertyDescriptor(s,t)).set)return a.set.call(o,n),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(o,t)){if(!a.writable)return!1;a.value=n,Object.defineProperty(o,t,a)}else i(o,t,n);return!0})(e,t,n,a)}e.exports=function(e,t,n,r,i){if(!o(e,t,n,r||e)&&i)throw new Error("failed to set property");return n}},function(e,t,n){var r=n(47),i=n(82).f,o=n(105),a=n(65),s=n(154),l=n(188),c=n(131);e.exports=function(e,t){var n,u,d,f,h,g=e.target,v=e.global,p=e.stat;if(n=v?r:p?r[g]||s(g,{}):(r[g]||{}).prototype)for(u in t){if(f=t[u],d=e.noTargetGet?(h=i(n,u))&&h.value:n[u],!c(v?u:g+(p?".":"#")+u,e.forced)&&void 0!==d){if(typeof f==typeof d)continue;l(f,d)}(e.sham||d&&d.sham)&&o(f,"sham",!0),a(n,u,f,e)}}},function(e,t,n){"use strict";var r=n(84),i=n(133),o=n(138),a=n(85),s=n(177),l=a.set,c=a.getterFor("Array Iterator");e.exports=s(Array,"Array",(function(e,t){l(this,{type:"Array Iterator",target:r(e),index:0,kind:t})}),(function(){var e=c(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,n){var r=n(47),i=n(203),o=n(20),a=n(105),s=n(51),l=s("iterator"),c=s("toStringTag"),u=o.values;for(var d in i){var f=r[d],h=f&&f.prototype;if(h){if(h[l]!==u)try{a(h,l,u)}catch(e){h[l]=u}if(h[c]||a(h,c,d),i[d])for(var g in o)if(h[g]!==o[g])try{a(h,g,o[g])}catch(e){h[g]=o[g]}}}},function(e,t,n){var r=n(52),i=n(56).f,o=Function.prototype,a=o.toString,s=/^\s*function ([^ (]*)/;r&&!("name"in o)&&i(o,"name",{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(e){return""}}})},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))}}},function(e,t,n){"use strict";var r=n(19),i=n(48),o=n(144),a=n(143),s=n(62),l=n(84),c=n(121),u=n(51),d=n(134),f=n(83),h=d("slice"),g=f("slice",{ACCESSORS:!0,0:0,1:2}),v=u("species"),p=[].slice,y=Math.max;r({target:"Array",proto:!0,forced:!h||!g},{slice:function(e,t){var n,r,u,d=l(this),f=s(d.length),h=a(e,f),g=a(void 0===t?f:t,f);if(o(d)&&("function"!=typeof(n=d.constructor)||n!==Array&&!o(n.prototype)?i(n)&&null===(n=n[v])&&(n=void 0):n=void 0,n===Array||void 0===n))return p.call(d,h,g);for(r=new(void 0===n?Array:n)(y(g-h,0)),u=0;h<g;h++,u++)h in d&&c(r,u,d[h]);return r.length=u,r}})},function(e,t,n){"use strict";var r=n(175).charAt,i=n(85),o=n(177),a=i.set,s=i.getterFor("String Iterator");o(String,"String",(function(e){a(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=s(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(19),i=n(109).map,o=n(134),a=n(83),s=o("map"),l=a("map");r({target:"Array",proto:!0,forced:!s||!l},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(19),i=n(47),o=n(57),a=n(36),s=n(52),l=n(161),c=n(191),u=n(41),d=n(55),f=n(144),h=n(48),g=n(30),v=n(66),p=n(84),y=n(119),m=n(112),b=n(114),k=n(132),w=n(130),S=n(194),C=n(160),R=n(82),x=n(56),E=n(140),D=n(105),T=n(65),M=n(156),A=n(141),I=n(129),F=n(142),O=n(51),_=n(195),P=n(196),L=n(115),H=n(85),j=n(109).forEach,B=A("hidden"),N=O("toPrimitive"),z=H.set,V=H.getterFor("Symbol"),W=Object.prototype,U=i.Symbol,G=o("JSON","stringify"),Y=R.f,$=x.f,q=S.f,X=E.f,K=M("symbols"),J=M("op-symbols"),Q=M("string-to-symbol-registry"),Z=M("symbol-to-string-registry"),ee=M("wks"),te=i.QObject,ne=!te||!te.prototype||!te.prototype.findChild,re=s&&u((function(){return 7!=b($({},"a",{get:function(){return $(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=Y(W,t);r&&delete W[t],$(e,t,n),r&&e!==W&&$(W,t,r)}:$,ie=function(e,t){var n=K[e]=b(U.prototype);return z(n,{type:"Symbol",tag:e,description:t}),s||(n.description=t),n},oe=c?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof U},ae=function(e,t,n){e===W&&ae(J,t,n),g(e);var r=y(t,!0);return g(n),d(K,r)?(n.enumerable?(d(e,B)&&e[B][r]&&(e[B][r]=!1),n=b(n,{enumerable:m(0,!1)})):(d(e,B)||$(e,B,m(1,{})),e[B][r]=!0),re(e,r,n)):$(e,r,n)},se=function(e,t){g(e);var n=p(t),r=k(n).concat(de(n));return j(r,(function(t){s&&!le.call(n,t)||ae(e,t,n[t])})),e},le=function(e){var t=y(e,!0),n=X.call(this,t);return!(this===W&&d(K,t)&&!d(J,t))&&(!(n||!d(this,t)||!d(K,t)||d(this,B)&&this[B][t])||n)},ce=function(e,t){var n=p(e),r=y(t,!0);if(n!==W||!d(K,r)||d(J,r)){var i=Y(n,r);return!i||!d(K,r)||d(n,B)&&n[B][r]||(i.enumerable=!0),i}},ue=function(e){var t=q(p(e)),n=[];return j(t,(function(e){d(K,e)||d(I,e)||n.push(e)})),n},de=function(e){var t=e===W,n=q(t?J:p(e)),r=[];return j(n,(function(e){!d(K,e)||t&&!d(W,e)||r.push(K[e])})),r};(l||(T((U=function(){if(this instanceof U)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=F(e),n=function(e){this===W&&n.call(J,e),d(this,B)&&d(this[B],t)&&(this[B][t]=!1),re(this,t,m(1,e))};return s&&ne&&re(W,t,{configurable:!0,set:n}),ie(t,e)}).prototype,"toString",(function(){return V(this).tag})),T(U,"withoutSetter",(function(e){return ie(F(e),e)})),E.f=le,x.f=ae,R.f=ce,w.f=S.f=ue,C.f=de,_.f=function(e){return ie(O(e),e)},s&&($(U.prototype,"description",{configurable:!0,get:function(){return V(this).description}}),a||T(W,"propertyIsEnumerable",le,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:U}),j(k(ee),(function(e){P(e)})),r({target:"Symbol",stat:!0,forced:!l},{for:function(e){var t=String(e);if(d(Q,t))return Q[t];var n=U(t);return Q[t]=n,Z[n]=t,n},keyFor:function(e){if(!oe(e))throw TypeError(e+" is not a symbol");if(d(Z,e))return Z[e]},useSetter:function(){ne=!0},useSimple:function(){ne=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!s},{create:function(e,t){return void 0===t?b(e):se(b(e),t)},defineProperty:ae,defineProperties:se,getOwnPropertyDescriptor:ce}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:ue,getOwnPropertySymbols:de}),r({target:"Object",stat:!0,forced:u((function(){C.f(1)}))},{getOwnPropertySymbols:function(e){return C.f(v(e))}}),G)&&r({target:"JSON",stat:!0,forced:!l||u((function(){var e=U();return"[null]"!=G([e])||"{}"!=G({a:e})||"{}"!=G(Object(e))}))},{stringify:function(e,t,n){for(var r,i=[e],o=1;arguments.length>o;)i.push(arguments[o++]);if(r=t,(h(t)||void 0!==e)&&!oe(e))return f(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!oe(t))return t}),i[1]=t,G.apply(null,i)}});U.prototype[N]||D(U.prototype,N,U.prototype.valueOf),L(U,"Symbol"),I[B]=!0},function(e,t,n){"use strict";var r=n(19),i=n(158).indexOf,o=n(120),a=n(83),s=[].indexOf,l=!!s&&1/[1].indexOf(1,-0)<0,c=o("indexOf"),u=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:l||!c||!u},{indexOf:function(e){return l?s.apply(this,arguments)||0:i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(19),i=n(52),o=n(47),a=n(55),s=n(48),l=n(56).f,c=n(188),u=o.Symbol;if(i&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var d={},f=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof f?new u(e):void 0===e?u():u(e);return""===e&&(d[t]=!0),t};c(f,u);var h=f.prototype=u.prototype;h.constructor=f;var g=h.toString,v="Symbol(test)"==String(u("test")),p=/^Symbol\((.*)\)[^)]+$/;l(h,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=g.call(e);if(a(d,e))return"";var n=v?t.slice(7,-1):t.replace(p,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:f})}},function(e,t,n){var r=n(48);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){var r=n(19),i=n(207);r({target:"Array",stat:!0,forced:!n(176)((function(e){Array.from(e)}))},{from:i})},function(e,t,n){"use strict";var r=n(19),i=n(109).filter,o=n(134),a=n(83),s=o("filter"),l=a("filter");r({target:"Array",proto:!0,forced:!s||!l},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t){e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}},function(e,t,n){"use strict";var r=n(19),i=n(145);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(e,t,n){"use strict";var r=n(19),i=n(158).includes,o=n(133);r({target:"Array",proto:!0,forced:!n(83)("indexOf",{ACCESSORS:!0,1:0})},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(e,t){e.exports=!1},function(e,t,n){n(196)("iterator")},function(e,t,n){"use strict";var r=n(19),i=n(168),o=n(63);r({target:"String",proto:!0,forced:!n(170)("includes")},{includes:function(e){return!!~String(o(this)).indexOf(i(e),arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(19),i=n(247).left,o=n(120),a=n(83),s=o("reduce"),l=a("reduce",{1:0});r({target:"Array",proto:!0,forced:!s||!l},{reduce:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(19),i=n(128),o=n(84),a=n(120),s=[].join,l=i!=Object,c=a("join",",");r({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(o(this),void 0===e?",":e)}})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var r=n(19),i=n(109).find,o=n(133),a=n(83),s=!0,l=a("find");"find"in[]&&Array(1).find((function(){s=!1})),r({target:"Array",proto:!0,forced:s||!l},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("find")},function(e,t,n){"use strict";var r=n(19),i=n(109).some,o=n(120),a=n(83),s=o("some"),l=a("some");r({target:"Array",proto:!0,forced:!s||!l},{some:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(19),i=n(143),o=n(113),a=n(62),s=n(66),l=n(162),c=n(121),u=n(134),d=n(83),f=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,v=Math.min;r({target:"Array",proto:!0,forced:!f||!h},{splice:function(e,t){var n,r,u,d,f,h,p=s(this),y=a(p.length),m=i(e,y),b=arguments.length;if(0===b?n=r=0:1===b?(n=0,r=y-m):(n=b-2,r=v(g(o(t),0),y-m)),y+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(u=l(p,r),d=0;d<r;d++)(f=m+d)in p&&c(u,d,p[f]);if(u.length=r,n<r){for(d=m;d<y-r;d++)h=d+n,(f=d+r)in p?p[h]=p[f]:delete p[h];for(d=y;d>y-r+n;d--)delete p[d-1]}else if(n>r)for(d=y-r;d>m;d--)h=d+n-1,(f=d+r-1)in p?p[h]=p[f]:delete p[h];for(d=0;d<n;d++)p[d+m]=arguments[d+2];return p.length=y-r+n,u}})},function(e,t,n){var r=n(19),i=n(66),o=n(132);r({target:"Object",stat:!0,forced:n(41)((function(){o(1)}))},{keys:function(e){return o(i(e))}})},function(e,t,n){var r=n(30),i=n(209),o=n(62),a=n(58),s=n(148),l=n(208),c=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,n,u,d){var f,h,g,v,p,y,m,b=a(t,n,u?2:1);if(d)f=e;else{if("function"!=typeof(h=s(e)))throw TypeError("Target is not iterable");if(i(h)){for(g=0,v=o(e.length);v>g;g++)if((p=u?b(r(m=e[g])[0],m[1]):b(e[g]))&&p instanceof c)return p;return new c(!1)}f=h.call(e)}for(y=f.next;!(m=y.call(f)).done;)if("object"==typeof(p=l(f,b,m.value,u))&&p&&p instanceof c)return p;return new c(!1)}).stop=function(e){return new c(!0,e)}},function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")()}).call(this,n(184))},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";var r,i,o,a,s=n(19),l=n(36),c=n(47),u=n(57),d=n(236),f=n(65),h=n(139),g=n(115),v=n(173),p=n(48),y=n(50),m=n(123),b=n(104),k=n(155),w=n(46),S=n(176),C=n(86),R=n(214).set,x=n(237),E=n(238),D=n(239),T=n(216),M=n(240),A=n(85),I=n(131),F=n(51),O=n(163),_=F("species"),P="Promise",L=A.get,H=A.set,j=A.getterFor(P),B=d,N=c.TypeError,z=c.document,V=c.process,W=u("fetch"),U=T.f,G=U,Y="process"==b(V),$=!!(z&&z.createEvent&&c.dispatchEvent),q=I(P,(function(){if(!(k(B)!==String(B))){if(66===O)return!0;if(!Y&&"function"!=typeof PromiseRejectionEvent)return!0}if(l&&!B.prototype.finally)return!0;if(O>=51&&/native code/.test(B))return!1;var e=B.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[_]=t,!(e.then((function(){}))instanceof t)})),X=q||!S((function(e){B.all(e).catch((function(){}))})),K=function(e){var t;return!(!p(e)||"function"!=typeof(t=e.then))&&t},J=function(e,t,n){if(!t.notified){t.notified=!0;var r=t.reactions;x((function(){for(var i=t.value,o=1==t.state,a=0;r.length>a;){var s,l,c,u=r[a++],d=o?u.ok:u.fail,f=u.resolve,h=u.reject,g=u.domain;try{d?(o||(2===t.rejection&&te(e,t),t.rejection=1),!0===d?s=i:(g&&g.enter(),s=d(i),g&&(g.exit(),c=!0)),s===u.promise?h(N("Promise-chain cycle")):(l=K(s))?l.call(s,f,h):f(s)):h(i)}catch(e){g&&!c&&g.exit(),h(e)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&Z(e,t)}))}},Q=function(e,t,n){var r,i;$?((r=z.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),c.dispatchEvent(r)):r={promise:t,reason:n},(i=c["on"+e])?i(r):"unhandledrejection"===e&&D("Unhandled promise rejection",n)},Z=function(e,t){R.call(c,(function(){var n,r=t.value;if(ee(t)&&(n=M((function(){Y?V.emit("unhandledRejection",r,e):Q("unhandledrejection",e,r)})),t.rejection=Y||ee(t)?2:1,n.error))throw n.value}))},ee=function(e){return 1!==e.rejection&&!e.parent},te=function(e,t){R.call(c,(function(){Y?V.emit("rejectionHandled",e):Q("rejectionhandled",e,t.value)}))},ne=function(e,t,n,r){return function(i){e(t,n,i,r)}},re=function(e,t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,J(e,t,!0))},ie=function(e,t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(e===n)throw N("Promise can't be resolved itself");var i=K(n);i?x((function(){var r={done:!1};try{i.call(n,ne(ie,e,r,t),ne(re,e,r,t))}catch(n){re(e,r,n,t)}})):(t.value=n,t.state=1,J(e,t,!1))}catch(n){re(e,{done:!1},n,t)}}};q&&(B=function(e){m(this,B,P),y(e),r.call(this);var t=L(this);try{e(ne(ie,this,t),ne(re,this,t))}catch(e){re(this,t,e)}},(r=function(e){H(this,{type:P,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=h(B.prototype,{then:function(e,t){var n=j(this),r=U(C(this,B));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=Y?V.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&J(this,n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=L(e);this.promise=e,this.resolve=ne(ie,e,t),this.reject=ne(re,e,t)},T.f=U=function(e){return e===B||e===o?new i(e):G(e)},l||"function"!=typeof d||(a=d.prototype.then,f(d.prototype,"then",(function(e,t){var n=this;return new B((function(e,t){a.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof W&&s({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return E(B,W.apply(c,arguments))}}))),s({global:!0,wrap:!0,forced:q},{Promise:B}),g(B,P,!1,!0),v(P),o=u(P),s({target:P,stat:!0,forced:q},{reject:function(e){var t=U(this);return t.reject.call(void 0,e),t.promise}}),s({target:P,stat:!0,forced:l||q},{resolve:function(e){return E(l&&this===o?B:this,e)}}),s({target:P,stat:!0,forced:X},{all:function(e){var t=this,n=U(t),r=n.resolve,i=n.reject,o=M((function(){var n=y(t.resolve),o=[],a=0,s=1;w(e,(function(e){var l=a++,c=!1;o.push(void 0),s++,n.call(t,e).then((function(e){c||(c=!0,o[l]=e,--s||r(o))}),i)})),--s||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=U(t),r=n.reject,i=M((function(){var i=y(t.resolve);w(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,n){var r=n(47),i=n(156),o=n(55),a=n(142),s=n(161),l=n(191),c=i("wks"),u=r.Symbol,d=l?u:u&&u.withoutSetter||a;e.exports=function(e){return o(c,e)||(s&&o(u,e)?c[e]=u[e]:c[e]=d("Symbol."+e)),c[e]}},function(e,t,n){var r=n(41);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,n){"use strict";var r=n(146),i=n(30),o=n(66),a=n(62),s=n(113),l=n(63),c=n(174),u=n(147),d=Math.max,f=Math.min,h=Math.floor,g=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(e,t,n,r){var p=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,y=r.REPLACE_KEEPS_$0,m=p?"$":"$0";return[function(n,r){var i=l(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!p&&y||"string"==typeof r&&-1===r.indexOf(m)){var o=n(t,e,this,r);if(o.done)return o.value}var l=i(e),h=String(this),g="function"==typeof r;g||(r=String(r));var v=l.global;if(v){var k=l.unicode;l.lastIndex=0}for(var w=[];;){var S=u(l,h);if(null===S)break;if(w.push(S),!v)break;""===String(S[0])&&(l.lastIndex=c(h,a(l.lastIndex),k))}for(var C,R="",x=0,E=0;E<w.length;E++){S=w[E];for(var D=String(S[0]),T=d(f(s(S.index),h.length),0),M=[],A=1;A<S.length;A++)M.push(void 0===(C=S[A])?C:String(C));var I=S.groups;if(g){var F=[D].concat(M,T,h);void 0!==I&&F.push(I);var O=String(r.apply(void 0,F))}else O=b(D,h,T,M,I,r);T>=x&&(R+=h.slice(x,T)+O,x=T+D.length)}return R+h.slice(x)}];function b(e,n,r,i,a,s){var l=r+e.length,c=i.length,u=v;return void 0!==a&&(a=o(a),u=g),t.call(s,u,(function(t,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(l);case"<":s=a[o.slice(1,-1)];break;default:var u=+o;if(0===u)return t;if(u>c){var d=h(u/10);return 0===d?t:d<=c?void 0===i[d-1]?o.charAt(1):i[d-1]+o.charAt(1):t}s=i[u-1]}return void 0===s?"":s}))}}))},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n,r){var i=t&&t.prototype instanceof u?t:u,o=Object.create(i.prototype),a=new S(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return R()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var c={};function u(){}function d(){}function f(){}var h={};h[i]=function(){return this};var g=Object.getPrototypeOf,v=g&&g(g(C([])));v&&v!==t&&n.call(v,i)&&(h=v);var p=f.prototype=u.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function m(e,t){var r;this._invoke=function(i,o){function a(){return new t((function(r,a){!function r(i,o,a,s){var c=l(e[i],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=l(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,c;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=p.constructor=f,f.constructor=d,f[a]=d.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(p),e},e.awrap=function(e){return{__await:e}},y(m.prototype),m.prototype[o]=function(){return this},e.AsyncIterator=m,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new m(s(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(p),p[a]="Generator",p[i]=function(){return this},p.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=C,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(52),i=n(185),o=n(30),a=n(119),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(189),i=n(47),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e])||o(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},function(e,t,n){var r=n(50);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){"use strict";var r=n(146),i=n(169),o=n(30),a=n(63),s=n(86),l=n(174),c=n(62),u=n(147),d=n(145),f=n(41),h=[].push,g=Math.min,v=!f((function(){return!RegExp(4294967295,"y")}));r("split",2,(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(a(this)),o=void 0===n?4294967295:n>>>0;if(0===o)return[];if(void 0===e)return[r];if(!i(e))return t.call(r,e,o);for(var s,l,c,u=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,v=new RegExp(e.source,f+"g");(s=d.call(v,r))&&!((l=v.lastIndex)>g&&(u.push(r.slice(g,s.index)),s.length>1&&s.index<r.length&&h.apply(u,s.slice(1)),c=s[0].length,g=l,u.length>=o));)v.lastIndex===s.index&&v.lastIndex++;return g===r.length?!c&&v.test("")||u.push(""):u.push(r.slice(g)),u.length>o?u.slice(0,o):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=a(this),o=null==t?void 0:t[e];return void 0!==o?o.call(t,i,n):r.call(String(i),t,n)},function(e,i){var a=n(r,e,this,i,r!==t);if(a.done)return a.value;var d=o(e),f=String(this),h=s(d,RegExp),p=d.unicode,y=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(v?"y":"g"),m=new h(v?d:"^(?:"+d.source+")",y),b=void 0===i?4294967295:i>>>0;if(0===b)return[];if(0===f.length)return null===u(m,f)?[f]:[];for(var k=0,w=0,S=[];w<f.length;){m.lastIndex=v?w:0;var C,R=u(m,v?f:f.slice(w));if(null===R||(C=g(c(m.lastIndex+(v?0:w)),f.length))===k)w=l(f,w,p);else{if(S.push(f.slice(k,w)),S.length===b)return S;for(var x=1;x<=R.length-1;x++)if(S.push(R[x]),S.length===b)return S;w=k=C}}return S.push(f.slice(k)),S}]}),!v)},function(e,t,n){var r=n(19),i=n(212).entries;r({target:"Object",stat:!0},{entries:function(e){return i(e)}})},function(e,t,n){var r=n(19),i=n(212).values;r({target:"Object",stat:!0},{values:function(e){return i(e)}})},function(e,t,n){var r=n(113),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,n){"use strict";var r=n(19),i=n(109).findIndex,o=n(133),a=n(83),s=!0,l=a("findIndex");"findIndex"in[]&&Array(1).findIndex((function(){s=!1})),r({target:"Array",proto:!0,forced:s||!l},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("findIndex")},function(e,t,n){var r=n(47),i=n(105),o=n(55),a=n(154),s=n(155),l=n(85),c=l.get,u=l.enforce,d=String(String).split("String");(e.exports=function(e,t,n,s){var l=!!s&&!!s.unsafe,c=!!s&&!!s.enumerable,f=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||o(n,"name")||i(n,"name",t),u(n).source=d.join("string"==typeof t?t:"")),e!==r?(l?!f&&e[t]&&(c=!0):delete e[t],c?e[t]=n:i(e,t,n)):c?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},function(e,t,n){var r=n(63);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r,i=n(19),o=n(82).f,a=n(62),s=n(168),l=n(63),c=n(170),u=n(36),d="".startsWith,f=Math.min,h=c("startsWith");i({target:"String",proto:!0,forced:!!(u||h||(r=o(String.prototype,"startsWith"),!r||r.writable))&&!h},{startsWith:function(e){var t=String(l(this));s(e);var n=a(f(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return d?d.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";var r=n(182),i=n(226);e.exports=r("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(183);r({target:"Map",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(58),s=n(108),l=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{every:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return!l(n,(function(e,n){if(!r(n,e,t))return l.stop()}),void 0,!0,!0).stopped}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(58),c=n(86),u=n(108),d=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{filter:function(e){var t=a(this),n=u(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Map"))),f=s(i.set);return d(n,(function(e,n){r(n,e,t)&&f.call(i,e,n)}),void 0,!0,!0),i}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(58),s=n(108),l=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{find:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n){if(r(n,e,t))return l.stop(n)}),void 0,!0,!0).result}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(58),s=n(108),l=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{findKey:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n){if(r(n,e,t))return l.stop(e)}),void 0,!0,!0).result}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(108),s=n(263),l=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{includes:function(e){return l(a(o(this)),(function(t,n){if(s(n,e))return l.stop()}),void 0,!0,!0).stopped}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(108),s=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{keyOf:function(e){return s(a(o(this)),(function(t,n){if(n===e)return s.stop(t)}),void 0,!0,!0).result}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(58),c=n(86),u=n(108),d=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{mapKeys:function(e){var t=a(this),n=u(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Map"))),f=s(i.set);return d(n,(function(e,n){f.call(i,r(n,e,t),n)}),void 0,!0,!0),i}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(58),c=n(86),u=n(108),d=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{mapValues:function(e){var t=a(this),n=u(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Map"))),f=s(i.set);return d(n,(function(e,n){f.call(i,e,r(n,e,t))}),void 0,!0,!0),i}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(50),s=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{merge:function(e){for(var t=o(this),n=a(t.set),r=0;r<arguments.length;)s(arguments[r++],n,t,!0);return t}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(50),s=n(108),l=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{reduce:function(e){var t=o(this),n=s(t),r=arguments.length<2,i=r?void 0:arguments[1];if(a(e),l(n,(function(n,o){r?(r=!1,i=o):i=e(i,o,n,t)}),void 0,!0,!0),r)throw TypeError("Reduce of empty map with no initial value");return i}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(58),s=n(108),l=n(46);r({target:"Map",proto:!0,real:!0,forced:i},{some:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n){if(r(n,e,t))return l.stop()}),void 0,!0,!0).stopped}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(50);r({target:"Map",proto:!0,real:!0,forced:i},{update:function(e,t){var n=o(this),r=arguments.length;a(t);var i=n.has(e);if(!i&&r<3)throw TypeError("Updating absent value");var s=i?n.get(e):a(r>2?arguments[2]:void 0)(e,n);return n.set(e,t(s,e,n)),n}})},function(e,t,n){var r=n(52),i=n(140),o=n(112),a=n(84),s=n(119),l=n(55),c=n(185),u=Object.getOwnPropertyDescriptor;t.f=r?u:function(e,t){if(e=a(e),t=s(t,!0),c)try{return u(e,t)}catch(e){}if(l(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t,n){var r=n(52),i=n(41),o=n(55),a=Object.defineProperty,s={},l=function(e){throw e};e.exports=function(e,t){if(o(s,e))return s[e];t||(t={});var n=[][e],c=!!o(t,"ACCESSORS")&&t.ACCESSORS,u=o(t,0)?t[0]:l,d=o(t,1)?t[1]:void 0;return s[e]=!!n&&!i((function(){if(c&&!r)return!0;var e={length:-1};c?a(e,1,{enumerable:!0,get:l}):e[1]=1,n.call(e,u,d)}))}},function(e,t,n){var r=n(128),i=n(63);e.exports=function(e){return r(i(e))}},function(e,t,n){var r,i,o,a=n(187),s=n(47),l=n(48),c=n(105),u=n(55),d=n(141),f=n(129),h=s.WeakMap;if(a){var g=new h,v=g.get,p=g.has,y=g.set;r=function(e,t){return y.call(g,e,t),t},i=function(e){return v.call(g,e)||{}},o=function(e){return p.call(g,e)}}else{var m=d("state");f[m]=!0,r=function(e,t){return c(e,m,t),t},i=function(e){return u(e,m)?e[m]:{}},o=function(e){return u(e,m)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var r=n(30),i=n(50),o=n(51)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[o])?t:i(n)}},function(e,t,n){"use strict";var r=n(182),i=n(226);e.exports=r("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(264);r({target:"Set",proto:!0,real:!0,forced:i},{addAll:function(){return o.apply(this,arguments)}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(183);r({target:"Set",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(86),c=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{difference:function(e){var t=a(this),n=new(l(t,o("Set")))(t),r=s(n.delete);return c(e,(function(e){r.call(n,e)})),n}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(58),s=n(116),l=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{every:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return!l(n,(function(e){if(!r(e,e,t))return l.stop()}),void 0,!1,!0).stopped}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(58),c=n(86),u=n(116),d=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{filter:function(e){var t=a(this),n=u(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Set"))),f=s(i.add);return d(n,(function(e){r(e,e,t)&&f.call(i,e)}),void 0,!1,!0),i}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(58),s=n(116),l=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{find:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e){if(r(e,e,t))return l.stop(e)}),void 0,!1,!0).result}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(86),c=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{intersection:function(e){var t=a(this),n=new(l(t,o("Set"))),r=s(t.has),i=s(n.add);return c(e,(function(e){r.call(t,e)&&i.call(n,e)})),n}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(50),s=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:function(e){var t=o(this),n=a(t.has);return!s(e,(function(e){if(!0===n.call(t,e))return s.stop()})).stopped}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(151),c=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:function(e){var t=l(this),n=a(e),r=n.has;return"function"!=typeof r&&(n=new(o("Set"))(e),r=s(n.has)),!c(t,(function(e){if(!1===r.call(n,e))return c.stop()}),void 0,!1,!0).stopped}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(50),s=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:function(e){var t=o(this),n=a(t.has);return!s(e,(function(e){if(!1===n.call(t,e))return s.stop()})).stopped}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(116),s=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{join:function(e){var t=o(this),n=a(t),r=void 0===e?",":String(e),i=[];return s(n,i.push,i,!1,!0),i.join(r)}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(58),c=n(86),u=n(116),d=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{map:function(e){var t=a(this),n=u(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(c(t,o("Set"))),f=s(i.add);return d(n,(function(e){f.call(i,r(e,e,t))}),void 0,!1,!0),i}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(50),s=n(116),l=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{reduce:function(e){var t=o(this),n=s(t),r=arguments.length<2,i=r?void 0:arguments[1];if(a(e),l(n,(function(n){r?(r=!1,i=n):i=e(i,n,n,t)}),void 0,!1,!0),r)throw TypeError("Reduce of empty set with no initial value");return i}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(30),a=n(58),s=n(116),l=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{some:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e){if(r(e,e,t))return l.stop()}),void 0,!1,!0).stopped}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(86),c=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:function(e){var t=a(this),n=new(l(t,o("Set")))(t),r=s(n.delete),i=s(n.add);return c(e,(function(e){r.call(n,e)||i.call(n,e)})),n}})},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(57),a=n(30),s=n(50),l=n(86),c=n(46);r({target:"Set",proto:!0,real:!0,forced:i},{union:function(e){var t=a(this),n=new(l(t,o("Set")))(t);return c(e,s(n.add),n),n}})},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(52),i=n(56),o=n(112);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";var r=n(52),i=n(47),o=n(131),a=n(65),s=n(55),l=n(104),c=n(171),u=n(119),d=n(41),f=n(114),h=n(130).f,g=n(82).f,v=n(56).f,p=n(178).trim,y=i.Number,m=y.prototype,b="Number"==l(f(m)),k=function(e){var t,n,r,i,o,a,s,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(43===(t=(c=p(c)).charCodeAt(0))||45===t){if(88===(n=c.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(a=(o=c.slice(2)).length,s=0;s<a;s++)if((l=o.charCodeAt(s))<48||l>i)return NaN;return parseInt(o,r)}return+c};if(o("Number",!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var w,S=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof S&&(b?d((function(){m.valueOf.call(n)})):"Number"!=l(n))?c(new y(k(t)),n,S):k(t)},C=r?h(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),R=0;C.length>R;R++)s(y,w=C[R])&&!s(S,w)&&v(S,w,g(y,w));S.prototype=m,m.constructor=S,a(i,"Number",S)}},function(e,t,n){"use strict";var r=n(19),i=n(178).trim;r({target:"String",proto:!0,forced:n(252)("trim")},{trim:function(){return i(this)}})},function(e,t,n){var r=n(36),i=n(151);e.exports=r?i:function(e){return Map.prototype.entries.call(e)}},function(e,t,n){var r=n(58),i=n(128),o=n(66),a=n(62),s=n(162),l=[].push,c=function(e){var t=1==e,n=2==e,c=3==e,u=4==e,d=6==e,f=5==e||d;return function(h,g,v,p){for(var y,m,b=o(h),k=i(b),w=r(g,v,3),S=a(k.length),C=0,R=p||s,x=t?R(h,S):n?R(h,0):void 0;S>C;C++)if((f||C in k)&&(m=w(y=k[C],C,b),e))if(t)x[C]=m;else if(m)switch(e){case 3:return!0;case 5:return y;case 6:return C;case 2:l.call(x,y)}else if(u)return!1;return d?-1:c||u?u:x}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},function(e,t,n){var r=n(19),i=n(199),o=n(41),a=n(48),s=n(135).onFreeze,l=Object.freeze;r({target:"Object",stat:!0,forced:o((function(){l(1)})),sham:!i},{freeze:function(e){return l&&a(e)?l(s(e)):e}})},function(e,t,n){var r=n(19),i=n(41),o=n(66),a=n(136),s=n(200);r({target:"Object",stat:!0,forced:i((function(){a(1)})),sham:!s},{getPrototypeOf:function(e){return a(o(e))}})},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r,i=n(30),o=n(192),a=n(159),s=n(129),l=n(193),c=n(153),u=n(141),d=u("IE_PROTO"),f=function(){},h=function(e){return"<script>"+e+"<\/script>"},g=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;g=r?function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t}(r):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F);for(var n=a.length;n--;)delete g.prototype[a[n]];return g()};s[d]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f.prototype=i(e),n=new f,f.prototype=null,n[d]=e):n=g(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(56).f,i=n(55),o=n(51)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){var r=n(36),i=n(151);e.exports=r?i:function(e){return Set.prototype.values.call(e)}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var r=n(230);e.exports=function(e){return new r(e)}},function(e,t,n){var r=n(48);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){"use strict";var r=n(41);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},function(e,t,n){"use strict";var r=n(119),i=n(56),o=n(112);e.exports=function(e,t,n){var a=r(t);a in e?i.f(e,a,o(0,n)):e[a]=n}},function(e,t,n){"use strict";var r,i=n(19),o=n(82).f,a=n(62),s=n(168),l=n(63),c=n(170),u=n(36),d="".endsWith,f=Math.min,h=c("endsWith");i({target:"String",proto:!0,forced:!!(u||h||(r=o(String.prototype,"endsWith"),!r||r.writable))&&!h},{endsWith:function(e){var t=String(l(this));s(e);var n=arguments.length>1?arguments[1]:void 0,r=a(t.length),i=void 0===n?r:f(a(n),r),o=String(e);return d?d.call(t,o,i):t.slice(i-o.length,i)===o}})},function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},function(e,t,n){var r=n(19),i=n(41),o=n(84),a=n(82).f,s=n(52),l=i((function(){a(1)}));r({target:"Object",stat:!0,forced:!s||l,sham:!s},{getOwnPropertyDescriptor:function(e,t){return a(o(e),t)}})},function(e,t,n){"use strict";var r=n(19),i=n(109).every,o=n(120),a=n(83),s=o("every"),l=a("every");r({target:"Array",proto:!0,forced:!s||!l},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(206),i=n(262);function o(t,n,a){return i()?e.exports=o=Reflect.construct:e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},o.apply(null,arguments)}e.exports=o},function(e,t,n){var r=n(268);e.exports=function(e){return function(){return new r(e.apply(this,arguments))}}},function(e,t,n){var r=n(41),i=n(104),o="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t){e.exports={}},function(e,t,n){var r=n(190),i=n(159).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(41),i=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==c||n!=l&&("function"==typeof t?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=o.data={},l=o.NATIVE="N",c=o.POLYFILL="P";e.exports=o},function(e,t,n){var r=n(190),i=n(159);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(51),i=n(114),o=n(56),a=r("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},function(e,t,n){var r=n(41),i=n(51),o=n(163),a=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){var r=n(129),i=n(48),o=n(55),a=n(56).f,s=n(142),l=n(199),c=s("meta"),u=0,d=Object.isExtensible||function(){return!0},f=function(e){a(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},h=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,c)){if(!d(e))return"F";if(!t)return"E";f(e)}return e[c].objectID},getWeakData:function(e,t){if(!o(e,c)){if(!d(e))return!0;if(!t)return!1;f(e)}return e[c].weakData},onFreeze:function(e){return l&&h.REQUIRED&&d(e)&&!o(e,c)&&f(e),e}};r[c]=!0},function(e,t,n){var r=n(55),i=n(66),o=n(141),a=n(200),s=o("IE_PROTO"),l=Object.prototype;e.exports=a?Object.getPrototypeOf:function(e){return e=i(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},function(e,t,n){var r=n(52),i=n(47),o=n(131),a=n(171),s=n(56).f,l=n(130).f,c=n(169),u=n(172),d=n(205),f=n(65),h=n(41),g=n(85).set,v=n(173),p=n(51)("match"),y=i.RegExp,m=y.prototype,b=/a/g,k=/a/g,w=new y(b)!==b,S=d.UNSUPPORTED_Y;if(r&&o("RegExp",!w||S||h((function(){return k[p]=!1,y(b)!=b||y(k)==k||"/a/i"!=y(b,"i")})))){for(var C=function(e,t){var n,r=this instanceof C,i=c(e),o=void 0===t;if(!r&&i&&e.constructor===C&&o)return e;w?i&&!o&&(e=e.source):e instanceof C&&(o&&(t=u.call(e)),e=e.source),S&&(n=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var s=a(w?new y(e,t):y(e,t),r?this:m,C);return S&&n&&g(s,{sticky:n}),s},R=function(e){e in C||s(C,e,{configurable:!0,get:function(){return y[e]},set:function(t){y[e]=t}})},x=l(y),E=0;x.length>E;)R(x[E++]);m.constructor=C,C.prototype=m,f(i,"RegExp",C)}v("RegExp")},function(e,t){e.exports={}},function(e,t,n){var r=n(65);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(156),i=n(142),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},function(e,t,n){var r=n(113),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t,n){var r=n(104);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r,i,o=n(172),a=n(205),s=RegExp.prototype.exec,l=String.prototype.replace,c=s,u=(r=/a/,i=/b*/g,s.call(r,"a"),s.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),d=a.UNSUPPORTED_Y||a.BROKEN_CARET,f=void 0!==/()??/.exec("")[1];(u||f||d)&&(c=function(e){var t,n,r,i,a=this,c=d&&a.sticky,h=o.call(a),g=a.source,v=0,p=e;return c&&(-1===(h=h.replace("y","")).indexOf("g")&&(h+="g"),p=String(e).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(g="(?: "+g+")",p=" "+p,v++),n=new RegExp("^(?:"+g+")",h)),f&&(n=new RegExp("^"+g+"$(?!\\s)",h)),u&&(t=a.lastIndex),r=s.call(c?n:a,p),c?r?(r.input=r.input.slice(v),r[0]=r[0].slice(v),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:u&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),f&&r&&r.length>1&&l.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=c},function(e,t,n){"use strict";n(34);var r=n(65),i=n(41),o=n(51),a=n(145),s=n(105),l=o("species"),c=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u="$0"==="a".replace(/./,"$0"),d=o("replace"),f=!!/./[d]&&""===/./[d]("a","$0"),h=!i((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,d){var g=o(e),v=!i((function(){var t={};return t[g]=function(){return 7},7!=""[e](t)})),p=v&&!i((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[g]=/./[g]),n.exec=function(){return t=!0,null},n[g](""),!t}));if(!v||!p||"replace"===e&&(!c||!u||f)||"split"===e&&!h){var y=/./[g],m=n(g,""[e],(function(e,t,n,r,i){return t.exec===a?v&&!i?{done:!0,value:y.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:f}),b=m[0],k=m[1];r(String.prototype,e,b),r(RegExp.prototype,g,2==t?function(e,t){return k.call(e,this,t)}:function(e){return k.call(e,this)})}d&&s(RegExp.prototype[g],"sham",!0)}},function(e,t,n){var r=n(104),i=n(145);e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){var r=n(166),i=n(138),o=n(51)("iterator");e.exports=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){"use strict";var r=n(19),i=n(250);r({target:"String",proto:!0,forced:n(251)("anchor")},{anchor:function(e){return i(this,"a","name",e)}})},function(e,t,n){"use strict";var r=n(146),i=n(30),o=n(62),a=n(63),s=n(174),l=n(147);r("match",1,(function(e,t,n){return[function(t){var n=a(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var a=i(e),c=String(this);if(!a.global)return l(a,c);var u=a.unicode;a.lastIndex=0;for(var d,f=[],h=0;null!==(d=l(a,c));){var g=String(d[0]);f[h]=g,""===g&&(a.lastIndex=s(c,o(a.lastIndex),u)),h++}return 0===h?null:f}]}))},function(e,t,n){var r=n(30),i=n(148);e.exports=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return r(t.call(e))}},function(e,t,n){n(19)({target:"String",proto:!0},{repeat:n(181)})},function(e,t,n){var r=n(47),i=n(48),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r=n(47),i=n(105);e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},function(e,t,n){var r=n(186),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},function(e,t,n){var r=n(36),i=n(186);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(57),i=n(130),o=n(160),a=n(30);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(a(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(84),i=n(62),o=n(143),a=function(e){return function(t,n,a){var s,l=r(t),c=i(l.length),u=o(a,c);if(e&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(41);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(e,t,n){var r=n(48),i=n(144),o=n(51)("species");e.exports=function(e,t){var n;return i(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!i(n.prototype)?r(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},function(e,t,n){var r,i,o=n(47),a=n(164),s=o.process,l=s&&s.versions,c=l&&l.v8;c?i=(r=c.split("."))[0]+r[1]:a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=r[1]),e.exports=i&&+i},function(e,t,n){var r=n(57);e.exports=r("navigator","userAgent")||""},function(e,t,n){var r={};r[n(51)("toStringTag")]="z",e.exports="[object z]"===String(r)},function(e,t,n){var r=n(165),i=n(104),o=n(51)("toStringTag"),a="Arguments"==i(function(){return arguments}());e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:a?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r}},function(e,t,n){var r=n(19),i=n(52),o=n(30),a=n(119),s=n(56);r({target:"Reflect",stat:!0,forced:n(41)((function(){Reflect.defineProperty(s.f({},1,{value:1}),1,{value:2})})),sham:!i},{defineProperty:function(e,t,n){o(e);var r=a(t,!0);o(n);try{return s.f(e,r,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(169);e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},function(e,t,n){var r=n(48),i=n(104),o=n(51)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(51)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},function(e,t,n){var r=n(48),i=n(204);e.exports=function(e,t,n){var o,a;return i&&"function"==typeof(o=t.constructor)&&o!==n&&r(a=o.prototype)&&a!==n.prototype&&i(e,a),e}},function(e,t,n){"use strict";var r=n(30);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(57),i=n(56),o=n(51),a=n(52),s=o("species");e.exports=function(e){var t=r(e),n=i.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(175).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r=n(113),i=n(63),o=function(e){return function(t,n){var o,a,s=String(i(t)),l=r(n),c=s.length;return l<0||l>=c?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e,t,n){var r=n(51)("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(19),i=n(210),o=n(136),a=n(204),s=n(115),l=n(105),c=n(65),u=n(51),d=n(36),f=n(138),h=n(211),g=h.IteratorPrototype,v=h.BUGGY_SAFARI_ITERATORS,p=u("iterator"),y=function(){return this};e.exports=function(e,t,n,u,h,m,b){i(n,t,u);var k,w,S,C=function(e){if(e===h&&T)return T;if(!v&&e in E)return E[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},R=t+" Iterator",x=!1,E=e.prototype,D=E[p]||E["@@iterator"]||h&&E[h],T=!v&&D||C(h),M="Array"==t&&E.entries||D;if(M&&(k=o(M.call(new e)),g!==Object.prototype&&k.next&&(d||o(k)===g||(a?a(k,g):"function"!=typeof k[p]&&l(k,p,y)),s(k,R,!0,!0),d&&(f[R]=y))),"values"==h&&D&&"values"!==D.name&&(x=!0,T=function(){return D.call(this)}),d&&!b||E[p]===T||l(E,p,T),f[t]=T,h)if(w={values:C("values"),keys:m?T:C("keys"),entries:C("entries")},b)for(S in w)(v||x||!(S in E))&&c(E,S,w[S]);else r({target:t,proto:!0,forced:v||x},w);return w}},function(e,t,n){var r=n(63),i="["+n(179)+"]",o=RegExp("^"+i+i+"*"),a=RegExp(i+i+"*$"),s=function(e){return function(t){var n=String(r(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(a,"")),n}};e.exports={start:s(1),end:s(2),trim:s(3)}},function(e,t){e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},function(e,t,n){"use strict";var r=n(146),i=n(30),o=n(63),a=n(254),s=n(147);r("search",1,(function(e,t,n){return[function(t){var n=o(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var o=i(e),l=String(this),c=o.lastIndex;a(c,0)||(o.lastIndex=0);var u=s(o,l);return a(o.lastIndex,c)||(o.lastIndex=c),null===u?-1:u.index}]}))},function(e,t,n){"use strict";var r=n(113),i=n(63);e.exports="".repeat||function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t,n){"use strict";var r=n(19),i=n(47),o=n(131),a=n(65),s=n(135),l=n(46),c=n(123),u=n(48),d=n(41),f=n(176),h=n(115),g=n(171);e.exports=function(e,t,n){var v=-1!==e.indexOf("Map"),p=-1!==e.indexOf("Weak"),y=v?"set":"add",m=i[e],b=m&&m.prototype,k=m,w={},S=function(e){var t=b[e];a(b,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(p&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return p&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(p&&!u(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(o(e,"function"!=typeof m||!(p||b.forEach&&!d((function(){(new m).entries().next()})))))k=n.getConstructor(t,e,v,y),s.REQUIRED=!0;else if(o(e,!0)){var C=new k,R=C[y](p?{}:-0,1)!=C,x=d((function(){C.has(1)})),E=f((function(e){new m(e)})),D=!p&&d((function(){for(var e=new m,t=5;t--;)e[y](t,t);return!e.has(-0)}));E||((k=t((function(t,n){c(t,k,e);var r=g(new m,t,k);return null!=n&&l(n,r[y],r,v),r}))).prototype=b,b.constructor=k),(x||D)&&(S("delete"),S("has"),v&&S("get")),(D||R)&&S(y),p&&b.clear&&delete b.clear}return w[e]=k,r({global:!0,forced:k!=m},w),h(k,e),p||n.setStrong(k,e,v),k}},function(e,t,n){"use strict";var r=n(30),i=n(50);e.exports=function(){for(var e,t=r(this),n=i(t.delete),o=!0,a=0,s=arguments.length;a<s;a++)e=n.call(t,arguments[a]),o=o&&e;return!!o}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(52),i=n(41),o=n(153);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(47),i=n(154),o=r["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=o},function(e,t,n){var r=n(47),i=n(155),o=r.WeakMap;e.exports="function"==typeof o&&/native code/.test(i(o))},function(e,t,n){var r=n(55),i=n(157),o=n(82),a=n(56);e.exports=function(e,t){for(var n=i(t),s=a.f,l=o.f,c=0;c<n.length;c++){var u=n[c];r(e,u)||s(e,u,l(t,u))}}},function(e,t,n){var r=n(47);e.exports=r},function(e,t,n){var r=n(55),i=n(84),o=n(158).indexOf,a=n(129);e.exports=function(e,t){var n,s=i(e),l=0,c=[];for(n in s)!r(a,n)&&r(s,n)&&c.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~o(c,n)||c.push(n));return c}},function(e,t,n){var r=n(161);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(52),i=n(56),o=n(30),a=n(132);e.exports=r?Object.defineProperties:function(e,t){o(e);for(var n,r=a(t),s=r.length,l=0;s>l;)i.f(e,n=r[l++],t[n]);return e}},function(e,t,n){var r=n(57);e.exports=r("document","documentElement")},function(e,t,n){var r=n(84),i=n(130).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t,n){var r=n(51);t.f=r},function(e,t,n){var r=n(189),i=n(55),o=n(195),a=n(56).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||a(t,e,{value:o.f(e)})}},function(e,t,n){"use strict";var r=n(109).forEach,i=n(120),o=n(83),a=i("forEach"),s=o("forEach");e.exports=a&&s?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},function(e,t,n){"use strict";var r=n(52),i=n(41),o=n(132),a=n(160),s=n(140),l=n(66),c=n(128),u=Object.assign,d=Object.defineProperty;e.exports=!u||i((function(){if(r&&1!==u({b:1},u(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||"abcdefghijklmnopqrst"!=o(u({},t)).join("")}))?function(e,t){for(var n=l(e),i=arguments.length,u=1,d=a.f,f=s.f;i>u;)for(var h,g=c(arguments[u++]),v=d?o(g).concat(d(g)):o(g),p=v.length,y=0;p>y;)h=v[y++],r&&!f.call(g,h)||(n[h]=g[h]);return n}:u},function(e,t,n){var r=n(41);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,n){var r=n(41);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){var r=n(19),i=n(41),o=n(48),a=Object.isFrozen;r({target:"Object",stat:!0,forced:i((function(){a(1)}))},{isFrozen:function(e){return!o(e)||!!a&&a(e)}})},function(e,t,n){var r=n(19),i=n(52),o=n(30),a=n(82);r({target:"Reflect",stat:!0,sham:!i},{getOwnPropertyDescriptor:function(e,t){return a.f(o(e),t)}})},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,n){var r=n(30),i=n(234);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,o){return r(n),i(o),t?e.call(n,o):n.__proto__=o,n}}():void 0)},function(e,t,n){"use strict";var r=n(41);function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){"use strict";var r=n(58),i=n(66),o=n(208),a=n(209),s=n(62),l=n(121),c=n(148);e.exports=function(e){var t,n,u,d,f,h,g=i(e),v="function"==typeof this?this:Array,p=arguments.length,y=p>1?arguments[1]:void 0,m=void 0!==y,b=c(g),k=0;if(m&&(y=r(y,p>2?arguments[2]:void 0,2)),null==b||v==Array&&a(b))for(n=new v(t=s(g.length));t>k;k++)h=m?y(g[k],k):g[k],l(n,k,h);else for(f=(d=b.call(g)).next,n=new v;!(u=f.call(d)).done;k++)h=m?o(d,y,[u.value,k],!0):u.value,l(n,k,h);return n.length=k,n}},function(e,t,n){var r=n(30);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(51),i=n(138),o=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},function(e,t,n){"use strict";var r=n(211).IteratorPrototype,i=n(114),o=n(112),a=n(115),s=n(138),l=function(){return this};e.exports=function(e,t,n){var c=t+" Iterator";return e.prototype=i(r,{next:o(1,n)}),a(e,c,!1,!0),s[c]=l,e}},function(e,t,n){"use strict";var r,i,o,a=n(136),s=n(105),l=n(55),c=n(51),u=n(36),d=c("iterator"),f=!1;[].keys&&("next"in(o=[].keys())?(i=a(a(o)))!==Object.prototype&&(r=i):f=!0),null==r&&(r={}),u||l(r,d)||s(r,d,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},function(e,t,n){var r=n(52),i=n(132),o=n(84),a=n(140).f,s=function(e){return function(t){for(var n,s=o(t),l=i(s),c=l.length,u=0,d=[];c>u;)n=l[u++],r&&!a.call(s,n)||d.push(e?[n,s[n]]:s[n]);return d}};e.exports={entries:s(!0),values:s(!1)}},function(e,t,n){var r=n(19),i=n(41),o=n(48),a=Object.isExtensible;r({target:"Object",stat:!0,forced:i((function(){a(1)}))},{isExtensible:function(e){return!!o(e)&&(!a||a(e))}})},function(e,t,n){var r,i,o,a=n(47),s=n(41),l=n(104),c=n(58),u=n(193),d=n(153),f=n(215),h=a.location,g=a.setImmediate,v=a.clearImmediate,p=a.process,y=a.MessageChannel,m=a.Dispatch,b=0,k={},w=function(e){if(k.hasOwnProperty(e)){var t=k[e];delete k[e],t()}},S=function(e){return function(){w(e)}},C=function(e){w(e.data)},R=function(e){a.postMessage(e+"",h.protocol+"//"+h.host)};g&&v||(g=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return k[++b]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},r(b),b},v=function(e){delete k[e]},"process"==l(p)?r=function(e){p.nextTick(S(e))}:m&&m.now?r=function(e){m.now(S(e))}:y&&!f?(o=(i=new y).port2,i.port1.onmessage=C,r=c(o.postMessage,o,1)):!a.addEventListener||"function"!=typeof postMessage||a.importScripts||s(R)||"file:"===h.protocol?r="onreadystatechange"in d("script")?function(e){u.appendChild(d("script")).onreadystatechange=function(){u.removeChild(this),w(e)}}:function(e){setTimeout(S(e),0)}:(r=R,a.addEventListener("message",C,!1))),e.exports={set:g,clear:v}},function(e,t,n){var r=n(164);e.exports=/(iphone|ipod|ipad).*applewebkit/i.test(r)},function(e,t,n){"use strict";var r=n(50),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t,n){var r=n(217);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t,n){var r=n(0);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t,n){n(19)({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},function(e,t,n){"use strict";n(25);var r,i=n(19),o=n(52),a=n(222),s=n(47),l=n(192),c=n(65),u=n(123),d=n(55),f=n(198),h=n(207),g=n(175).codeAt,v=n(255),p=n(115),y=n(256),m=n(85),b=s.URL,k=y.URLSearchParams,w=y.getState,S=m.set,C=m.getterFor("URL"),R=Math.floor,x=Math.pow,E=/[A-Za-z]/,D=/[\d+-.A-Za-z]/,T=/\d/,M=/^(0x|0X)/,A=/^[0-7]+$/,I=/^\d+$/,F=/^[\dA-Fa-f]+$/,O=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,_=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,P=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,L=/[\u0009\u000A\u000D]/g,H=function(e,t){var n,r,i;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return"Invalid host";if(!(n=B(t.slice(1,-1))))return"Invalid host";e.host=n}else if($(e)){if(t=v(t),O.test(t))return"Invalid host";if(null===(n=j(t)))return"Invalid host";e.host=n}else{if(_.test(t))return"Invalid host";for(n="",r=h(t),i=0;i<r.length;i++)n+=G(r[i],z);e.host=n}},j=function(e){var t,n,r,i,o,a,s,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),(t=l.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=l[r]))return e;if(o=10,i.length>1&&"0"==i.charAt(0)&&(o=M.test(i)?16:8,i=i.slice(8==o?1:2)),""===i)a=0;else{if(!(10==o?I:8==o?A:F).test(i))return e;a=parseInt(i,o)}n.push(a)}for(r=0;r<t;r++)if(a=n[r],r==t-1){if(a>=x(256,5-t))return null}else if(a>255)return null;for(s=n.pop(),r=0;r<n.length;r++)s+=n[r]*x(256,3-r);return s},B=function(e){var t,n,r,i,o,a,s,l=[0,0,0,0,0,0,0,0],c=0,u=null,d=0,f=function(){return e.charAt(d)};if(":"==f()){if(":"!=e.charAt(1))return;d+=2,u=++c}for(;f();){if(8==c)return;if(":"!=f()){for(t=n=0;n<4&&F.test(f());)t=16*t+parseInt(f(),16),d++,n++;if("."==f()){if(0==n)return;if(d-=n,c>6)return;for(r=0;f();){if(i=null,r>0){if(!("."==f()&&r<4))return;d++}if(!T.test(f()))return;for(;T.test(f());){if(o=parseInt(f(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;d++}l[c]=256*l[c]+i,2!=++r&&4!=r||c++}if(4!=r)return;break}if(":"==f()){if(d++,!f())return}else if(f())return;l[c++]=t}else{if(null!==u)return;d++,u=++c}}if(null!==u)for(a=c-u,c=7;0!=c&&a>0;)s=l[c],l[c--]=l[u+a-1],l[u+--a]=s;else if(8!=c)return;return l},N=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)t.unshift(e%256),e=R(e/256);return t.join(".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=e[n].toString(16),n<7&&(t+=":")));return"["+t+"]"}return e},z={},V=f({},z,{" ":1,'"':1,"<":1,">":1,"`":1}),W=f({},V,{"#":1,"?":1,"{":1,"}":1}),U=f({},W,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),G=function(e,t){var n=g(e,0);return n>32&&n<127&&!d(t,e)?e:encodeURIComponent(e)},Y={ftp:21,file:null,http:80,https:443,ws:80,wss:443},$=function(e){return d(Y,e.scheme)},q=function(e){return""!=e.username||""!=e.password},X=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},K=function(e,t){var n;return 2==e.length&&E.test(e.charAt(0))&&(":"==(n=e.charAt(1))||!t&&"|"==n)},J=function(e){var t;return e.length>1&&K(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},Q=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&K(t[0],!0)||t.pop()},Z=function(e){return"."===e||"%2e"===e.toLowerCase()},ee={},te={},ne={},re={},ie={},oe={},ae={},se={},le={},ce={},ue={},de={},fe={},he={},ge={},ve={},pe={},ye={},me={},be={},ke={},we=function(e,t,n,i){var o,a,s,l,c,u=n||ee,f=0,g="",v=!1,p=!1,y=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(P,"")),t=t.replace(L,""),o=h(t);f<=o.length;){switch(a=o[f],u){case ee:if(!a||!E.test(a)){if(n)return"Invalid scheme";u=ne;continue}g+=a.toLowerCase(),u=te;break;case te:if(a&&(D.test(a)||"+"==a||"-"==a||"."==a))g+=a.toLowerCase();else{if(":"!=a){if(n)return"Invalid scheme";g="",u=ne,f=0;continue}if(n&&($(e)!=d(Y,g)||"file"==g&&(q(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=g,n)return void($(e)&&Y[e.scheme]==e.port&&(e.port=null));g="","file"==e.scheme?u=he:$(e)&&i&&i.scheme==e.scheme?u=re:$(e)?u=se:"/"==o[f+1]?(u=ie,f++):(e.cannotBeABaseURL=!0,e.path.push(""),u=me)}break;case ne:if(!i||i.cannotBeABaseURL&&"#"!=a)return"Invalid scheme";if(i.cannotBeABaseURL&&"#"==a){e.scheme=i.scheme,e.path=i.path.slice(),e.query=i.query,e.fragment="",e.cannotBeABaseURL=!0,u=ke;break}u="file"==i.scheme?he:oe;continue;case re:if("/"!=a||"/"!=o[f+1]){u=oe;continue}u=le,f++;break;case ie:if("/"==a){u=ce;break}u=ye;continue;case oe:if(e.scheme=i.scheme,a==r)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query;else if("/"==a||"\\"==a&&$(e))u=ae;else if("?"==a)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query="",u=be;else{if("#"!=a){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.path.pop(),u=ye;continue}e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query,e.fragment="",u=ke}break;case ae:if(!$(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,u=ye;continue}u=ce}else u=le;break;case se:if(u=le,"/"!=a||"/"!=g.charAt(f+1))continue;f++;break;case le:if("/"!=a&&"\\"!=a){u=ce;continue}break;case ce:if("@"==a){v&&(g="%40"+g),v=!0,s=h(g);for(var m=0;m<s.length;m++){var b=s[m];if(":"!=b||y){var k=G(b,U);y?e.password+=k:e.username+=k}else y=!0}g=""}else if(a==r||"/"==a||"?"==a||"#"==a||"\\"==a&&$(e)){if(v&&""==g)return"Invalid authority";f-=h(g).length+1,g="",u=ue}else g+=a;break;case ue:case de:if(n&&"file"==e.scheme){u=ve;continue}if(":"!=a||p){if(a==r||"/"==a||"?"==a||"#"==a||"\\"==a&&$(e)){if($(e)&&""==g)return"Invalid host";if(n&&""==g&&(q(e)||null!==e.port))return;if(l=H(e,g))return l;if(g="",u=pe,n)return;continue}"["==a?p=!0:"]"==a&&(p=!1),g+=a}else{if(""==g)return"Invalid host";if(l=H(e,g))return l;if(g="",u=fe,n==de)return}break;case fe:if(!T.test(a)){if(a==r||"/"==a||"?"==a||"#"==a||"\\"==a&&$(e)||n){if(""!=g){var w=parseInt(g,10);if(w>65535)return"Invalid port";e.port=$(e)&&w===Y[e.scheme]?null:w,g=""}if(n)return;u=pe;continue}return"Invalid port"}g+=a;break;case he:if(e.scheme="file","/"==a||"\\"==a)u=ge;else{if(!i||"file"!=i.scheme){u=ye;continue}if(a==r)e.host=i.host,e.path=i.path.slice(),e.query=i.query;else if("?"==a)e.host=i.host,e.path=i.path.slice(),e.query="",u=be;else{if("#"!=a){J(o.slice(f).join(""))||(e.host=i.host,e.path=i.path.slice(),Q(e)),u=ye;continue}e.host=i.host,e.path=i.path.slice(),e.query=i.query,e.fragment="",u=ke}}break;case ge:if("/"==a||"\\"==a){u=ve;break}i&&"file"==i.scheme&&!J(o.slice(f).join(""))&&(K(i.path[0],!0)?e.path.push(i.path[0]):e.host=i.host),u=ye;continue;case ve:if(a==r||"/"==a||"\\"==a||"?"==a||"#"==a){if(!n&&K(g))u=ye;else if(""==g){if(e.host="",n)return;u=pe}else{if(l=H(e,g))return l;if("localhost"==e.host&&(e.host=""),n)return;g="",u=pe}continue}g+=a;break;case pe:if($(e)){if(u=ye,"/"!=a&&"\\"!=a)continue}else if(n||"?"!=a)if(n||"#"!=a){if(a!=r&&(u=ye,"/"!=a))continue}else e.fragment="",u=ke;else e.query="",u=be;break;case ye:if(a==r||"/"==a||"\\"==a&&$(e)||!n&&("?"==a||"#"==a)){if(".."===(c=(c=g).toLowerCase())||"%2e."===c||".%2e"===c||"%2e%2e"===c?(Q(e),"/"==a||"\\"==a&&$(e)||e.path.push("")):Z(g)?"/"==a||"\\"==a&&$(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&K(g)&&(e.host&&(e.host=""),g=g.charAt(0)+":"),e.path.push(g)),g="","file"==e.scheme&&(a==r||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==a?(e.query="",u=be):"#"==a&&(e.fragment="",u=ke)}else g+=G(a,W);break;case me:"?"==a?(e.query="",u=be):"#"==a?(e.fragment="",u=ke):a!=r&&(e.path[0]+=G(a,z));break;case be:n||"#"!=a?a!=r&&("'"==a&&$(e)?e.query+="%27":e.query+="#"==a?"%23":G(a,z)):(e.fragment="",u=ke);break;case ke:a!=r&&(e.fragment+=G(a,V))}f++}},Se=function(e){var t,n,r=u(this,Se,"URL"),i=arguments.length>1?arguments[1]:void 0,a=String(e),s=S(r,{type:"URL"});if(void 0!==i)if(i instanceof Se)t=C(i);else if(n=we(t={},String(i)))throw TypeError(n);if(n=we(s,a,null,t))throw TypeError(n);var l=s.searchParams=new k,c=w(l);c.updateSearchParams(s.query),c.updateURL=function(){s.query=String(l)||null},o||(r.href=Re.call(r),r.origin=xe.call(r),r.protocol=Ee.call(r),r.username=De.call(r),r.password=Te.call(r),r.host=Me.call(r),r.hostname=Ae.call(r),r.port=Ie.call(r),r.pathname=Fe.call(r),r.search=Oe.call(r),r.searchParams=_e.call(r),r.hash=Pe.call(r))},Ce=Se.prototype,Re=function(){var e=C(this),t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,a=e.path,s=e.query,l=e.fragment,c=t+":";return null!==i?(c+="//",q(e)&&(c+=n+(r?":"+r:"")+"@"),c+=N(i),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+a.join("/"):"",null!==s&&(c+="?"+s),null!==l&&(c+="#"+l),c},xe=function(){var e=C(this),t=e.scheme,n=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&$(e)?t+"://"+N(e.host)+(null!==n?":"+n:""):"null"},Ee=function(){return C(this).scheme+":"},De=function(){return C(this).username},Te=function(){return C(this).password},Me=function(){var e=C(this),t=e.host,n=e.port;return null===t?"":null===n?N(t):N(t)+":"+n},Ae=function(){var e=C(this).host;return null===e?"":N(e)},Ie=function(){var e=C(this).port;return null===e?"":String(e)},Fe=function(){var e=C(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},Oe=function(){var e=C(this).query;return e?"?"+e:""},_e=function(){return C(this).searchParams},Pe=function(){var e=C(this).fragment;return e?"#"+e:""},Le=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(o&&l(Ce,{href:Le(Re,(function(e){var t=C(this),n=String(e),r=we(t,n);if(r)throw TypeError(r);w(t.searchParams).updateSearchParams(t.query)})),origin:Le(xe),protocol:Le(Ee,(function(e){var t=C(this);we(t,String(e)+":",ee)})),username:Le(De,(function(e){var t=C(this),n=h(String(e));if(!X(t)){t.username="";for(var r=0;r<n.length;r++)t.username+=G(n[r],U)}})),password:Le(Te,(function(e){var t=C(this),n=h(String(e));if(!X(t)){t.password="";for(var r=0;r<n.length;r++)t.password+=G(n[r],U)}})),host:Le(Me,(function(e){var t=C(this);t.cannotBeABaseURL||we(t,String(e),ue)})),hostname:Le(Ae,(function(e){var t=C(this);t.cannotBeABaseURL||we(t,String(e),de)})),port:Le(Ie,(function(e){var t=C(this);X(t)||(""==(e=String(e))?t.port=null:we(t,e,fe))})),pathname:Le(Fe,(function(e){var t=C(this);t.cannotBeABaseURL||(t.path=[],we(t,e+"",pe))})),search:Le(Oe,(function(e){var t=C(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",we(t,e,be)),w(t.searchParams).updateSearchParams(t.query)})),searchParams:Le(_e),hash:Le(Pe,(function(e){var t=C(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",we(t,e,ke)):t.fragment=null}))}),c(Ce,"toJSON",(function(){return Re.call(this)}),{enumerable:!0}),c(Ce,"toString",(function(){return Re.call(this)}),{enumerable:!0}),b){var He=b.createObjectURL,je=b.revokeObjectURL;He&&c(Se,"createObjectURL",(function(e){return He.apply(b,arguments)})),je&&c(Se,"revokeObjectURL",(function(e){return je.apply(b,arguments)}))}p(Se,"URL"),i({global:!0,forced:!a,sham:!o},{URL:Se})},function(e,t,n){var r=n(41),i=n(51),o=n(36),a=i("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},function(e,t,n){var r=n(62),i=n(181),o=n(63),a=Math.ceil,s=function(e){return function(t,n,s){var l,c,u=String(o(t)),d=u.length,f=void 0===s?" ":String(s),h=r(n);return h<=d||""==f?u:(l=h-d,(c=i.call(f,a(l/f.length))).length>l&&(c=c.slice(0,l)),e?u+c:c+u)}};e.exports={start:s(!1),end:s(!0)}},function(e,t,n){var r=n(164);e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r)},function(e,t,n){"use strict";var r=n(19),i=n(223).start;r({target:"String",proto:!0,forced:n(224)},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(56).f,i=n(114),o=n(139),a=n(58),s=n(123),l=n(46),c=n(177),u=n(173),d=n(52),f=n(135).fastKey,h=n(85),g=h.set,v=h.getterFor;e.exports={getConstructor:function(e,t,n,c){var u=e((function(e,r){s(e,u,t),g(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),null!=r&&l(r,e[c],e,n)})),h=v(t),p=function(e,t,n){var r,i,o=h(e),a=y(e,t);return a?a.value=n:(o.last=a={index:i=f(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),d?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},y=function(e,t){var n,r=h(e),i=f(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return o(u.prototype,{clear:function(){for(var e=h(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,d?e.size=0:this.size=0},delete:function(e){var t=h(this),n=y(this,e);if(n){var r=n.next,i=n.previous;delete t.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),t.first==n&&(t.first=r),t.last==n&&(t.last=i),d?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=h(this),r=a(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!y(this,e)}}),o(u.prototype,n?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return p(this,0===e?0:e,t)}}:{add:function(e){return p(this,e=0===e?0:e,e)}}),d&&r(u.prototype,"size",{get:function(){return h(this).size}}),u},setStrong:function(e,t,n){var r=t+" Iterator",i=v(t),o=v(r);c(e,t,(function(e,t){g(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(t)}}},function(e,t,n){"use strict";var r,i=n(47),o=n(139),a=n(135),s=n(182),l=n(265),c=n(48),u=n(85).enforce,d=n(187),f=!i.ActiveXObject&&"ActiveXObject"in i,h=Object.isExtensible,g=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},v=e.exports=s("WeakMap",g,l);if(d&&f){r=l.getConstructor(g,"WeakMap",!0),a.REQUIRED=!0;var p=v.prototype,y=p.delete,m=p.has,b=p.get,k=p.set;o(p,{delete:function(e){if(c(e)&&!h(e)){var t=u(this);return t.frozen||(t.frozen=new r),y.call(this,e)||t.frozen.delete(e)}return y.call(this,e)},has:function(e){if(c(e)&&!h(e)){var t=u(this);return t.frozen||(t.frozen=new r),m.call(this,e)||t.frozen.has(e)}return m.call(this,e)},get:function(e){if(c(e)&&!h(e)){var t=u(this);return t.frozen||(t.frozen=new r),m.call(this,e)?b.call(this,e):t.frozen.get(e)}return b.call(this,e)},set:function(e,t){if(c(e)&&!h(e)){var n=u(this);n.frozen||(n.frozen=new r),m.call(this,e)?k.call(this,e,t):n.frozen.set(e,t)}else k.call(this,e,t);return this}})}},function(e,t,n){"use strict";var r=n(19),i=n(36),o=n(183);r({target:"WeakMap",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},function(e,t,n){n(19)({target:"Reflect",stat:!0},{ownKeys:n(157)})},function(e,t){e.exports=function(e){this.wrapped=e}},function(e,t,n){n(19)({target:"Reflect",stat:!0},{has:function(e,t){return t in e}})},function(e,t,n){(function(r){var i,o;void 0===(o="function"==typeof(i=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}var l=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return n(t,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,i=n.length;r<i;r++)if(n[r]===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(e){var t=this;if(e.type in this.listeners){for(var n=function(n){setTimeout((function(){return n.call(t,e)}))},r=this.listeners[e.type],i=0,o=r.length;i<o;i++)n(r[i]);return!e.defaultPrevented}}}]),t}(),c=function(t){function r(){var t;return e(this,r),(t=function(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?a(e):t}(this,i(r).call(this))).listeners||l.call(a(t)),Object.defineProperty(a(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(a(t),"onabort",{value:null,writable:!0,configurable:!0}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(r,t),n(r,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),s(i(r.prototype),"dispatchEvent",this).call(this,e)}}]),r}(l),u=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new c,writable:!0,configurable:!0})}return n(t,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();function d(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(u.prototype[Symbol.toStringTag]="AbortController",c.prototype[Symbol.toStringTag]="AbortSignal"),function(e){if(d(e))if(e.fetch){var t=function(e){"function"==typeof e&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,i=void 0===r?n.Request:r,o=t.AbortController,a=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,s=void 0!==a&&a;if(!d({fetch:n,Request:i,AbortController:o,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:s}))return{fetch:n,Request:l};var l=i;(l&&!l.prototype.hasOwnProperty("signal")||s)&&((l=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);var r=new i(e,t);return n&&Object.defineProperty(r,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),r}).prototype=i.prototype);var c=n;return{fetch:function(e,t){var n=l&&l.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(n){var r;try{r=new DOMException("Aborted","AbortError")}catch(e){(r=new Error("Aborted")).name="AbortError"}if(n.aborted)return Promise.reject(r);var i=new Promise((function(e,t){n.addEventListener("abort",(function(){return t(r)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([i,c(e,t)])}return c(e,t)},Request:l}}(e),n=t.fetch,r=t.Request;e.fetch=n,e.Request=r,Object.defineProperty(e,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:u}),Object.defineProperty(e,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:c})}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill")}("undefined"!=typeof self?self:r)})?i.call(t,n,t,e):i)||(e.exports=o)}).call(this,n(184))},function(e,t,n){"use strict";var r=n(165),i=n(166);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t,n){var r=n(48);e.exports=function(e){if(!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,n){"use strict";var r=n(50),i=n(48),o=[].slice,a={},s=function(e,t,n){if(!(t in a)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";a[t]=Function("C,a","return new C("+r.join(",")+")")}return a[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=o.call(arguments,1),a=function(){var r=n.concat(o.call(arguments));return this instanceof a?s(t,r.length,r):t.apply(e,r)};return i(t.prototype)&&(a.prototype=t.prototype),a}},function(e,t,n){var r=n(47);e.exports=r.Promise},function(e,t,n){var r,i,o,a,s,l,c,u,d=n(47),f=n(82).f,h=n(104),g=n(214).set,v=n(215),p=d.MutationObserver||d.WebKitMutationObserver,y=d.process,m=d.Promise,b="process"==h(y),k=f(d,"queueMicrotask"),w=k&&k.value;w||(r=function(){var e,t;for(b&&(e=y.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?a():o=void 0,e}}o=void 0,e&&e.enter()},b?a=function(){y.nextTick(r)}:p&&!v?(s=!0,l=document.createTextNode(""),new p(r).observe(l,{characterData:!0}),a=function(){l.data=s=!s}):m&&m.resolve?(c=m.resolve(void 0),u=c.then,a=function(){u.call(c,r)}):a=function(){g.call(d,r)}),e.exports=w||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,a()),o=t}},function(e,t,n){var r=n(30),i=n(48),o=n(216);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){var r=n(47);e.exports=function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}},function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},function(e,t,n){var r=n(217);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){var r=n(50),i=n(66),o=n(128),a=n(62),s=function(e){return function(t,n,s,l){r(n);var c=i(t),u=o(c),d=a(c.length),f=e?d-1:0,h=e?-1:1;if(s<2)for(;;){if(f in u){l=u[f],f+=h;break}if(f+=h,e?f<0:d<=f)throw TypeError("Reduce of empty array with no initial value")}for(;e?f>=0:d>f;f+=h)f in u&&(l=n(l,u[f],f,c));return l}};e.exports={left:s(!1),right:s(!0)}},function(e,t,n){var r=n(19),i=n(48),o=n(30),a=n(55),s=n(82),l=n(136);r({target:"Reflect",stat:!0},{get:function e(t,n){var r,c,u=arguments.length<3?t:arguments[2];return o(t)===u?t[n]:(r=s.f(t,n))?a(r,"value")?r.value:void 0===r.get?void 0:r.get.call(u):i(c=l(t))?e(c,n,u):void 0}})},function(e,t,n){var r=n(19),i=n(30),o=n(48),a=n(55),s=n(41),l=n(56),c=n(82),u=n(136),d=n(112);r({target:"Reflect",stat:!0,forced:s((function(){var e=l.f({},"a",{configurable:!0});return!1!==Reflect.set(u(e),"a",1,e)}))},{set:function e(t,n,r){var s,f,h=arguments.length<4?t:arguments[3],g=c.f(i(t),n);if(!g){if(o(f=u(t)))return e(f,n,r,h);g=d(0)}if(a(g,"value")){if(!1===g.writable||!o(h))return!1;if(s=c.f(h,n)){if(s.get||s.set||!1===s.writable)return!1;s.value=r,l.f(h,n,s)}else l.f(h,n,d(0,r));return!0}return void 0!==g.set&&(g.set.call(h,r),!0)}})},function(e,t,n){var r=n(63),i=/"/g;e.exports=function(e,t,n,o){var a=String(r(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(o).replace(i,"&quot;")+'"'),s+">"+a+"</"+t+">"}},function(e,t,n){var r=n(41);e.exports=function(e){return r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},function(e,t,n){var r=n(41),i=n(179);e.exports=function(e){return r((function(){return!!i[e]()||""!=""[e]()||i[e].name!==e}))}},function(e,t,n){var r=n(19),i=n(46),o=n(121);r({target:"Object",stat:!0},{fromEntries:function(e){var t={};return i(e,(function(e,n){o(t,e,n)}),void 0,!0),t}})},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";var r=/[^\0-\u007E]/,i=/[.\u3002\uFF0E\uFF61]/g,o="Overflow: input needs wider integers to process",a=Math.floor,s=String.fromCharCode,l=function(e){return e+22+75*(e<26)},c=function(e,t,n){var r=0;for(e=n?a(e/700):e>>1,e+=a(e/t);e>455;r+=36)e=a(e/35);return a(r+36*e/(e+38))},u=function(e){var t,n,r=[],i=(e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var o=e.charCodeAt(n++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),n--)}else t.push(i)}return t}(e)).length,u=128,d=0,f=72;for(t=0;t<e.length;t++)(n=e[t])<128&&r.push(s(n));var h=r.length,g=h;for(h&&r.push("-");g<i;){var v=2147483647;for(t=0;t<e.length;t++)(n=e[t])>=u&&n<v&&(v=n);var p=g+1;if(v-u>a((2147483647-d)/p))throw RangeError(o);for(d+=(v-u)*p,u=v,t=0;t<e.length;t++){if((n=e[t])<u&&++d>2147483647)throw RangeError(o);if(n==u){for(var y=d,m=36;;m+=36){var b=m<=f?1:m>=f+26?26:m-f;if(y<b)break;var k=y-b,w=36-b;r.push(s(l(b+k%w))),y=a(k/w)}r.push(s(l(y))),f=c(d,p,g==h),d=0,++g}}++d,++u}return r.join("")};e.exports=function(e){var t,n,o=[],a=e.toLowerCase().replace(i,".").split(".");for(t=0;t<a.length;t++)n=a[t],o.push(r.test(n)?"xn--"+u(n):n);return o.join(".")}},function(e,t,n){"use strict";n(20);var r=n(19),i=n(57),o=n(222),a=n(65),s=n(139),l=n(115),c=n(210),u=n(85),d=n(123),f=n(55),h=n(58),g=n(166),v=n(30),p=n(48),y=n(114),m=n(112),b=n(151),k=n(148),w=n(51),S=i("fetch"),C=i("Headers"),R=w("iterator"),x=u.set,E=u.getterFor("URLSearchParams"),D=u.getterFor("URLSearchParamsIterator"),T=/\+/g,M=Array(4),A=function(e){return M[e-1]||(M[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},I=function(e){try{return decodeURIComponent(e)}catch(t){return e}},F=function(e){var t=e.replace(T," "),n=4;try{return decodeURIComponent(t)}catch(e){for(;n;)t=t.replace(A(n--),I);return t}},O=/[!'()~]|%20/g,_={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},P=function(e){return _[e]},L=function(e){return encodeURIComponent(e).replace(O,P)},H=function(e,t){if(t)for(var n,r,i=t.split("&"),o=0;o<i.length;)(n=i[o++]).length&&(r=n.split("="),e.push({key:F(r.shift()),value:F(r.join("="))}))},j=function(e){this.entries.length=0,H(this.entries,e)},B=function(e,t){if(e<t)throw TypeError("Not enough arguments")},N=c((function(e,t){x(this,{type:"URLSearchParamsIterator",iterator:b(E(e).entries),kind:t})}),"Iterator",(function(){var e=D(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n})),z=function(){d(this,z,"URLSearchParams");var e,t,n,r,i,o,a,s,l,c=arguments.length>0?arguments[0]:void 0,u=this,h=[];if(x(u,{type:"URLSearchParams",entries:h,updateURL:function(){},updateSearchParams:j}),void 0!==c)if(p(c))if("function"==typeof(e=k(c)))for(n=(t=e.call(c)).next;!(r=n.call(t)).done;){if((a=(o=(i=b(v(r.value))).next).call(i)).done||(s=o.call(i)).done||!o.call(i).done)throw TypeError("Expected sequence with length 2");h.push({key:a.value+"",value:s.value+""})}else for(l in c)f(c,l)&&h.push({key:l,value:c[l]+""});else H(h,"string"==typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")},V=z.prototype;s(V,{append:function(e,t){B(arguments.length,2);var n=E(this);n.entries.push({key:e+"",value:t+""}),n.updateURL()},delete:function(e){B(arguments.length,1);for(var t=E(this),n=t.entries,r=e+"",i=0;i<n.length;)n[i].key===r?n.splice(i,1):i++;t.updateURL()},get:function(e){B(arguments.length,1);for(var t=E(this).entries,n=e+"",r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){B(arguments.length,1);for(var t=E(this).entries,n=e+"",r=[],i=0;i<t.length;i++)t[i].key===n&&r.push(t[i].value);return r},has:function(e){B(arguments.length,1);for(var t=E(this).entries,n=e+"",r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){B(arguments.length,1);for(var n,r=E(this),i=r.entries,o=!1,a=e+"",s=t+"",l=0;l<i.length;l++)(n=i[l]).key===a&&(o?i.splice(l--,1):(o=!0,n.value=s));o||i.push({key:a,value:s}),r.updateURL()},sort:function(){var e,t,n,r=E(this),i=r.entries,o=i.slice();for(i.length=0,n=0;n<o.length;n++){for(e=o[n],t=0;t<n;t++)if(i[t].key>e.key){i.splice(t,0,e);break}t===n&&i.push(e)}r.updateURL()},forEach:function(e){for(var t,n=E(this).entries,r=h(e,arguments.length>1?arguments[1]:void 0,3),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new N(this,"keys")},values:function(){return new N(this,"values")},entries:function(){return new N(this,"entries")}},{enumerable:!0}),a(V,R,V.entries),a(V,"toString",(function(){for(var e,t=E(this).entries,n=[],r=0;r<t.length;)e=t[r++],n.push(L(e.key)+"="+L(e.value));return n.join("&")}),{enumerable:!0}),l(z,"URLSearchParams"),r({global:!0,forced:!o},{URLSearchParams:z}),o||"function"!=typeof S||"function"!=typeof C||r({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,n,r,i=[e];return arguments.length>1&&(t=arguments[1],p(t)&&(n=t.body,"URLSearchParams"===g(n)&&((r=t.headers?new C(t.headers):new C).has("content-type")||r.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=y(t,{body:m(0,String(n)),headers:m(0,r)}))),i.push(t)),S.apply(this,i)}}),e.exports={URLSearchParams:z,getState:E}},function(e,t,n){"use strict";var r=n(19),i=n(113),o=n(258),a=n(181),s=n(41),l=1..toFixed,c=Math.floor,u=function(e,t,n){return 0===t?n:t%2==1?u(e,t-1,n*e):u(e*e,t/2,n)};r({target:"Number",proto:!0,forced:l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){l.call({})}))},{toFixed:function(e){var t,n,r,s,l=o(this),d=i(e),f=[0,0,0,0,0,0],h="",g="0",v=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*f[n],f[n]=r%1e7,r=c(r/1e7)},p=function(e){for(var t=6,n=0;--t>=0;)n+=f[t],f[t]=c(n/e),n=n%e*1e7},y=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==f[e]){var n=String(f[e]);t=""===t?n:t+a.call("0",7-n.length)+n}return t};if(d<0||d>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(h="-",l=-l),l>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(l*u(2,69,1))-69)<0?l*u(2,-t,1):l/u(2,t,1),n*=4503599627370496,(t=52-t)>0){for(v(0,n),r=d;r>=7;)v(1e7,0),r-=7;for(v(u(10,r,1),0),r=t-1;r>=23;)p(1<<23),r-=23;p(1<<r),v(1,1),p(2),g=y()}else v(0,n),v(1<<-t,0),g=y()+a.call("0",d);return g=d>0?h+((s=g.length)<=d?"0."+a.call("0",d-s)+g:g.slice(0,s-d)+"."+g.slice(s-d)):h+g}})},function(e,t,n){var r=n(104);e.exports=function(e){if("number"!=typeof e&&"Number"!=r(e))throw TypeError("Incorrect invocation");return+e}},function(e,t,n){n(19)({target:"Math",stat:!0},{sign:n(260)})},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t,n){"use strict";var r=n(19),i=n(223).end;r({target:"String",proto:!0,forced:n(224)},{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){"use strict";var r=n(30),i=n(50);e.exports=function(){for(var e=r(this),t=i(e.add),n=0,o=arguments.length;n<o;n++)t.call(e,arguments[n]);return e}},function(e,t,n){"use strict";var r=n(139),i=n(135).getWeakData,o=n(30),a=n(48),s=n(123),l=n(46),c=n(109),u=n(55),d=n(85),f=d.set,h=d.getterFor,g=c.find,v=c.findIndex,p=0,y=function(e){return e.frozen||(e.frozen=new m)},m=function(){this.entries=[]},b=function(e,t){return g(e.entries,(function(e){return e[0]===t}))};m.prototype={get:function(e){var t=b(this,e);if(t)return t[1]},has:function(e){return!!b(this,e)},set:function(e,t){var n=b(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=v(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,c){var d=e((function(e,r){s(e,d,t),f(e,{type:t,id:p++,frozen:void 0}),null!=r&&l(r,e[c],e,n)})),g=h(t),v=function(e,t,n){var r=g(e),a=i(o(t),!0);return!0===a?y(r).set(t,n):a[r.id]=n,e};return r(d.prototype,{delete:function(e){var t=g(this);if(!a(e))return!1;var n=i(e);return!0===n?y(t).delete(e):n&&u(n,t.id)&&delete n[t.id]},has:function(e){var t=g(this);if(!a(e))return!1;var n=i(e);return!0===n?y(t).has(e):n&&u(n,t.id)}}),r(d.prototype,n?{get:function(e){var t=g(this);if(a(e)){var n=i(e);return!0===n?y(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return v(this,e,t)}}:{add:function(e){return v(this,e,!0)}}),d}}},function(e,t,n){"use strict";n(19)({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},function(e,t,n){var r=n(19),i=n(41),o=n(194).f;r({target:"Object",stat:!0,forced:i((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:o})},function(e,t,n){var r=n(230);function i(e){var t,n;function i(t,n){try{var a=e[t](n),s=a.value,l=s instanceof r;Promise.resolve(l?s.wrapped:s).then((function(e){l?i("return"===t?"return":"next",e):o(a.done?"return":"normal",e)}),(function(e){i("throw",e)}))}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(o,a){var s={key:e,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(i.prototype[Symbol.asyncIterator]=function(){return this}),i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},e.exports=i},function(e,t,n){var r=n(19),i=n(270);r({target:"Number",stat:!0,forced:Number.parseInt!=i},{parseInt:i})},function(e,t,n){var r=n(47),i=n(178).trim,o=n(179),a=r.parseInt,s=/^[+-]?0[Xx]/,l=8!==a(o+"08")||22!==a(o+"0x16");e.exports=l?function(e,t){var n=i(String(e));return a(n,t>>>0||(s.test(n)?16:10))}:a},function(e,t,n){"use strict";var r=n(19),i=n(52),o=n(272),a=n(66),s=n(50),l=n(56);i&&r({target:"Object",proto:!0,forced:o},{__defineGetter__:function(e,t){l.f(a(this),e,{get:s(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(36),i=n(47),o=n(41);e.exports=r||!o((function(){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete i[e]}))},function(e,t,n){var r=n(19),i=n(41),o=n(48),a=Object.isSealed;r({target:"Object",stat:!0,forced:i((function(){a(1)}))},{isSealed:function(e){return!o(e)||!!a&&a(e)}})},function(e,t,n){var r=n(19),i=n(52),o=n(157),a=n(84),s=n(82),l=n(121);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){for(var t,n,r=a(e),i=s.f,c=o(r),u={},d=0;c.length>d;)void 0!==(n=i(r,t=c[d++]))&&l(u,t,n);return u}})},function(e,t,n){n(19)({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(19),i=n(277),o=n(133);r({target:"Array",proto:!0},{fill:i}),o("fill")},function(e,t,n){"use strict";var r=n(66),i=n(143),o=n(62);e.exports=function(e){for(var t=r(this),n=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,c=void 0===l?n:i(l,n);c>s;)t[s++]=e;return t}},function(e,t,n){"use strict";n.r(t),n.d(t,"Base",(function(){return G})),n.d(t,"GlobalEvents",(function(){return Gr})),n.d(t,"BryntumWidgetAdapter",(function(){return Ts})),n.d(t,"BryntumWidgetAdapterRegister",(function(){return ye})),n.d(t,"AjaxStore",(function(){return ka})),n.d(t,"DomDataStore",(function(){return Ms})),n.d(t,"Duration",(function(){return As})),n.d(t,"Model",(function(){return Io})),n.d(t,"StateTrackingManager",(function(){return lc})),n.d(t,"Store",(function(){return ga})),n.d(t,"Transaction",(function(){return Js})),n.d(t,"AjaxHelper",(function(){return Ae})),n.d(t,"ArrayHelper",(function(){return ue})),n.d(t,"BrowserHelper",(function(){return Re})),n.d(t,"CSSHelper",(function(){return cc})),n.d(t,"DateHelper",(function(){return ft})),n.d(t,"DomClassList",(function(){return bt})),n.d(t,"DomHelper",(function(){return on})),n.d(t,"DomSync",(function(){return vc})),n.d(t,"DragHelper",(function(){return Tc})),n.d(t,"EventHelper",(function(){return Kn})),n.d(t,"FunctionHelper",(function(){return _n})),n.d(t,"IdHelper",(function(){return we})),n.d(t,"ObjectHelper",(function(){return mt})),n.d(t,"ResizeHelper",(function(){return jc})),n.d(t,"ResizeMonitor",(function(){return nr})),n.d(t,"StringHelper",(function(){return L})),n.d(t,"TemplateHelper",(function(){return Ii})),n.d(t,"VersionHelper",(function(){return j})),n.d(t,"WidgetHelper",(function(){return Ce})),n.d(t,"DataGenerator",(function(){return Nc})),n.d(t,"DemoBot",(function(){return Wc})),n.d(t,"Fullscreen",(function(){return Uc})),n.d(t,"Point",(function(){return On})),n.d(t,"RandomGenerator",(function(){return Bc})),n.d(t,"Rectangle",(function(){return In})),n.d(t,"Scroller",(function(){return Mr})),n.d(t,"LocaleManager",(function(){return Fe})),n.d(t,"Localizable",(function(){return _e})),n.d(t,"Delayable",(function(){return or})),n.d(t,"Events",(function(){return pe})),n.d(t,"InstancePlugin",(function(){return ho})),n.d(t,"Override",(function(){return Yc})),n.d(t,"Pluggable",(function(){return vo})),n.d(t,"State",(function(){return yo})),n.d(t,"Bag",(function(){return fi})),n.d(t,"ClickRepeater",(function(){return to})),n.d(t,"Collection",(function(){return Sr})),n.d(t,"CollectionFilter",(function(){return cr})),n.d(t,"CollectionSorter",(function(){return dr})),n.d(t,"Month",(function(){return Ya})),n.d(t,"Parser",(function(){return fu})),n.d(t,"Badge",(function(){return Yi})),n.d(t,"BooleanCombo",(function(){return gu})),n.d(t,"Button",(function(){return Ji})),n.d(t,"ButtonGroup",(function(){return Zi})),n.d(t,"CalendarPanel",(function(){return qa})),n.d(t,"Checkbox",(function(){return uo})),n.d(t,"ChipView",(function(){return ja})),n.d(t,"Combo",(function(){return Wa})),n.d(t,"Container",(function(){return yi})),n.d(t,"DateField",(function(){return as})),n.d(t,"DatePicker",(function(){return rs})),n.d(t,"DisplayField",(function(){return pu})),n.d(t,"DurationField",(function(){return mu})),n.d(t,"Editor",(function(){return ts})),n.d(t,"Field",(function(){return so})),n.d(t,"FileField",(function(){return wu})),n.d(t,"FilePicker",(function(){return Cu})),n.d(t,"FlagField",(function(){return xu})),n.d(t,"List",(function(){return Pa})),n.d(t,"Mask",(function(){return Qr})),n.d(t,"Menu",(function(){return Bi})),n.d(t,"MenuItem",(function(){return Li})),n.d(t,"MessageDialog",(function(){return Du})),n.d(t,"NumberField",(function(){return us})),n.d(t,"PagingToolbar",(function(){return Mu})),n.d(t,"Panel",(function(){return Ri})),n.d(t,"Popup",(function(){return Ei})),n.d(t,"Ripple",(function(){return ci})),n.d(t,"Slider",(function(){return hs})),n.d(t,"Splitter",(function(){return Pu})),n.d(t,"TabPanel",(function(){return bs})),n.d(t,"TextAreaField",(function(){return Cs})),n.d(t,"TextField",(function(){return Ca})),n.d(t,"TimeField",(function(){return Ds})),n.d(t,"TimePicker",(function(){return xs})),n.d(t,"Toast",(function(){return zi})),n.d(t,"Tool",(function(){return ni})),n.d(t,"Toolbar",(function(){return bi})),n.d(t,"Tooltip",(function(){return Ui})),n.d(t,"Widget",(function(){return Nr})),n.d(t,"AggregateColumn",(function(){return Wu})),n.d(t,"CheckColumn",(function(){return $u})),n.d(t,"Column",(function(){return Hu})),n.d(t,"DateColumn",(function(){return Xu})),n.d(t,"PercentColumn",(function(){return Ju})),n.d(t,"RatingColumn",(function(){return td})),n.d(t,"RowNumberColumn",(function(){return rd})),n.d(t,"TemplateColumn",(function(){return sd})),n.d(t,"TimeColumn",(function(){return cd})),n.d(t,"TreeColumn",(function(){return fd})),n.d(t,"WidgetColumn",(function(){return Gu})),n.d(t,"ColumnStore",(function(){return zu})),n.d(t,"GridRowModel",(function(){return gd})),n.d(t,"CellEdit",(function(){return Cd})),n.d(t,"CellTooltip",(function(){return xd})),n.d(t,"ColumnDragToolbar",(function(){return Ad})),n.d(t,"ColumnPicker",(function(){return Fd})),n.d(t,"ColumnReorder",(function(){return _d})),n.d(t,"ColumnResize",(function(){return Ld})),n.d(t,"ContextMenu",(function(){return jd})),n.d(t,"Filter",(function(){return Vd})),n.d(t,"FilterBar",(function(){return Yd})),n.d(t,"GridFeatureManager",(function(){return bd})),n.d(t,"Group",(function(){return Kd})),n.d(t,"QuickFind",(function(){return ef})),n.d(t,"RegionResize",(function(){return nf})),n.d(t,"RowReorder",(function(){return of})),n.d(t,"Search",(function(){return cf})),n.d(t,"Sort",(function(){return hf})),n.d(t,"Stripe",(function(){return vf})),n.d(t,"Tree",(function(){return mf})),n.d(t,"GridExportDialog",(function(){return Ff})),n.d(t,"GridMultiPageExporter",(function(){return zf})),n.d(t,"GridPdfExport",(function(){return Gf})),n.d(t,"GridSinglePageExporter",(function(){return Wf})),n.d(t,"PaperFormat",(function(){return kf})),n.d(t,"Orientation",(function(){return wf})),n.d(t,"RowsRange",(function(){return bf})),n.d(t,"FileFormat",(function(){return Sf})),n.d(t,"GridExcelExporter",(function(){return Kf})),n.d(t,"ScrollManager",(function(){return Qf})),n.d(t,"TableExporter",(function(){return $f})),n.d(t,"Footer",(function(){return ih})),n.d(t,"Grid",(function(){return fg})),n.d(t,"GridBase",(function(){return ug})),n.d(t,"Header",(function(){return wh})),n.d(t,"RowManager",(function(){return uh})),n.d(t,"TreeGrid",(function(){return gg})),n.d(t,"SchedulerCommon",(function(){return pg})),n.d(t,"AbstractCrudManager",(function(){return xg})),n.d(t,"AjaxTransport",(function(){return Dg})),n.d(t,"CrudManagerView",(function(){return Mg})),n.d(t,"JsonEncoder",(function(){return Ig})),n.d(t,"AbstractRecurrenceIterator",(function(){return Og})),n.d(t,"AssignmentStore",(function(){return Hg})),n.d(t,"Calendar",(function(){return Wg})),n.d(t,"CrudManager",(function(){return zv})),n.d(t,"DailyRecurrenceIterator",(function(){return rv})),n.d(t,"DependencyStore",(function(){return Bv})),n.d(t,"EventStore",(function(){return Fv})),n.d(t,"MonthlyRecurrenceIterator",(function(){return dv})),n.d(t,"RecurrenceDayRuleEncoder",(function(){return sv})),n.d(t,"RecurrenceLegend",(function(){return Wv})),n.d(t,"RecurringEventsMixin",(function(){return yv})),n.d(t,"RecurringTimeSpansMixin",(function(){return vv})),n.d(t,"ResourceStore",(function(){return Kg})),n.d(t,"ResourceTimeRangeStore",(function(){return $v})),n.d(t,"TimeAxis",(function(){return rp})),n.d(t,"WeeklyRecurrenceIterator",(function(){return cv})),n.d(t,"YearlyRecurrenceIterator",(function(){return hv})),n.d(t,"ColumnLines",(function(){return op})),n.d(t,"Dependencies",(function(){return Dp})),n.d(t,"DependencyEdit",(function(){return Ip})),n.d(t,"EventContextMenu",(function(){return Pp})),n.d(t,"EventDrag",(function(){return Vp})),n.d(t,"EventDragCreate",(function(){return Yp})),n.d(t,"EventDragSelect",(function(){return qp})),n.d(t,"EventEdit",(function(){return Dy})),n.d(t,"EventFilter",(function(){return My})),n.d(t,"EventResize",(function(){return _y})),n.d(t,"EventTooltip",(function(){return jy})),n.d(t,"GroupSummary",(function(){return xb})),n.d(t,"HeaderContextMenu",(function(){return pb})),n.d(t,"HeaderZoom",(function(){return Db})),n.d(t,"Labels",(function(){return _b})),n.d(t,"NonWorkingTime",(function(){return Nb})),n.d(t,"Pan",(function(){return Vb})),n.d(t,"RecurringEventEdit",(function(){return xy})),n.d(t,"RecurringEvents",(function(){return Yb})),n.d(t,"RecurringTimeSpans",(function(){return Ub})),n.d(t,"ResourceTimeRanges",(function(){return qb})),n.d(t,"ScheduleTooltip",(function(){return kb})),n.d(t,"SimpleEventEdit",(function(){return Kb})),n.d(t,"Summary",(function(){return ek})),n.d(t,"TimeRanges",(function(){return nk})),n.d(t,"MultiPageExporter",(function(){return sk})),n.d(t,"PdfExport",(function(){return vk})),n.d(t,"SchedulerExportDialog",(function(){return dk})),n.d(t,"SinglePageExporter",(function(){return hk})),n.d(t,"ScheduleRange",(function(){return rk})),n.d(t,"ExcelExporter",(function(){return bk})),n.d(t,"ResourceInfoColumn",(function(){return wk})),n.d(t,"TimeAxisColumn",(function(){return lb})),n.d(t,"AssignmentModel",(function(){return Pg})),n.d(t,"CalendarDayModel",(function(){return Bg})),n.d(t,"DependencyBaseModel",(function(){return Pv})),n.d(t,"DependencyModel",(function(){return Hv})),n.d(t,"EventModel",(function(){return Av})),n.d(t,"RecurrenceModel",(function(){return Cv})),n.d(t,"RecurringTimeSpan",(function(){return Ev})),n.d(t,"ResourceModel",(function(){return Yg})),n.d(t,"ResourceTimeRangeModel",(function(){return Gv})),n.d(t,"TimeSpan",(function(){return zg})),n.d(t,"PresetManager",(function(){return tp})),n.d(t,"PresetStore",(function(){return Zv})),n.d(t,"ViewPreset",(function(){return Jv})),n.d(t,"RectangularPathFinder",(function(){return lp})),n.d(t,"ScheduleTableExporter",(function(){return yk})),n.d(t,"HorizontalTimeAxis",(function(){return ib})),n.d(t,"RecurrenceCombo",(function(){return sy})),n.d(t,"RecurrenceConfirmationPopup",(function(){return ry})),n.d(t,"RecurrenceDaysButtonGroup",(function(){return hy})),n.d(t,"RecurrenceDaysCombo",(function(){return dy})),n.d(t,"RecurrenceEditor",(function(){return Cy})),n.d(t,"RecurrenceFrequencyCombo",(function(){return oy})),n.d(t,"RecurrenceLegendButton",(function(){return cy})),n.d(t,"RecurrenceMonthDaysButtonGroup",(function(){return vy})),n.d(t,"RecurrenceMonthsButtonGroup",(function(){return yy})),n.d(t,"RecurrencePositionsCombo",(function(){return wy})),n.d(t,"RecurrenceStopConditionCombo",(function(){return by})),n.d(t,"Scheduler",(function(){return Sb})),n.d(t,"SchedulerBase",(function(){return gb})),n.d(t,"TimeAxisViewModel",(function(){return Yy})),n.d(t,"SchedulerTag",(function(){return xk}));var r="URLSearchParams"in self,i="Symbol"in self&&"iterator"in Symbol,o="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in self,s="ArrayBuffer"in self;if(s)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&l.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function g(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function p(e){var t=new FileReader,n=v(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&o&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var e,t,n,r=g(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=v(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=u(e),t=d(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},h.prototype.delete=function(e){delete this.map[u(e)]},h.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},h.prototype.set=function(e,t){this.map[u(e)]=d(t)},h.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},h.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),f(e)},h.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},h.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),f(e)},i&&(h.prototype[Symbol.iterator]=h.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(e,t){var n,r,i=(t=t||{}).body;if(e instanceof k){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),b.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function S(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})},m.call(k.prototype),m.call(S.prototype),S.prototype.clone=function(){return new S(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},S.error=function(){var e=new S(null,{status:0,statusText:""});return e.type="error",e};var C=[301,302,303,307,308];S.redirect=function(e,t){if(-1===C.indexOf(t))throw new RangeError("Invalid status code");return new S(null,{status:t,headers:{location:e}})};var R=self.DOMException;try{new R}catch(e){(R=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),R.prototype.constructor=R}function x(e,t){return new Promise((function(n,r){var i=new k(e,t);if(i.signal&&i.signal.aborted)return r(new R("Aborted","AbortError"));var a=new XMLHttpRequest;function s(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;n(new S(i,r))},a.onerror=function(){r(new TypeError("Network request failed"))},a.ontimeout=function(){r(new TypeError("Network request failed"))},a.onabort=function(){r(new R("Aborted","AbortError"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),i.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),i.signal&&(i.signal.addEventListener("abort",s),a.onreadystatechange=function(){4===a.readyState&&i.signal.removeEventListener("abort",s)}),a.send(void 0===i._bodyInit?null:i._bodyInit)}))}x.polyfill=!0,self.fetch||(self.fetch=x,self.Headers=h,self.Request=k,self.Response=S);n(232),n(27),n(29),n(12),n(35),n(26),n(24),n(44),n(22),n(17),n(110),n(111),n(201),n(45),n(6),n(167),n(202),n(38),n(67),n(14);var E=n(2),D=n.n(E),T=n(3),M=n.n(T),A=(n(40),n(137),n(34),n(7),n(53),/([a-z])([A-Z])/g),I=/[.*+?^${}()|[\]\\]/g,F=/(^[^a-z]+|[^\w]+)/gi,O=function(e,t,n){return t+"-"+n.toLowerCase()},_=function(e){return e?"_x".concat(e.charCodeAt(0).toString(16)):"__blank__"},P={},L=function(){function e(){D()(this,e)}return M()(e,null,[{key:"capitalizeFirstLetter",value:function(e){return e?e[0].toUpperCase()+e.substr(1):null}},{key:"lowercaseFirstLetter",value:function(e){return e?e[0].toLowerCase()+e.substr(1):null}},{key:"hyphenate",value:function(e){var t=P[e];return t||(P[e]=e.replace(A,O))}},{key:"safeJsonParse",value:function(e){var t=null;try{t=JSON.parse(e)}catch(e){console.error(e)}return t}},{key:"safeJsonStringify",value:function(e){var t=null;try{t=JSON.stringify(e)}catch(e){console.error(e)}return t}},{key:"createId",value:function(e){return String(e).replace(F,_)}},{key:"escapeRegExp",value:function(e){return e.replace(I,"\\$&")}},{key:"joinPaths",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}}]),e}();L._$name="StringHelper";n(13),n(122);var H=!1;try{H=Boolean(window!==window.parent&&window.parent.Siesta)}catch(e){}var j=function(){function e(){D()(this,e)}return M()(e,null,[{key:"setVersion",value:function(e,t){this[e=e.toLowerCase()]={version:t,isNewerThan:function(e){return e<t},isOlderThan:function(e){return e>t}};var n="".concat("scheduler",".").concat(e).concat(t.replace(/\./g,"-"));if(!0===window.bryntum[n]){if(!H)throw new Error("Bundle included twice, check cache-busters and file types (.js)");window.BUNDLE_EXCEPTION=!0}else window.bryntum[n]=!0}},{key:"getVersion",value:function(e){if(!this[e=e.toLowerCase()])throw new Error("No version specified");return this[e].version}},{key:"checkVersion",value:function(e,t,n,r){var i,o=this.getVersion(e);switch(n){case"<":i=o<t;break;case"<=":i=o<=t;break;case"=":i=o===t;break;case">=":i=o>=t;break;case">":i=o>t}return i}},{key:"deprecate",value:function(e,t,n){var r=this.checkVersion(e,t,"<",n);if(!t.endsWith(".0.0"))throw new Error("May only break APIs in major releases");if(!n)throw new Error("Must provide helpful message for developers");if(!r)throw new Error("Deprecated API use. ".concat(n));console.warn("Deprecation warning: You are using a deprecated API which will change in v".concat(t,". ").concat(n))}},{key:"isTestEnv",get:function(){return H}}]),e}();(window.bryntum||(window.bryntum={})).getVersion=j.getVersion.bind(j),window.bryntum.checkVersion=j.checkVersion.bind(j),window.bryntum.deprecate=j.deprecate.bind(j),j._$name="VersionHelper";var B=Symbol("defaultConfig"),N=Symbol("propertyInitializers"),z=Symbol("classHierarchy"),V=Symbol("configuration"),W=Symbol("originalConfig"),U=Symbol("instanceProperties"),G=function(){function e(){D()(this,e),this.construct.apply(this,arguments),this.afterConstruct()}return M()(e,[{key:"construct",value:function(){null!==(arguments.length<=0?void 0:arguments[0])&&this.configure.apply(this,arguments),this.afterConfigure()}},{key:"destroy",value:function(){var e=this;for(var t in e.isDestroying=!0,e.doDestroy(),Object.setPrototypeOf(this,null),e)delete e[t];delete e[W],e.isDestroyed=!0}},{key:"_thisIsAUsedExpression",value:function(e){}},{key:"startConfigure",value:function(e){}},{key:"finishConfigure",value:function(e){}},{key:"afterConfigure",value:function(){}},{key:"afterConstruct",value:function(){}},{key:"callback",value:function(e,t,n){"this"===t&&(t=this);var r=this.resolveCallback(e,t),i=r.handler,o=r.thisObj;return n?i.apply(o,n):i.call(o)}},{key:"resolveCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(e.substr){if(e.startsWith("up."))for(e=e.substr(3),t=this.owner;t&&!t[e];t=t.owner);else e.startsWith("this.")&&(t=this);e=t[e]}return{handler:e,thisObj:t}}},{key:"bindCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(e){var n=this.resolveCallback(e,t),r=n.handler,i=n.thisObj;if(r)return r.bind(i)}}},{key:"delay",value:function(e,t){e=this.setTimeout?e:e.bind(this),("number"==typeof t?this.setTimeout||setTimeout:this.requestAnimationFrame||requestAnimationFrame)(e,t)}},{key:"doDestroy",value:function(){}},{key:"destroyProperties",value:function(){for(var e,t,n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];for(var a=0,s=i;a<s.length;a++)!((e=s[a])in n)||n[V]&&n[V][e]||((t=n[e])&&t.destroy&&t.destroy(),delete n[e])}},{key:"configure",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;n.initialConfig=t,n.isConfiguring=!0,Object.assign(n,n.getProperties()),n.setConfig(n[W]=e.assign(n.getDefaultConfiguration(),t),!0),n.isConfiguring=!1}},{key:"setConfig",value:function(t,n){var r,i,o=this,a=o[V],s=a?o.configDone:o.configDone={},l=o[U]={};for(r in o[V]=a?Object.setPrototypeOf(Object.assign({},t),a):t,t)null!=t[r]||t.hasOwnProperty(r)?(l[r]||!(i=Reflect.getOwnPropertyDescriptor(o,r))||"value"in i||(l[r]=i),Reflect.defineProperty(o,r,e.createPropInitializer(r)),n||(s[r]=!1)):s[r]=!0;for(r in n&&o.startConfigure(t),t)s[r]||(o[r]=t[r]);a?o[V]=a:delete o[V],n&&o.finishConfigure(t)}},{key:"getDefaultConfiguration",value:function(){return this.constructor.getDefaultConfiguration()}},{key:"getProperties",value:function(){var e,t,n=this.classHierarchy(),r=n.length,i={};for(e=0;e<r;e++)(t=n[e]).hasOwnProperty("properties")&&Object.assign(i,t.properties);return i}},{key:"classHierarchy",value:function(t){var n,r=this.constructor,i=r.hasOwnProperty(z)?r[z]:null;if(!i){for(i=r[z]=[];r!==e;r=Object.getPrototypeOf(r))i.unshift(r);Object.freeze(i)}if(t)for(var o=0;!n&&o<i.length;o++)i[o]===t&&(n=i.slice(o));else n=i;return n}},{key:"classNameHierarchy",value:function(e){return this.classHierarchy(e).map((function(e){return e.$name}))}},{key:"detachListeners",value:function(e){var t=this.$detachers;if(t=t&&t[e])for(;t.length;)t.pop()()}},{key:"trackDetacher",value:function(e,t){var n=this.$detachers||(this.$detachers={});(n[e]||(n[e]=[])).push(t)}},{key:"untrackDetachers",value:function(e){var t=this.$detachers;if(t)for(var n in t)for(var r=t[n],i=r.length;i-- >0;)r[i].eventer===e&&r.splice(i,1)}},{key:"$name",get:function(){return this.constructor.$name}},{key:"config",get:function(){var e,t={},n=this[W];for(e in n)t[e]=n[e];return t}}],[{key:"destroy",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){e&&e.destroy&&!e.isDestroyed&&e.destroy()}))}},{key:"getDefaultConfiguration",value:function(){var e=this.getConfigDescriptor(),t=e.needsFork?this.fork(e.defaultConfig):Object.setPrototypeOf({},e.defaultConfig);if(j.isTestEnv&&t.testConfig&&window.__applyTestConfigs)for(var n in t.testConfig)t[n]=t.testConfig[n];return t}},{key:"getConfigDescriptor",value:function(t){var n,r,i,o,a,s=this,l=!t&&s.hasOwnProperty(B)?s[B]:null;if(!l){for(r in l={defaultConfig:n=s.hasOwnProperty("defaultConfig")?s.defaultConfig:{},needsFork:0},t||(s[B]=l),n)if((o=n[r])&&(o.constructor===Object||Array.isArray(o))&&!Object.isFrozen(o)){l.needsFork=1;break}if(!t)for(i=s.superclass;i&&i!==e;i=i.superclass)a=i.getConfigDescriptor(!0),Object.keys(a.defaultConfig).length&&(l.needsFork|=a.needsFork,Object.setPrototypeOf(n,n=a.defaultConfig))}return l}},{key:"fork",value:function(e){var t,n,r;if(e&&e.constructor===Object&&!Object.isFrozen(e))for(n in t=Object.setPrototypeOf({},e),e)(r=e[n])&&(r.constructor===Object?t[n]=this.fork(r):r instanceof Array&&(t[n]=r.slice()));else t=e;return t}},{key:"assign",value:function(e){for(var t,n,r=0,i=arguments.length<=1?0:arguments.length-1;r<i;r++)for(n in t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])e[n]=t[n];return e}},{key:"createPropInitializer",value:function(e){var t=(this[N]||(this[N]={}))[e];if(!t){var n="initializing"+L.capitalizeFirstLetter(e);t=this[N][e]={configurable:!0,get:function(){var t=this,r=t[U][e];return r?Reflect.defineProperty(t,e,r):delete t[e],t[n]=!0,t[e]=t[V][e],t[n]=!1,t.configDone[e]=!0,t[e]},set:function(t){var n=this,r=n[U][e];r?Reflect.defineProperty(n,e,r):delete n[e],n.configDone[e]=!0,n[e]=t}}}return t}},{key:"isOfTypeName",value:function(e){return this.classNameHierarchy().includes(e)}},{key:"$name",get:function(){return this.hasOwnProperty("_$name")&&this._$name||this.name}},{key:"superclass",get:function(){return Object.getPrototypeOf(this)}}]),e}();Object.assign(G.prototype,{$detachers:null}),j.setVersion("core","0.0.0"),G._$name="Base";n(8);var Y=n(4),$=n.n(Y),q=n(5),X=n.n(q),K=n(0),J=n.n(K),Q=(n(37),n(64),n(31),n(20),n(60),n(213),n(49),n(25),n(21),n(11)),Z=n.n(Q),ee=n(16),te=n.n(ee),ne=n(15),re=n.n(ne),ie=n(9),oe=n.n(ie),ae=n(1),se=n.n(ae);n(28),n(39),n(106),n(220),n(248),n(249);function le(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ce(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ue=function(){function e(){D()(this,e)}return M()(e,[{key:"magnitudeCompare",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"lexicalCompare",value:function(e,t){return(e=String(e))<(t=String(t))?-1:e>t?1:0}}],[{key:"clean",value:function(e){return e.reduce((function(e,t){return null==t||Array.isArray(t)&&0===t.length||""===t||e.push(t),e}),[])}},{key:"remove",value:function(e){for(var t,n,r=!1,i=0;i<(arguments.length<=1?0:arguments.length-1);i++)n=i+1<1||arguments.length<=i+1?void 0:arguments[i+1],-1!==(t=e.indexOf(n))&&(e.splice(t,1),r=!0);return r}},{key:"findInsertionIndex",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.lexicalCompare,o=arguments.length>3?arguments[3]:void 0,a=t.length;return o<a&&(n=o>0?i(t[o-1],e):0,r=o<a-1?i(e,t[o]):0,n<1&&r<1)?o:this.binarySearch(t,e,i)}},{key:"binarySearch",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.lexicalCompare,s=e.length;for(i instanceof Function?(a=i,i=0):o instanceof Function&&(a=o,o=s),--o;i<=o;)(r=a(t,e[n=i+o>>1]))>=0?i=n+1:r<0&&(o=n-1);return i}},{key:"fill",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=[],i=Array.isArray(t)?t:[t],o=0;o<e;o++){var a,s=le(i);try{for(s.s();!(a=s.n()).done;){var l=a.value,c=Object.assign({},l);n&&n(c,o),r.push(c)}}catch(e){s.e(e)}finally{s.f()}}return r}},{key:"populate",value:function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}},{key:"include",value:function(e,t){e.includes(t)||e.push(t)}},{key:"allowNegative",value:function(e){return new Proxy(e,{get:function(e,t,n){if("string"!=typeof t)return Reflect.get(e,t,n);var r=Number(t);return Number.isNaN(r)?Reflect.get(e,t,n):e[r<0?e.length+r:r]},set:function(e,t,n,r){if("string"!=typeof t)return Reflect.set(e,t,n,r);var i=Number(t);return Number.isNaN(i)?Reflect.set(e,t,n,r):(e[i<0?e.length+i:i]=n,!0)}})}},{key:"delta",value:function(e,t){if(!t)return{onlyInA:e,onlyInB:[],inBoth:[]};for(var n=[],r=[],i=[],o=0;o<e.length;o++){var a=e[o];t.includes(a)?i.push(a):n.push(a)}for(var s=0;s<t.length;s++){var l=t[s];i.includes(l)||r.push(l)}return{onlyInA:n,onlyInB:r,inBoth:i}}}]),e}();function de(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fe(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function he(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ue._$name="ArrayHelper";var ge={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,name:1,_oldDestructor:1},ve=function(e,t){return t.prio-e.prio},pe=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(he()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"destroy",value:function(){this.trigger("beforeDestroy"),se()(J()(r.prototype),"destroy",this).call(this)}},{key:"construct",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=se()(J()(r.prototype),"construct",this)).call.apply(e,[this].concat(n)),this.processConfiguredListeners()}},{key:"processConfiguredListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.listeners&&this.initialEventListeners,t=this;if(e&&!t.defaultListenersInitialized){var n=t.addListener(e,t);!1!==t.listeners.detachable&&(t.listenerDetacher=n),t.defaultListenersInitialized=!0}}},{key:"doDestroy",value:function(){this.trigger("destroy"),this.listenerDetacher&&this.listenerDetacher(),this.removeAllListeners(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"addListener",value:function(e,t,n){var r,i=this,o=i.eventListeners||(i.eventListeners={});if("string"==typeof e)return i.addListener((r={},oe()(r,e,t),oe()(r,"detachable",!1!==t.detachable),oe()(r,"thisObj",n),r));for(var a in t=void 0!==e.thisObj?e.thisObj:e.thisObj=t,e)ge[a]||function(){var n=e[a],r={fn:"object"===re()(n)?n.fn:n,thisObj:void 0!==n.thisObj?n.thisObj:t,args:n.args||e.args,prio:void 0!==n.prio?n.prio:void 0!==e.prio?e.prio:0,once:void 0!==n.once?n.once:void 0!==e.once&&e.once,catchAll:"catchAll"===a},s=a.toLowerCase(),l=o[s]||(o[s]=[]);n.expires&&i.delay((function(){return i.un(s,r)}),e.expires),l.splice(ue.findInsertionIndex(r,l,ve,l.length),0,r)}();e.relayAll&&i.relayAll(e.relayAll),t&&i.attachAutoDetacher(e);var s=!1!==e.detachable,l=e.name,c=e.expires||s||l?function(){i.isDestroyed||i.removeListener(e)}:null;return c&&(c.eventer=i,c.listenerName=l,l&&t&&t.trackDetacher&&t.trackDetacher(l,c),e.expires&&i.delay(c,e.expires),s)?c:void 0}},{key:"on",value:function(){return this.addListener.apply(this,arguments)}},{key:"un",value:function(){this.removeListener.apply(this,arguments)}},{key:"removeListener",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.thisObj,n=this;"string"!=typeof e?(Object.entries(e).forEach((function(e){var r=te()(e,2),i=r[0],o=r[1];if(!ge[i]){var a=i.toLowerCase(),s=n.eventListeners&&n.eventListeners[a];if(s){var l=s.findIndex((function(e){return!(e.fn!==o&&e.fn!==o.fn||e.thisObj!==t&&e.thisObj!==o.thisObj&&t)}));l>=0&&(s.splice(l,1),s.length||delete n.eventListeners[a])}}})),e.thisObj&&!e.thisObj.isDestroyed&&n.detachAutoDetacher(e)):n.removeListener(oe()({},e,t),!((arguments.length<=2?0:arguments.length-2)>0)||(arguments.length<=2?void 0:arguments[2]))}},{key:"hasListener",value:function(e){return Boolean(this.eventListeners&&this.eventListeners[e])}},{key:"relayAll",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(this.relayAllTargets||(this.relayAllTargets=[])).push({through:e,prefix:t,transformCase:n})}},{key:"removeAllListeners",value:function(){var e,t,n=this.eventListeners;for(var r in n){var i=n[r];for(e=i.length;e-- >0;){var o=i[e];this.removeListener(r,o),(t=o.thisObj)&&t.untrackDetachers&&t.untrackDetachers(this)}}}},{key:"relayEvents",value:function(e,t,n){var r=this,i={detachable:!0},o=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return r.trigger.apply(r,[(n||"")+e].concat(i))};return t.forEach((function(e){i[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.apply(void 0,[e].concat(n))}})),e.on(i)}},{key:"attachAutoDetacher",value:function(e){var t=this,n=e.thisObj,r="doDestroy"in n?"doDestroy":"destroy";r in n?(e._oldDestructor=n[r],n[r]=function(){t.isDestroyed||t.removeListener(e),e._oldDestructor.call(n)}):n[r]=function(){t.removeListener(e)}}},{key:"detachAutoDetacher",value:function(e){var t=e.thisObj,n="doDestroy"in t?"doDestroy":"destroy";e._oldDestructor&&(t[n]=e._oldDestructor)}},{key:"await",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{checkLog:!0,resetLog:!0},n=this;return!1===t&&(t={checkLog:!1}),new Promise((function(r){var i;t.checkLog&&n._triggered&&n._triggered[e]&&(r(),t.resetLog&&n.clearLog(e)),n.on((i={},oe()(i,e,(function(){r.apply(void 0,arguments),t.resetLog&&n.clearLog(e)})),oe()(i,"prio",-1e4),oe()(i,"once",!0),i))}))}},{key:"clearLog",value:function(e){this._triggered&&(e?delete this._triggered[e]:this._triggered={})}},{key:"callPreventable",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this;if(!i&&!1===o.trigger("before"+L.capitalizeFirstLetter(e),t))return!1;var a=n.apply(void 0,[t].concat(Z()(r)));return i||o.trigger(e,t),a}},{key:"trigger",value:function(e,t){var n,r=this,i=e.toLowerCase(),o=r.eventsSuspended,a=r.relayAllTargets,s=r.callOnFunctions,l=r.owner,c=r.eventListeners&&r.eventListeners[i],u=!0;if(r._triggered||(r._triggered={}),r._triggered[e]=!0,o)return o.shouldQueue&&o.queue.push(arguments),!0;r.eventListeners&&r.eventListeners.catchall&&((n=c=c?c.slice():[]).push.apply(n,Z()(r.eventListeners.catchall)),c.sort(ve),u=!1);if(!c&&!a&&!s)return!0;if(t?"source"in t||(Object.isExtensible(t)?t.source=r:t=Object.setPrototypeOf({source:r},t)):t={source:r},t.type!==i&&(t.constructor!==Object?Reflect.defineProperty(t,"type",{get:function(){return i}}):t.type=i),s){var d="on"+L.capitalizeFirstLetter(e);if(d in r&&(r.callback(r[d],r,[t]),!r.isDestroyed&&Object.prototype.hasOwnProperty.call(r,d)&&(!r.pluginFunctionChain||!r.pluginFunctionChain[d]))){var f=Object.getPrototypeOf(r);if(d in f&&(f[d].call(r,t),r.isDestroyed))return}}if(c){var h,g,v=0;for(u&&(c=c.slice());v<c.length&&!r.isDestroyed;v++){var p=(h=c[v]).thisObj;if(!p||!p.isDestroyed){if(h.once&&r.removeListener(i,h),"string"==typeof h.fn){if(p&&(g=p[h.fn]),!g){var y=r.resolveCallback(h.fn);g=y.handler,p=y.thisObj}}else g=h.fn;var m;if(h.args){if(!1===(m=g).call.apply(m,[p||r].concat(Z()(h.args),[t])))return!1}else if(!1===g.call(p||r,t))return!1}}}return a&&a.forEach((function(n){var r=e;if(n.transformCase&&(r=L.capitalizeFirstLetter(r)),n.prefix&&(r=n.prefix+r),!1===n.through.trigger(r,t))return!1})),!(t.bubbles&&l&&!l.isDestroyed)||l.trigger(e,t)}},{key:"suspendEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.eventsSuspended||(this.eventsSuspended={shouldQueue:e,queue:[],count:0});t.count++}},{key:"resumeEvents",value:function(){var e=this.eventsSuspended;if(e&&0==--e.count&&(this.eventsSuspended=null,e.shouldQueue)){var t,n=de(e.queue);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.trigger.apply(this,Z()(r))}}catch(e){n.e(e)}finally{n.f()}}return!Boolean(this.eventsSuspended)}},{key:"listeners",set:function(e){this.isConfiguring?this.initialEventListeners=e:(this.removeAllListeners(),e&&this.on(e))},get:function(){return this.eventListeners||this.initialEventListeners}}],[{key:"defaultConfig",get:function(){return{listeners:null}}}]),r}(e||G)},ye=(n(124),n(149),n(32),n(59),n(107),function(){function e(){D()(this,e)}return M()(e,null,[{key:"register",value:function(e,t){var n=be[t];e=e.toLowerCase(),me[e]=t,n?n[e]=1:be[t]=oe()({},e,1)}},{key:"getClass",value:function(e){return me[e.toLowerCase()]}},{key:"isType",value:function(e,t,n){t=t.toLowerCase();for(var r=e.constructor;r;r=n&&Object.getPrototypeOf(r)){var i=r.hasOwnProperty("$name")?r.$name:r.name,o=be[r]||i&&(be[r]=oe()({},i.toLowerCase(),1));if(o&&o[t])return!0}}},{key:"createWidget",value:function(e,t){var n=this.getClass(e||"widget");return n?new n(t):null}}]),e}()),me=ye.widgetRegister={},be=ye.widgetClassRegister={};ye._$name="BryntumWidgetAdapterRegister";function ke(e,t){for(var n=e.classHierarchy(),r=0;r<n.length;r++)if(n[r].$name.toLowerCase()===t)return!0;return!1}var we=function(){function e(){D()(this,e)}return M()(e,null,[{key:"generateId",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generatedId";return t+ ++e.idCounter}},{key:"register",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=t.id;if(null==r&&(r=t.id=e.generateId(n),t.hasGeneratedId=!0),r in e.idMap&&!this.disableThrow)throw new Error("Id "+r+" already in use");e.idMap[r]=t}},{key:"unregister",value:function(t){e.idMap[t.id]===t&&delete e.idMap[t.id]}},{key:"get",value:function(t){return e.idMap[t]}},{key:"query",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.idMap;for(var i in r)if(Se(r[i],t,n))return r[i];return null}},{key:"queryAll",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.idMap,i=[];for(var o in r)Se(r[o],t,n)&&i.push(r[o]);return i}},{key:"fromElement",value:function(t,n,r){var i=re()(n);t&&t instanceof Event&&(t=t.target),("number"===i||n&&1===n.nodeType)&&(r=n,n=null);var o,a,s,l=t,c=e.idMap,u=0;for("number"!=typeof r&&(o=r,r=Number.MAX_VALUE),"string"===i&&(n=n.toLowerCase());l&&1===l.nodeType&&u<r&&l!==o;){if(a=l.dataset&&l.dataset.ownerCmp||l.id){if(s=c[a]){if(!n)return s;if("function"===i){if(n(s))return s}else if(Se(s,n)||ke(s,n))return s}u++}l=l.parentNode}return null}}]),e}();function Se(e,t,n){return"*"===t||("function"==typeof t?t(e):ye.isType(e,t,n))}we.idCounter=0,we.idMap={},(window.bryntum||(window.bryntum={})).get=we.get,window.bryntum.IdHelper=we,window.bryntum.query=we.query,window.bryntum.queryAll=we.queryAll,window.bryntum.fromElement=we.fromElement,we._$name="IdHelper";var Ce=function(){function e(){D()(this,e)}return M()(e,null,[{key:"getById",value:function(e){return we.get(e)}},{key:"fromElement",value:function(e,t,n){return we.fromElement(e,t,n)}},{key:"createWidget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.adapter.createWidget(e)}},{key:"append",value:function(e,t){if(e=Array.isArray(e)&&e||[e],(t instanceof HTMLElement||"string"==typeof t)&&(t={appendTo:t}),t.insertFirst){var n="string"==typeof t.insertFirst?document.getElementById(t.insertFirst):t.insertFirst;n.firstChild?t.insertBefore=n.firstChild:t.appendTo=n}return this.adapter.appendWidgets(e,t)}},{key:"openPopup",value:function(e,t){return this.adapter.openPopup(e,t)}},{key:"showContextMenu",value:function(e,t){return this.adapter.showContextMenu(e,t)}},{key:"attachTooltip",value:function(e,t){return this.adapter.attachTooltip(e,t)}},{key:"hasTooltipAttached",value:function(e){return this.adapter.hasTooltipAttached(e)}},{key:"destroyTooltipAttached",value:function(e){return this.adapter.destroyTooltipAttached(e)}},{key:"mask",value:function(e,t){return this.adapter.mask(e,t)}},{key:"unmask",value:function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.adapter.unmask(e)}},{key:"toast",value:function(e){this.adapter.toast(e)}},{key:"adapter",set:function(e){this._adapter=new e},get:function(){if(!this._adapter)throw new Error("Widget adapter is required. Please import BryntumWidgetAdapter class. See docs here: https://www.bryntum.com/docs/grid/#Core/adapter/widget/BryntumWidgetAdapter");return this._adapter}},{key:"hasAdapter",get:function(){return!!this._adapter}},{key:"defaultStyle",set:function(e){this.adapter.defaultStyle=e},get:function(){return this.adapter.defaultStyle}}]),e}();Ce._$name="WidgetHelper";n(253),n(150),n(180),n(221);var Re=function(){function e(){D()(this,e)}return M()(e,null,[{key:"cacheFlags",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.platform,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:navigator.userAgent,n=this;n._isLinux=Boolean(e.match(/Linux/)),n._isMac=Boolean(e.match(/Mac/)),n._isWindows=Boolean(e.match(/Win32/)),n._isIE11=Boolean(t.match(/rv:11/)),n._edgeVersion=n.getVersion(t,/Edge?\/(\d+)\./),n._isEdge=n._edgeVersion>0&&n._edgeVersion<80,n._isEdge||(n._edgeVersion=0),n._isWebkit=Boolean(t.match(/WebKit/))&&!n._isEdge,n._firefoxVersion=n.getVersion(t,/Firefox\/(\d+)\./),n._isFirefox=n._firefoxVersion>0,n._chromeVersion=n._isEdge?0:n.getVersion(t,/Chrom(?:e|ium)\/(\d+)\./),n._isChrome=n._chromeVersion>0,n._isSafari=Boolean(t.match(/Safari/))&&!n._isChrome&&!n._isEdge,n._isMobileSafari=Boolean(t.match(/Mobile.*Safari/)),n._isAndroid=Boolean(t.match(/Android/g));try{document.querySelector(":scope"),n.supportsQueryScope=!n._isFirefox}catch(e){n.supportsQueryScope=!1}n._supportsPassive=!1;try{document.addEventListener("__notvalid__",null,{get passive(){n._supportsPassive=!0}})}catch(e){}}},{key:"getVersion",value:function(e,t){var n=e.match(t);return n?parseInt(n[1]):0}},{key:"setLocalStorageItem",value:function(e,t){this.storageAvailable&&localStorage.setItem(e,t)}},{key:"getLocalStorageItem",value:function(e){return this.storageAvailable&&localStorage.getItem(e)}},{key:"removeLocalStorageItem",value:function(e){this.storageAvailable&&localStorage.removeItem(e)}},{key:"searchParam",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.location.search,r=new RegExp("[?&]".concat(e,"=([^&]*)")),i=n.match(r);return i&&i[1]||t}},{key:"getCookie",value:function(e){for(var t=encodeURIComponent(e)+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return""}},{key:"isTouchDevice",get:function(){return"_isTouchDevice"in this?this._isTouchDevice:"ontouchstart"in window||!this.isEdge&&navigator.maxTouchPoints>0||this.isEdge&&window.TouchEvent||navigator.msMaxTouchPoints>0},set:function(e){this._isTouchDevice=e}},{key:"isMac",get:function(){return this._isMac}},{key:"isWindows",get:function(){return this._isWindows}},{key:"isLinux",get:function(){return this._isLinux}},{key:"isIE11",get:function(){return this._isIE11}},{key:"isEdge",get:function(){return this._isEdge}},{key:"edgeVersion",get:function(){return this._edgeVersion}},{key:"isWebkit",get:function(){return this._isWebkit}},{key:"isChrome",get:function(){return this._isChrome}},{key:"chromeVersion",get:function(){return this._chromeVersion}},{key:"isFirefox",get:function(){return this._isFirefox}},{key:"firefoxVersion",get:function(){return this._firefoxVersion}},{key:"isSafari",get:function(){return this._isSafari}},{key:"isMobileSafari",get:function(){return this._isMobileSafari}},{key:"isAndroid",get:function(){return this._isAndroid}},{key:"supportsPassive",get:function(){return this._supportsPassive}},{key:"storageAvailable",get:function(){var e,t;try{return e=localStorage,t="__storage_test__",e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}},{key:"queryString",get:function(){var e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries())}}]),e}();Re.cacheFlags(),Re._$name="BrowserHelper";n(125),n(257),n(259),n(261),n(225);var xe=n(126),Ee=n.n(xe);n(43);function De(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Te(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Me=/^(\w+)=(.*)$/,Ae=function(){function e(){D()(this,e)}return M()(e,null,[{key:"get",value:function(e,t){return this.fetch(e,t)}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t instanceof FormData||"string"==typeof t||(t=JSON.stringify(t),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},n))}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new AbortController;if(t.signal=n.signal,"credentials"in t||(t.credentials="include"),t.queryParams){var r=Object.entries(t.queryParams);r.length&&(e+="?"+r.map((function(e){var t=te()(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(encodeURIComponent(r))})).join("&"))}var i=new Promise((function(n,r){fetch(e,t).then((function(e){t.parseJson?e.json().then((function(t){e.parsedJson=t,n(e)})).catch((function(t){e.parsedJson=null,e.error=t,r(e)})):n(e)})).catch((function(e){e.stack=i.stack,r(e)}))}));return i.stack=(new Error).stack,i.abort=function(){n.abort()},i}))},{key:"mockUrl",value:function(t,n){(this.mockAjaxMap||(this.mockAjaxMap={}))[t]=n,e.originalFetch||(e.originalFetch=e.fetch),e.fetch=this.mockAjaxFetch.bind(this)}},{key:"mockAjaxFetch",value:function(t,n){var r=t.split("?"),i=this.mockAjaxMap[r[0]],o=null;if(i){"function"==typeof i&&(i=i(r[0],r[1]&&function(e){var t,n={},r=De(e.split("&"));try{for(r.s();!(t=r.n()).done;){var i=t.value,o=Me.exec(i),a=te()(o,3),s=a[0],l=a[1],c=a[2];if(s){var u=n[l];u?(Array.isArray(u)||(u=n[l]=[u]),u.push(c)):n[l]=c}}}catch(e){r.e(e)}finally{r.f()}return n}(r[1]),n));try{o=n.parseJson&&JSON.parse(i.responseText)}catch(e){o=null,i.error=e}return i=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:t,parsedJson:o,text:function(){return new Promise((function(e){e(i.responseText)}))},json:function(){return new Promise((function(e){e(o)}))}},i),new Promise((function(e,t){i.synchronous?e(i):setTimeout((function(){e(i)}),"delay"in i?i.delay:100)}))}return e.originalFetch(t,n)}}]),e}();function Ie(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ae._$name="AjaxHelper";var Fe=new(function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ie()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(e=se()(J()(r.prototype),"construct",this)).call.apply(e,[this].concat(i));var a=document.querySelector("script[data-default-locale]");a&&(t.defaultLocaleName=a.dataset.defaultLocale),window.bryntum&&window.bryntum.locales&&(Object.keys(window.bryntum.locales).forEach((function(e){if(!e.startsWith("moment")){var n=window.bryntum.locales[e];n.extends?t.extendLocale(n.extends,n):t.registerLocale(n.localeName,{desc:n.localeDesc,locale:n})}})),t.locale||"En"!==t.defaultLocaleName&&t.applyLocale(t.defaultLocaleName||Object.keys(t.locales)[0]))}},{key:"registerLocale",value:function(e,t){var n=this,r=n.defaultLocaleName===e,i=n.locale&&n.locale.localeName===e,o=0===Object.keys(n.locales).length;n.locales[e]=t,(r||!n.defaultLocaleName&&(o||i))&&n.internalApplyLocale(t)}},{key:"extendLocale",value:function(e,t){var n=this.locales[e];return!!n&&(Object.keys(t).forEach((function(e){n.locale[e]?Object.assign(n.locale[e],t[e]):n.locale[e]=t[e]})),delete n.locale.extends,!0)}},{key:"internalApplyLocale",value:function(e){this._locale=e.locale,this.trigger("locale",e)}},{key:"applyLocale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.locales[e];if(i&&i.locale&&r._locale===i.locale&&!t)return!0;if(!i){if(n)return!0;throw new Error("Locale ".concat(e," not registered"))}function o(){r.internalApplyLocale(i)}return i.locale?(o(),!0):new Promise((function(t,n){r.loadLocale(i.path).then((function(n){n.text().then((function(n){new Function(n)(),i.locale=window.bryntum.locales[e],o(),t(i)}))})).catch((function(e){return n(e)}))}))}},{key:"loadLocale",value:function(e){return Ae.get(e)}},{key:"locales",set:function(e){this._locales=e},get:function(){return this._locales}},{key:"locale",set:function(e){"string"==typeof e?this.applyLocale(e):(e.locale||(e={locale:e,localeName:e.localeName||"custom"}),this.registerLocale(e.localeName,e),this.applyLocale(e.localeName))},get:function(){return this._locale}}],[{key:"defaultConfig",get:function(){return{locales:{}}}}]),r}(pe(G)));function Oe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var _e=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Oe()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(e=se()(J()(r.prototype),"construct",this)).call.apply(e,[this,t].concat(o)),Fe.on("locale",n.updateLocalization,n),n.updateLocalization()}},{key:"localizeProperty",value:function(e){var t=this;if("string"==typeof t[e]){t.originalLocales=t.originalLocales||{},t.originalLocales[e]=t.originalLocales[e]||t[e];var n=t.originalLocales[e];n&&(t[e]=t.L(n))}}},{key:"updateLocalization",value:function(){this.localizableProperties&&this.localizableProperties.forEach(this.localizeProperty,this)}},{key:"buildLocalizableProperties",value:function(e){var t=[];e.localizableProperties&&t.push.apply(t,Z()(e.localizableProperties));for(var n=this.constructor.superclass;n&&n!==G;n=n.superclass){var r=n.getConfigDescriptor(!0).defaultConfig;r&&r.localizableProperties&&t.push.apply(t,Z()(r.localizableProperties.filter((function(e){return t.indexOf(e)<0}))))}return t}},{key:"startConfigure",value:function(e){e.localizableProperties=this.buildLocalizableProperties(e),se()(J()(r.prototype),"startConfigure",this).call(this,e)}},{key:"L",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this.localeClass&&this.localeClass!==this.constructor?r.L(e,t,this.localeClass,this.constructor):r.L(e,t,this.constructor)}},{key:"localeClass",get:function(){return this._localeClass||this.parent&&this.parent.localeClass||null},set:function(e){this._localeClass=e}},{key:"localeManager",get:function(){return Fe}}],[{key:"parseText",value:function(e){var t=this.inTextLocaleRegExp.exec(e);return t?t[1]:e}},{key:"getTranslation",value:function(e,t,n){var r,i,o=Fe.locale;if(o)for(e=this.parseText(e);n&&(i="string"==typeof n?n:n.$name||n.name);){var a=o[i];if(a&&e in a){var s=a[e];r="function"==typeof s&&void 0!==t?s(t):s;break}if("string"==typeof n)break;n=Object.getPrototypeOf(n)}return r}},{key:"L",value:function(e){for(var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];return o.length||(o=[this]),o.some((function(i){return void 0!==(t=n.getTranslation(e,r,i))})),void 0===t?e:t}},{key:"defaultConfig",get:function(){return{localeClass:null,localizableProperties:[]}}},{key:"inTextLocaleRegExp",get:function(){return/L{([^}]+)}/g}}]),r}(e||G)};function Pe(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Le(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function He(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var je=function(e){return e+({1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th")},Be=new RegExp(""),Ne=function(e,t){return isNaN(e)||null==e?t:e},ze=function(e,t,n){var r=(Ge[e]||(Ge[e]=new Intl.DateTimeFormat(Ve,t))).format(n);return Re.isIE11&&(r=r.replace(Be,"")),r},Ve="en-US",We=je,Ue={},Ge={},Ye={},$e={M:function(e){return e.getMonth()+1},Mo:function(e){return We($e.M(e).toString())},MM:function(e){return(e.getMonth()+1).toString().padStart(2,"0")},MMM:function(e){return ze("MMM",{month:"short"},e)},MMMM:function(e){return ze("MMMM",{month:"long"},e)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},Qo:function(e){return We($e.Q(e).toString())},D:function(e){return e.getDate()},Do:function(e){return We($e.D(e).toString())},DD:function(e){return e.getDate().toString().padStart(2,"0")},DDD:function(e){return Math.ceil((new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0)-new Date(e.getFullYear(),0,0,12,0,0))/864e5)},DDDo:function(e){return We($e.DDD(e).toString())},DDDD:function(e){return $e.DDD(e).toString().padStart(3,"0")},d:function(e){return e.getDay()},do:function(e){return We(e.getDay().toString())},d1:function(e){return $e.ddd(e).substring(0,1)},dd:function(e){return $e.ddd(e).substring(0,2)},ddd:function(e){return ze("ddd",{weekday:"short"},e)},dddd:function(e){return ze("dddd",{weekday:"long"},e)},e:function(e){return e.getDay()},E:function(e){return e.getDay()+1},W:function(e){var t=new Date(e.valueOf());t.setDate(t.getDate()-(e.getDay()+6)%7+3);var n=t.valueOf();return t.setMonth(0,1),4!==t.getDay()&&t.setMonth(0,1+(4-t.getDay()+7)%7),1+Math.ceil((n-t)/6048e5)},Wo:function(e){return We($e.W(e).toString())},WW:function(e){return $e.W(e).toString().padStart(2,"0")},Y:function(e){return e.getFullYear()},YY:function(e){return e.getFullYear()%100},YYYY:function(e){return e.getFullYear()},A:function(e){return e.getHours()<12?"AM":"PM"},a:function(e){return e.getHours()<12?"am":"pm"},H:function(e){return e.getHours()},HH:function(e){return e.getHours().toString().padStart(2,"0")},h:function(e){return e.getHours()%12||12},hh:function(e){return $e.h(e).toString().padStart(2,"0")},k:function(e){return e.getHours()+1},kk:function(e){return $e.k(e).toString().padStart(2,"0")},K:function(e){return ze("K",{hour:"numeric"},e)},KK:function(e){return ze("KK",{hour:"2-digit"},e)},m:function(e){return e.getMinutes()},mm:function(e){return $e.m(e).toString().padStart(2,"0")},s:function(e){return e.getSeconds()},ss:function(e){return $e.s(e).toString().padStart(2,"0")},S:function(e){return e.getMilliseconds().toString().substr(0,1)},SS:function(e){return e.getMilliseconds().toString().substr(0,2).padEnd(2,"0")},SSS:function(e){return e.getMilliseconds().toString().substr(0,3).padEnd(3,"0")},z:function(e){return ze("z",{timeZoneName:"short"},e)},zz:function(e){return ze("zz",{timeZoneName:"long"},e)},LT:function(e){return ze("LT",{hour:"2-digit",minute:"2-digit"},e)},LTS:function(e){return ze("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},e)},L:function(e){return ze("L",{year:"numeric",month:"2-digit",day:"2-digit"},e)},l:function(e){return ze("l",{year:"numeric",month:"numeric",day:"numeric"},e)},LL:function(e){return ze("LL",{year:"numeric",month:"long",day:"numeric"},e)},ll:function(e){return ze("ll",{year:"numeric",month:"short",day:"numeric"},e)},LLL:function(e){return ze("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},e)},lll:function(e){return ze("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},e)},LLLL:function(e){return ze("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},e)},llll:function(e){return ze("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},e)}},qe=Object.keys($e).sort((function(e,t){return t.length-e.length})),Xe="^(?:".concat(qe.join("|"),")"),Ke=function(){return{}},Je={YYYY:function(e){return{year:parseInt(e)}},Y:function(e){return{year:parseInt(e)}},YY:function(e){var t=parseInt(e);return{year:t+(t>1968?1900:2e3)}},MM:function(e){return{month:parseInt(e)-1}},Mo:function(e){return{month:parseInt(e)-1}},DD:function(e){return{date:parseInt(e)}},M:function(e){return{month:parseInt(e)-1}},D:function(e){return{date:parseInt(e)}},Do:function(e){return{date:parseInt(e)}},DDD:Ke,MMM:Ke,MMMM:Ke,DDDo:Ke,DDDD:Ke,d:Ke,do:Ke,d1:Ke,dd:Ke,ddd:Ke,dddd:Ke,Q:Ke,Qo:Ke,W:Ke,Wo:Ke,WW:Ke,e:Ke,E:Ke,HH:function(e){return{hours:parseInt(e)}},hh:function(e){return{hours:parseInt(e)}},mm:function(e){return{minutes:parseInt(e)}},H:function(e){return{hours:parseInt(e)}},m:function(e){return{minutes:parseInt(e)}},ss:function(e){return{seconds:parseInt(e)}},s:function(e){return{seconds:parseInt(e)}},S:function(e){return{milliseconds:parseInt(e)}},SS:function(e){return{milliseconds:parseInt(e)}},SSS:function(e){return{milliseconds:parseInt(e)}},A:function(e){return{amPm:e.toLowerCase()}},a:function(e){return{amPm:e.toLowerCase()}},L:"MM/DD/YYYY",LT:"HH:mm A",Z:function(e){if(!e)return{};var t=0;if(!e.endsWith("Z")){var n=ut.exec(e);if(n)t=("+"===n[1]?1:-1)*(60*(parseInt(n[2])||0)+(parseInt(n[3])||0));else t=-1*(new Date).getTimezoneOffset()}return{timeZone:t}}},Qe=Object.keys(Je).sort((function(e,t){return t.length-e.length})),Ze=new RegExp("(".concat(Qe.join("|"),")")),et=new RegExp("(l|LL|ll|LLL|lll|LLLL|llll)"),tt={year:{year:1,quarter:4,month:12,week:52,day:365,hour:8760,minute:525600,second:31536e3,millisecond:31536e6},quarter:{year:1/4,quarter:1,month:3,week:4,day:91,hour:2184,minute:131040,second:7862400,millisecond:78624e5},month:{year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-720,minute:-43200,second:-2592e3,millisecond:-2592e6},week:{year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{year:-1/8760,quarter:-1/2184,month:-1/720,week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{year:-1/525600,quarter:-1/131040,month:-1/43200,week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{year:-1/31536e3,quarter:-1/7862400,month:-1/2592e3,week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{year:-1/31536e6,quarter:-1/78624e5,month:-1/2592e6,week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:.001}},nt={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year"},rt=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,it=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,ot=["millisecond","second","minute","hour","day","week","month","quarter","year"],at=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"]],st=["year","month","week","day","hour","minute","second","millisecond"],lt=["milliseconds","seconds","minutes","hours","date","month","year"],ct=function(e){var t=parseFloat(e);return isNaN(t)?null:t},ut=/([+-])(\d\d):*(\d\d)*$/,dt={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8},ft=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(He()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"buildParser",value:function(e){var t=this,n=e.split(Ze),i=[];return 1===n.length||et.test(e)?[]:(n.reduce((function(n,o,a,s){if(0!==a||""!==o)if(Ze.test(o)){var l=("parsers"!==t.L("parsers")&&t.L("parsers")||{})[o]||Je[o];if("Z"===o&&a<s.length-2)throw new Error("Invalid format ".concat(e," TimeZone (Z) must be last token"));if("string"==typeof l){var c=r.buildParser(l),u=c.pop();delete u.last,i.push.apply(i,Z()(c)),n=u}else n.pattern=o,n.fn=Je[o]}else n.splitter=o,i.push(n),n={};else n.hasOwnProperty("pattern")&&i.push(n);return n}),{}),i[i.length-1].last=!0,i)}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultFormat;if(e instanceof Date)return e;if("string"!=typeof e||!e)return null;var n={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null},i=Ye[t];i||(i=Ye[t]=r.buildParser(t)),i.reduce((function(e,t){if(!t.last){var r,i,o;if(-1===(r="T"===t.splitter&&-1===e.indexOf("T")?e.indexOf(" "):""!==t.splitter?e.indexOf(t.splitter):t.pattern&&t.pattern.length||-1)){var a=e.split(/([Z\-+])/);1===a.length?(i=e,o=""):(i=a[0],o="".concat(a[1]).concat(a[2]))}else i=e.substring(0,r)||e,o=e.substring(r+t.splitter.length);return t.fn&&Object.assign(n,t.fn(i)),o}Object.assign(n,t.fn(e))}),e),n.year&&!n.date&&(n.date=1);var o=this.create(n);return o||new Date(e)}},{key:"create",value:function(e){var t=Object.assign({},e),n=isNaN(t.year),r=!1;if(!n){var i=!0;lt.forEach((function(e){e in t&&!isNaN(t[e])||(t[e]=0),i=i&&null===t[e]})),n=i}if("pm"===t.amPm&&(t.hours=t.hours%12+12),"timeZone"in t&&(r=!0,t.minutes-=t.timeZone),n)return null;var o=[Ne(t.year,1970),Ne(t.month,0),Ne(t.date,1),t.hours,t.minutes,t.seconds,t.milliseconds];return r?new Date(Date.UTC.apply(Date,o)):Ee()(Date,o)}},{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultFormat;if(!e||isNaN(e))return null;var n=Ue[t],r="";if(!n){n=Ue[t]=[];for(var i=0;i<t.length;i++){var o=t.substr(i).match(Xe),a=o&&o[0];if(a){var s="formats"!==this.L("formats")&&this.L("formats")||{},l=s[a]||$e[a];n.push(l),i+=a.length-1}else if("{"===t[i]){var c=t.indexOf("}",i+1);-1===c?(n.push(t.substr(i+1)),i=t.length):(n.push(t.substring(i+1,c)),i=c)}else n.push(t[i])}}return n.forEach((function(t){r+="string"==typeof t?t:t(e)})),(Re.isEdge||Re.isIE11)&&(r=r.replace(/\u200E/g,"")),r}},{key:"asMilliseconds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"==typeof e&&(t=e,e=1),this.as("millisecond",e,t)}},{key:"formatDelta",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],i=n?this.getShortNameOfUnit:this.getLocalizedNameOfUnit,o=n?"":" ",a=Pe(st);try{for(a.s();!(t=a.n()).done;){var s=t.value,l=Math.floor(this.as(s,e));if(l&&(r.push("".concat(l).concat(o).concat(i.call(this,s,l>1))),e-=this.as("ms",l,s)),!e)break}}catch(e){a.e(e)}finally{a.f()}return r.join(", ")}},{key:"as",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms";return e===n?t:(e=this.normalizeUnit(e),n=this.normalizeUnit(n),dt[n]>dt[e]?t*Math.abs(tt[n][e]):t/Math.abs(tt[e][n]))}},{key:"formatContainsHourInfo",value:function(e){return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(/(\\.)/g,""))}},{key:"is24HourFormat",value:function(e){return this.format(this.getTime(13,0,0),e).includes("13")}},{key:"add",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms",o=this;if(n="string"==typeof e?o.parse(e):new Date(e.getTime()),!i||0===t)return n;switch(i=r.normalizeUnit(i)){case"millisecond":n=new Date(n.getTime()+t);break;case"second":n=new Date(n.getTime()+1e3*t);break;case"minute":n=new Date(n.getTime()+6e4*t);break;case"hour":n=new Date(n.getTime()+36e5*t);break;case"day":t%1==0?n.setDate(n.getDate()+t):n=new Date(n.getTime()+864e5*t),23===n.getHours()&&0===n.getHours()&&(n=o.add(n,1,"hour"));break;case"week":n.setDate(n.getDate()+7*t);break;case"month":var a=n.getDate();a>28&&(a=Math.min(a,o.getLastDateOfMonth(o.add(o.getFirstDateOfMonth(n),t,"month")).getDate())),n.setDate(a),n.setMonth(n.getMonth()+t);break;case"quarter":n=o.add(n,3*t,"month");break;case"year":n.setFullYear(n.getFullYear()+t)}return n}},{key:"diff",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms",o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(i=r.normalizeUnit(i),!e||!t)return 0;switch(i){case"year":n=this.diff(e,t,"month")/12;break;case"quarter":n=this.diff(e,t,"month")/3;break;case"month":n=12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth());break;case"week":n=this.diff(e,t,"day")/7;break;case"day":var a=e.getTimezoneOffset()-t.getTimezoneOffset();n=(t-e+60*a*1e3)/864e5;break;case"hour":n=(t-e)/36e5;break;case"minute":n=(t-e)/6e4;break;case"second":n=(t-e)/1e3;break;case"millisecond":n=t-e}return o?n:Math.round(n)}},{key:"startOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"day",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;t=this.normalizeUnit(t),n&&(e=this.clone(e));for(var r={},i=dt[t],o=0;o<i;o++){var a=ot[o];"quarter"!==a&&"week"!==a&&(r[a]="day"===a?1:0)}if("quarter"===t)r.month=3*(this.get(e,"quarter")-1);else if("week"===t){var s=e.getDay()-this.weekStartDay;r.day=e.getDate()-s}return this.set(e,r)}},{key:"clone",value:function(e){return new Date(e.getTime())}},{key:"clearTime",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return r.startOf(e,"day",t)}},{key:"set",value:function(e,t,n){var r=this;if(!t)return e;if("string"==typeof t)switch(this.normalizeUnit(t)){case"millisecond":(0!==n||e.getMilliseconds()>0)&&e.setMilliseconds(n);break;case"second":(0!==n||e.getSeconds()>0)&&e.setSeconds(n);break;case"minute":(0!==n||e.getMinutes()>0)&&e.setMinutes(n);break;case"hour":e.setHours(n);break;case"day":case"date":e.setDate(n);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(n);break;case"quarter":e.setDate(1),e.setMonth(3*(n-1));break;case"year":e.setFullYear(n)}else Object.entries(t).sort((function(e,t){return dt[e[0]]-dt[t[0]]})).forEach((function(t){var n=te()(t,2),i=n[0],o=n[1];r.set(e,i,o)}));return e}},{key:"constrain",value:function(e,t,n){return null!=t&&(e=this.max(e,t)),null==n?e:this.min(e,n)}},{key:"getTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new Date(1970,0,1,e,t,n,r)}},{key:"copyTimeValues",value:function(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}},{key:"isDST",value:function(e){var t=new Date(e.getFullYear(),0,1),n=new Date(e.getFullYear(),6,1);return e.getTimezoneOffset()<Math.max(t.getTimezoneOffset(),n.getTimezoneOffset())}},{key:"isBefore",value:function(e,t){return e<t}},{key:"isAfter",value:function(e,t){return e>t}},{key:"isEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null===n?e&&t&&e.getTime()===t.getTime():this.startOf(e,n)-this.startOf(t,n)==0}},{key:"compare",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this;return n&&(e=r.startOf(e,n),t=r.startOf(t,n)),r.isBefore(e,t)?-1:r.isAfter(e,t)?1:0}},{key:"isStartOf",value:function(e,t){return this.isEqual(e,this.startOf(e,t))}},{key:"betweenLesser",value:function(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<n.getTime()}},{key:"betweenLesserEqual",value:function(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<=n.getTime()}},{key:"intersectSpans",value:function(e,t,n,r){return this.betweenLesser(e,n,r)||this.betweenLesser(n,e,t)}},{key:"compareUnits",value:function(e,t){return Math.sign(dt[e]-dt[t])}},{key:"timeSpanContains",value:function(e,t,n,r){return n-e>=0&&t-r>=0}},{key:"get",value:function(e,t){switch(this.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return $e.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}},{key:"daysInMonth",value:function(e){var t=this.clone(e);return t.setDate(1),t.setMonth(e.getMonth()+1),t.setDate(0),t.getDate()}},{key:"getFirstDateOfMonth",value:function(e){return new Date(e.getFullYear(),e.getMonth(),1)}},{key:"getLastDateOfMonth",value:function(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}},{key:"min",value:function(e,t){return e.getTime()<t.getTime()?e:t}},{key:"max",value:function(e,t){return e.getTime()>t.getTime()?e:t}},{key:"getNext",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.weekStartDay,i=this;if("week"===t){var o=i.clone(e),a=o.getDay();return o=i.startOf(o,"day"),(o=i.add(o,r-a+7*(n-(r<=a?0:1)),"day")).getDay()!==r&&i.add(o,1,"hour"),o}return i.startOf(i.add(e,n,t),t)}},{key:"isValidDate",value:function(e){return this.isDate(e)&&!isNaN(e)}},{key:"isDate",value:function(e){return e&&e.constructor&&"Date"===e.constructor.name}},{key:"getStartOfNextDay",value:function(e,t,n){var i=r.add(n?e:r.clearTime(e,t),1,"day");if(i.getDate()==e.getDate()){var o=r.add(r.clearTime(e,t),"day",2).getTimezoneOffset(),a=e.getTimezoneOffset();i=r.add(i,a-o,"minute")}return i}},{key:"getEndOfPreviousDay",value:function(e,t){var n=t?e:r.clearTime(e,!0);return n-e?n:this.add(n,-1,"day")}},{key:"formatCount",value:function(e,t){return t=r.normalizeUnit(t),1!==e&&(t+="s"),e+" "+t}},{key:"getUnitToBaseUnitRatio",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(e=r.normalizeUnit(e))===(t=r.normalizeUnit(t))?1:tt[e]&&tt[e][t]&&(n||tt[e][t]>0)?1/r.as(t,1,e):tt[t]&&tt[t][e]&&(n||tt[t][e]>0)?r.as(e,1,t):-1}},{key:"getMeasuringUnit",value:function(e){return"week"===e?"day":e}},{key:"getShortNameOfUnit",value:function(e){return e=this.parseTimeUnit(e),this.unitLookup[e].abbrev}},{key:"getLocalizedNameOfUnit",value:function(e,t){return e=this.normalizeUnit(e),e=this.parseTimeUnit(e),this.unitLookup[e][t?"plural":"single"]}},{key:"normalizeUnit",value:function(e){return e?"date"===e.toLowerCase()||ot.includes(e.toLowerCase())?e.toLowerCase():nt[e]||nt[e.toLowerCase()]:null}},{key:"getUnitByName",value:function(e){return r.normalizeUnit(e)||r.normalizeUnit(this.parseTimeUnit(e))}},{key:"getDurationInUnit",value:function(e,t,n,r){return this.diff(e,t,n,r)}},{key:"doesUnitsAlign",value:function(e,t){return e===t||"week"!==t}},{key:"getSmallerUnit",value:function(e){return ot[dt[this.normalizeUnit(e)]-1]||null}},{key:"getLargerUnit",value:function(e){return ot[dt[this.normalizeUnit(e)]+1]||null}},{key:"parseDuration",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this,i=t?rt:it,o=i.exec(e);if(null==e||!o)return null;var a=ct(o[1]),s=r.parseTimeUnit(o[2])||n;return s?{magnitude:a,unit:s}:null}},{key:"parseTimeUnit",value:function(e){var t=null==e?null:this.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(var n=0;n<ot.length;n++)if(t[n+1])return ot[n]}},{key:"fillDayNames",value:function(){var e=this,t=new Date("2000-01-01T12:00:00"),n=e._dayNames||[],r=e._dayShortNames||[];n.length=0,r.length=0;for(var i=2;i<9;i++)t.setDate(i),n.push(e.format(t,"dddd")),r.push(e.format(t,"ddd"));e._dayNames=n,e._dayShortNames=r}},{key:"getDayNames",value:function(){return this._dayNames}},{key:"getDayName",value:function(e){return this._dayNames[e]}},{key:"getDayShortNames",value:function(){return this._dayShortNames}},{key:"getDayShortName",value:function(e){return this._dayShortNames[e]}},{key:"fillMonthNames",value:function(){var e=this,t=new Date("2000-01-15T12:00:00"),n=e._monthNames||[],r=e._monthShortNames||[];n.length=0,r.length=0;for(var i=0;i<12;i++)t.setMonth(i),n.push(e.format(t,"MMMM")),r.push(e.format(t,"MMM"));e._monthNames=n,e._monthShortNames=r}},{key:"getMonthShortNames",value:function(){return this._monthShortNames}},{key:"getMonthShortName",value:function(e){return this._monthShortNames[e]}},{key:"getMonthNames",value:function(){return this._monthNames}},{key:"getMonthName",value:function(e){return this._monthNames[e]}},{key:"setupDurationRegEx",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this,r={},i="",o=0;o<t.length;o++){var a=t[o],s=e[o];s.canonicalUnitName=ot[o],r[s.single]=r[s.single.toUpperCase()]=r[s.canonicalUnitName]=r[s.canonicalUnitName.toUpperCase()]=s,i+="".concat(o?"|":"","(");for(var l=0;l<a.length;l++)i+="".concat(a[l],"|");if("en-US"!==(Ve=n.L("locale")||"en-US"))for(var c=at[o],u=0;u<c.length;u++)i+="".concat(c[u],"|");i+="".concat(s.single,"|").concat(s.plural,"|").concat(s.canonicalUnitName,")")}n.unitLookup=r,n.durationRegEx=new RegExp("^(?:".concat(i,")$"))}},{key:"applyLocale",value:function(){var e=this,t=e.L("unitAbbreviations"),n=e.unitNames=e.L("unitNames");"unitNames"!==n&&("en-US"===(Ve=e.L("locale")||"en-US")?We=je:"ordinalSuffix"!==e.L("ordinalSuffix")&&(We=e.L("ordinalSuffix")),Ue={},Ye={},Ge={},e.setupDurationRegEx(n,t),e.fillDayNames(),e.fillMonthNames())}},{key:"defaultFormat",set:function(e){this._defaultFormat=e},get:function(){return this._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}},{key:"weekStartDay",get:function(){var e=this.L("weekStartDay");return"weekStartDay"!==e?e:0}},{key:"locale",set:function(e){Ve=e},get:function(){return Ve}}]),r}(_e());function ht(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}ft._$name="DateHelper",Fe.on({locale:"applyLocale",prio:1e3,thisObj:ft}),Fe.locale&&ft.applyLocale(),ft._$name="DateHelper";var vt=/\s+/,pt=function(e){var t=re()(e);if("object"===t){if(null===e)return"null";if("[object Date]"===Object.prototype.toString.call(e))return"date"}return t},yt="1.01"===1.005.toFixed(2)?null:function(e,t){var n=e.toString().split("."),r=+(n[1]?n.join(".")+"1":n[0]);return e.toFixed.call(r,t)},mt=function(){function e(){D()(this,e)}return M()(e,null,[{key:"isEqual",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===e&&null!==t||void 0===e&&void 0!==t||null===t&&null!==e||void 0===t&&void 0!==e)return!1;if(null==e&&null==t)return!0;if(e===t)return!0;var i=re()(e),o=re()(t);if(i===o){switch(i){case"number":case"string":case"boolean":return e===t}switch(!0){case e instanceof Date&&t instanceof Date:return e.getTime()===t.getTime();case Array.isArray(e)&&Array.isArray(t):return e.length===t.length&&e.every((function(e,i){return n.isEqual(e,t[i],r)}));case"object"===i&&e.constructor.prototype===t.constructor.prototype:return r?this.isDeeplyEqual(e,t,r):JSON.stringify(e)===JSON.stringify(t)}}return String(e)===String(t)}},{key:"isDeeplyEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;if(!e||!t)return!1;var r=this.keys(e,n.ignore),i=this.keys(t,n.ignore);if(r.length!==i.length)return!1;for(var o=0;o<r.length;o++){var a=r[o],s=i[o];if(a!==s)return!1;var l=e[a],c=t[s];if(!n.shouldEvaluate||!1!==n.shouldEvaluate(a,{value:l,object:e},{value:c,object:t})){if(n.evaluate){var u=n.evaluate(a,{value:l,object:e},{value:c,object:t});if(!1===u)return!1;if(!0===u)continue}if(!this.isEqual(l,c,n))return!1}}return!0}},{key:"isPartial",value:function(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),-1!=e.indexOf(t)}},{key:"isLessThan",value:function(e,t){return e instanceof Date&&t instanceof Date?ft.isBefore(e,t):e<t}},{key:"isMoreThan",value:function(e,t){return e instanceof Date&&t instanceof Date?ft.isAfter(e,t):e>t}},{key:"fork",value:function(e){var t,n,r;if(e&&e.constructor===Object)for(n in t=Object.setPrototypeOf({},e),e)(r=e[n])&&(r.constructor===Object?t[n]=this.fork(r):r instanceof Array&&(t[n]=r.slice()));else t=e;return t}},{key:"assign",value:function(e){for(var t,n,r=0,i=arguments.length<=1?0:arguments.length-1;r<i;r++)for(n in t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])e[n]=t[n];return e}},{key:"clone",value:function(e){if(null==e)return e;var t,n,r=e.constructor.name,i=e;if("Date"===r)return new Date(e.getTime());if("Array"===r)for(t=e.length,i=[];t--;)i[t]=this.clone(e[t]);else if("Object"===r)for(n in i={},e)i[n]=this.clone(e[n]);return i}},{key:"merge",value:function(e){for(var t,n,r,i,o=0,a=arguments.length<=1?0:arguments.length-1;o<a;o++)for(n in t=o+1<1||arguments.length<=o+1?void 0:arguments[o+1])(r=t[n])&&r.constructor===Object?(i=e[n])&&"Object"===i.constructor.name?this.merge(i,r):e[n]=this.clone(r):e[n]=r;return e}},{key:"copyProperties",value:function(e,t,n){var r,i;for(i=0;i<n.length;i++)(r=n[i])in t&&(e[r]=t[r]);return e}},{key:"copyPropertiesIf",value:function(e,t,n){var r,i=ht(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;o in e||(e[o]=t[o])}}catch(e){i.e(e)}finally{i.f()}return e}},{key:"keys",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[];for(var r in e)t&&t[r]||n.push(r);return n}},{key:"isEmpty",value:function(e){for(var t in e)return!1;return!0}},{key:"getTruthyKeys",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;)e[t[n]]?n++:t.splice(n,1);return t}},{key:"getTruthyValues",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;)e[t[n]]?t[n]=e[t[n++]]:t.splice(n,1);return t}},{key:"createTruthyKeys",value:function(e){"string"==typeof e&&(e=e.split(vt));var t,n={},r=ht(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.length&&(n[i]=1)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"allKeys",value:function(e){for(var t=[];e;e=Object.getPrototypeOf(e))t.push.apply(t,Z()(Object.keys(e)));return t}},{key:"pathExists",value:function(e,t){return t.split(".").every((function(t){return t in e&&(e=e[t],!0)}))}},{key:"getPath",value:function(e,t){return t.split(".").reduce((function(e,t){return(e||{})[t]}),e)}},{key:"setPath",value:function(e,t,n){return t.split(".").reduce((function(e,t,r,i){return r===i.length-1?e[t]=n:(e[t]instanceof Object||(e[t]={}),e[t])}),e),e}},{key:"deletePath",value:function(e,t){t.split(".").reduce((function(e,t,n,r){if(null==e)return null;if(Object.hasOwnProperty.call(e,t)){if(n!==r.length-1)return e[t];delete e[t]}}),e)}},{key:"coerce",value:function(e,t){var n=pt(e),r=pt(t),i="string"==typeof e;if(n!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return!(i&&(!e||"false"===e||"0"===e))&&Boolean(e);case"null":return!(!i||e&&"null"!==e)&&null;case"undefined":return!(!i||e&&"undefined"!==e)&&void 0;case"date":return i&&isNaN(e)?ft.parse(e):Date(Number(e))}return e}},{key:"wrapProperty",value:function(e,t,n,r){for(var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o={},a=Object.getPrototypeOf(e),s=Object.getOwnPropertyDescriptor(a,t);!s&&a&&i;)(a=Object.getPrototypeOf(a))&&(s=Object.getOwnPropertyDescriptor(a,t));s?(s.set?o.set=function(t){s.set.call(e,t),r&&r.call(e,s.get.call(e))}:o.set=r,s.get?o.get=function(){var t=s.get.call(e);return n&&(t=n.call(e,t)),t}:o.get=n):(o.set=function(n){e["_".concat(t)]=n,r&&r.call(e,n)},o.get=function(){var r=e["_".concat(t)];return n&&(r=n.call(e,r)),r}),Object.defineProperty(e,t,o)}},{key:"getPropertyDescriptor",value:function(e,t){for(var n=null,r=e;!n&&r!==G;r=Object.getPrototypeOf(r))n=Object.getOwnPropertyDescriptor(r,t);return n}},{key:"cleanupProperties",value:function(e){return Object.entries(e).forEach((function(t){var n=te()(t,2),r=n[0];return null==n[1]&&delete e[r]})),e}},{key:"assertType",value:function(e,t,n){if(null!=e&&re()(e)!==t)throw new Error('Incorrect type "'.concat(re()(e),'" for ').concat(n,', expected "').concat(t,'"'))}},{key:"assertNumber",value:function(e,t){this.assertType(e,"number",t)}},{key:"assertBoolean",value:function(e,t){this.assertType(e,"boolean",t)}},{key:"toFixed",value:function(e,t){return yt?yt(e,t):e.toFixed(t)}},{key:"roundTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.round(e/t)*t}},{key:"round",value:function(e,t){if(null==t)return e;var n=Math.pow(10,t);return Math.round(e*n)/n}}]),e}();mt._$name="ObjectHelper";var bt=function(){function e(){D()(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];"object"===re()(n[0])?Object.assign(this,n[0]):this.process(1,n),this[Ct]=!0}return M()(e,[{key:"clone",value:function(){return new e(this)}},{key:"contains",value:function(e){return!("string"!=typeof e||!e)&&Boolean(this[e])}},{key:"toString",value:function(){return this.length?"".concat(this.value," "):""}},{key:"toJSON",value:function(){return this.toString()}},{key:"trim",value:function(){return this.value}},{key:"isEqual",value:function(e){if("string"==typeof e&&(Rt.value=e,e=Rt),this.length===e.length){for(var t=mt.getTruthyKeys(e),n=0,r=t.length;n<r;n++)if(!this[t[n]])return!1;return!0}return!1}},{key:"process",value:function(e,t){for(var n=t.length,r=0;r<n;r++)if(t[r])for(var i=t[r],o=i.values?Array.from(i.values()):i.item?Array.from(i):i.split(kt),a=o.length,s=0;s<a;s++)o[s]&&(this[o[s]]=e);this[Ct]=!0}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.process(1,t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.process(0,t)}},{key:"split",value:function(){return mt.getTruthyKeys(this)}},{key:"forEach",value:function(e){return mt.getTruthyKeys(this).forEach(e)}},{key:"value",get:function(){var e=this;if(e[Ct]){var t=mt.getTruthyKeys(e);e[St]=t.length,e[wt]=t.join(" "),e[Ct]=!1}return e[wt]},set:function(e){for(var t=Object.keys(this),n=t.length,r=0;r<n;r++)delete this[t[r]];e?this.process(1,[e]):this[Ct]=!0}},{key:"length",get:function(){return this.value?this[St]:0}},{key:"isDomClassList",get:function(){return!0}}]),e}(),kt=/\s+/,wt=Symbol("value"),St=Symbol("length"),Ct=Symbol("dirty"),Rt=new bt;function xt(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Et(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}bt._$name="DomClassList";var Dt,Tt,Mt,At,It,Ft,Ot={align:"t0-t0"},_t=null,Pt=0,Lt=null,Ht=/(?:matrix\((?:-?\d*\.?[0-9]*),\s?(?:-?\d*\.?[0-9]*),\s?(?:-?\d*\.?[0-9]*),\s?(?:-?\d*\.?[0-9]*),\s?(-?\d*\.?[0-9]*),\s?(-?\d*\.?[0-9]*))|(?:matrix3d\((?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(-?\d*),\s?(-?\d*))/,jt=/translate(3d|X)?\((-?\d*\.?[0-9]*)px(?:,\s?(-?\d*\.?[0-9]*)px)?/,Bt=/translate(3d|Y)?\((-?\d*\.?[0-9]*)px(?:,\s?(-?\d*\.?[0-9]*)px)?/,Nt=/^[^a-z]+|[^\w:.-]+/gi,zt=/\s+/,Vt={tag:1,html:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,className:1,unmatched:1,_element:1,onlyChildren:1,elementData:1,compareHtml:1,syncOptions:1},Wt={length:1,parentRule:1,style:1},Ut={width:1,height:1,top:1,left:1,minWidth:1,minHeight:1,maxWidth:1,maxHeight:1,fontSize:1},Gt={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,HTML:Re.isIE11?1:0,BODY:Re.isIE11?0:1},Yt=window,$t=document,qt={},Xt=[],Kt=Array.prototype.slice,Jt=new Promise((function(e){return e()})),Qt=window.devicePixelRatio||1,Zt=1===Qt?Math.round:function(e){return Math.round(e*Qt)/Qt},en=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],tn=function(e){return e._hidden},nn=document.documentElement.getRootNode?function(e){return e.getRootNode()}:function(e){for(;e.parentNode;)e=e.parentNode;return e},rn=function e(t){return t&&(document.body.contains(t)||(Dt=nn(t).host)&&e(Dt))},on=function(){function e(){D()(this,e)}return M()(e,null,[{key:"isFocusable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&(!this.isVisible(e)||we.fromElement(e,tn)))return!1;var n=e.nodeName;return Gt[n]||("A"===n||"LINK"===n)&&!!e.href||null!=e.getAttribute("tabIndex")||"true"===e.contentEditable}},{key:"isInView",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=In.from(e),r=!0,i=n.height,o=n.width;r&&e.parentElement;)e=e.parentElement,r=(n=n.intersect(In.from(e)))&&(!t||n.height>=i&&n.width>=o);return r}},{key:"isVisible",value:function(e){for(var t,n,r,i=e.ownerDocument;e;e=(r=e).parentNode||r.host){if(e===i)return!0;if(1===e.nodeType&&(n=void 0,"none"===(n=(t=e).ownerDocument.defaultView.getComputedStyle(t)).getPropertyValue("display")||"hidden"===n.getPropertyValue("visibility")))return!1}return!1}},{key:"roundPx",value:function(e){return Zt(e)}},{key:"isCustomElement",value:function(e){return e&&e.shadowRoot}},{key:"elementFromPoint",value:function(t,n){var r=document.elementFromPoint(t,n);return e.isCustomElement(r)&&(r=r.shadowRoot.elementFromPoint(t,n)||r),r}},{key:"getId",value:function(e){return e.id||(e.id="b-element-"+ ++Pt)}},{key:"getElement",value:function(e){return e instanceof Element?e:$t.querySelector(e)}},{key:"setAttributes",value:function(e,t){var n=this.getElement(e);Object.entries(t).forEach((function(e){var t=te()(e,2),r=t[0],i=t[1];return n.setAttribute(r,i)}))}},{key:"setLength",value:function(e,t,n){return 1===arguments.length?"number"==typeof e?"".concat(e,"px"):e:(e=this.getElement(e)).style[t]="number"==typeof n?"".concat(n,"px"):n}},{key:"getChild",value:function(e,t){if(Re.supportsQueryScope)t=":scope>"+t;else{var n=e.id||(e.id="b-element-"+ ++Pt);t="#".concat(n," > ").concat(t)}return e.querySelector(t)}},{key:"hasChild",value:function(t,n){return null!=e.getChild(t,n)}},{key:"children",value:function(e,t){return Array.from(e.querySelectorAll(t))}},{key:"down",value:function(e,t){if(!e)return null;if(e.matches&&e.matches(t))return e;if(Re.supportsQueryScope)t=":scope "+t;else{var n=e.id||(e.id="b-element-"+ ++Pt);t="#".concat(n," ").concat(t)}return e.querySelector(t)}},{key:"isDescendant",value:function(e,t){return e.contains||(e=e.body),e.contains(t)}},{key:"forEachSelector",value:function(e,t,n){"string"==typeof e&&(n=t,t=e,e=$t),this.children(e,t).forEach(n)}},{key:"forEachChild",value:function(e,t){Array.from(e.children).forEach(t)}},{key:"removeEachSelector",value:function(e,t){this.forEachSelector(e,t,(function(e){return e.remove()}))}},{key:"removeClsGlobally",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];r.forEach((function(n){return t.forEachSelector(e,"."+n,(function(e){return e.classList.remove(n)}))}))}},{key:"up",value:function(e,t){return e&&e.closest(t)}},{key:"getAncestor",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!1,o=e;for(Array.isArray(t)||(t=[t]);o=o.parentElement;){if(t.includes(o)){i=!0;break}if(r&&o===r)break;n=o}return i?n||e:null}},{key:"getParents",value:function(e){for(var t=[];e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}},{key:"makeValidId",value:function(e){return null==e?null:String(e).replace(Nt,"")}},{key:"createElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;"string"==typeof t.parent&&(t.parent=document.getElementById(t.parent)),t.syncOptions&&t.syncOptions.syncIdField&&(i=t.syncOptions.syncIdField);var o,a=t.parent||t.nextSibling&&t.nextSibling.parentNode;o=t.ns?$t.createElementNS(t.ns,t.tag||"svg"):$t.createElement(t.tag||"div"),null!=t.html&&(t.html instanceof DocumentFragment?o.appendChild(t.html):o.innerHTML=t.html),t.tooltip&&Ce.attachTooltip(o,t.tooltip),t.style&&this.applyStyle(o,t.style),t.dataset&&Object.assign(o.dataset,t.dataset),a&&a.insertBefore(o,t.nextSibling),t.reference&&((r||(r={}))[t.reference]=o,o.setAttribute("reference",t.reference)),t.elementData&&(o.elementData=t.elementData);var s=t.className;s&&(s.isDomClassList?o.className=s.toString():"object"===re()(s)?o.className=new bt(s):o.className=s);for(var l=0,c=Object.keys(t);l<c.length;l++){var u=c[l];Vt[u]||(t.ns?o.setAttribute(u,t[u]):o[u]=t[u])}return!0===n?n=[o]:Array.isArray(n)&&n.push(o),t.children&&(i&&(o.syncIdMap={}),t.children.forEach((function(a){if(a)if("string"==typeof a)o.appendChild(document.createTextNode(a));else if(isNaN(a.nodeType)){a.parent=o,!a.ns&&t.ns&&(a.ns=t.ns);var s=e.createElement(a,n,r,i),l=a.dataset&&a.dataset[i];null!=l&&(o.syncIdMap[l]=s),delete a.parent}else o.appendChild(a)}))),o.lastConfig=t,t._element=o,r||n||o}},{key:"createElementFromTemplate",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qt,i=r.array,o=r.raw,a=r.fragment;if(e.supportsTemplate){if((Tt||(Tt=$t.createElement("template"))).innerHTML=t,n=Tt.content,a)return n.cloneNode(!0)}else{if((Mt||(Mt=new DOMParser)).parseFromString(t,"text/html"),n=Mt.parseFromString(t,"text/html").body,a){var s=n?n.childNodes:Xt;for(n=document.createDocumentFragment();s.length;)n.appendChild(s[0]);return n}n||(n={children:[],childNodes:[]})}return 1!==(n=o?n.childNodes:n.children).length||i?Kt.call(n):n[0]}},{key:"insertFirst",value:function(t,n){return n&&n.nodeType!==Node.ELEMENT_NODE&&n.tag&&(n=e.createElement(n)),t.insertBefore(n,t.firstElementChild)}},{key:"insertBefore",value:function(t,n,r){return n&&n.nodeType!==Node.ELEMENT_NODE&&n.tag&&(n=e.createElement(n)),r?t.insertBefore(n,r):e.insertFirst(t,n)}},{key:"append",value:function(t,n){return n&&("string"==typeof n?n=e.createElementFromTemplate(n):n.nodeType!==Node.ELEMENT_NODE&&n.tag&&(n=e.createElement(n))),Array.isArray(n)?n.map((function(e){return t.appendChild(e)})):t.appendChild(n)}},{key:"getTranslateX",value:function(e){var t=e.style.transform,n=jt.exec(t);return n?parseInt(n[2]):(n=Ht.exec(t)||Ht.exec(this.getStyleValue(this.getElement(e),"transform")))?parseInt(n[1]||n[3]):0}},{key:"getTranslateY",value:function(e){var t=e.style.transform,n=Bt.exec(t);if(n){var r=parseInt(n["Y"===n[1]?2:3]);return isNaN(r)?0:r}return(n=Ht.exec(t)||Ht.exec(this.getStyleValue(this.getElement(e),"transform")))?parseInt(n[2]||n[4]):0}},{key:"getTranslateXY",value:function(e){return[this.getTranslateX(e),this.getTranslateY(e)]}},{key:"getOffsetX",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}},{key:"getOffsetY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}},{key:"getOffsetXY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return[this.getOffsetX(e,t),this.getOffsetY(e,t)]}},{key:"focusWithoutScrolling",value:function(t){function n(e){e.forEach((function(e){var t=e.element,n=e.scrollLeft,r=e.scrollTop;t.scrollLeft!==n&&(t.scrollLeft=n),t.scrollTop!==r&&(t.scrollTop=r)}))}if(Re.chromeVersion>=64||Re.fireFoxVersion>=68)t.focus({preventScroll:!0});else{var r=e.getParents(t).map((function(e){return{element:e,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}));t.focus(),Re.isIE11?n(r):setTimeout((function(){return n(r)}),0)}}},{key:"getPageX",value:function(e){return e.getBoundingClientRect().left+Yt.pageXOffset}},{key:"getPageY",value:function(e){return e.getBoundingClientRect().top+Yt.pageYOffset}},{key:"getExtremalSizePX",value:function(e,t){var n=L.hyphenate(t),r=n.split("-")[1],i=this.getStyleValue(e,n);return i=/%/.test(i)?e.parentElement?parseInt(this.getStyleValue(e.parentElement,r),10):NaN:parseInt(i,10)}},{key:"setTranslateX",value:function(t,n){var r=e.getStyleValue(t,"transform").split(/,\s*/);n=Zt(n),r.length>1?(r[r[0].startsWith("matrix3d")?12:4]=n,t.style.transform=r.join(",")):t.style.transform="translateX(".concat(n,"px)")}},{key:"setTranslateY",value:function(t,n){var r=e.getStyleValue(t,"transform").split(/,\s*/);n=Zt(n),r.length>1?(r[r[0].startsWith("matrix3d")?13:5]=n,t.style.transform=r.join(",")+")"):t.style.transform="translateY(".concat(n,"px)")}},{key:"setTop",value:function(e,t){this.setLength(e,"top",t)}},{key:"setLeft",value:function(e,t){this.setLength(e,"left",t)}},{key:"setTranslateXY",value:function(t,n,r){if(null==n)return this.setTranslateY(t,r);if(null==r)return this.setTranslateX(t,n);n=Zt(n),r=Zt(r);var i=e.getStyleValue(t,"transform").split(/,\s*/),o=i[0].startsWith("matrix3d");i.length>1?(i[o?12:4]=n,i[o?13:5]=r,t.style.transform=i.join(",")+")"):t.style.transform="translateX(".concat(n,"px) translateY(").concat(r,"px)")}},{key:"addTranslateX",value:function(t,n){e.setTranslateX(t,e.getTranslateX(t)+n)}},{key:"addTranslateY",value:function(t,n){e.setTranslateY(t,e.getTranslateY(t)+n)}},{key:"addLeft",value:function(t,n){e.setLeft(t,e.getOffsetX(t)+n)}},{key:"addTop",value:function(t,n){e.setTop(t,e.getOffsetY(t)+n)}},{key:"alignTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ot;t=t instanceof In?t:In.from(t,!0);var r=this.getTranslateXY(e),i=In.from(e,!0),o=i.alignTo(Object.assign(n,{target:t}));this.setTranslateXY(e,r[0]+o.x-i.x,r[1]+o.y-i.y)}},{key:"getStyleValue",value:function(e,t,n,r){var i=n?e.style:e.ownerDocument.defaultView.getComputedStyle(e,r);if(Array.isArray(t)){var o,a={},s=xt(t);try{for(s.s();!(o=s.n()).done;){var l=o.value;a[l]=i.getPropertyValue(L.hyphenate(l))}}catch(e){s.e(e)}finally{s.f()}return a}return i.getPropertyValue(L.hyphenate(t))}},{key:"getEdgeSize",value:function(t,n,r){for(var i="border"===n?"-width":"",o={raw:{}},a=0,s=["top","right","bottom","left"];a<s.length;a++){var l=s[a];r&&!r.includes(l[0])||(o[l]=parseFloat(o.raw[l]=e.getStyleValue(t,"".concat(n,"-").concat(l).concat(i))))}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}},{key:"applyStyle",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof t)n?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else for(var r in n&&(e.style.cssText=""),t.style&&("string"==typeof t.style?e.style.cssText=t.style:t=Object.assign({},t.style,t)),t)Wt[r]||(Ut[r]&&"number"==typeof t[r]?e.style[L.hyphenate(r)]=t[r]+"px":e.style[L.hyphenate(r)]=t[r])}},{key:"getCSSText",value:function(e){if("string"==typeof e)return e;var t="";for(var n in e)Wt[n]||(t+="".concat(L.hyphenate(n),":").concat(e[n],";"));return t}},{key:"addClasses",value:function(e,t){t.forEach((function(t){return e.classList.add(t)}))}},{key:"removeClasses",value:function(e,t){t.forEach((function(t){return e.classList.remove(t)}))}},{key:"toggleClasses",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)||(t=[t]),!0===n?this.addClasses(e,t):!1===n?this.removeClasses(e,t):t.forEach((function(t){return e.classList.toggle(t)}))}},{key:"addTemporaryClass",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;n>0&&(e.classList.add(t),r.setTimeout((function(){return e.classList.remove(t)}),n))}},{key:"getPropertyTransitionDuration",value:function(e,t){var n,r=window.getComputedStyle(e),i=r.transitionProperty.split(", "),o=r.transitionDuration.split(", "),a=i.indexOf(t);return-1!==a&&(n=1e3*parseFloat(o[a])),n}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e instanceof In?e.highlight():new Promise((function(n){t.setTimeout((function(){e.classList.add("b-fx-highlight"),t.setTimeout((function(){e.classList.remove("b-fx-highlight"),n()}),1e3)}),0)}))}},{key:"resetScrollBarWidth",value:function(){_t=null}},{key:"measureText",value:function(e,t,n,r){var i=this.getMeasureElement(t,r);i[n?"innerHTML":"innerText"]=e;var o=i.clientWidth;return i.className="",o}},{key:"measureSize",value:function(t,n){if(!t)return 0;if("number"==typeof t)return t;if(!t.length)return 0;if(/^\d+(px)?$/.test(t))return parseInt(t);if(n){var r=this.getMeasureElement(n);r.innerHTML="",r.style.width=e.setLength(t);var i=r.offsetWidth;return r.style.width=r.className="",i}return/^\d+em$/.test(t)?14*parseInt(t):isNaN(t)?0:parseInt(t)}},{key:"getMeasureElement",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$t.body,r=Yt.getComputedStyle(t),i=n.offScreenDiv=n.offScreenDiv||e.createElement({parent:n,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},!0)[1];return en.forEach((function(e){i.style[e]!==r[e]&&(i.style[e]=r[e])})),i.className=t.className,i.parentElement.parentElement!==n&&n.appendChild(i.parentElement),i}},{key:"sync",value:function(e,t){if("string"==typeof e){if(""===e)return void(t.innerHTML="");e=this.createElementFromTemplate(e)}return this.performSync(e,t),t}},{key:"performSync",value:function(e,t){return e.outerHTML!==t.outerHTML&&(this.syncAttributes(e,t),this.syncContent(e,t),this.syncChildren(e,t),!0)}},{key:"getSyncAttributes",value:function(e){for(var t={},n=[],r=0;r<e.attributes.length;r++){var i=e.attributes[r];if(i.specified){var o=i.name.toLowerCase();t[o]=i.value,n.push(o)}}return{attributes:t,names:n}}},{key:"syncAttributes",value:function(e,t){var n=this.getSyncAttributes(e),r=n.attributes,i=n.names,o=this.getSyncAttributes(t),a=o.attributes,s=o.names,l=i.includes("dataset"),c=i.filter((function(e){return!s.includes(e)})),u=s.filter((function(e){return!(i.includes(e)||l&&e.startsWith("data-"))})),d=i.filter((function(e){return s.includes(e)}));if(c.length>0)for(var f=0;f<c.length;f++){var h=c[f];"style"===h?this.applyStyle(t,r.style,!0):"dataset"===h?Object.assign(t.dataset,r.dataset):t.setAttribute(h,r[h])}if(u.length>0)for(var g=0;g<u.length;g++)t.removeAttribute(u[g]);if(d.length>0)for(var v=0;v<d.length;v++){var p=d[v];if("style"===p)this.applyStyle(t,r.style,!0);else if("dataset"===p)Object.assign(t.dataset,r.dataset);else if("class"!==p||!r.class.isDomClassList&&"object"!==re()(r.class))a[p]!==r[p]&&t.setAttribute(p,r[p]);else{var y=void 0;(y=r.class.isDomClassList?r.class:new bt(r.class)).isEqual(a.class)||t.setAttribute("class",y)}}}},{key:"syncContent",value:function(e,t){0===e.childElementCount&&(t.innerText=e.innerText)}},{key:"setInnerText",value:function(e,t){var n=e.firstChild;n?n.data=t:e.textContent=t}},{key:"syncChildren",value:function(e,t){for(var n=Kt.call(e.childNodes),r=Kt.call(t.childNodes);n.length;){var i=n.shift(),o=r.shift();if(i&&i.nodeType!==Node.TEXT_NODE&&i.nodeType!==Node.ELEMENT_NODE)throw new Error("Source node type ".concat(i.nodeType," not supported by DomHelper.sync()"));if(o&&o.nodeType!==Node.TEXT_NODE&&o.nodeType!==Node.ELEMENT_NODE)throw new Error("Target node type ".concat(o.nodeType," not supported by DomHelper.sync()"));if(o)if(i.nodeType===o.nodeType)i.nodeType===Node.TEXT_NODE?o.data=i.data:i.tagName===o.tagName?this.performSync(i,o):(t.insertBefore(i,o),o.remove());else{if(i.nodeType!==Node.TEXT_NODE||o.nodeType!==Node.ELEMENT_NODE)throw new Error("Currently no support for transforming nodeType");t.innerText=i.data.trim()}else t.appendChild(i)}r.forEach((function(e){e.remove()}))}},{key:"syncClassList",value:function(e,t){var n,r=e.classList,i="string"==typeof t,o=i?t.trim().split(zt):Array.isArray(t)?t:mt.getTruthyKeys(t),a=o.length,s=r.length!==a;for(n=0;!s&&n<a;n++)s=!r.contains(o[n]);s&&(e.className=i?t:o.join(" "))}},{key:"setTheme",value:function(t){t=t.toLowerCase();var n=this.themeInfo.name.toLowerCase(),r=document.head.querySelector("#bryntum-theme:not([data-loading])")||document.head.querySelector('[href$="'.concat(n,'.css"]:not([data-loading])'));if(e.removeEachSelector(document.head,"#bryntum-theme[data-loading]"),!r||!r.href.includes("".concat(n,".css")))throw new Error("Theme link for ".concat(n," not found"));return r.href.includes(t)?Jt:new Promise((function(n,i){var o=document.createElement("link"),a=r.nextSibling,s=e.themeInfo.name.toLowerCase(),l={theme:t,prev:s};o.rel="stylesheet",o.id="bryntum-theme",o.addEventListener("load",(function(){delete o.dataset.loading,Lt=null,r.remove(),window.bryntum.GlobalEvents.trigger("theme",l),n(l)})),o.addEventListener("error",(function(e){delete o.dataset.loading,i(e)})),o.dataset.loading="true",o.href=r.href.replace(s,t),a.parentNode.insertBefore(o,a)}))}},{key:"isOrphaned",value:function(e){return e!==document.body&&e!==document.documentElement&&e.nodeType===Node.ELEMENT_NODE&&null===e.offsetParent}},{key:"activeElement",get:function(){for(var e=document.activeElement;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}},{key:"scrollBarWidth",get:function(){if(null===_t&&$t.body){var t=e.createElement({parent:$t.body,style:"position:absolute;top:-999px;width:100px;height:100px;overflow:scroll"});_t=t.offsetWidth-t.clientWidth,t.remove()}return _t}},{key:"themeInfo",get:function(){if(!Lt){var e=this.createElement({parent:document.body,className:"b-theme-info"}),t=this.getStyleValue(e,"content",!1,":before");if(t)try{Lt=JSON.parse(t.replace(/^["']|["']$|\\/g,""))}catch(e){Lt=null}e.remove()}return Lt}}]),e}(),an=function(){return on.isTouchEvent=!1},sn=function(){on.isTouchEvent=!0,clearTimeout(At),At=setTimeout(an,400)};if($t.addEventListener("touchstart",sn,!0),$t.addEventListener("touchend",sn,!0),on.supportsTemplate="content"in $t.createElement("template"),!("children"in Node.prototype)){var ln=function(e){return 1===e.nodeType};Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,ln)}})}(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}),Yt.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(e){var t=this;if(!$t.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}:Node.prototype.closest=function(e){return this.parentNode.closest(e)},[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),SVGElement.prototype.contains||(SVGElement.prototype.contains=function(e){do{if(this===e)return!0;e=e.parentNode}while(e);return!1}),"function"!=typeof Yt.CustomEvent)&&(Yt.CustomEvent=Ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0};return(It=$t.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),It},Ft.prototype=Yt.Event.prototype,Yt.MouseEvent=Ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0};return(It=$t.createEvent("MouseEvents")).initMouseEvent(e,t.bubbles,t.cancelable,$t.defaultView||Yt,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,document),It},Ft.prototype=Yt.Event.prototype,Yt.KeyboardEvent=Ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0},n="".concat(t.shiftKey?"Shift ":"").concat(t.ctrlKey?"Control":"");return(It=$t.createEvent("KeyboardEvent")).initKeyboardEvent(e,t.bubbles,t.cancelable,$t.defaultView||Yt,t.key,t.location,n,!1,""),It},Ft.prototype=Yt.Event.prototype);if(!Object.getOwnPropertyDescriptor(SVGElement.prototype,"dataset")||!Object.getOwnPropertyDescriptor(SVGElement.prototype,"dataset").get){var cn={enumerable:!0,get:function(){var e,t,n,r,i,o={},a=this.attributes,s=a.length,l=function(e){return e.charAt(1).toUpperCase()},c=function(){return this},u=function(e,t){return void 0!==t?this.setAttribute(e,t):this.removeAttribute(e)};for(e=0;e<s;e++)(i=a[e])&&i.name&&/^data-\w[\w-]*$/.test(i.name)&&(t=i.value,r=(n=i.name).substr(5).replace(/-./g,l),Object.defineProperty(o,r,{enumerable:this.enumerable,get:c.bind(t||""),set:u.bind(this,n)}));return o}};Object.defineProperty(SVGElement.prototype,"dataset",cn)}var un=DOMTokenList.prototype.add,dn=DOMTokenList.prototype.remove;DOMTokenList.prototype.add=function(e){Array.isArray(e)?un.call.apply(un,[this].concat(Z()(e))):un.call.apply(un,[this].concat(Array.prototype.slice.call(arguments)))},DOMTokenList.prototype.remove=function(e){Array.isArray(e)?dn.call.apply(dn,[this].concat(Z()(e))):dn.call.apply(dn,[this].concat(Array.prototype.slice.call(arguments)))},on._$name="DomHelper";var fn=["border-top-width","border-right-width","border-bottom-width","border-left-width"],hn=["padding-top","padding-right","padding-bottom","padding-left"],gn="border-top-width",vn="border-right-width",pn="border-bottom-width",yn="border-left-width",mn="padding-top",bn="padding-right",kn="padding-bottom",wn="padding-left",Sn=Object.freeze({x:0,y:0}),Cn=/^([trblc])(\d*)-([trblc])(\d*)$/i,Rn=/^([trblc])(\d*)$/i,xn=["top","right","bottom","left"],En={t:0,r:1,b:2,l:3},Dn=["b-t","l-r","t-b","r-l"],Tn=Object.freeze([0,0]),Mn=["width","height"];function An(e){return"".concat(xn[(En[e.myEdge]+2)%4][0]).concat(e.myOffset,"-").concat(xn[(En[e.targetEdge]+2)%4][0]).concat(e.targetOffset)}var In=function(){function e(t,n,r,i){D()(this,e);this._x=t,this._y=n,this._width=r,this._height=i}return M()(e,[{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.devicePixelRatio/2||1,t=this;return t._x=mt.roundTo(t._x,e),t._y=mt.roundTo(t._y,e),t._width=mt.roundTo(t._width,e),t._height=mt.roundTo(t._height,e),t}},{key:"$name",get:function(){return this.constructor.$name}}],[{key:"from",value:function(t,n,r){if(t instanceof e)return t;if(void 0===r&&"boolean"==typeof n&&(r=n,n=null),n){var i=n,o=i.scrollLeft,a=i.scrollTop;(Re.isEdge||Re.isSafari)&&n===document.body&&(o=a=0),n=e.from(n).translate(-o,-a)}else n=Sn;var s=t===document||t===window,l=s?new e(0,0,window.innerWidth,window.innerHeight):t.getBoundingClientRect(),c=r||s?[0,0]:[window.pageXOffset,window.pageYOffset];return new e(l.left+c[0]-n.x,l.top+c[1]-n.y,l.width,l.height)}},{key:"inner",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.from(e,t,n);if(document.body.contains(e)){var i=on.getStyleValue(e,fn);r.x+=parseInt(i[yn]),r.y+=parseInt(i[gn]),r.right-=parseInt(i[vn]),r.bottom-=parseInt(i[pn])}return r}},{key:"content",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.from(e,t,n);if(document.body.contains(e)){var i=on.getStyleValue(e,fn),o=on.getStyleValue(e,hn);r.x+=parseInt(i[yn])+parseInt(o[wn]),r.y+=parseInt(i[gn])+parseInt(o[mn]),r.right-=parseInt(i[vn])+parseInt(o[bn]),r.bottom-=parseInt(i[pn])+parseInt(o[kn])}return r}},{key:"client",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.content(e,t,r),o=on.scrollBarWidth;return o&&(e.scrollHeight>e.clientHeight&&"hidden"!==on.getStyleValue(e,"overflow-y")&&(n=parseInt(on.getStyleValue(e,"padding-right")),i.right+=n-Math.max(n,o)),e.scrollWidth>e.clientWidth&&"hidden"!==on.getStyleValue(e,"overflow-x")&&(n=parseInt(on.getStyleValue(e,"padding-bottom")),i.bottom+=n-Math.max(n,o))),i}},{key:"union",value:function(){var t,n=arguments.length<=0?void 0:arguments[0],r=n.x,i=n.y,o=n.right,a=n.bottom;if(arguments.length>1)for(var s=1;s<arguments.length;s++)(t=s<0||arguments.length<=s?void 0:arguments[s]).x<r&&(r=t.x),t.y<i&&(i=t.y),t.right>o&&(o=t.right),t.bottom>a&&(a=t.bottom);return new e(r,i,o-r,a-i)}},{key:"$name",get:function(){return Object.prototype.hasOwnProperty.call(this,"_$name")&&this._$name||this.name}}]),M()(e,[{key:"clone",value:function(){var t=this,n=new e(t.x,t.y,t.width,t.height);return n.minHeight=t.minHeight,n.minWidth=t.minWidth,n}},{key:"contains",value:function(t){return t instanceof e&&(t._x>=this._x&&t._y>=this._y&&t.right<=this.right&&t.bottom<=this.bottom)}},{key:"intersect",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this,o=Math.max(i.y,t.y),a=Math.min(i.right,t.right),s=Math.min(i.bottom,t.bottom),l=Math.max(i.x,t.x),c=r?s>=o&&a>=l:s>o&&a>l;return!!c&&(!!n||new e(l,o,a-l,s-o))}},{key:"equals",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n?function(e){return Math.round(e)}:function(e){return e};return t instanceof e&&r(t.x)===r(this.x)&&r(t.y)===r(this.y)&&r(t.width)===r(this.width)&&r(t.height)===r(this.height)}},{key:"translate",value:function(e,t){return this._x+=e||0,this._y+=t||0,this}},{key:"moveTo",value:function(e,t){return null!=e&&(this._x=e),null!=t&&(this._y=t),this}},{key:"getDelta",value:function(e){return[e.x-this.x,e.y-this.y]}},{key:"adjust",value:function(e,t,n,r){var i=this;return i.x+=e,i.y+=t,i.width+=n,i.height+=r,i}},{key:"inflate",value:function(e){return this.adjust(-e,-e,e,e)}},{key:"constrainTo",value:function(e,t){var n=this,r=n.height,i=n.y,o=n.minWidth||n.width,a=n.minHeight||n.height;if(n.height>=e.height){if(t&&a>e.height)return!1;n._y=e.y,n.height=e.height}if(n.width>=e.width){if(t&&o>e.width)return n.y=i,n.height=r,!1;n._x=e.x,n.width=e.width}var s=n.bottom-e.bottom;return s>0&&n.translate(0,-s),(s=n.right-e.right)>0&&n.translate(-s),(s=e.y-n.y)>0&&n.translate(0,s),(s=e.x-n.x)>0&&n.translate(s),n}},{key:"alignTo",value:function(t){var n,r,i,o,a=this.clone(),s=t.target,l=t.constrainTo;!s||s instanceof e||(s=e.from(s.element?s.element:s)),!l||l instanceof e||(o=l===window||l===document,l=e.from(l.element?l.element:l,null,t.ignorePageScroll),t.constrainPadding&&l.inflate(-t.constrainPadding));var c,u=this,d=null==(c=t.offset)?Tn:"number"==typeof c?[c,c]:c,f=t.align,h=t.axisLock,g=t.anchorSize,v=t.anchorPosition,p=function(e){var t=Cn.exec(e),n=parseInt(t[2]||50),r=parseInt(t[4]||50);return{myAlignmentPoint:t[1]+n,myEdge:t[1],myOffset:n,targetAlignmentPoint:t[3]+r,targetEdge:t[3],targetOffset:r,startZone:En[t[3]]}}(f),y=t.position||(s&&"Point"===s.$name?s:null),m=l&&l.clone(),b=[],k=[{zone:r=p.startZone,align:f}],w=t.matchSize&&Mn[1&p.startZone],S=u[w];if(w&&h&&(a[w]=s[w]),l&&a.constrainTo(l),l&&null!=p.startZone)if(h)k.push({zone:r=(r+2)%4,align:An(p)}),"flexible"===h&&(k.push({zone:r=(p.startZone+1)%4,align:Dn[r]}),k.push({zone:r=(r+2)%4,align:Dn[r]}));else for(var C=1;C<4;C++)k.push({zone:r=(r+1)%4,align:Dn[r]});if(v){var R,x=1&p.startZone?"y":"x";R={},oe()(R,x,v[x]),oe()(R,"edge",xn[(p.startZone+2)%4]),n=R}if(m&&s&&(m.adjust(-s.width,-s.height,s.width,s.height),s.constrainTo(m)),a.minWidth=u.minWidth,a.minHeight=u.minHeight,y)a.moveTo(y.x,y.y),l&&a.constrainTo(l);else{var E=g?[g[1]+d[0],g[1]+d[1]]:d,D=s.getAlignmentPoint(p.targetAlignmentPoint,E),T=a.getAlignmentPoint(p.myAlignmentPoint);if(a.translate(D[0]-T[0],D[1]-T[1]),a.intersect(s,!0))l&&a.constrainTo(l),i=p.startZone;else if(l&&!l.contains(a)){var M,A,I=a.clone(),F=[];n=null,b[0]=M=l.clone(),M.bottom=s.y-E[1],b[1]=M=l.clone(),M.x=s.right+E[0],b[2]=M=l.clone(),M.y=s.bottom+E[1],b[3]=M=l.clone(),M.right=s.x-E[0];for(var O=0;O<k.length;O++){if(w&&2==O&&(a[w]=S),M=b[i=k[O].zone],(a=a.alignTo({target:s,offsets:E,align:k[O].align})).constrainTo(M,!0)&&(F.push({result:a,zone:i}),!A||a.width<u.width||a.height<u.height)){a.align=k[O].align;break}if(!A||M.area>A.area){var _=a.clone();switch(i){case 0:_.moveTo(null,M.bottom-_.height);break;case 1:_.moveTo(M.left);break;case 2:_.moveTo(null,M.top);break;case 3:_.moveTo(M.right-_.width)}A={area:M.area,result:_,zone:i}}}F.length?(F.length>1&&!h&&F.sort((function(e,t){return Math.sqrt(Math.pow(I.x-e.result.x,2)+Math.pow(I.y-e.result.y,2))-Math.sqrt(Math.pow(I.x-t.result.x,2)+Math.pow(I.y-t.result.y,2))})),a=F[0].result,i=F[0].zone):(a=A.result,i=A.zone,o&&a.constrainTo(l))}else i=p.startZone;if(a.zone=i,g){if(!n){var P,L=1&i,H=L?"y":"x",j=L?"bottom":"right",B=Math.max(s[H],a[H]),N=B+(Math.min(s[j],a[j])-B)/2-g[0]/2,z=N+g[0];z>a[j]&&(N-=z-a[j]),N<a[H]&&(N+=a[H]-N),P={},oe()(P,H,N-a[H]),oe()(P,"edge",xn[(i+2)%4]),n=P}a.anchor=n}}return a}},{key:"getAlignmentPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tn,n=this,r=Rn.exec(e),i=r[1].toLowerCase(),o=Math.min(Math.max(parseInt(r[2]||50),0),100)/100;switch(i){case"t":return[n.x+n.width*o,n.y-t[1]];case"r":return[n.right+t[0],n.y+n.height*o];case"b":return[n.x+n.width*o,n.bottom+t[1]];case"l":return[n.x-t[0],n.y+n.height*o];case"c":var a=n.center;return[a.x+t[0],a.y+t[1]]}}},{key:"highlight",value:function(){var e=on.createElement({parent:document.body,style:"position:absolute;z-index:9999999;pointer-events:none;\n                            left:".concat(this.x,"px;top:").concat(this.y,"px;width:").concat(this.width,"px;height:").concat(this.height,"px")});return on.highlight(e).then((function(){return e.remove()}))}},{key:"center",get:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2)}},{key:"x",set:function(e){var t=e-this._x;this._x=e,this._width-=t},get:function(){return this._x}},{key:"left",set:function(e){this.x=e},get:function(){return this.x}},{key:"top",set:function(e){this.y=e},get:function(){return this.y}},{key:"y",set:function(e){var t=e-this._y;this._y=e,this._height-=t},get:function(){return this._y}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}},{key:"right",set:function(e){this._width=e-this._x},get:function(){return this._x+this._width}},{key:"bottom",set:function(e){this._height=e-this._y},get:function(){return this._y+this._height}},{key:"area",get:function(){return this.width*this.height}},{key:"minWidth",set:function(e){var t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.width=Math.max(t.width,t._minWidth))},get:function(){return this._minWidth}},{key:"minHeight",set:function(e){var t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.height=Math.max(t.height,t._minHeight))},get:function(){return this._minHeight}}]),e}();function Fn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}In._$name="Rectangle";var On=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Fn()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(e,t){return D()(this,r),n.call(this,e,t,0,0)}return M()(r,null,[{key:"from",value:function(e){var t=e.changedTouches;return new r(t?t[0].screenX:e.screenX,t?t[0].screenY:e.pageY)}}]),M()(r,[{key:"constrain",value:function(e){return this.x=Math.min(Math.max(this.x,e.x),e.right-1),this.y=Math.min(Math.max(this.y,e.y),e.bottom-1),this}},{key:"toArray",value:function(){return[this.x,this.y]}}]),r}(In);On.__proto__.Point=On,On._$name="Point";var _n=function(){function e(){D()(this,e)}return M()(e,null,[{key:"curry",value:function(e){return function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.length>=e.length?e.apply(this,r):function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,r.concat(n))}}}},{key:"bindAll",value:function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=e[t].bind(e))}},{key:"createInterceptor",value:function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return!1!==t.call.apply(t,[n].concat(i))&&e.call.apply(e,[n].concat(i))}}},{key:"createSequence",value:function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=e.call.apply(e,[n].concat(i)),s=t.call.apply(t,[n].concat(i));return void 0===s?a:s}}},{key:"createThrottled",value:function(e,t,n,r,i){var o,a,s,l=0,c=function(){a=0,l=performance.now(),o.push.apply(o,r),e.apply(n,o)};return(s=function(){for(var e=performance.now()-l,s=arguments.length,u=new Array(s),d=0;d<s;d++)u[d]=arguments[d];o=u,e>=t?(clearTimeout(a),c()):(a||(a=setTimeout(c,t-e)),i&&(o.push.apply(o,r),i.apply(n,o)))}).cancel=function(){return clearTimeout(a)},s}},{key:"createBuffered",value:function(e,t,n,r){var i,o,a,s=function(){o=0,i.push.apply(i,r),e.apply(n,i)};return(a=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];i=n,o&&clearTimeout(o),o=setTimeout(s,t)}).cancel=function(){return clearTimeout(o)},a}},{key:"returnTrue",value:function(){return!0}},{key:"animate",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"linear",o=!1,a=new Promise((function(a){var s=performance.now();!function l(){var c=Math.min((performance.now()-s)/e,1),u=n&&n.setTimeout?n:window;o||!1===t.call(n,r.easingFunctions[i](c))&&a(),o||1===c?u.requestAnimationFrame((function(){return a()})):u.requestAnimationFrame(l)}()}));return a.cancel=function(){return o=!0,!1},a}}]),e}(),Pn=1.70158,Ln=7.5625,Hn=1.525,jn=2/2.75,Bn=2.25/2.75,Nn=1/2.75,zn=1.5/2.75,Vn=2.5/2.75,Wn=2.625/2.75,Un=.984375;_n.easingFunctions={linear:function(e){return e},easeInQuad:function(e){return Math.pow(e,2)},easeOutQuad:function(e){return-(Math.pow(e-1,2)-1)},easeInOutQuad:function(e){return(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2)},easeInCubic:function(e){return Math.pow(e,3)},easeOutCubic:function(e){return Math.pow(e-1,3)+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},easeInQuart:function(e){return Math.pow(e,4)},easeOutQuart:function(e){return-(Math.pow(e-1,4)-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeInQuint:function(e){return Math.pow(e,5)},easeOutQuint:function(e){return Math.pow(e-1,5)+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2)},easeInSine:function(e){return 1-Math.cos(e*(Math.PI/2))},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeOutBounce:function(e){return e<Nn?Ln*e*e:e<jn?Ln*(e-=zn)*e+.75:e<Vn?Ln*(e-=Bn)*e+.9375:Ln*(e-=Wn)*e+Un},easeInBack:function(e){return e*e*((Pn+1)*e-Pn)},easeOutBack:function(e){return(e-=1)*e*((Pn+1)*e+Pn)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=Hn))*e-t)*.5:.5*((e-=2)*e*((1+(t*=Hn))*e+t)+2)},elastic:function(e){return-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1},swingFromTo:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=Hn))*e-t)*.5:.5*((e-=2)*e*((1+(t*=Hn))*e+t)+2)},swingFrom:function(e){return e*e*((Pn+1)*e-Pn)},swingTo:function(e){return(e-=1)*e*((Pn+1)*e+Pn)+1},bounce:function(e){return e<Nn?Ln*e*e:e<jn?Ln*(e-=zn)*e+.75:e<Vn?Ln*(e-=Bn)*e+.9375:Ln*(e-=Wn)*e+Un},bouncePast:function(e){return e<Nn?Ln*e*e:e<jn?2-(Ln*(e-=zn)*e+.75):e<Vn?2-(Ln*(e-=Bn)*e+.9375):2-(Ln*(e-=Wn)*e+Un)},easeFromTo:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeFrom:function(e){return Math.pow(e,4)},easeTo:function(e){return Math.pow(e,.25)}},_n._$name="FunctionHelper";var Gn=["clientX","clientY","pageX","pageY","screenX","screenY"],Yn={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1},$n={get:function(){return!0}},qn={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},Xn=function(e){var t=e.type;if(t.startsWith("key")){var n=qn[e.key];n&&Object.defineProperty(e,"key",{get:function(){return n}})," "!==e.key||e.code||Object.defineProperty(e,"code",{get:function(){return"Space"}})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",$n),e.target&&e.target.shadowRoot&&e.composedPath&&!Re.isIE11&&!Re.isEdge){var r=e.composedPath()[0],i=e.target;e.target!==r&&(Object.defineProperty(e,"target",{get:function(){return r}}),Object.defineProperty(e,"originalTarget",{get:function(){return i}}))}if(Re.isChrome&&e.target){var o=e.target,a=e.offsetX,s=e.offsetY,l=o.offsetWidth,c=o.offsetHeight,u=Math.min(Math.max(a,0),l-1),d=Math.min(Math.max(s,0),c-1);!Object.getOwnPropertyDescriptor(e,"offsetX")&&(a<0||a>=l)&&Object.defineProperty(e,"offsetX",{get:function(){return u}}),!Object.getOwnPropertyDescriptor(e,"offsetY")&&(s<0||s>=c)&&Object.defineProperty(e,"offsetY",{get:function(){return d}})}if(e.target&&9===e.target.nodeType&&"clientX"in e){var f=on.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{get:function(){return f}})}if(e.target&&3===e.target.nodeType){var h=e.target.parentElement;Object.defineProperty(e,"target",{get:function(){return h}})}if(e.relatedTarget&&3===e.relatedTarget.nodeType){var g=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{get:function(){return g}})}return t.startsWith("touch")&&e.touches.length&&Kn.normalizeEvent(e),e},Kn=function(){function e(){D()(this,e)}return M()(e,null,[{key:"normalizeEvent",value:function(e){return mt.copyPropertiesIf(e,e.touches[0]||e.changedTouches[0],Gn)}},{key:"getXY",value:function(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}},{key:"getDistanceBetween",value:function(e,t){var n=this.getXY(e),r=this.getXY(t);return Math.sqrt(Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2))}},{key:"getPagePoint",value:function(e){return new On(e.pageX,e.pageY)}},{key:"getClientPoint",value:function(e){return new On(e.clientX,e.clientY)}},{key:"addListener",value:function(e,t,n,r){return r=e.nodeType?"string"==typeof t?Object.assign(oe()({element:e},t,n),r):Object.assign({element:e},t):e,this.on(r)}},{key:"on",value:function(e){var t,n,r=e.element,i=e.thisObj,o=[],a=mt.allKeys(e),s=a.length;for(t=0;t<s;t++)if(n=a[t],!Yn[n]){var l=e[n];"object"!==re()(l)&&(l={handler:l});var c=l.element||r;Re.isTouchDevice&&!Re.isAndroid&&"contextmenu"===n&&o.push(this.addElementListener(c,"touchstart",{handler:this.createContextMenuWrapper(l.handler,l.thisObj||i)},e)),o.push(this.addElementListener(c,n,l,e))}var u=function(){for(s=o.length,t=0;t<s;t++){var e=o[t];e[0].removeEventListener(e[1],e[2],e[3])}o.length=0};return i&&!1!==e.autoDetach&&(i.doDestroy=_n.createInterceptor(i.doDestroy,u,i)),u}},{key:"addElementListener",value:function(e,t,n,r){var i=this.createHandler(e,t,n,r),o="passive"in n,a=n.expires||r.expires,s=r.thisObj,l=n.capture||r.capture;if((o||"passive"in r)&&Re.supportsPassive&&(l={capture:!!l,passive:o?n.passive:r.passive}),e.addEventListener(t,i,l),a){var c=s&&s.setTimeout?s:window;("number"==typeof a?c.setTimeout:c.requestAnimationFrame).call(c,(function(){return e.removeEventListener(t,i,l)}),a)}return[e,t,i,l]}},{key:"createHandler",value:function(e,t,n,r){var i=this,o=n.delay||r.delay,a=n.throttled||r.throttled,s=n.once||r.once,l=n.thisObj||r.thisObj,c=n.capture||r.capture,u=n.delegate||r.delegate,d=n.handler,f=function(e){var t;if(!(i.playingDemo&&e.isTrusted||l&&l.isDestroyed)){if(Xn(e),u){var n=e.target instanceof HTMLElement&&e.target.closest(u);if(!n)return;Object.defineProperty(e,"currentTarget",{get:function(){return n},configurable:!0})}"string"==typeof d&&(d=l[d]);for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];(t=d).call.apply(t,[l,e].concat(o))}};if(null!=o){var h=f,g=l&&l.setTimeout?l:window;f=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];g.setTimeout((function(){h.apply(void 0,t)}),o)}}if(null!=a){var v,p=a;a.buffer&&(v=function(e){return a.alt.call(i,Xn(e))},p=a.buffer),f=l&&l.isDelayable?l.throttle(f,p,l,null,v):_n.createThrottled(f,p,l,null,v)}if(s){var y=f;f=function(){e.removeEventListener(t,f,c),y.apply(void 0,arguments)}}return n.thisObj&&!1!==n.autoDetach&&(l.doDestroy=_n.createInterceptor(l.doDestroy,(function(){return e.removeEventListener(t,f)}),l)),f}},{key:"onTransitionEnd",value:function(t){var n,r=t.element,i=t.property,o=t.handler,a=t.timeout,s=t.thisObj,l=void 0===s?window:s,c=e.on({element:r,thisObj:l,transitionend:function(e){e.propertyName===i&&(n&&(l.isDelayable?l.clearTimeout(n):clearTimeout(n),n=null),c(),o.call(l))}});null==a&&(a=on.getPropertyTransitionDuration(r,i)),null!=a&&(n=l.isDelayable?l.setTimeout((function(){c(),o.call(l)}),a):setTimeout((function(){c(),o.call(l)}),a))}},{key:"createContextMenuWrapper",value:function(e,t){var n=this;return function(r){if(1===r.touches.length)var i=r.touches[0],o=setTimeout((function(){s();var o=new MouseEvent("contextmenu",i);Object.defineProperty(o,"target",{get:function(){return i.target}}),"string"==typeof e&&(e=t[e]),o.browserEvent=r,e.call(t,o),n.contextMenuTouchId=i.identifier}),n.longPressTime),a=function(){n.contextMenuTouchId=null,s(),clearTimeout(o)},s=n.on({element:document,touchmove:a,touchend:a,pointermove:a,pointerup:a,capture:!0})}}},{key:"createDblClickWrapper",value:function(e,t,n){var r,i,o,a=this;return function(){i||(i=a.on({element:e,touchstart:function(e){r=e.changedTouches[0].identifier,e.preventDefault()},touchend:function(e){if(e.changedTouches[0].identifier===r){e.preventDefault(),clearTimeout(o),r=i=null;var a=In.from(e.changedTouches[0].target,null,!0),s=e.changedTouches[0].pageX-a.x,l=e.changedTouches[0].pageY-a.y,c=Object.assign({browserEvent:e},e),u=new MouseEvent("dblclick",c);Object.defineProperty(u,"target",{get:function(){return e.target}}),Object.defineProperty(u,"offsetX",{get:function(){return s}}),Object.defineProperty(u,"offsetY",{get:function(){return l}}),"string"==typeof t&&(t=n[t]),t.call(n,u)}},once:!0}),o=setTimeout((function(){i(),r=i=null}),a.dblClickTime))}}},{key:"lockComposedPath",value:function(e){var t;e.composedPath&&(e.composedPath=(t=e.composedPath(),function(){return t}))}}]),e}();function Jn(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qn(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Kn.longPressTime=500,Kn.dblClickTime=300,Kn.on({element:document,mousedown:function(){on.isTouchEvent||(on.usingKeyboard=!1,document.body.classList.remove("b-using-keyboard"))},touchmove:function(){on.usingKeyboard=!1,document.body.classList.remove("b-using-keyboard")},keydown:function(){on.usingKeyboard=!0,document.body.classList.add("b-using-keyboard")}}),Re.isTouchDevice&&Kn.on({element:document,touchmove:function(e){e.target.closest(".b-dragging")&&e.preventDefault()},passive:!1,capture:!0}),Kn._$name="EventHelper";var Zn=null,er=[],tr=function(e){return 1===e.nodeType&&"absolute"===e.ownerDocument.defaultView.getComputedStyle(e).getPropertyValue("position")},nr=function(){function e(){D()(this,e)}return M()(e,null,[{key:"addResizeListener",value:function(e,t){var n=this;if(e!==document&&e!==window||(e=document.body),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)n.hasWindowResizeListener||(window.addEventListener("resize",n.onWindowResize),n.hasWindowResizeListener=!0);else if(window.ResizeObserver)n.resizeObserver||(n.resizeObserver=new ResizeObserver(n.onElementResize)),n.resizeObserver.observe(e);else{var r=on.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},!0),i=te()(r,3),o=i[0],a=i[1],s=i[2];a.scrollLeft=a.scrollTop=s.scrollLeft=s.scrollTop=1e6,a.addEventListener("scroll",n.onSizeMonitorScroll,!0),s.addEventListener("scroll",n.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver((function(e){var t,n=[],r=Jn(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;"childList"===i.type&&(n.push.apply(n,i.removedNodes),n.push.apply(n,i.addedNodes))}}catch(e){r.e(e)}finally{r.f()}n.length>0&&n.every(tr)||a.dispatchEvent(new CustomEvent("scroll",{bubbles:!1}))}))).observe(e,{childList:!0,subtree:!0}),t.monitorElement=o}e._bResizemonitor.handlers.push(t)}},{key:"removeResizeListener",value:function(e,t){if(e){e!==document&&e!==window||(e=document.body);var n=e._bResizemonitor,r=0;n&&n.handlers&&(ue.remove(n.handlers,t),r=n.handlers.length),r||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}},{key:"onElementResize",value:function(e){var t,n=Jn(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.target,o=i._bResizemonitor,a=r.contentRect||i.getBoundingClientRect();if(i.offsetParent&&(!o.rectangle||a.width!==o.rectangle.width||a.height!==o.rectangle.height)){var s=o.rectangle;o.rectangle=a;var l,c=Jn(o.handlers);try{for(c.s();!(l=c.n()).done;){(0,l.value)(i,s,a)}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){n.e(e)}finally{n.f()}}},{key:"onSizeMonitorScroll",value:function(t){if(document.body.contains(t.target)){t.stopImmediatePropagation();var n=t.target.parentNode,r=n.parentNode,i=r._bResizemonitor,o=r.getBoundingClientRect();i.rectangle&&o.width===i.rectangle.width&&o.height===i.rectangle.height||(er.push([r,i.rectangle,o]),i.rectangle=o,Zn||(Zn=requestAnimationFrame(e.fireResizeEvents))),n.firstChild.scrollLeft=n.firstChild.scrollTop=n.childNodes[1].scrollTop=n.childNodes[1].scrollLeft=1e6}}},{key:"onWindowResize",value:function(e){var t=document.body,n=t._bResizemonitor,r=n.rectangle;n.rectangle=document.documentElement.getBoundingClientRect();var i,o=Jn(n.handlers);try{for(o.s();!(i=o.n()).done;){(0,i.value)(t,r,n.rectangle)}}catch(e){o.e(e)}finally{o.f()}}},{key:"fireResizeEvents",value:function(){var e,t=Jn(er);try{for(t.s();!(e=t.n()).done;){var n,r=e.value,i=Jn(r[0]._bResizemonitor.handlers);try{for(i.s();!(n=i.n()).done;){var o=n.value;r[0].offsetParent&&o.apply(this,r)}}catch(e){i.e(e)}finally{i.f()}}}catch(e){t.e(e)}finally{t.f()}Zn=null,er.length=0}}]),e}();nr._$name="ResizeMonitor";n(68),n(87),n(69),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(88),n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(102),n(103);function rr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ir=null;j.isTestEnv&&(ir=window.bryntum.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,isEmpty:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ir.timeouts.size+ir.animationFrames.size+(e?ir.intervals.size:0)===0}});var or=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(rr()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"doDestroy",value:function(){var e=this;e.timeoutIds&&(e.timeoutIds.forEach((function(e,t){"function"==typeof e&&e(),clearTimeout(t),ir&&ir.timeouts.delete(t)})),e.timeoutIds=null),e.timeoutMap&&(e.timeoutMap.forEach((function(e,t){return clearTimeout(t)})),e.timeoutMap=null),e.intervalIds&&(e.intervalIds.forEach((function(e){clearInterval(e),ir&&ir.intervals.delete(e)})),e.intervalIds=null),e.animationFrameIds&&(e.animationFrameIds.forEach((function(e){cancelAnimationFrame(e),ir&&ir.animationFrames.delete(e)})),e.animationFrameIds=null),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"hasTimeout",value:function(e){return!(!this.timeoutMap||!this.timeoutMap.has(e))}},{key:"setTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.fn,n=e.delay,r=e.name,i=e.runOnDestroy,o=e.cancelOutstanding,a=e.args;if(arguments.length>1||"function"==typeof arguments[0]){var s=Array.prototype.slice.call(arguments);t=s[0],n=s[1],r=s[2],i=s[3]}"string"==typeof t?r=t:r||(r=t.name),o&&this.clearTimeout(r);var l=this,c=l.timeoutIds||(l.timeoutIds=new Map),u=l.timeoutMap||(l.timeoutMap=new Map),d=setTimeout((function(){"string"==typeof t&&(t=l[r]),c&&c.delete(d),u&&u.delete(r),ir&&ir.timeouts.delete(d),t.apply(l,a)}),n);return c.set(d,!i||t),ir&&ir.timeouts.set(d,{fn:t,delay:n,name:r}),r&&u.set(r,d),d}))},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e;if("string"==typeof t){if(!this.timeoutMap)return;t=this.timeoutMap.get(e),this.timeoutMap.delete(e)}clearTimeout(t),this.timeoutIds&&this.timeoutIds.delete(t),ir&&ir.timeouts.delete(t)}))},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){clearInterval(e),this.intervalIds&&this.intervalIds.delete(e),ir&&ir.intervals.delete(e)}))},{key:"setInterval",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var n=setInterval(e,t);return(this.intervalIds||(this.intervalIds=new Set)).add(n),ir&&ir.intervals.set(n,{fn:e,delay:t}),n}))},{key:"requestAnimationFrame",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,r=this.animationFrameIds||(this.animationFrameIds=new Set),i=requestAnimationFrame((function(){return ir&&ir.animationFrames.delete(i),r.delete(i),e.apply(n,t)}));return r.add(i),ir&&ir.animationFrames.set(i,{fn:e,extraArgs:t,thisObj:n}),i}))},{key:"createOnFrame",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,o=arguments.length>3?arguments[3]:void 0,a=function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];t&&o&&(n.cancelAnimationFrame(t),t=null),t||(t=n.requestAnimationFrame((function(){"string"==typeof e&&(e=i[e]),t=null,s.push.apply(s,Z()(r)),e.apply(i,s)})))};return a.cancel=function(){return n.cancelAnimationFrame(t)},a}},{key:"cancelAnimationFrame",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){cancelAnimationFrame(e),this.animationFrameIds&&this.animationFrameIds.delete(e),ir&&ir.animationFrames.delete(e)}))},{key:"buffer",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=null;"string"==typeof e&&(e=r[e]);var o=function o(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];o.called=!1,null!==i&&n.clearTimeout(i),i=n.setTimeout((function(){var t;(t=e).call.apply(t,[r].concat(s)),o.called=!0}),t)};return o.cancel=function(){return n.clearTimeout(i)},o}},{key:"throttle",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,s=this,l=0,c=function(){r=0,l=performance.now(),n.push.apply(n,o),e.apply(i,n),u.called=!0},u=function e(){for(var u=performance.now()-l,d=arguments.length,f=new Array(d),h=0;h<d;h++)f[h]=arguments[h];n=f,u>=t?(s.clearTimeout(r),c()):(r||(r=s.setTimeout(c,t-u),e.called=!1),a&&(n.push.apply(n,o),a.apply(i,n)))};return u.cancel=function(){return s.clearTimeout(r)},u}},{key:"isDelayable",get:function(){return!0}},{key:"widgetClass",get:function(){}}]),r}(e||G)};n(42),n(227),n(228);function ar(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return sr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sr(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function sr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var cr=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(lr()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){"function"==typeof e&&(e={filterBy:e}),se()(J()(r.prototype),"construct",this).call(this,e)}},{key:"onChange",value:function(e){var t=this;!t.isConfiguring&&t.owner&&!t.owner.isConfiguring&&t.owner.onFilterChanged&&t.owner.onFilterChanged(t,e)}},{key:"defaultFilterBy",value:function(e){return this[this.operator](this.convert(e[this.property]))}},{key:"convert",value:function(e){return this.caseSensitive||"string"!=typeof e?e:e.toLowerCase()}},{key:"filter",value:function(e){return this.filterBy(e)}},{key:"startsWith",value:function(e){return String(e).startsWith(this.value)}},{key:"endsWith",value:function(e){return String(e).endsWith(this.value)}},{key:"=",value:function(e){return mt.isEqual(e,this.value)}},{key:"!=",value:function(e){return!mt.isEqual(e,this.value)}},{key:">",value:function(e){return mt.isMoreThan(e,this.value)}},{key:">=",value:function(e){return mt.isMoreThan(e,this.value)||mt.isEqual(e,this.value)}},{key:"<",value:function(e){return mt.isLessThan(e,this.value)}},{key:"<=",value:function(e){return mt.isLessThan(e,this.value)||mt.isEqual(e,this.value)}},{key:"*",value:function(e){return mt.isPartial(e,this.value)}},{key:"id",get:function(){return this._id||(this._id=this.property||we.generateId("b-filter"))},set:function(e){this._id=e}},{key:"filterBy",get:function(){return this._filterBy||this.defaultFilterBy},set:function(e){this._filterBy=e}},{key:"property",set:function(e){this._property=e,this.onChange("property")},get:function(){return this._property}},{key:"value",set:function(e){this._value=this.caseSensitive||"string"!=typeof e?e:e.toLowerCase(),this.onChange("value")},get:function(){return this._value}},{key:"operator",set:function(e){this._operator=e,this.onChange("operator")},get:function(){return this._operator||("string"==typeof this.value?"*":"=")}}],[{key:"generateFiltersFunction",value:function(e){return e&&(e.length||e.count)?function(t){var n,r=!0,i=ar(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.disabled||(r=o.filter(t)),!r)break}}catch(e){i.e(e)}finally{i.f()}return r}:_n.returnTrue}},{key:"defaultConfig",get:function(){return{property:null,value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null}}}]),r}(G);function ur(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}cr._$name="CollectionFilter";var dr=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ur()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){"function"==typeof e&&(e={sortFn:e}),se()(J()(r.prototype),"construct",this).call(this,e)}},{key:"defaultSortFn",value:function(e,t){var n=this.convert,r=this.property,i=this.useLocaleSort,o="desc"===this.direction.toLowerCase()?-1:1;if(e=e[r],t=t[r],n&&(e=n(e),t=n(t)),i&&null!=e&&null!=t){if(!0===i)return String(e).localeCompare(t);if("string"==typeof i)return String(e).localeCompare(t,i);if("object"===re()(i))return String(e).localeCompare(t,i.locale,i)}return(e>t?1:e<t?-1:0)*o}},{key:"id",get:function(){return this._id||(this._id=this.property||we.generateId("b-sorter"))},set:function(e){this._id=e}},{key:"sortFn",set:function(e){this._sortFn=e},get:function(){return this._sortFn?this._sortFn:this.defaultSortFn}}],[{key:"generateSortFunction",value:function(e,t){var n=e.isCollection?e.values:e,r=n.length;return function(e,i){var o,a;for(a=0;a<r;++a)if(o=n[a].sortFn(e,i))return o;return t?t(e,i):0}}},{key:"defaultConfig",get:function(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}}]),r}(G);function fr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}dr._$name="CollectionSorter";var hr=function(){return 0},gr=function(e,t){return t-e},vr=Symbol("filteredIndicesProperty"),pr=Object.freeze([]),yr=Object.freeze({action:"sort",added:pr,removed:pr,replaced:pr}),mr=Object.freeze({action:"filter",added:pr,removed:pr,replaced:pr}),br={string:1,number:1},kr=new WeakMap,wr=function(e){if(e&&"object"===re()(e)){var t=kr.get(e);void 0===t&&(t=Symbol("bscik"),kr.set(e,t)),e=t}return e},Sr=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(fr()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){this.generation=0,this._values=[],se()(J()(r.prototype),"construct",this).call(this,e)}},{key:"doDestroy",value:function(){se()(J()(r.prototype),"doDestroy",this).call(this),this._values.length=0,this.isFiltered&&(this._filteredValues.length=0,this.filters.destroy()),this._sorters&&this._sorters.destroy()}},{key:"clear",value:function(){var e=this,t=this._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}},{key:"replaceValues",value:function(e,t,n){var r,i=this;i.isFiltered&&!n?(r=i._filteredValues,i._filteredValues=e.slice()):(r=i._values,i._values=e,i.isFiltered&&n&&i.autoFilter?(i._filterFunction=null,i._filteredValues=i._values.filter(i.filterFunction),i._indicesInvalid=!0):i._filteredValues&&(i._filteredValues.length=0)),i._indicesInvalid=!0,i.generation++,t||i.trigger("change",{action:"replaceValues",removed:r,values:e,replaced:[]})}},{key:Symbol.iterator,value:function(){return this.values[Symbol.iterator]()}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length?this.splice.apply(this,[this._values.length,null].concat(t)):this.splice(this._values.length,null,t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length?this.splice.apply(this,[0].concat(t)):this.splice(0,t)}},{key:"move",value:function(e,t){var n=this,r=n._values,i=n.indexOf(e,!0),o=t?n.indexOf(t,!0):r.length;if(-1===i||-1===o)throw new Error("Collection move parameters must be present in Collection");return i!==o&&i!==o-1&&(i<o&&o--,r.splice(i,1),r.splice(o,0,e),n._indicesInvalid=!0,n.trigger("change",{action:"move",item:e,from:i,to:o})),o}},{key:"splice",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o,a,s=this,l=s.idProperty,c=s._values,u={},d=[],f=[],h=s.totalCount;if(r)if(1===r.length&&Array.isArray(r[0])&&(r=r[0]),h&&r.length){var g=s.indices[l];o=[];for(var v=0;v<r.length;v++){var p=r[v],y=wr(p[l]),m=g[y];u[y]=!0,null!=m?c[m]!==p&&(f.push([c[m],p]),c[m]=p):o.push(p)}}else o=r;if(t)if("number"==typeof t)for(var b=e;t;--t){var k=wr(c[b][l]);u[k]?(e++,b++):(d.push(c[b]),c.splice(b,1),s._indicesInvalid=a=!0)}else{var w,S=0===o.length;Array.isArray(t)||(t=[t]);var C=t.reduce((function(e,t){var n="number"==typeof t,r=n?t:s.indexOf(t,!0);return S&&(null!=w&&r!==w+1||n)&&(S=!1),r>=0&&r<h&&e.push(r),w=r,e}),[]).sort(gr);if(S)C.length&&(d.push.apply(d,t),c.splice(C[C.length-1],C.length),s._indicesInvalid=a=!0);else for(var R=0;R<C.length;R++){var x=C[R];if(-1!==x){var E=wr(c[x][l]);u[E]||(d.unshift(c[x]),c.splice(x,1),s._indicesInvalid=a=!0)}}}if(o.length&&(c.splice.apply(c,[Math.min(e,c.length),0].concat(Z()(o))),s._indicesInvalid=a=!0),s.isSorted)s.onSortersChanged();else if(s.isFiltered){var D;if(s.autoFilter)s.onFiltersChanged();else(D=s._filteredValues).push.apply(D,Z()(o))}a||f.length?(s.generation++,s.trigger("change",{action:"splice",removed:d,added:o,replaced:f,oldCount:h})):s.trigger("noChange",{index:e,toRemove:t,toAdd:r})}},{key:"changeId",value:function(e,t){var n=this,r=n.idProperty,i=br[re()(e)]?e:e[r],o=n.get(i);if(o){var a=n.get(t);if(a&&o!==a)throw new Error("Attempt to set item ".concat(i," to already existing member's id ").concat(t));if(o[r]=t,!n._indicesInvalid){var s=n.indices.id,l=s[i];delete s[i],s[t]=l}}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getBy(this.idProperty,e,t)}},{key:"getAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}},{key:"getBy",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;if(r.isFiltered&&n){var i=r.findIndex(e,t,!0);if(-1!==i)return r._values[i]}else{var o=r.findIndex(e,t);if(-1!==o)return r.values[o]}}},{key:"addSorter",value:function(e){var t=e instanceof dr?e:new dr(e);return this.sorters.add(t),t}},{key:"onSortersChanged",value:function(){var e=this;delete e._sortFunction,e._values.sort(e.sortFunction),e._indicesInvalid=!0,e.trigger("change",yr)}},{key:"addFilter",value:function(e){var t=e instanceof cr?e:new cr(e);return this.filters.add(t),t}},{key:"onFiltersChanged",value:function(){var e=this;e._filterFunction=null,e._filteredValues=e._values.filter(e.filterFunction),e._indicesInvalid=!0,e.trigger("change",mr)}},{key:"addIndex",value:function(e){(this._indices||(this._indices={}))[e]={},this._indicesInvalid=!0}},{key:"findIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.isFiltered,o=i&&!n?r.indices[vr][e]:r.indices[e];if(o){var a=o[wr(t)];if(null!=a)return a}else for(var s=i&&!n?r._filteredValues:r._values,l=s.length,c=0;c<l;c++)if(s[c][e]==t)return c;return-1}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.findIndex(this.idProperty,br[re()(e)]?e:e[this.idProperty],t)}},{key:"includes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return-1!==this.indexOf(e,t)}},{key:"rebuildIndices",value:function(){var e,t,n=this,r=n.isFiltered,i=n._indices||(n._indices={}),o=Object.keys(i),a=o.length,s=n._values,l=s.length;for(r&&(i[vr]={}),e=0;e<a;e++)i[o[e]]={},r&&(i[vr][o[e]]={});for(e=0;e<l;e++){var c=s[e];for(t=0;t<a;t++){var u=o[t];i[u][wr(c[u])]=e}}if(r){var d=n._filteredValues,f=d.length,h=n._indices[vr];for(e=0;e<f;e++){var g=d[e];for(t=0;t<a;t++){var v=o[t];h[v][wr(g[v])]=e}}}n._indicesInvalid=!1}},{key:"isCollection",get:function(){return!0}},{key:"values",set:function(e){this.splice(0,this._values.length,e)},get:function(){return this.isFiltered?this._filteredValues:this._values}},{key:"first",get:function(){return this.values[0]}},{key:"last",get:function(){return this.values[this.count-1]}},{key:"allValues",get:function(){return this._values}},{key:"count",get:function(){return this.values.length}},{key:"totalCount",get:function(){return this._values.length}},{key:"idProperty",set:function(e){this._idProperty=e,this.addIndex(e)},get:function(){return this._idProperty}},{key:"extraKeys",set:function(e){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++)this.addIndex(e[t])}},{key:"sorters",get:function(){return this._sorters||(this._sorters=new r({listeners:{change:"onSortersChanged",thisObj:this}})),this._sorters}},{key:"isSorted",get:function(){return Boolean(this._sorters&&this._sorters.count)}},{key:"sortFunction",get:function(){return this._sortFunction||(this.isSorted?this._sortFunction=dr.generateSortFunction(this.sorters.values):this._sortFunction=hr),this._sortFunction}},{key:"filters",get:function(){return this._filters||(this._filters=new r({listeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}},{key:"isFiltered",get:function(){return Boolean(this._filters&&this._filters.count)}},{key:"filterFunction",get:function(){return this._filterFunction||(this.isFiltered?this._filterFunction=cr.generateFiltersFunction(this.filters.values):this._filterFunction=_n.returnTrue),this._filterFunction}},{key:"indices",get:function(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}}],[{key:"defaultConfig",get:function(){return{idProperty:"id",extraKeys:null,autoFilter:!0}}}]),r}(pe(G));function Cr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Sr._$name="Collection";var Rr={true:"auto",false:"hidden","hidden-scroll":"auto"},xr={block:"nearest"},Er=new Promise((function(e){return e()})),Dr=function(e){return new Promise((function(t){return Kn.on({element:e,scroll:t,once:!0})}))},Tr={x:1},Mr=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Cr()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"addPartner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tr;"string"==typeof t&&(t=oe()({},t,1)),(this.partners||(this.partners=new Sr)).add({id:e.id,scroller:e,axes:t}),e.partners&&e.partners.includes(this.id)||e.addPartner(this,t)}},{key:"removePartner",value:function(e){this.partners&&this.partners.includes(e)&&(this.partners.remove(e),e.removePartner(this))}},{key:"scrollIntoView",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xr,r=e instanceof In,i=r?e:In.from(e),o=this.getDeltaTo(e,n),a=o.xDelta,s=o.yDelta,l=this.scrollBy(a,s,n);return(n.highlight||n.focus)&&l.then((function(){r&&(e=i.translate(-a,-s)),n.highlight&&on.highlight(e,t),n.focus&&e.focus()})),l}},{key:"scrollBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xr,r=this,i="object"===re()(n)?n.animate:n,o=Math.abs(e),a=Math.abs(t);r.scrollAnimation&&(r.scrollAnimation.cancel(),r.scrollAnimation=null),(e||t)&&(r.silent=n.silent);var s=i&&("number"==typeof i?i:"number"==typeof i.duration?i.duration:300);if(s&&(o>10||a>10)){var l=r.x,c=r.y,u=l,d=c;return Math.max(o,a)<50&&(s=Math.min(s,500)),r.scrollAnimation=_n.animate(s,(function(i){var o=1===i;if(e){if(r.x!==u&&!n.force)return r.scrollAnimation&&r.scrollAnimation.cancel();r.x=Math.max(l+(o?e:Math.round(e*i)),0)}if(t){if(r.y!==d&&!n.force)return r.scrollAnimation&&r.scrollAnimation.cancel();r.y=Math.max(c+(o?t:Math.round(t*i)),0)}u=r.x,d=r.y}),r,i.easing),r.element.classList.add("b-scrolling"),r.scrollAnimation.then((function(){r.isDestroyed||(r.element.classList.remove("b-scrolling"),r.scrollAnimation=null)})),r.scrollAnimation}return e|t?(r.x+=e,r.y+=t,Dr(r.element)):Er}},{key:"scrollTo",value:function(e,t,n){var r=this.x,i=this.y,o=null==e?0:e-r,a=null==t?0:t-i;return this.scrollBy(o,a,n)}},{key:"doDestroy",value:function(){var e=this;e._element&&(e._element.removeEventListener("scroll",e.scrollHandler),e.wheelListenerRemover&&e.wheelListenerRemover()),e.scrollAnimation&&e.scrollAnimation.cancel(),e.partners&&e.partners.forEach((function(t){return t.scroller.removePartner(e)})),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onElMutation",value:function(e){var t=this,n=on.getTranslateXY(t.element),r=te()(n,2),i=r[0],o=r[1];if(t._x!==-i||t.y!==-o){var a=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(a,"target",{get:function(){return t.element}}),t.onScroll(a)}}},{key:"onScroll",value:function(e){var t=this;t.widget&&t.widget.isDestroyed||(t.positionDirty=!0,t.element.classList.contains("b-scrolling")||t.element.classList.add("b-scrolling"),e.widget=t.widget,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.scrollEndHandler(e))}},{key:"syncPartners",value:function(){var e=this;e.partners&&e.partners.forEach((function(t){var n=t.axes,r=t.scroller;r!==e.controllingPartner&&r.sync(e,n)}))}},{key:"onScrollEnd",value:function(e){this.silent&&(this.silent=!1),this.trigger("scrollEnd",e),this.element.classList.remove("b-scrolling")}},{key:"getDeltaTo",value:function(e,t){var n=this;if(!n.viewport)return{xDelta:0,yDelta:0};e instanceof In||(e=In.from(e)),e.round();var r=t.block||"nearest",i=n.viewport.round(),o=t.edgeOffset||0,a=i.width>=e.width+2*o?o:0,s=i.height>=e.height+2*o?o:0,l=e.clone().adjust(-a,-s,a,s).constrainTo(new In(i.x-n.x,i.y-n.y,n.scrollWidth,n.scrollHeight)),c=l.clone(),u=0,d=0;if("start"===r)c.moveTo(i.x,i.y),u=l.x-c.x,d=l.y-c.y;else if("end"===r)c.translate(i.right-c.right,i.bottom-c.bottom),u=l.x-c.x,d=l.y-c.y;else if("center"===r){var f=i.center;c.moveTo(f.x-c.width/2,f.y-c.height/2),u=u||l.x-c.x,d=d||l.y-c.y}else c.width>i.width?u=c.x-i.x:c.right>i.right?u=c.right-i.right:c.x<i.x&&(u=c.x-i.x),c.height>i.height?d=c.y-i.y:c.bottom>i.bottom?d=c.bottom-i.bottom:c.y<i.y&&(d=c.y-i.y);return{xDelta:!1===t.x?0:Math.max(Math.min(u,n.maxX-n.x),-n.x),yDelta:!1===t.y?0:Math.max(Math.min(d,n.maxY-n.y),-n.y)}}},{key:"sync",value:function(e,t){var n=t.x,r=t.y;this.controllingPartner=e,null!=n&&(this.x=e.x),null!=r&&(this.y=e.y)}},{key:"updateOverflowX",value:function(e){var t=this.element,n=this.translate;"hidden-scroll"!==e||n||(t.classList.add("b-hide-scroll"),this.enableWheel()),n||(t.style.overflowX=Rr[e]||e),this.positionDirty=!this.isConfiguring}},{key:"updateOverflowY",value:function(e){var t=this.element,n=this.translate;"hidden-scroll"!==e||n||(t.classList.add("b-hide-scroll"),this.enableWheel()),n||(t.style.overflowY=Rr[e]||e),this.positionDirty=!this.isConfiguring}},{key:"enableWheel",value:function(){Re.isChrome||Re.isSafari||this.wheelListenerRemover||(this.wheelListenerRemover=Kn.on({element:this.element,wheel:"onWheel",thisObj:this}))}},{key:"onWheel",value:function(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&!1!==this.overflowX?(this.x+=e.deltaX,e.stopPropagation()):!1!==this.overflowY&&(this.y+=e.deltaY,e.stopPropagation())}},{key:"viewport",get:function(){return In.client(this.element)}},{key:"element",get:function(){return this._element},set:function(e){var t=this,n=t.scrollHandler||(t.scrollHandler=t.onScroll.bind(t));if(t.scrollEndHandler||(t.scrollEndHandler=t.buffer(t.onScrollEnd,t.scrollEndBuffer)),t._element&&(t.translate?t.mutationObserver&&t.mutationObserver.disconnect(t._element):(t._element.removeEventListener("scroll",n),t._element.classList.remove("b-widget-scroller"))),t._element=e,t.translate){if(t.mutationObserver||(t.mutationObserver=new MutationObserver((function(e){return t.onElMutation(e)}))),t.mutationObserver.observe(e,{attributes:!0}),t._x=t._y=0,document.contains(e)){var r=on.getTranslateXY(e),i=te()(r,2),o=i[0],a=i[1];t._x=-o,t._y=-a}}else e.addEventListener("scroll",n),e.classList.add("b-widget-scroller");t.updateOverflowX(t.overflowX),t.updateOverflowY(t.overflowY)}},{key:"x",get:function(){var e=this,t=e.element;if(t&&e.positionDirty){if(e.translate){var n=on.getTranslateXY(t),r=te()(n,2),i=r[0],o=r[1];e._x=-i,e._y=-o}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._x},set:function(e){var t=this.element,n=this.widget;n&&n.isConfiguring||(this._x=e,t&&(this.trigger("scrollStart",{x:e}),this.translate?on.setTranslateX(t,-e):t.scrollLeft=e,this.positionDirty=!0))}},{key:"y",get:function(){var e=this,t=e.element;if(t&&e.positionDirty){if(e.translate){var n=on.getTranslateXY(t),r=te()(n,2),i=r[0],o=r[1];e._x=-i,e._y=-o}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y},set:function(e){var t=this.element,n=this.widget;n&&n.isConfiguring||(this._y=e,t&&(this.trigger("scrollStart",{y:e}),this.translate?on.setTranslateY(t,-e):t.scrollTop=e,this.positionDirty=!0))}},{key:"maxX",get:function(){return this.scrollWidth-this.clientWidth}},{key:"maxY",get:function(){return this.scrollHeight-this.clientHeight}},{key:"overflowX",get:function(){return this._overflowX},set:function(e){this._overflowX=e,this.element&&this.updateOverflowX(e)}},{key:"overflowY",get:function(){return this._overflowY},set:function(e){this._overflowY=e,this.element&&this.updateOverflowY(e)}},{key:"scrollWidth",get:function(){return this.element?this.element.scrollWidth:0},set:function(e){var t=this,n=t.widthStretcher;n&&null==e?(n.remove(),t.widthStretcher=null):e&&(n||(n=t.widthStretcher=on.createElement({className:"b-scroller-stretcher"})),n.style.transform="translateX(".concat(e-1,"px)"),t.element&&t.element.lastChild!==n&&t.element.appendChild(n))}},{key:"scrollHeight",get:function(){return this.element?this.element.scrollHeight:0},set:function(e){var t=this,n=t.stretcher||(t.stretcher=on.createElement({className:"b-scroller-stretcher"}));n.style.transform="translateY(".concat(e-1,"px)"),t.element&&t.element.lastChild!==n&&t.element.appendChild(n)}},{key:"clientWidth",get:function(){return this.element?this.element.clientWidth:0}},{key:"clientHeight",get:function(){return this.element?this.element.clientHeight:0}},{key:"id",get:function(){return this._id||(this.widget?this._id="".concat(this.widget.id,"-scroller"):this._id=we.generateId("scroller-")),this._id}}],[{key:"defaultConfig",get:function(){return{element:null,overflowX:null,overflowY:null,translate:null,_x:0,_y:0,scrollEndBuffer:100}}}]),r}(or(pe(G)));Mr._$name="Scroller";var Ar={localeName:"En",localeDesc:"English",Object:{Yes:"Yes",No:"No",Cancel:"Cancel",Custom:"Custom"},InstancePlugin:{fnMissing:function(e){return"Trying to chain fn ".concat(e.plugIntoName,"#").concat(e.fnName,", but plugin fn ").concat(e.pluginName,"#").concat(e.fnName," does not exist")},overrideFnMissing:function(e){return"Trying to override fn ".concat(e.plugIntoName,"#").concat(e.fnName,", but plugin fn ").concat(e.pluginName,"#").concat(e.fnName," does not exist")}},Field:{invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},TimeField:{invalidTime:"Invalid time input"},DateHelper:{locale:"en-US",shortWeek:"W",shortQuarter:"q",week:"Week",weekStartDay:0,unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A"},ordinalSuffix:function(e){return e+({1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th")}},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:function(e){return"of ".concat(e.lastPage)},summaryTemplate:function(e){return"Displaying records ".concat(e.start," - ").concat(e.end," of ").concat(e.allCount)}},List:{loading:"Loading..."}},Ir=Ar;function Fr(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Or(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Or(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Or(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Fe.registerLocale("En",{desc:"English",locale:Ar});var Pr=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,Lr={INPUT:1,TEXTAREA:1},Hr=function(e){e.isVisible&&e.triggerPaint()},jr=/^:not\((.+)\)$/,Br=on.createElement({html:"",style:"position:absolute;top:-10000em;left:-10000em"}),Nr=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(_r()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;t.alignConstrained=0,t.afterHideShowAnimate=t.afterHideShowAnimate.bind(t),t.callRealign=t.realign.bind(t),t.doHideOrRealign=t.doHideOrRealign.bind(t),t.initialRender=!0,t._isUserAction=!1;for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];se()(J()(r.prototype),"construct",this).call(this,e,i),t.finalizeInit()}},{key:"isType",value:function(e,t){return we.isType(this,e,t)}},{key:"startConfigure",value:function(e){var t=this,n=t.adopt,i=t.element;if(n){var o="string"==typeof n?document.getElementById(n):n,a=we.fromElement(o);a&&a.destroy(),t.preExistingElements=Array.from(o.childNodes),t.adoptedElementClassName=o.className,t.adoptedElementCssText=o.style.cssText,o.id&&!e.id&&(t.id=i.id=o.id),on.syncAttributes(i,o);for(var s=0,l=i.childNodes.length;s<l;s++)o.appendChild(i.childNodes[0]);t._element=o,delete t._contentRange}se()(J()(r.prototype),"startConfigure",this).call(this,e)}},{key:"finalizeInit",value:function(){(this.insertBefore||this.appendTo||this.insertFirst||this.adopt)&&this.render()}},{key:"doDestroy",value:function(){var e=this,t=e._element,n=e.tooltip,i=e.preExistingElements;if(e.scrollable&&e.scrollable.destroy(),n&&(e._tooltip?n.destroy():n.activeTarget===t&&n.isVisible&&n.hide()),e.unmask(),t){if(e.removeTransientListeners(),e.floating||e.positioned?e.hide():e.revertFocus(),nr.removeResizeListener(t.parentElement,e.onParentElementResize),nr.removeResizeListener(t,e.onElementResize),e.adopt){for(var o=Array.from(t.childNodes),a=0,s=o.length;a<s;a++){var l=o[a];i.includes(l)||l===r.floatRoot||l.remove()}t.className=e.adoptedElementClassName,t.style.cssText=e.adoptedElementCssText}else t.remove();e.dragEventDetacher&&e.dragEventDetacher(),e.dragOverEventDetacher&&e.dragOverEventDetacher(),Br.remove()}we.unregister(e),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"render",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n.element;nr.removeResizeListener(r.parentElement,n.onParentElementResize),nr.removeResizeListener(r,n.onElementResize),n.emptyCache(),n.syncElement&&n.currentElement?on.sync(r,n.currentElement):(e?(n.appendTo="string"==typeof e?document.getElementById(e):e,n.appendTo.appendChild(r)):n.insertBefore?(n.insertBefore="string"==typeof n.insertBefore?document.getElementById(n.insertBefore):n.insertBefore,n.insertBefore.parentElement.insertBefore(r,n.insertBefore)):n.insertFirst?(n.insertFirst="string"==typeof n.insertFirst?document.getElementById(n.insertFirst):n.insertFirst,n.insertFirst.firstChild?n.insertFirst.insertBefore(r,n.insertFirst.firstChild):n.insertFirst.appendChild(r)):n.appendTo&&(n.appendTo="string"==typeof n.appendTo?document.getElementById(n.appendTo):n.appendTo,n.appendTo.appendChild(r)),n.currentElement=r),n.rendered=!0,t&&(n._thisIsAUsedExpression(n.contentRange),n.triggerPaint())}},{key:"template",value:function(e){return'<div class="'.concat(e.html?"b-html":"",'" ').concat(e.name?'data-name="'.concat(e.name,'"'):"",">").concat(e.html||"","</div>")}},{key:"alignTo",value:function(e){(1===e.nodeType||e instanceof r||e instanceof On)&&(e={target:e}),this.releaseSizeConstraints();var t=this,n=t.scrollable,i=t.element,o=e.target,a=o&&(o instanceof In?o:o.element||o),s=In.from(i,t.positioned?i.offsetParent:null,!0),l=a&&1===a.nodeType;if(e=mt.assign({constrainTo:t.positioned?null:t.constrainTo,axisLock:t.axisLock,anchor:t.anchor},"object"===re()(t.align)?t.align:{align:t.align},e),s.minWidth=e.minWidth||t.minWidth,s.minHeight=e.minHeight||t.minHeight,t.lastAlignSpec=e,l&&a.offsetParent){(e=Object.setPrototypeOf({},e)).target=In.from(a,t.positioned?i.offsetParent:null,!t.positioned),e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1);var c=t.clippedBy;if(c){var u=e.target.intersect(c);if(!u){var d=t.hide();return t.lastAlignSpec.targetHidden=!0,d}e.target=u}t.anchoredTo=a}else t.anchoredTo=null;e.anchor&&(e.anchorSize=t.anchorSize,i.appendChild(t.anchorElement)),t.isAligning=!0,t.trigger("beforeAlign",e),t.isAligning=!1;var f=e.constrainTo,h=f===window||f===document,g=s.alignTo(e),v=g.align,p=g.anchor,y=g.x,m=g.y,b=g.width,k=g.height,w=g.bottom,S=g.right;if(t.lastAlignSpec.zone=g.zone,k!==s.height&&("configuredHeight"in t||(t.configuredHeight=i.style.height),t.height=k,t.alignConstrained=1|t.alignConstrained,n&&(n.overflowY=!0)),b!==s.width&&("configuredWidth"in t||(t.configuredWidth=i.style.width),t.width=b,t.alignConstrained=2|t.alignConstrained,n&&(n.overflowX=n.clientWidth>n.scrollWidth)),v&&t.alignConstrained){e.align=v;var C=In.from(i,t.positioned?i.offsetParent:null,!0).alignTo(e);p=C.anchor,y=C.x,m=C.y,b=C.width,k=C.height,w=C.bottom,S=C.right}if(t.setXY(y,m),p){var R,x=p.edge,E=t.anchorElement,D=[],T=i.style.pointerEvents;i.style.pointerEvents="all","top"===x||"bottom"===x?(D[0]=y+p.x,D[1]="top"===x?m+1:w-1):(D[0]="left"===x?y+1:S-1,D[1]=m+p.y);var M=(R=document).elementFromPoint.apply(R,D);if(i.style.pointerEvents=T||null,M){var A=on.getStyleValue(M,"background-color");A.match(Pr)?t.anchorPathElement.setAttribute("fill",t.defaultAnchorBackgroundColor):t.anchorPathElement.setAttribute("fill",A)}E.classList.remove("b-hide-display"),E.style.transform="",E.className="b-anchor b-anchor-".concat(x),on.setTranslateXY(E,p.x,p.y)}else t._anchorElement&&t.anchorElement.classList.add("b-hide-display");"hide"!==t.scrollAction||l||(i.style.pointerEvents="none",t.anchoredTo=document.elementFromPoint(y,m),i.style.pointerEvents=""),("realign"===t.scrollAction&&l||"hide"===t.scrollAction)&&!t.documentScrollListener&&t.setTimeout((function(){document.addEventListener("scroll",t.doHideOrRealign,!0),t.documentScrollListener=!0}),"hide"===t.scrollAction?100:0),!Re.isAndroid&&h&&(t.constrainListeners||f instanceof In||(nr.addResizeListener(f,t.callRealign),h||t.constrainMutationMonitor||(t.constrainMutationMonitor=new MutationObserver(t.callRealign)).observe(f,{attributes:!0,childList:!0}),t.constrainListeners=!0))}},{key:"realign",value:function(e){var t=this;if(t.isVisible&&(t.floating||t.positioned)&&t.lastAlignSpec){var n=t.lastAlignSpec.target;if(n&&1===n.nodeType){var r=In.from(n);if(r.minHeight=r.minWidth=1,n!==document.body&&!n.offsetParent||e&&1===e.nodeType&&e.contains(n)&&!In.from(e).intersect(r))return t.hide()}t.alignTo(t.lastAlignSpec)}}},{key:"releaseSizeConstraints",value:function(){var e=this,t=e.scrollable;1&e.alignConstrained&&(e.height=e.configuredHeight,t&&(t.overflowY=t.config.overflowY)),2&e.alignConstrained&&(e.width=e.configuredWidth,t&&(t.overflowX=t.config.overflowX)),e.alignConstrained=0}},{key:"toFront",value:function(){this.element&&this.element.nextSibling&&this.element.parentNode.appendChild(this.element)}},{key:"onThemeChange",value:function(){this.anchorElement&&this.anchorElement.offsetParent&&(this._anchorSize=null,this.realign())}},{key:"onWidgetDragStart",value:function(e){var t=this,n=document.elementFromPoint(e.clientX,e.clientY),r=t.draggable.handleSelector;if(r){var i=jr.exec(r)[1];if(i){if(n.closest("#".concat(t.element.id," ").concat(i)))return void e.preventDefault()}else if(!n.closest("#".concat(t.element.id," ").concat(r)))return void e.preventDefault()}t.removeTransientListeners();var o=e.clientX,a=e.clientY,s=document.scrollingElement||document.body,l=t.getXY()[0],c=t.getXY()[1];document.body.appendChild(Br),e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(Br,0,0)),e.dataTransfer.effectAllowed="none",t.dragOverEventDetacher=Kn.addListener({element:document.body,dragover:function(e){return t.setXY(l+e.clientX-o-s.scrollLeft,c+e.clientY-a-s.scrollTop)}}),t.anchor=null}},{key:"onWidgetDragEnd",value:function(e){Br.remove(),this.dragOverEventDetacher()}},{key:"getXY",value:function(){return[on.getPageX(this.element),on.getPageY(this.element)]}},{key:"setXY",value:function(e,t){var n=this;(n.floating||n.positioned)&&(null!=e&&(n._x=e,n.centered=!1),null!=t&&(n._y=t,n.centered=!1),on.setTranslateXY(n.element,n._x||0,n._y||0))}},{key:"fixIEMaxHeightBug",value:function(){var e=this.element,t=this.contentElement;if("column"===on.getStyleValue(e,"flex-direction")){t.style.maxHeight="";for(var n=In.client(e).height,r=e.childNodes,i=r.length,o=0;o<i;o++){var a=r[o];a===t||a.classList.contains("b-resize-monitors")||(n-=a.offsetHeight)}this.contentElement.style.maxHeight="".concat(n,"px")}}},{key:"onDisabled",value:function(e){}},{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"focus",value:function(){this.isFocusable&&on.focusWithoutScrolling(this.focusElement)}},{key:"show",value:function(){var e=this;return new Promise((function(t){var n,i,o=e,a=o.showAnimation,s=o.element,l=r.floatRoot,c=s.style;o.isVisible||!1===o.trigger("beforeShow")||o.internalBeforeShow&&!1===o.internalBeforeShow()?t():(o.cancelHideShowAnimation(),a&&(n=Object.keys(a)[0],i=a[n],o.currentAnimation={styleProp:n,resolve:t},o.isAnimating=!0,s.addEventListener("transitionend",o.afterHideShowAnimate),c[n]=i.from),o.floating&&(l.contains(s)||(o.rendered?l.appendChild(o.element):o.render(l,!1))),o._hidden=!1,s.classList.remove("b-hidden"),a&&(c.transition="".concat(n," ").concat(i.duration," ease ").concat(i.delay),o.requestAnimationFrame((function(){c[n]=i.to}))),o.afterShow(!a&&t),!o.inShowBy&&o.floating&&o.forElement&&!o.hidden&&o.alignTo(o.forElement))}))}},{key:"showBy",value:function(e){var t=this;t.inShowBy=!0;var n=t.show();return t.inShowBy=!1,t.isVisible&&t.alignTo(e),n}},{key:"showByPoint",value:function(e,t,n){var r=1===arguments.length?e:[e,t];return this.showBy(Object.assign({target:new In(r[0],r[1],1,1),align:"t-b"},n))}},{key:"afterShow",value:function(e){this.boundMaxHeightBugHandler&&this.boundMaxHeightBugHandler(),this.trigger("show"),this.triggerPaint(),e&&e()}},{key:"triggerPaint",value:function(){var e=this,t=e.element,n=!e.isPainted;e.isVisible&&(n&&(e.scaleToFitWidth?(e.onParentElementResize=e.onParentElementResize.bind(e),nr.addResizeListener(t.parentElement,e.onParentElementResize),e.isVisible&&e.updateScale()):e.monitorResize&&(e.onElementResize=e.onElementResize.bind(e),nr.addResizeListener(t,e.onElementResize))),e.eachWidget&&e.eachWidget(Hr,!1),e.trigger("paint",{firstPaint:n}),n&&e.monitorResize&&!e.scaleToFitWidth&&nr.onElementResize([{target:e.element}]),e.isPainted=!0)}},{key:"cancelHideShowAnimation",value:function(){var e=this,t=e.element,n=t.style;e.currentAnimation&&(e.isAnimating=!1,t.classList.remove("b-hiding"),t.removeEventListener("transitionend",e.afterHideShowAnimate),n.transition=n[e.currentAnimation.styleProp]="",e.currentAnimation=null)}},{key:"afterHideShowAnimate",value:function(e){if(!this.isDestroyed){var t=this,n=t.element,r=n.style,i=t.currentAnimation,o=i.styleProp,a=i.resolve;e.target===n&&e.propertyName===o&&(n.classList.remove("b-hiding"),t.isAnimating=!1,t.currentAnimation=null,n.removeEventListener("transitionend",t.afterHideShowAnimate),r.transition=r[o]="",t._hidden&&t.afterHideAnimation(),a())}}},{key:"hide",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise((function(n){var r=e,i=r.element,o=i.style,a=t&&r.hideAnimation;if(!r._hidden&&!1!==r.trigger("beforeHide")){if(r._hidden=!0,!i)return;if(r.revertFocus(),r.isDestroyed)return void n();if(r.cancelHideShowAnimation(),a){var s=Object.keys(a)[0],l=a[s];Number(getComputedStyle(r.element)[s])!==l.to?(r.currentAnimation={styleProp:s,resolve:n},i.classList.add("b-hiding"),r.isAnimating=!0,i.addEventListener("transitionend",r.afterHideShowAnimate),o[s]=l.from,o.transition="".concat(s," ").concat(l.duration," ease ").concat(l.delay),r.requestAnimationFrame((function(){o[s]=l.to}))):i.classList.add("b-hidden")}else i.classList.add("b-hidden");r.afterHide(!a&&n)}}))}},{key:"doHideOrRealign",value:function(e){var t=this,n=t.anchoredTo,r=t.lastAlignSpec,i=r&&r.target,o=document.activeElement,a=t.getXY(),s=te()(a,2),l=s[0],c=s[1];if(!t.element.contains(e.target)&&e.isTrusted&&!(9===e.target.nodeType&&t.element.contains(o)&&Lr[o]&&window.innerHeight<document.body.offsetHeight)&&(t.realign(e.target),!t.isDestroyed&&"hide"===t.scrollAction)){var u=t.getXY(),d=te()(u,2),f=d[0],h=d[1];!(f!==l||h!==c||i instanceof On)||n&&!on.isDescendant(e.target,n)||t.hide()}}},{key:"afterHide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t.lastAlignSpec;n&&(n.targetHidden=null),t.removeTransientListeners(),t.hideAnimation||t.afterHideAnimation(),t.trigger("hide"),e&&e()}},{key:"removeTransientListeners",value:function(){var e=this;e.documentScrollListener&&(document.removeEventListener("scroll",e.doHideOrRealign,!0),e.documentScrollListener=!1),e.constrainListeners&&(nr.removeResizeListener(e.lastAlignSpec.constrainTo,e.callRealign),e.constrainMutationMonitor&&e.constrainMutationMonitor.disconnect(),e.constrainListeners=!1)}},{key:"afterHideAnimation",value:function(){var e=this.element;this.floating&&r.floatRoot.contains(e)?e.remove():e.classList.add("b-hidden")}},{key:"getSibling",value:function(e){var t=this.parent,n=t?t.childItems:Array.from(this.element.parentElement.querySelectorAll(".b-widget"));return t?n[n.indexOf(this)+e]:we.fromElement(n[n.indexOf(this.element)+e])}},{key:"up",value:function(e,t,n){for(var r=re()(n),i="number"===r,o="string"===r,a=this.owner,s=1;a;a=a.owner,s++){if(Se(a,e,t))return a;if(i&&s>=n)return;if(o&&Se(a,n,t))return;if(a===n)return}}},{key:"owns",value:function(e){if(e){if(e.eventPhase&&(e=e.target),1===e.nodeType){if(this.element.contains(e))return!0;e=we.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}},{key:"onFocusIn",value:function(e){var t=this,n=t.element;t.containsFocus=!0,t.focusInEvent=e,n.classList.add("b-contains-focus"),n.contains(e.target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=Kn.on({element:n,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}},{key:"onFocusOut",value:function(e){var t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!0),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.trigger("focusout",e))}},{key:"revertFocus",value:function(e){var t=this.focusInEvent&&this.focusInEvent.relatedTarget;(e||this.containsFocus&&t&&1===t.nodeType&&this.element.contains(document.activeElement))&&(t&&on.isFocusable(t)||(t=this.getFocusRevertTarget()),t&&on.isFocusable(t)&&on.focusWithoutScrolling(t))}},{key:"getFocusRevertTarget",value:function(){var e=this,t=e.owner,n=e.focusInEvent,r=n&&n.backwards?1:-1,i=n&&n.relatedTarget,o=i&&we.fromElement(i);if(t&&!t.isDestroyed&&(!i||!on.isFocusable(i)||o&&!o.isFocusable)){if(i=null,t.eachWidget){var a=[];if(t.eachWidget((function(t){(t===e||t.isFocusable)&&a.push(t)}),!1),a.length>1){var s=a.indexOf(e);i=a[s+r]||a[s-r]}}!i&&t.isFocusable&&(i=t),i=i?i.focusElement:t.getFocusRevertTarget()}return i}},{key:"fromCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.element;if(!n)return null;var r=this;return r.cache[e]||(r.cache[e]=t?on.children(n,e):on.down(n,e)),r.cache[e]}},{key:"emptyCache",value:function(){this.cache={}}},{key:"mask",value:function(e){var t=this;return t.maskInstance&&t.maskInstance.destroy(),"string"==typeof e?t.maskInstance=Ce.mask(t.element,e):(e.element=t.element,t.maskInstance=Ce.mask(e))}},{key:"unmask",value:function(){this.maskInstance&&(Ce.unmask(this.element),this.maskInstance=null)}},{key:"onInternalResize",value:function(e,t,n,r,i){this._width=e.offsetWidth,this._height=e.offsetHeight}},{key:"onElementResize",value:function(e){var t=this,n=t.element,r=t._width,i=t._height,o=n.offsetWidth,a=n.offsetHeight;t.suspendResizeMonitor||r===o&&i===a||(t.onInternalResize(n,o,a,r,i),t.trigger("resize",{width:o,height:a,oldWidth:r,oldHeight:i}))}},{key:"updateScale",value:function(){var e=this,t=e.element,n=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),e.parentHeight||(e.parentHeight=n.offsetHeight),t.style.display="none";var r=n.offsetWidth/e.configuredWidth,i=e.allowGrowWidth?Math.min(r,1):r;t.style.transform="scale(".concat(i,")"),t.style.transformOrigin="top left",t.style.display="",n.style.height=e.parentHeight*i+"px",e.allowGrowWidth&&r>1&&(e.width=e.configuredWidth*r)}},{key:"onParentElementResize",value:function(e){this.updateScale()}},{key:"parseTRBL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";if("number"==typeof(e=e||0))return["".concat(e).concat(t),"".concat(e).concat(t),"".concat(e).concat(t),"".concat(e).concat(t)];var n=e.split(" "),r=n.length;return 1===r?n[1]=n[2]=n[3]=n[0]:2===r?(n[2]=n[0],n[3]=n[1]):3===r&&(n[3]=n[1]),[isFinite(n[0])?"".concat(n[0]).concat(t):n[0],isFinite(n[1])?"".concat(n[1]).concat(t):n[2],isFinite(n[2])?"".concat(n[2]).concat(t):n[3],isFinite(n[3])?"".concat(n[3]).concat(t):n[4]]}},{key:"title",set:function(e){this._title!==e&&(this._title=e,this.titleElement&&(this.titleElement.innerHTML=e))},get:function(){return this._title}},{key:"element",get:function(){return this._element},set:function(e){var t=this;"string"==typeof e?e=on.createElementFromTemplate(e):"Object"===e.constructor.name?e=on.createElement(e):1!==e.nodeType&&(e=on.createElementFromTemplate(t.template(t))),t._element=e;var n=e.classList;e.id=t.id,e.className+=" "+t.widgetClassList.join(" "),t._hidden&&n.add("b-hidden"),t.parent||(t.floating||t.owner||n.add("b-outer"),Re.isTouchDevice&&n.add("b-touch-events"),on.scrollBarWidth?n.add("b-visible-scrollbar"):n.add("b-overlay-scrollbar"),Re.isChrome?n.add("b-chrome"):Re.isSafari?n.add("b-safari"):Re.isFirefox?n.add("b-firefox"):Re.isIE11?n.add("b-ie"):Re.isEdge&&n.add("b-edge"));var r,i=Fr(e.querySelectorAll("[reference]"));try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.getAttribute("reference");o.removeAttribute("reference"),t[a]=o,o.dataset&&(o.dataset.ownerCmp=t.id)}}catch(e){i.e(e)}finally{i.f()}}},{key:"constrainTo",set:function(e){this._constrainTo=e},get:function(){return"_constrainTo"in this?this._constrainTo:window}},{key:"centered",set:function(e){if(this._centered=e,e&&!this.floating)throw new Error("`centered` is only relevant when a Widget is `floating`");e?this.element.classList.add("b-centered"):this.element.classList.remove("b-centered")},get:function(){return this._centered}},{key:"contentElement",get:function(){return this.element}},{key:"contentRange",get:function(){var e=this,t=e.contentElement,n=e._contentRange||(e._contentRange=Re.isIE11?document.createRange():new Range);return n.collapsed&&(n.setStart(t,e.contentRangeStartOffset||0),n.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),n}},{key:"id",get:function(){return this._id},set:function(e){var t=this,n=t._id;if(e?t.hasGeneratedId=!1:(e=we.generateId("b-".concat(t.$name.toLowerCase(),"-")),t.hasGeneratedId=!0),n){var r=t.element.querySelectorAll('[data-owner-cmp="'.concat(n,'"]'));we.unregister(t);for(var i=0,o=r.length;i<o;i++)r[i].dataset.ownerCmp=e;t.element.id=e}t._id=e,we.register(t)}},{key:"style",get:function(){return this.element?this.element.ownerDocument.defaultView.getComputedStyle(this.element):this._style},set:function(e){this._style=e,this.element&&on.applyStyle(this.element,this._style)}},{key:"dataset",get:function(){return this.element.dataset},set:function(e){Object.assign(this.dataset,e)}},{key:"ref",set:function(e){this._ref=e,this.element.dataset.ref=e},get:function(){return this._ref}},{key:"clippedBy",set:function(e){this._clippedBy=Array.isArray(e)?e:e?[e]:null},get:function(){var e=this._clippedBy;if(e){var t,n=In.from(e[0],null,!0);for(t=1;t<e.length;t++)n=n.intersect(In.from(e[t],null,!0));return n}}},{key:"overflowElement",get:function(){return this.contentElement}},{key:"maxHeightElement",get:function(){return this.element}},{key:"scrollable",set:function(e){var t=this.overflowElement;"boolean"==typeof e&&(e={overflowX:e,overflowY:e}),t&&(e.element=t),e.widget=this,this._scrollable=new this.scrollerClass(e)},get:function(){return this._scrollable}},{key:"html",get:function(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML},set:function(e){var t=this,n=null==e,r=t.element,i=t.contentElement;if(t._html!==e&&(t._html=e,r)){var o=i===r&&t._anchorElement;r.classList[n?"remove":"add"]("b-html"),o&&t.element.removeChild(o),t.contentElement.innerHTML=n?"":e,o&&r.appendChild(o),(t.floating||t.positioned)&&(t.isAligning||t.realign())}}},{key:"content",set:function(e){var t=this,n=null==e,r=t.element;if(t._html!==e&&(t._html=e,r)){var i=t.contentRange;r.classList[n?"remove":"add"]("b-html"),rn(r)?(i.deleteContents(),n||i.insertNode(on.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=i.startOffset,t.contentRangeEndOffset=i.endOffset,t.isAligning&&!t.positioned||t.realign()}}},{key:"anchorSize",get:function(){var e=this,t=this._anchorSize;if(!t){var n=parseFloat(on.getStyleValue(e.element,"border-top-width")),r=on.getStyleValue(e.element,"border-top-color"),i=e.anchorElement,o=i.firstElementChild,a=e.anchorPathElement=o.lastElementChild,s=e._hidden,l=on.getStyleValue(e.contentElement,"background-color");l.match(Pr)&&(l=on.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=l,t=i.getBoundingClientRect();var c=t=e._anchorSize=[t.width,t.height],u=te()(c,2),d=u[0],f=u[1];o.setAttribute("height",f+n),o.setAttribute("width",d),a.setAttribute("d","M0,".concat(f,"L").concat(d/2,",0.5L").concat(d,",").concat(f)),n&&(a.setAttribute("stroke-width",n),a.setAttribute("stroke",r)),t[1]-=n,s&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=Gr.on({theme:"onThemeChange",thisObj:e}))}return e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor),t}},{key:"anchorElement",get:function(){var e=this._anchorElement;return e||(e=this._anchorElement=on.createElement({parent:this.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[{tag:"defs",children:[{tag:"filter",id:"shadow-filter",children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:2,"flood-opacity":.05}]}]},{tag:"path",filter:Re.isIE11||Re.isEdge?null:"url(#shadow-filter)"}]}]})),e}},{key:"anchor",set:function(e){this._anchor=e,this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")},get:function(){return this._anchor}},{key:"draggable",get:function(){return this._draggable},set:function(e){var t=this,n=t.element;t._draggable=e,n.setAttribute("draggable",Boolean(e)),e?t.dragEventDetacher=Kn.addListener({element:t.element,dragstart:t.onWidgetDragStart,dragend:t.onWidgetDragEnd,thisObj:t}):(t.dragEventDetacher&&t.dragEventDetacher(),t.dragOverEventDetacher&&t.dragOverEventDetacher())}},{key:"floating",get:function(){return this._floating},set:function(e){e=Boolean(e),Boolean(this.floating)!==e&&(this._floating=e)}},{key:"positioned",get:function(){return this._positioned},set:function(e){e=Boolean(e),Boolean(this.positioned)!==e&&(this.element.classList[e?"add":"remove"]("b-positioned"),this._positioned=e)}},{key:"x",set:function(e){this.setXY(e)},get:function(){return this.getXY()[0]}},{key:"y",set:function(e){this.setXY(null,e)},get:function(){return this.getXY()[1]}},{key:"width",get:function(){var e=this,t=e.element;return e.monitorResize?(null==e._width&&(e._width=t.offsetWidth),e._width):t.offsetWidth},set:function(e){on.setLength(this.element,"width",e),this._width=null,this._flex=null,this.element.style.flex=Re.isIE11?"":null}},{key:"maxWidth",get:function(){return on.measureSize(this.element.style.maxWidth,this.element)},set:function(e){on.setLength(this.element,"maxWidth",e)}},{key:"minWidth",get:function(){return on.measureSize(this.element.style.minWidth,this.element)},set:function(e){on.setLength(this.element,"minWidth",e)}},{key:"flex",get:function(){return this._flex},set:function(e){this._flex=e,("number"==typeof e||"string"==typeof e&&1===e.split(/\s/).length)&&(e="".concat(e," ").concat(e)),this.element.style.flex=e,this.element.style.width=Re.isIE11?"":null}},{key:"alignSelf",get:function(){return this._alignSelf},set:function(e){this.element.style.alignSelf=e}},{key:"margin",get:function(){return this._margin},set:function(e){this.element.style.margin=this._margin=this.parseTRBL(e).join(" ")}},{key:"height",get:function(){var e=this,t=e.element;return e.monitorResize?(null==e._height&&(e._height=t.offsetHeight),e._height):t.offsetHeight},set:function(e){on.setLength(this.element,"height",e),this._height=null}},{key:"maxHeight",get:function(){return on.measureSize(this.maxHeightElement.style.maxHeight,this.element)},set:function(e){var t=this,n=t.element;on.setLength(t.maxHeightElement,"maxHeight",e),Re.isIE11&&t.contentElement!==n&&(null==e?nr.removeResizeListener(n,t.boundMaxHeightBugHandler):(nr.addResizeListener(n,t.boundMaxHeightBugHandler||(t.boundMaxHeightBugHandler=t.fixIEMaxHeightBug.bind(t))),document.body.contains(n)&&t.fixIEMaxHeightBug()))}},{key:"minHeight",get:function(){return on.measureSize(this.element.style.minHeight,this.element)},set:function(e){on.setLength(this.element,"minHeight",e)}},{key:"disabled",get:function(){return this._disabled},set:function(e){var t=this.element,n=this.focusElement;e&&this.revertFocus(),t&&(t.classList[e?"add":"remove"]("b-disabled"),n&&(n.disabled=e)),this._disabled=e,this.onDisabled(e)}},{key:"tooltip",get:function(){if(this._tooltip)return this._tooltip;var e=this.constructor.tooltip;return e&&e.trigger("pointerOver",{source:e,target:this.element}),e},set:function(e){var t=this;t._tooltip&&(t._tooltip.destroy(),t._tooltip=null),delete t.element.dataset.btip,e&&(t.preventTooltipOnTouch&&Re.isTouchDevice||("Object"!==e.constructor.name&&(e={html:"string"==typeof e?e:t.placeholder,textContent:!0}),e.newInstance?(e.type="tooltip",e.forElement||(e.forElement=t.element),"showOnHover"in e||e.forSelector||(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),t._tooltip=Ce.createWidget(e)):(t.element.dataset.btip=!0,t.tipConfig=e)))}},{key:"isVisible",get:function(){var e=this,t=e.element;return Boolean(t&&!e._hidden&&!e.isDestroying&&rn(t)&&(!e.requireSize||function e(t){return t&&(t===document.body||("offsetParent"in t?t.offsetParent:e(t.parentNode)))}(t))&&(!e.owner||e.owner.isVisible))}},{key:"focusElement",get:function(){}},{key:"isFocusable",get:function(){var e=this.focusElement;return e&&this.isVisible&&!this.disabled&&(e===document.body||e.offsetParent)}},{key:"visible",set:function(e){this.hidden=!e}},{key:"hidden",set:function(e){this.isConfiguring?(this._hidden=e,this.element.classList[e?"add":"remove"]("b-hidden")):e?this.hide():this.show()},get:function(){return Boolean(this._hidden)}},{key:"assignedId",get:function(){return this.hasGeneratedId?null:this.id}},{key:"owner",get:function(){return this.parent||this._owner||this._element&&we.fromElement(this.forElement||this.element.parentNode)},set:function(e){this._owner=e}},{key:"previousSibling",get:function(){return this.getSibling(-1)}},{key:"nextSibling",get:function(){return this.getSibling(1)}},{key:"widgetClassList",get:function(){var e=this,t=e.cls,n=e.classHierarchy(r).reduce((function(t,n){var r,i=Reflect.getOwnPropertyDescriptor(n.prototype,"widgetClass");if(i&&i.get)r=i.get.call(e);else{var o=Object.prototype.hasOwnProperty.call(n,"$name")||Object.prototype.hasOwnProperty.call(n,"_$name")?n.$name:n.name;(o.length<3||o.includes("$"))&&console.warn("Widget class ".concat(o," with no $name getter found")),r="b-".concat(o.toLowerCase())}return r&&t.push.apply(t,Z()(r.split(" "))),t}),t?t.split(" "):[]);return e.floating&&n.push("b-floating"),Re.isTouchDevice&&n.push("b-touch"),n}},{key:"isAnimating",get:function(){return this._animating},set:function(e){this.isPainted&&e!==this.isAnimating&&(this.element.classList[e?"add":"remove"]("b-animating"),this._animating=e)}}],[{key:"$name",get:function(){return"Widget"}},{key:"defaultConfig",get:function(){return{element:!0,callOnFunctions:!0,id:"",html:null,hasGeneratedId:null,cls:null,style:null,disabled:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:null,preventTooltipOnTouch:null,monitorResize:null,cache:{},floating:null,positioned:null,draggable:null,align:"t-b",centered:null,constrainTo:null,anchor:null,scrollAction:null,hideAnimation:null,showAnimation:null,x:null,y:null,scrollable:null,scrollerClass:Mr,defaultBindProperty:"html",defaultAction:null,width:null,height:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title"],requireSize:!1,ref:null,hidden:null}}},{key:"floatRoot",get:function(){var e=this;return e._floatRoot||(e._floatRoot=document.querySelector(".b-float-root")),e._floatRoot?document.body.contains(e._floatRoot)||document.body.appendChild(e._floatRoot):(e._floatRoot=on.createElement({className:"b-float-root",parent:document.body}),Re.isAndroid&&(e._floatRoot.style.height="".concat(screen.height,"px"),Kn.on({element:window,orientationchange:function(){return e._floatRoot.style.height="".concat(screen.height,"px")}}))),e._floatRoot}}]),r}(or(pe(_e(G))));function zr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Nr._$name="Widget",ye.register("widget",Nr);var Vr,Wr,Ur=!1,Gr=(window.bryntum||(window.bryntum={})).GlobalEvents=new(function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(zr()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"suspendFocusEvents",value:function(){Ur=!0}},{key:"resumeFocusEvents",value:function(){Ur=!1}},{key:"lastInteractionType",get:function(){return Wr}}]),r}(pe(G))),Yr=function(e){return e.isVisible&&e.isTopModal};function $r(e,t,n,r,i,o,a){var s=new CustomEvent(e,a);return Object.defineProperty(s,"target",{get:function(){return t}}),Object.defineProperty(s,"relatedTarget",{get:function(){return n}}),s.fromWidget=r,s.toWidget=i,s.backwards=o,s}function qr(e,t){if(e===t)return e;for(var n=e instanceof Nr;e&&!e[n?"owns":"contains"](t)&&e!==t;)e=e[n?"owner":"parentNode"];return e}var Xr={element:document,touchstart:function(e){Vr=Vr||1!==e.changedTouches.length?null:e.changedTouches[0]},touchend:{handler:function(e){Vr&&(Vr.identifier===Kn.contextMenuTouchId?(e.stopImmediatePropagation(),e.preventDefault()):1===e.changedTouches.length&&e.changedTouches[0].identifier===Vr.identifier&&Gr.trigger("globaltap",{event:e}),Vr=null)},passive:!1},mousedown:{handler:function(e){Wr="mouse",Vr||Gr.trigger("globaltap",{event:e})},passive:!1},keydown:function(){Wr="key"},keypress:function(){Wr="key"},focusin:function(e){if(Nr.floatRoot.scrollTop=Nr.floatRoot.scrollLeft=0,!Ur){var t=e.relatedTarget?e.relatedTarget instanceof HTMLElement?e.relatedTarget:document.body:null,n=e.target||document.body,r=we.fromElement(t),i=we.fromElement(n),o=qr(r,i),a=!!(t&&4&n.compareDocumentPosition(t)),s=we.query(Yr),l=document.activeElement;if(!s||i&&s.owns(i)){for(var c=$r("focusout",t,e.target,r,i,a),u=r;u&&u!==o;u=u.owner)if(!u.isDestroyed&&!u.isDestroying&&u.onFocusOut&&(u.onFocusOut(c),l!==document.activeElement))return;if(o&&e.target===o.element)document.activeElement===n&&o.focusElement&&o.focusElement!==o.element&&o.setTimeout((function(){return o.focus&&o.focus()}),0);else{c=$r("focusin",n,t,r,i,a);for(var d=i;d&&d!==o;d=d.owner)d.isDestroyed||d.isDestroying||d.onFocusIn&&d.onFocusIn(c)}var f=qr(t&&1===t.nodeType?t:null,n)||n.parentNode;c=$r("focusmove",n,t,r,i,a,{bubbles:!0}),f.dispatchEvent(c)}else s.focus()}},focusout:function(e){Ur||e.relatedTarget&&we.fromElement(e.relatedTarget)||Xr.focusin({target:e.relatedTarget,relatedTarget:e.target})},capture:!0,passive:!0};function Kr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=mt.assign({},Xr,{element:e});Kn.on(t)}function Jr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Kr();var Qr=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Jr()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e),this.element||(this.element=document.body),this.show()}},{key:"doDestroy",value:function(){var e=this;e.maskElement&&(e.maskElement.remove(),e.maskElement=null,e.mode.endsWith("blur")&&on.forEachChild(e.element,(function(t){t.classList.remove("b-masked-".concat(e.mode))})),e.elementMask=null),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"create",value:function(){var e,t=this;t.elementMask=t,Object.assign(t,on.createElement({parent:t.element,className:(e={"b-mask":1,"b-mask-type":1,"b-widget":1},oe()(e,"b-mask-".concat(t.mode),1),oe()(e,"b-progress",t.maxProgress),oe()(e,"b-prevent-transitions",!t.useTransition),e),reference:"maskElement",children:[{className:"b-mask-content",reference:"maskContent",children:[t.maxProgress?{className:"b-mask-progress-bar",reference:"progressElement",style:{width:Math.round(t.progress/t.maxProgress*100)+"%"}}:null,{className:"b-mask-text",reference:"maskText"}]}]})),t.text=t._text}},{key:"show",value:function(){var e=this;e.hasTimeout("hide")&&(e.resolve(),e.clearTimeout("hide")),e.elementMask||e.create();var t=e.element,n=e.maskElement;n&&(t.classList.add("b-masked"),n.classList.add("b-visible"),n.classList.remove("b-hidden"),e.shown=!0,e.mode.endsWith("blur")&&on.forEachChild(t,(function(t){t!==n&&t.classList.add("b-masked-".concat(e.mode))})))}},{key:"hide",value:function(){var e=this,t=e.element,n=e.maskElement;return new Promise((function(r){e.shown?(e.shown=!1,n.classList.remove("b-visible"),n.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&on.forEachChild(t,(function(t){t!==n&&t.classList.remove("b-masked-".concat(e.mode))})),e.resolve=r,e.setTimeout((function(){return r()}),500,"hide")):r()}))}},{key:"close",value:function(){var e=this;return new Promise((function(t){e.hide().then((function(){e.destroy(),t()}))}))}},{key:"typeName",get:function(){return"string"==typeof this.type?this.type.trim():""}},{key:"maskName",get:function(){return"mask".concat(this.typeName)}},{key:"elementMask",get:function(){return this.element&&this.element[this.maskName]},set:function(e){this.element&&(this.element[this.maskName]=e)}},{key:"text",set:function(e){var t=this;t._text=e||"",t.maskText&&(t.maskText.innerHTML='<i class="b-mask-icon '.concat(t.icon,'"></i>').concat(t._text))},get:function(){return this._text}},{key:"progress",set:function(e){this._progress=e,this.progressElement&&null!=e&&(this.progressElement.style.width=Math.round(e/this._maxProgress*100)+"%")},get:function(){return this._progress}},{key:"maxProgress",set:function(e){this._maxProgress=e,this.progress=this.progress},get:function(){return this._maxProgress}}],[{key:"mask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;return new r("string"!=typeof e?Object.assign({element:t},e):{element:t,text:e})}},{key:"unmask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return e.mask&&e.mask.close()}},{key:"$name",get:function(){return"Mask"}},{key:"defaultConfig",get:function(){return{mode:"dark",icon:"b-icon b-icon-spinner",text:null,type:null,progress:null,maxProgress:null,useTransition:!1}}}]),r}(or());Qr._$name="Mask";var Zr=n(18),ei=n.n(Zr);n(61);function ti(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ni=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ti()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"template",value:function(){return'<div class="b-icon"></div>'}},{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e),Kn.on({element:this.element,click:"onClick",mousedown:"onMousedown",thisObj:this})}},{key:"onClick",value:function(e){var t=this,n=t.panel,r="function"==typeof t.handler?t.handler:n[t.handler];!1!==n.trigger("toolclick",{tool:t})&&r&&t.callback(r,n,[e])}},{key:"onMousedown",value:function(e){var t=this.panel,n=t.focusElement;e.preventDefault(),n&&document.activeElement!==n&&t.focus()}},{key:"panel",get:function(){return this.parent}}],[{key:"$name",get:function(){return"Tool"}}]),r}(Nr);function ri(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ni._$name="Tool",ye.register("tool",ni);var ii=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ri()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"renderChildren",value:function(){var e=this.owner,t=this.containerCls,n=this.itemCls,r=e.contentElement,i=e.items,o=e.itemCls,a=i&&i.length;if(r.classList.add("b-content-element"),t&&r.classList.add(t),a){e.textContent=!1;for(var s=0;s<a;s++){var l=i[s],c=l.element;c.dataset.itemIndex=s,n&&c.classList.add(n),o&&c.classList.add(o),c.classList.remove("b-outer"),l.render(r,Boolean(e.isPainted))}}}},{key:"removeChild",value:function(e){var t=e.element,n=this.owner,r=this.itemCls,i=n.contentElement,o=n.itemCls;i.removeChild(t),delete t.dataset.itemIndex,r&&t.classList.remove(r),o&&t.classList.remove(o),this.fixChildIndices()}},{key:"appendChild",value:function(e){var t=e.element,n=this.owner.indexOfChild(e),r=this.owner,i=this.itemCls,o=r.contentElement,a=r.itemCls;t.dataset.itemIndex=n,r.textContent=!1,i&&t.classList.add(i),a&&t.classList.add(a),o.appendChild(t)}},{key:"insertChild",value:function(e,t){var n=e.element,r=this.owner,i=this.itemCls,o=r.contentElement,a=o.querySelector('[data-item-index="'.concat(t-1,'"]')),s=r.itemCls;r.textContent=!1,i&&n.classList.add(i),s&&n.classList.add(s),o.insertBefore(n,a&&a.nextSibling),this.fixChildIndices()}},{key:"fixChildIndices",value:function(){this.owner.items.forEach((function(e,t){e.element.dataset.itemIndex=t}))}}],[{key:"getLayout",value:function(e,t){if(e instanceof r)return e;var n="string"==typeof e,i={owner:t};return new(n?oi[e]:e)(n?i:Object.assign(i,e))}},{key:"registerLayout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.$name.toLowerCase();oi[t]=e}},{key:"defaultConfig",get:function(){return{containerCls:null,itemCls:null}}}]),r}(pe(G)),oi={default:ii};function ai(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ii._$name="Layout";var si=0,li=function(e){return e.ripple},ci=window.Ripple=new(function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ai()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"afterConstruct",value:function(){se()(J()(r.prototype),"afterConstruct",this).call(this),Kn.on({element:document,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}},{key:"onRippleControllingEvent",value:function(e){var t=this;t.show();var n=on.getStyleValue(t.circleElement,"animationName");t.hide(),t.listenerDetacher&&t.listenerDetacher(),n&&"none"!==n&&(t.listenerDetacher=Kn.on({mousedown:{element:document,capture:!0,handler:"onDocumentMousedown"},touchstart:{element:document,capture:!0,handler:"onDocumentTouchStart"},animationend:{element:t.circleElement,handler:"onAnimationEnd"},thisObj:t}),"mousedown"===e.type&&(t.onDocumentMousedown(e),Gr.on({theme:"onRippleControllingEvent",thisObj:this})))}},{key:"onDocumentTouchStart",value:function(e){si=performance.now(),this.handleTriggerEvent(e)}},{key:"onDocumentMousedown",value:function(e){performance.now()-si>200&&this.handleTriggerEvent(e)}},{key:"handleTriggerEvent",value:function(e){var t=we.fromElement(e.target,li);if(t){var n=t.ripple,r=n.delegate?e.target.closest(n.delegate):t.focusElement||t.element;if(r){var i=mt.assign({event:e,target:r,radius:this.radius},n);if("string"==typeof i.clip&&(i.clip=t[i.clip]||e.target.closest(i.clip),!i.clip))return;this.ripple(i)}}}},{key:"ripple",value:function(e){var t=e.event,n=e.point,r=void 0===n?Kn.getClientPoint(t):n,i=e.target,o=void 0===i?t.target:i,a=e.clip,s=void 0===a?o:a,l=e.radius,c=void 0===l?this.radius:l,u=e.color,d=void 0===u?this.color:u;this.clip=s,s=In.from(s,null,!0);var f=this,h=s.getDelta(r),g=f.rippleElement.style,v=f.circleElement;f.hide(),f.alignTo(s),g.transform="translateX(".concat(h[0],"px) translateY(").concat(h[1],"px)"),g.height=g.width="".concat(c,"px"),v.setAttribute("r",c),v.setAttribute("fill",d),f.show(),f.requestAnimationFrame((function(){document.addEventListener("scroll",f.callRealign,!0),f.documentScrollListener=!0}))}},{key:"alignTo",value:function(e){1===e.nodeType&&(e=In.from(e,null,!0));var t=e,n=t.x,r=t.y,i=t.width,o=t.height;this.x=n,this.y=r,this.height=o,this.width=i}},{key:"onAnimationEnd",value:function(e){"b-ripple-expand"===e.animationName&&this.hide()}},{key:"realign",value:function(){this.isVisible&&this.alignTo(this.clip)}}],[{key:"defaultConfig",get:function(){return{id:"bryntum-ripple",old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}},{key:"$name",get:function(){return"Ripple"}}]),r}(Nr));function ui(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return di(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return di(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function di(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fi=function(){function e(t){D()(this,e);var n=this;n.generation=0,n.items=new Set,n.idMap={},n.idProperty="id",t&&(t.idProperty&&(n.idProperty=t.idProperty),t.values&&(n.values=t.values))}return M()(e,[{key:"get",value:function(e){return this.idMap[wr(e)]}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length&&Array.isArray(t[0])&&(t=t[0]);for(var r=this,i=r.items,o=r.idMap,a=r.idProperty,s=t.length,l=0;l<s;l++){var c=t[l],u=br[re()(c)]?c:wr(c[a]),d=o[u];null==d?(o[u]=c,i.add(c),r.generation++):d!==c&&(o[u]=c,i.delete(d),i.add(c))}}},{key:"remove",value:function(e){Array.isArray(e)||(e=[e]);for(var t=this.items,n=this.idMap,r=this.idProperty,i=e.length,o=0;o<i;o++){var a=e[o],s=br[re()(a)]?a:wr(a[r]),l=n[s];null!=l&&(t.delete(l),delete n[s],this.generation++)}}},{key:"clear",value:function(){this.items.clear(),this.idMap={},this.generation++}},{key:"changeId",value:function(e,t){var n=this.idMap,r=this.idProperty,i=br[re()(e)]?e:wr(e[r]),o=this.get(i);if(o){var a=this.get(t);if(a&&o!==a)throw new Error("Attempt to set item ".concat(i," to already existing member's id ").concat(t));o[r]=t,delete n[i],n[t]=o}}},{key:"includes",value:function(e){var t=br[re()(e)]?e:wr(e[this.idProperty]);return Boolean(this.idMap[t])}},{key:"map",value:function(e,t){var n=this.items,r=new Array(n.size),i=0;return n.forEach((function(o){r[i]=e.call(t,o,i++,n)})),r}},{key:"forEach",value:function(e,t){return this.items.forEach(e,t)}},{key:"find",value:function(e){var t,n=ui(this.items);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(e){n.e(e)}finally{n.f()}}},{key:Symbol.iterator,value:function(){return this.items[Symbol.iterator]()}},{key:"indexOf",value:function(e){return this.values.indexOf(e)}},{key:"sort",value:function(e){this.values=this.values.sort(e)}},{key:"some",value:function(e,t){return this.values.some(e,t)}},{key:"count",get:function(){return this.items.size}},{key:"values",get:function(){return Z()(this.items)},set:function(e){Array.isArray(e)||(e=[e]),this.clear(),this.add.apply(this,e),this.generation++}}]),e}();function hi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}fi._$name="Bag";var gi=Object.freeze({}),vi=function(e){return e.weight},pi=function(e,t){return(e.weight||0)-(t.weight||0)},yi=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(hi()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"setConfig",value:function(e,t){e.widgets&&(e.items=e.widgets),se()(J()(r.prototype),"setConfig",this).call(this,e,t)}},{key:"startConfigure",value:function(e){var t=this.items;this.hasItems=Boolean(t&&t.length),se()(J()(r.prototype),"startConfigure",this).call(this,e)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0;1===t.length&&(Array.isArray(t[0])?t=t[0]:r=!1);for(var i=this,o=[],a=0;a<t.length;a++){var s=t[a];i._items.includes(s)&&(i._items.remove(s),i.layout.removeChild(s),o.push(s),i.unregisterReference(s))}return r?o:o[0]}},{key:"removeAll",value:function(){return this.remove(this.items)}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0;1===t.length&&(Array.isArray(t[0])?t=t[0]:r=!1);for(var i=this,o=[],a=0;a<t.length;a++){var s=t[a];s instanceof Nr?s.parent=i:s=i.createWidget(s),i._items.includes(s)||(i.registerReference(s),i._items.add(s),i.layout.appendChild(s),o.push(s))}return r?o:o[0]}},{key:"insert",value:function(e,t){var n=this,r=n._items;e instanceof Nr?e.parent=n:e=n.createWidget(e),r.includes(t)&&(t=n.indexOfChild(t)),t=Math.min(t,r.count);var i=r.values;return i.splice(t,0,e),r.values=i,n.registerReference(e),n.layout.insertChild(e,t),e}},{key:"indexOfChild",value:function(e){return this._items.indexOf(e)}},{key:"processItemsArray",value:function(e,t){var n,r,i=e.length;for(n=0;n<i;n++)(r=e[n])instanceof Nr?r.parent=this:r=this.createWidget(r),r&&t.add(r)}},{key:"processItemsObject",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gi,i=arguments.length>2?arguments[2]:void 0;for(n in e)(t=e[n])&&(n in r&&(t="object"===re()(t)?mt.merge(mt.clone(r[n]),t):r[n]),t&&(t instanceof Nr?t.parent=this:t=this.createWidget(t),t&&(t.ref=n,i.add(t))))}},{key:"registerReference",value:function(e){var t=e.ref||e.id;if(t)for(var n=this;n;n=n.parent)n.widgetMap[t]||(n.widgetMap[t]=e)}},{key:"unregisterReference",value:function(e){var t=e.ref||e.id;if(t)for(var n=this;n;n=n.parent)n.widgetMap[t]===e&&delete n.widgetMap[t]}},{key:"getValues",value:function(e){for(var t=this.queryAll((function(e){return e.name})),n=t.length,r={},i=0;i<n;i++){var o=t[i],a=o.name;e&&!e(o)||(r[a]=o.value)}return r}},{key:"eachWidget",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.childItems,r=n?n.length:0,i=0;i<r;i++){var o=n[i];if(!1===e(o))return!1;if(t&&o.eachWidget&&!1===o.eachWidget(e,t))return!1}return!0}},{key:"queryAll",value:function(e){var t=[];return this.eachWidget((function(n){e(n)&&t.push(n)})),t}},{key:"query",value:function(e){var t=null;return this.eachWidget((function(n){if(e(n))return t=n,!1})),t}},{key:"getWidgetById",value:function(e){return this.widgetMap[e]}},{key:"processWidgetConfig",value:function(e){}},{key:"createWidget",value:function(e){var t=this;"string"==typeof e?e={html:e}:1===e.nodeType&&(e={element:e,id:e.id}),(e=Object.setPrototypeOf({parent:t},e)).type||(e.type=t.defaultType);for(var n=e.parent;n;n=n.parent)if(!1===n.processWidgetConfig(e))return null;return!1===t.trigger("beforeWidgetCreate",{widget:e})?null:Ce.createWidget(mt.assign({},t.defaults,e),t.defaultType||"widget")}},{key:"render",value:function(){this.layout.renderChildren(),se()(J()(r.prototype),"render",this).apply(this,arguments)}},{key:"doDestroy",value:function(){!this.configuredItems&&this.items&&this.items.forEach((function(e){return e.destroy&&e.destroy()})),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"setValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._isSettingValues=!0,this.eachWidget((function(n){var r=n.highlightExternalChange,i=t?n.name:n.name||n.ref||n.id;"value"in n&&i&&(n.highlightExternalChange=!1,n.value=e&&i in e?e[i]:null,n.highlightExternalChange=r)}),!0),this._isSettingValues=!1}},{key:"widgets",set:function(e){console.warn("`widgets` was deprecated in 2.1, please change your code to use `items`")},get:function(){return console.warn("`widgets` was deprecated in 2.1, please change your code to use `items`"),this.items}},{key:"items",set:function(e){this.configuredItems=e},get:function(){var e=this,t=e._items||(e._items=new fi),n=e.configuredItems;return n&&(e.configuredItems=!1,Array.isArray(n)?e.processItemsArray(n,t):n&&e.processItemsObject(n,e.namedItems,t),t.some(vi)&&t.sort(pi),t.forEach(e.registerReference,e)),t.values}},{key:"widgetMap",get:function(){return this._widgetMap||(this._widgetMap={}),this._thisIsAUsedExpression(this.items),this._widgetMap}},{key:"record",set:function(e){this._record=e,this.setValues(e,!0)},get:function(){return this._record}},{key:"textContent",set:function(e){this._textContent=e,this.element.classList[e?"add":"remove"]("b-text-content")},get:function(){return this._textContent}},{key:"layoutStyle",set:function(e){on.applyStyle(this.contentElement,e),this._layoutStyle=e},get:function(){return this._layoutStyle}},{key:"layout",set:function(e){this._layout=ii.getLayout(e,this)},get:function(){return this._layout||(this._layout=new ii)}},{key:"childItems",get:function(){return this.items}},{key:"focusElement",get:function(){var e=this.query(this.defaultFocus||function(e){return e.isFocusable});return e?e.focusElement:se()(J()(r.prototype),"focusElement",this)}},{key:"isValid",get:function(){var e=!0;return this.eachWidget((function(t){if("isValid"in t&&!t.isValid)return e=!1}),!0),e}},{key:"values",get:function(){var e={};return this.eachWidget((function(t){"value"in t&&(e[t.name||t.ref||t.id]=t.value)}),!0),e},set:function(e){this.setValues(e)}},{key:"isSettingValues",get:function(){return this._isSettingValues||this.parent&&this.parent.isSettingValues}}],[{key:"$name",get:function(){return"Container"}},{key:"defaultConfig",get:function(){return{items:null,widgets:null,defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:"default",namedItems:null,textContent:!0}}}]),r}(Nr);function mi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}yi._$name="Container",ye.register("container",yi);var bi=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(mi()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"createWidget",value:function(e){"->"===e?e={type:"widget",cls:"b-toolbar-fill"}:"|"===e?e={type:"widget",cls:"b-toolbar-separator"}:"string"==typeof e&&(e={type:"widget",cls:"b-toolbar-text",html:e});var t=se()(J()(r.prototype),"createWidget",this).call(this,e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}}],[{key:"$name",get:function(){return"Toolbar"}},{key:"defaultConfig",get:function(){return{defaultType:"button",widgetCls:null,layout:"default"}}}]),r}(yi);function ki(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}bi._$name="Toolbar",ye.register("toolbar",bi);var wi=function(e){return!e.classList.contains("b-focus-trap")&&on.isFocusable(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP},Si=function(e,t){return(e.weight||0)-(t.weight||0)},Ci=function(e,t){return(t.weight||0)-(e.weight||0)};wi.acceptNode=wi;var Ri=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ki()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onFocusTrapped",value:function(e){var t=this,n=t.treeWalker;e.target===t.bottomFocusTrap?(n.currentNode=t.topFocusTrap,n.nextNode()):(n.currentNode=t.bottomFocusTrap,n.previousNode()),t.requestAnimationFrame((function(){return n.currentNode.focus()}))}},{key:"doDestroy",value:function(){var e=this.tools;if(e)for(var t=0,n=Object.values(e);t<n.length;t++){n[t].destroy()}this.tbar&&this.tbar.destroy(),this.bbar&&this.bbar.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"element",set:function(e){var t=this,n=t.title&&(!t.parent||!t.parent.suppressChildHeaders),i=t.header||(t.tools||n?{}:null),o=t.footer,a=i&&("string"==typeof i?i:t.title||i.title),s=i&&(i.titleAlign||"start"),l=t.classHierarchy(r).map((function(e){return"b-".concat(e.$name.toLowerCase(),"-header")})).join(" "),c=t.tbar,u=t.bbar||t.buttons,d=[{reference:"topFocusTrap",className:"b-focus-trap",tabIndex:0}],f=[],h=[],g={children:d};if((t.hasItems||t.focusable)&&(g.tabIndex=0),i){var v=[{reference:"titleElement",className:"b-header-title b-align-".concat(s),html:a}];for(var p in t.tools){var y=t.tools[p];"start"===y.align?f.unshift(y):h.push(y)}f.sort(Si),h.sort(Ci),v.unshift.apply(v,Z()(f.map((function(e){return e.element})))),v.push.apply(v,Z()(h.map((function(e){return e.element})))),d.push({tag:"header",reference:"headerElement",className:"".concat(l," b-dock-").concat(i.dock||"top"," ").concat(i.cls||""),children:v})}c&&(c.layout.renderChildren(),d.push(c.element)),d.push(t.bodyConfig),u&&(u.layout.renderChildren(),d.push(u.element)),o&&d.push({tag:"footer",reference:"footerElement",className:"".concat(l," b-dock-").concat(o.dock||"bottom"," ").concat(o.cls||"")}),d.push({reference:"bottomFocusTrap",className:"b-focus-trap",tabIndex:0}),ei()(J()(r.prototype),"element",g,this,!0)},get:function(){return se()(J()(r.prototype),"element",this)}},{key:"bodyConfig",set:function(e){this._bodyConfig=e},get:function(){return this._bodyConfig||{reference:"bodyElement",className:this.classHierarchy(r).map((function(e){return"b-".concat(e.$name.toLowerCase(),"-content")})).join(" "),html:this.html}}},{key:"tbar",get:function(){return this._tbar},set:function(e){e instanceof bi?e.parent=this:(Array.isArray(e)&&(e={items:e}),e=new bi(Object.assign({parent:this},e))),this.hasItems=this.hasItems||e.hasItems,e.element.classList.add("b-top-toolbar","b-dock-".concat(e.dock||"top")),this._tbar=e}},{key:"bbar",get:function(){return this._bbar},set:function(e){e instanceof bi?e.parent=this:(Array.isArray(e)&&(e={items:e}),e=Ce.createWidget(Object.assign({type:"toolbar",parent:this},e))),this.hasItems=this.hasItems||e.hasItems,e.element.classList.add("b-bottom-toolbar","b-dock-".concat(e.dock||"bottom")),this._bbar=e}},{key:"childItems",get:function(){var e=this,t=e.items?e.items.slice():[];return e.tools&&t.unshift.apply(t,Z()(Object.values(e.tools))),e.tbar&&t.unshift(e.tbar),e.bbar&&t.push(e.bbar),t}},{key:"tools",set:function(e){var t=this._tools={};for(var n in e){var r=t[n]=Ce.createWidget(mt.assign({type:"tool",ref:n,reference:n,parent:this},e[n]),this.defaultToolType||"tool");this.registerReference(r,r.ref)}},get:function(){return this._tools}},{key:"trapFocus",set:function(e){var t=this;t.element.classList[e?"add":"remove"]("b-focus-trapped"),e?(t.focusTrapListener=Kn.on({element:t.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:t}),t.treeWalker||(t.treeWalker=document.createTreeWalker(t.element,NodeFilter.SHOW_ELEMENT,wi,!1))):t.focusTrapListener&&(t.focusTrapListener(),t.focusTrapListener=null),t._trapFocus=e},get:function(){return this._trapFocus}},{key:"focusElement",get:function(){return this.hasItems&&(se()(J()(r.prototype),"focusElement",this)||this.element)}},{key:"contentElement",get:function(){return this.element&&this.bodyElement}},{key:"widgetClassList",get:function(){var e=this,t=se()(J()(r.prototype),"widgetClassList",this),n=e.header;return(n||e.title||e.tools)&&t.push("b-panel-has-header b-header-dock-".concat(n&&n.dock||"top")),e.tbar&&t.push("b-panel-has-top-toolbar"),e.bbar&&t.push("b-panel-has-bottom-toolbar"),t}}],[{key:"$name",get:function(){return"Panel"}},{key:"defaultConfig",get:function(){return{trapFocus:null,title:null,header:null,footer:null,tools:null,tbar:null,bbar:null}}}]),r}(yi);function xi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ri._$name="Panel",ye.register("panel",Ri);var Ei=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(xi()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"startConfigure",value:function(e){this._thisIsAUsedExpression(this.closable),se()(J()(r.prototype),"startConfigure",this).call(this,e)}},{key:"finalizeInit",value:function(){var e=this;e.anchoredTo=e.forElement,e.initialAnchor=e.anchor,e.forElement&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),Kn.on({element:e.forElement,click:"onElementUserAction",thisObj:e})),se()(J()(r.prototype),"finalizeInit",this).call(this),e.autoShow&&(!0===e.autoShow?e.show():e.setTimeout((function(){return e.show()}),e.autoShow))}},{key:"doDestroy",value:function(){this.syncModalMask(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"close",value:function(){if(!this._hidden&&!1!==this.trigger("beforeClose")||this._hidden&&"destroy"==this.closeAction)return this[this.closeAction]()}},{key:"onElementResize",value:function(e,t,n){var i=this,o=i.lastAlignSpec;if(i.isVisible&&o&&o.target){var a=!t||n.height!==t.height,s=!t||n.width!==t.width;(a&&2!==o.zone||s&&1!==o.zone)&&i.requestAnimationFrame((function(){return i.realign()}))}se()(J()(r.prototype),"onElementResize",this).call(this,e)}},{key:"onInternalKeyDown",value:function(e){"Escape"===e.key&&(e.stopImmediatePropagation(),this.close(!0))}},{key:"onDocumentMouseDown",value:function(e){var t=e.event,n=this;n.modal&&t.target===r.modalMask?(t.preventDefault(),n.modal.closeOnMaskTap?n.close():n.containsFocus||n.focus()):n.owns(t.target)||!n.autoClose||n.containsFocus||n.close(),n.setTimeout((function(){return document.body.classList.add("b-using-keyboard")}),0)}},{key:"onFocusIn",value:function(e){var t=document.activeElement;se()(J()(r.prototype),"onFocusIn",this).call(this,e),document.activeElement===t&&e.target===this.element&&this.focus()}},{key:"onFocusOut",value:function(e){!this.modal&&this.autoClose&&this.close(),se()(J()(r.prototype),"onFocusOut",this).call(this,e)}},{key:"onShow",value:function(){var e=this;e.autoClose&&e.addDocumentMouseDownListener(),e.focusOnToFront&&e.focus(),se()(J()(r.prototype),"onShow",this)&&se()(J()(r.prototype),"onShow",this).call(this),e.syncModalMask()}},{key:"addDocumentMouseDownListener",value:function(){this.mouseDownRemover||(this.mouseDownRemover=Gr.on({globaltap:"onDocumentMouseDown",thisObj:this}))}},{key:"syncModalMask",value:function(){var e=this,t=e.modal,n=r.modalMask;if(t&&e.isVisible)e._x||e._y||(e.centered=!0),n.classList.remove("b-hide-display"),n.parentNode.insertBefore(n,e.element),e.element.classList.add("b-modal");else{e.element.classList.remove("b-modal");var i=e.constructor.floatRoot.querySelectorAll(".b-modal");if(i.length){var o=i[i.length-1];n.classList.remove("b-hide-display"),n.parentNode.insertBefore(n,o)}else n.classList.add("b-hide-display")}}},{key:"onHide",value:function(){this.mouseDownRemover&&(this.mouseDownRemover(),this.mouseDownRemover=null),se()(J()(r.prototype),"onHide",this)&&se()(J()(r.prototype),"onHide",this).call(this),this.syncModalMask()}},{key:"onElementUserAction",value:function(){this.show()}},{key:"isTopModal",get:function(){return on.isVisible(r.modalMask)&&this.element.previousElementSibling===r.modalMask}},{key:"closable",set:function(e){this._closable=e,this.tools||(this.tools={})},get:function(){return this._closable}},{key:"tools",set:function(e){this.closable&&((e||(e={})).close={cls:"b-popup-close",handler:"close",weight:-1e3}),ei()(J()(r.prototype),"tools",e,this,!0)},get:function(){return se()(J()(r.prototype),"tools",this)}}],[{key:"$name",get:function(){return"Popup"}},{key:"defaultConfig",get:function(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:Re.isIE11?null:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:Re.isIE11?null:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,modal:null}}},{key:"modalMask",get:function(){var e=this;return e._modalMask?e.floatRoot.contains(e._modalMask)||e.floatRoot.appendChild(e._modalMask):e._modalMask=on.createElement({className:"b-modal-mask b-hide-display",parent:e.floatRoot}),e._modalMask}}]),r}(Ri);Ei._$name="Popup",ye.register("popup",Ei);var Di=n(33),Ti=n.n(Di),Mi=(n(152),/>[ \t\r\n]+</g),Ai=/\s\s+/g,Ii=function(){function e(){D()(this,e)}return M()(e,null,[{key:"tpl",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,o=n.map((function(t,n){var r=e[n];return Array.isArray(t)?r+=t.reduce((function(e,t){return e+(("string"==typeof t?t.trim():t)+"\n")}),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),i++,r})).join("");return i<=e.length&&(o+=e[e.length-1]),o.replace(Mi,"><").replace(Ai," ").trim()}},{key:"docsTpl",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,o=n.map((function(t,n){var r=e[n];return Array.isArray(t)?r+=t.reduce((function(e,t){return e+(("string"==typeof t?t.trim():t)+"\n")}),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),i++,r})).join("");return i<=e.length&&(o+=e[e.length-1]),o.replace(Mi,"><").trim()}},{key:"repeat",value:function(t){return function(){return e.tpl.apply(e,arguments).repeat(t)}}},{key:"loop",value:function(e){}}]),e}();function Fi(){var e=Ti()(["\n            <"," "," ",' class="','" ',' tabIndex="-1">\n                ','\n                <span class="b-menu-text" reference="textElement">',"</span>\n                ","\n            </",">"]);return Fi=function(){return e},e}function Oi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ii._$name="TemplateHelper";var _i=/^b-icon-/,Pi=/^b-fa-/,Li=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Oi()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"doAction",value:function(e){var t=this.parent,n={menu:t,item:this,element:this.element,bubbles:!0};"boolean"==typeof this.checked&&(this.checked=!this.checked),this.trigger("beforeItem",n),this.trigger("item",n),this.closeParent&&t&&(t.rootMenu.close(),e&&!this.href&&e.preventDefault())}},{key:"doDestroy",value:function(){var e=this._menu;e instanceof Nr&&e.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"template",value:function(e){var t=e.icon||("boolean"==typeof e.checked?"b-fw-icon b-icon-".concat(e.checked?"":"un","checked"):""),n=_i.test(t)?" b-icon":Pi.test(t)?" b-fa":"",r=e.href?"a":"div";return Ii.tpl(Fi(),r,"a"===r?'href="'.concat(e.href,'"'):"","a"===r&&e.target?'target="'.concat(e.target,'"'):"",e.hasMenu?"b-has-submenu":"",e.name?'data-name="'.concat(e.name,'"'):"",t?'<i class="b-menuitem-icon '.concat(t).concat(n,'" reference="iconElement"></i>'):"",e.text,e.hasMenu?'<i class="b-fw-icon b-icon-sub-menu" reference="subMenuIcon"></i>':"",r)}},{key:"onFocusIn",value:function(e){se()(J()(r.prototype),"onFocusIn",this).call(this,e),!this.disabled&&this.menu&&this.openMenu()}},{key:"onFocusOut",value:function(e){se()(J()(r.prototype),"onFocusOut",this).call(this,e),this.closeMenu()}},{key:"openMenu",value:function(e){var t=this.menu;!this.disabled&&t&&(t.focusOnToFront=e,t.show(),this.owner.currentSubMenu=t)}},{key:"closeMenu",value:function(){this._menu instanceof Nr&&this.menu.close()}},{key:"focusElement",get:function(){return this.element}},{key:"contentElement",get:function(){return this.textElement}},{key:"isFocusable",get:function(){var e=this.focusElement;return e&&this.isVisible&&(e===document.body||e.offsetParent)}},{key:"checked",set:function(e){var t=this,n=t.isConfiguring;(n||"boolean"==typeof t._checked)&&(e=!!e)!==t._checked&&(t._checked=e,n||(t.iconElement.classList[e?"add":"remove"]("b-icon-checked"),t.iconElement.classList[e?"remove":"add"]("b-icon-unchecked"),t.trigger("toggle",{menu:t.owner,item:t,checked:t._checked,element:t.element,bubbles:!0})))},get:function(){return this._checked}},{key:"menu",set:function(e){this._menu=e},get:function(){var e=this,t=e._menu;return!t||t instanceof Nr||("object"!==re()(t)||"items"in t||"widgets"in t||"html"in t||(t={items:t}),t=e.menu=Ce.createWidget(Object.assign({type:"menu",autoShow:!1,autoClose:!0,scrollAction:e.owner.scrollAction,constrainTo:e.owner.constrainTo,forElement:e.element,align:"l0-r0",anchor:!0,owner:e,cls:"b-sub-menu"},t))),t}},{key:"text",get:function(){return this.html},set:function(e){this.html=e}},{key:"closeParent",set:function(e){this._closeParent=e},get:function(){return("boolean"==typeof this.checked?this._closeParent:!1!==this._closeParent)&&!this.hasMenu}},{key:"hasMenu",get:function(){var e=this.isConfiguring?this.initialConfig.menu:this._menu;return e&&(e instanceof Nr||"object"===re()(e)||e.length>0)}}],[{key:"$name",get:function(){return"MenuItem"}},{key:"defaultConfig",get:function(){return{menu:null,icon:null,text:null,checked:null,closeParent:null,href:null,target:null,localizableProperties:["text"]}}}]),r}(Nr);function Hi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Li._$name="MenuItem",ye.register("menuitem",Li);var ji={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1},Bi=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Hi()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){Array.isArray(e)&&(e={items:e}),se()(J()(r.prototype),"construct",this).call(this,e),Kn.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseleave:"onMouseLeave",thisObj:this})}},{key:"afterShow",value:function(e){this.items.some((function(e){return Boolean(e._menu)}))&&this.element.classList.add("b-menu-with-submenu"),this.items.some((function(e){return e.icon}))&&this.element.classList.add("b-menu-with-icon"),se()(J()(r.prototype),"afterShow",this).call(this,e)}},{key:"createWidget",value:function(e){return"string"==typeof e&&(e={text:e}),se()(J()(r.prototype),"createWidget",this).call(this,e)}},{key:"onDocumentMouseDown",value:function(e){this.parentMenu&&this.parentMenu.owns(e.event.target)||se()(J()(r.prototype),"onDocumentMouseDown",this).call(this,e)}},{key:"hide",value:function(e){se()(J()(r.prototype),"hide",this).call(this,e),this.currentSubMenu&&!this.currentSubMenu.isDestroyed&&this.currentSubMenu.hide(e),this.parentMenu&&(this.parentMenu.currentSubMenu=null)}},{key:"onMouseClick",value:function(e){var t=e.target.closest(".b-menuitem");t&&(this.triggerElement(t,e),e.stopImmediatePropagation())}},{key:"onMouseOver",value:function(e){if(!1!==this.focusOnHover){var t=on.up(e.relatedTarget,".b-widget"),n=on.up(e.target,".b-widget"),r=we.fromElement(n);!on.isTouchEvent&&n&&n!==t&&r.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[r],cancelOutstanding:!0})}}},{key:"handleMouseOver",value:function(e){e.focus()}},{key:"onMouseLeave",value:function(e){var t=this,n=e.relatedTarget,r=n&&t.owns(n),i=n&&n instanceof HTMLElement&&we.fromElement(n),o=!r;if(i){for(;i.ownerCmp;)i=i.ownerCmp;o&=!on.getAncestor(i.element,[e.target])}!r&&o&&(t.currentSubMenu&&t.currentSubMenu.hide(),t.currentSubMenu=t.selectedElement=null,t.element.contains(document.activeElement)&&document.activeElement.matches(".b-menuitem")&&t.focusElement.focus())}},{key:"onInternalKeyDown",value:function(e){var t=we.fromElement(e),n=t&&t!==this&&!(t instanceof Li);if("Escape"!==e.key){if(se()(J()(r.prototype),"onInternalKeyDown",this).call(this,e),!n){ji[e.key]&&e.preventDefault();var i=document.activeElement,o=this.element;this.navigateFrom(i!==o&&o.contains(i)?i:null,e.key,e)}}else(n?this:this.rootMenu).close()}},{key:"navigateFrom",value:function(e,t,n){var r,i=this,o=i.treeWalker,a=e&&i.getItem(e);switch(t){case"ArrowUp":o.currentNode=e||(e=i.bottomFocusTrap),o.previousNode(),r=o.currentNode;break;case"ArrowDown":o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode;break;case" ":e&&!e.classList.contains("b-disabled")&&(a&&a.menu?i.openSubMenu(e,a):i.triggerElement(e,n));break;case"ArrowRight":if(e&&a&&a.menu&&!e.classList.contains("b-disabled")){var s=i.openSubMenu(e,a);s&&s.focus()}else o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode;break;case"ArrowLeft":i.isSubMenu?i.hide():e||(o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode);break;case"Enter":e&&!e.classList.contains("b-disabled")&&i.triggerElement(e,n)}r&&(r===i.element?i.navigateFrom(i.bottomFocusTrap,"ArrowUp",n):r===e?i.navigateFrom(i.topFocusTrap,"ArrowDown",n):r.focus())}},{key:"getItem",value:function(e){if(null!=e)return"number"==typeof e?this.items[e]:1===e.nodeType?we.fromElement(e,"menuitem",this.contentElement):this.items.find((function(t){return t.id==e}))}},{key:"triggerElement",value:function(e,t){var n=this.getItem(e);n&&!n.disabled&&n.doAction(t)}},{key:"openSubMenu",value:function(e,t){var n=t.menu;if(n){if(!n.isVisible){var r={item:t,element:e};if(!1===this.trigger("beforeSubMenu",r))return;if(t.onBeforeSubMenu&&!1===t.onBeforeSubMenu(r))return;n.show()}return this.currentSubMenu=n}}},{key:"selectFirst",value:function(){var e=this.treeWalker;e.currentNode=this.topFocusTrap,e.nextNode(),this.requestAnimationFrame((function(){return e.currentNode.focus()}))}},{key:"focusElement",get:function(){var e=this.parentMenu&&this.parentMenu.element.contains(document.activeElement),t=this.items[0];return!e&&t instanceof Li?this.element:se()(J()(r.prototype),"focusElement",this)}},{key:"isSubMenu",get:function(){return this.owner&&this===this.owner.menu}},{key:"selectedElement",set:function(e){var t=this._selectedElement;if(t){var n=this.getItem(t),r=n&&n.menu;r&&r.hide(),t.classList.remove("b-active")}if(this._selectedElement=e,e){var i=on.isFocusable(e);e.classList.add("b-active"),this.scrollable.scrollIntoView(e,{animate:!i,focus:i})}},get:function(){return this._selectedElement}},{key:"parentMenu",get:function(){var e=this.owner;if(e instanceof Li&&(e=e.owner),e instanceof r)return e}},{key:"rootMenu",get:function(){for(var e=this;e.parentMenu&&e.parentMenu instanceof this.constructor;)e=e.parentMenu;return e}}],[{key:"$name",get:function(){return"Menu"}},{key:"defaultConfig",get:function(){return{align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem"}}}]),r}(Ei);function Ni(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Bi._$name="Menu",ye.register("menu",Bi);var zi=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ni()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"doDestroy",value:function(){var e=r.toasts.indexOf(this);e>-1&&r.toasts.splice(e,1),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"show",value:function(){se()(J()(r.prototype),"show",this).call(this),this.timeout>0&&(this.hideTimeout=this.setTimeout("hide",this.timeout))}},{key:"hide",value:function(){var e=this;e.destroyTimer||(e.element.classList.add("b-toast-hide"),e.element.style.bottom="",e.destroyTimer=e.setTimeout("destroy",e.destroyTimeout))}},{key:"element",set:function(e){},get:function(){if(!this._element&&!this.isConfiguring){var e=this,t=r.toasts.length&&r.toasts[0].element,n=t?t._nextBottom:e.bottomMargin,i=ei()(J()(r.prototype),"element",on.createElement({parent:e.appendTo||Nr.floatRoot,children:e.showProgress?[{className:"b-toast-progress",style:"animation-duration:".concat(e.timeout/1e3,"s;")}]:null,html:e._html,className:e.color||"",style:e._style||""}),this,!0);Kn.on({element:i,click:"hide",thisObj:e}),r.toasts.unshift(e),i._nextBottom=n+i.offsetHeight+e.bottomMargin,i.style.cssText+=";bottom:".concat(n,"px;transform:translateY(0)")}return se()(J()(r.prototype),"element",this)}}],[{key:"hideAll",value:function(){r.toasts.reverse().forEach((function(e){return e.hide()}))}},{key:"show",value:function(e){var t=new r("string"==typeof e?{html:e}:e);return t.show(),t}},{key:"$name",get:function(){return"Toast"}},{key:"defaultConfig",get:function(){return{testConfig:{timeout:100,destroyTimeout:1},floating:!0,timeout:2500,destroyTimeout:200,showProgress:!0,color:null,bottomMargin:20}}}]),r}(Nr);function Vi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zi.toasts=[],zi._$name="Toast",ye.register("toast",zi);var Wi={left:!0,right:!0,top:!0,bottom:!0,transform:!0},Ui=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Vi()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"afterConstruct",value:function(){var e=this;e.forSelector&&(e.showOnHover=!0,e.forElement||(e.trackMouse=!0,e.forElement=document.body)),se()(J()(r.prototype),"afterConstruct",this).call(this),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=Kn.on({element:e.forElement,mouseover:"internalOnPointerOver",mouseout:"internalOnPointerOut",thisObj:e})),e.autoShow&&e.show(),e.allowOver&&Kn.on({element:e.element,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:e})}},{key:"doDestroy",value:function(){this.pointerOverOutDetacher&&this.pointerOverOutDetacher(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onDocumentMouseDown",value:function(e){var t=e.event,n=this.pointerEvent;n&&on.isTouchEvent&&t.pageX===n.pageX&&t.pageY===n.pageY&&this.activeTarget.contains(t.target)&&performance.now()-n.timeStamp<500||(this.abortDelayedShow(),se()(J()(r.prototype),"onDocumentMouseDown",this).call(this,{event:t}))}},{key:"internalOnPointerOver",value:function(e){var t,n=this,r=n.forElement,i=n.forSelector,o=n.activeTarget;if(!(n.disabled||n.allowOver&&n.element.contains(e.target))){if(i){if(o&&o.contains(e.target)&&o.contains(e.relatedTarget))return;if((t=e.target.closest(i))&&e.relatedTarget&&e.relatedTarget.closest(i)===t)return}else{if(r.contains(e.relatedTarget))return;t=r}t?n.handleForElementOver(e,t):o&&n.handleForElementOut()}}},{key:"onTransitionEnd",value:function(e){var t=this,n=r.currentOverElement;if(Wi[e.propertyName]){if(t.allowOver&&t.element.contains(n))return;t.activeTarget&&t.activeTarget.contains(n)&&!t.trackMouse&&t.realign()}}},{key:"handleForElementOver",value:function(e,t){var n=this;if(!1===n.trigger("pointerOver",{event:e,target:t}))n.internalOnPointerOut(e);else if(n.pointerEvent=e,n.abortDelayedHide(),n.isVisible&&!n.hideOnDelegateChange){if(n.updateActiveTarget(t),!1===n.trigger("beforeShow"))return n.hide();n.updateContent(),n.alignTo({target:n.anchorToTarget?t:new On(n.pointerEvent.pageX-window.pageXOffset+n.mouseOffsetX,n.pointerEvent.pageY-window.pageYOffset+n.mouseOffsetY),overlap:!(n.anchorToTarget&&n.anchor)}),n.trigger("show"),n.afterShowByTarget()}else n.hideOnDelegateChange&&n.hide(),n.updateActiveTarget(t),n.delayShow(t)}},{key:"delayShow",value:function(e){var t=this;t.currentAnimation&&(t.cancelHideShowAnimation(),t._hidden=!0),t.isVisible||t.hasTimeout("show")?t.isVisible&&t.showByTarget(e):!t.hoverDelay||t.forSelector&&Date.now()-t.lastHidden<t.quickShowInterval?(t.updateContent(),t.showByTarget(e)):(t.addDocumentMouseDownListener(),t.listeningForMouseMove||t.anchorToTarget||(t.mouseMoveRemover=Kn.on({element:document,mousemove:"onMouseMove",thisObj:t})),t.setTimeout((function(){on.isOrphaned(e)||(t.updateContent(),t.showByTarget(e))}),t.pointerEvent&&"mouseover"!==t.pointerEvent.type?0:t.hoverDelay,"show"))}},{key:"updateContent",value:function(){var e=this;e.getHtml&&(e.html=e.getHtml({tip:e,element:e.element,activeTarget:e.activeTarget,event:e.pointerEvent}))}},{key:"internalBeforeShow",value:function(){return this.updateContentOnMouseMove||this.hasContent}},{key:"showAsyncMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.L(this.loadingMsg);e&&(this.html='<div class="b-tooltip-loading"><div class="b-icon b-icon-spinner"></div>'.concat(e,"</div>"))}},{key:"showByTarget",value:function(e){var t=this;t.mouseMoveRemover&&(t.mouseMoveRemover(),t.mouseMoveRemover=null),t.showBy({target:t.anchorToTarget?e:new On(t.pointerEvent.pageX-window.pageXOffset+t.mouseOffsetX,t.pointerEvent.pageY-window.pageYOffset+t.mouseOffsetY),overlap:!(t.anchorToTarget&&t.anchor)})}},{key:"afterShowByTarget",value:function(){var e=this.dismissDelay;this.abortDelayedShow(),e&&this.setTimeout("hide",e),this.toFront()}},{key:"updateActiveTarget",value:function(e){var t=this.activeTarget;this.activeTarget=e,this.isConfiguring||this.trigger("overtarget",{newTarget:e,lastTarget:t})}},{key:"internalOnPointerOut",value:function(e){var t=this,n=e.relatedTarget;t.allowOver&&t.element.contains(n)||t.element.contains(e.target)&&t.activeTarget&&t.activeTarget.contains(n)||t.activeTarget&&!t.activeTarget.contains(e.relatedTarget)&&t.handleForElementOut()}},{key:"handleForElementOut",value:function(){var e=this,t=e.hideDelay;!1!==e.trigger("pointerOut")?(e.abortDelayedShow(),e.isVisible&&!1!==t&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())):e.activeTarget=null}},{key:"show",value:function(){var e=this;e.forElement&&e.anchorToTarget&&!e.forSelector&&!e.inShowBy?e.showByTarget(e.forElement):(e.inShowBy&&(e.y=-1e4),se()(J()(r.prototype),"show",this).call(this)),e.afterShowByTarget(),e.mouseMoveRemover||e._hidden||!e.trackMouse&&!e.updateContentOnMouseMove||(e.mouseMoveRemover=Kn.on({element:document,mousemove:"onMouseMove",thisObj:e})),!e.forElement||e.transitionEndDetacher||e._hidden||(e.transitionEndDetacher=Kn.on({element:e.forElement,transitionend:"onTransitionEnd",thisObj:e}))}},{key:"hide",value:function(){var e=this;if(e.abortDelayedShow(),e.isVisible){var t;e.abortDelayedHide();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(t=se()(J()(r.prototype),"hide",this)).call.apply(t,[this].concat(i)),e.lastHidden=Date.now(),e.activeTarget=null,e.mouseMoveRemover&&(e.mouseMoveRemover(),e.mouseMoveRemover=null),e.transitionEndDetacher&&(e.transitionEndDetacher(),e.transitionEndDetacher=null),e.listeningForMouseMove=!1}}},{key:"abortDelayedShow",value:function(){var e=this;e.hasTimeout("show")&&(e.mouseDownRemover&&(e.mouseDownRemover(),e.mouseDownRemover=null),e.clearTimeout("show"),e.mouseMoveRemover&&(e.mouseMoveRemover(),e.mouseMoveRemover=null),e.transitionEndDetacher&&(e.transitionEndDetacher(),e.transitionEndDetacher=null))}},{key:"abortDelayedHide",value:function(){this.clearTimeout("hide")}},{key:"realign",value:function(e){var t=this,n=t.lastAlignSpec,i=t.clippedBy;!t.isConfiguring&&i&&!t.isVisible&&n&&n.targetHidden&&(In.from(n.target,t.positioned?t.element.offsetParent:null,!t.positioned).intersect(i)&&(t.show(),n.targetHidden=!1));se()(J()(r.prototype),"realign",this).call(this,e)}},{key:"alignTo",value:function(e){this.isVisible&&(this.pointerEvent&&this.element.contains(this.pointerEvent.target)||1===e.nodeType&&(e={target:e}),se()(J()(r.prototype),"alignTo",this).call(this,e))}},{key:"onMouseMove",value:function(e){var t,n=this,r=e.pageX-window.pageXOffset+n.mouseOffsetX,i=e.pageY-window.pageYOffset+n.mouseOffsetY,o=n.hasTimeout("hide"),a=e.target;(n.pointerEvent=e,n._hidden)||(n.forSelector&&n.activeTarget&&!o&&1===a.nodeType&&!a.matches(n.forSelector)&&!(n.allowOver&&n.element.contains(a))&&(t=n.handleForElementOut()),(t||!o||n.forElement.contains(a))&&(n.dismissDelay&&!o&&n.setTimeout("hide",n.dismissDelay),n.updateContentOnMouseMove&&n.getHtml&&(n.html=n.getHtml({tip:n,element:n.element,forElement:n.activeTarget,event:e})),n.trackMouse&&n.alignTo({position:new On(r,i),ignorePageScroll:!0})))}},{key:"onOwnElementMouseEnter",value:function(e){this.abortDelayedHide()}},{key:"focusElement",get:function(){var e=se()(J()(r.prototype),"focusElement",this);if(e!==this.element)return e}},{key:"anchorToTarget",get:function(){return this._anchorToTarget},set:function(e){this._anchorToTarget=e,e||(this.anchor=!1)}},{key:"trackMouse",set:function(e){this._trackMouse=e},get:function(){return this._trackMouse&&!this.anchorToTarget}},{key:"hasContent",get:function(){return Boolean("string"==typeof this.html&&this.html.length||this.items.length)}},{key:"html",set:function(e){var t=this;return!1===e?(j.deprecate("Grid","5.0.0","Setting false to indicate loading is deprecated, in favor of `showAsyncMessage`. Please see https://bryntum.com/docs/grid/#guides/upgrades/3.0.1.md for more information"),void this.showAsyncMessage()):e instanceof Promise?(t.showAsyncMessage(),e.target=t.activeTarget,void e.then((function(n){e.target===t.activeTarget&&(t.html=n)}))):(e=null!=e?t.L(String(e)):"",ei()(J()(r.prototype),"html",e,this,!0),void(t.hasContent?(t.isVisible&&t.realign(),t.trigger("innerHtmlUpdate")):t.hide()))},get:function(){return se()(J()(r.prototype),"html",this)}}],[{key:"$name",get:function(){return"Tooltip"}},{key:"defaultConfig",get:function(){return{mouseOffsetX:15,mouseOffsetY:15,floating:!0,getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:!1,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:!1,anchor:!0,align:"b-t",axisLock:!0,showAnimation:null,hideAnimation:null,testConfig:{hideDelay:100,hoverDelay:100}}}}]),r}(Ei);function Gi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Kn.on({element:document,mouseenter:function(e){return Ui.currentOverElement=e.target},capture:!0}),Ui._$name="Tooltip",ye.register("tooltip",Ui),Nr.tooltip=new Ui({id:"bryntum-tooltip",forElement:window,forSelector:"[data-btip]",header:!0,resetCfg:{},listeners:{pointerOver:function(e){var t=e.source,n=e.target;for(var r in t.resetCfg)"listeners"===r?t.un(t.resetCfg[r].set):"was"in t.resetCfg[r]?t[r]=t.resetCfg[r].was:delete t[r];t.resetCfg={};var i=we.get(n.id),o=i?i.tipConfig:t.gatherDataConfigs(n.dataset);for(var a in o)t.resetCfg[a]={set:o[a]},Object.prototype.hasOwnProperty.call(t,a)&&(t.resetCfg[a].was=t[a]),"listeners"===a?t.on(o[a]):t[a]=o[a];t.headerElement.style.display=t.title?"":"none"}},gatherDataConfigs:function(e){var t={};for(var n in e)if(n.startsWith("btip"))if(n.length>4){var r=L.lowercaseFirstLetter(n.substr(4));if(r in this.getDefaultConfiguration()){var i=e[n];t[r]=isNaN(i)?i:parseInt(i,10)}}else t.html=e[n];return t}});var Yi=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Gi()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e),this._badge&&(this.badge=this._badge)}},{key:"badge",set:function(e){var t=this.element;this._badge=e,t&&(null!=e&&""!==e?(t.dataset.badge=e,t.classList.add("b-badge")):(t.dataset.badge&&delete t.dataset.badge,t.classList.remove("b-badge")))},get:function(){return this._badge}},{key:"widgetClass",get:function(){if(this.badge)return"b-badge"}}]),r}(e||G)};function $i(){var e=Ti()(["\n            <"," "," ",' class="'," ",'" ','>\n                <label reference="label"></label>\n            </',">\n        "],["\n            <"," "," ",' class="'," ",'" ','>\n                <label reference="label">\\xa0</label>\n            </',">\n        "]);return $i=function(){return e},e}function qi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Xi=/^b-icon-/,Ki=/^b-fa-/,Ji=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(qi()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"template",value:function(){var e=this,t=e.href?"a":"button";return Ii.tpl($i(),t,"a"===t?'href="'.concat(e.href,'"'):"","a"===t&&e.target?'target="'.concat(e.target,'"'):"",e.color||"",e.toggleable&&e.pressed?"b-pressed":"",e.toggleGroup?'data-group="'.concat(e.toggleGroup,'"'):"",t)}},{key:"construct",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.toggleGroup&&(t.toggleable=!0);for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(e=se()(J()(r.prototype),"construct",this)).call.apply(e,[this,t].concat(i)),Kn.on({element:this.element,click:"onInternalClick",thisObj:this})}},{key:"doDestroy",value:function(){this.destroyProperties("menu"),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"eachWidget",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.menu;if(n){if(!1===e(n))return;t&&n.eachWidget&&n.eachWidget(e,t)}}},{key:"onFocusOut",value:function(e){se()(J()(r.prototype),"onFocusOut",this).call(this,e),this.menu&&this.menu.hide()}},{key:"onInternalClick",value:function(e){var t=this,n={event:e};if(t.toggleable){if(t.toggleGroup&&t.pressed)return;t.toggle(!t.pressed)}t.trigger("click",n),t.isDestroyed||t.trigger("action",n),this.href||(e.preventDefault(),e.stopPropagation())}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t.menu;t.toggleable&&(null===e&&(e=!t.pressed),t.pressed=e,t.toggling=!0,n&&(n.minWidth=t.width,n[e?"show":"hide"]()),t.syncIconCls(),t.trigger("toggle",{pressed:e}),t.toggling=!1)}},{key:"syncIconCls",value:function(){var e=this,t=e._iconEl;if(e.icon){t||(t=e._iconEl=on.createElement({tag:"i",nextSibling:e.element.firstChild}));var n=e.pressed&&e.pressedIcon?e.pressedIcon:e.icon;e._iconEl.className=n,Xi.test(n)?t.classList.add("b-icon"):Ki.test(n)&&t.classList.add("b-fa")}else t&&t.remove()}},{key:"focusElement",get:function(){return this.element}},{key:"text",get:function(){return this._text},set:function(e){var t=this.element;null==e&&(e=""),this.label.innerText=this._text=e,t.classList[String(e).length?"add":"remove"]("b-text")}},{key:"menu",get:function(){var e=this,t=e._menu;return!t||t instanceof Nr||("object"!==re()(t)||"type"in t||"items"in t||"widgets"in t||"html"in t||(t={items:t}),t=e.menu=Ce.createWidget(Object.assign({type:"menu",floating:!0,autoShow:!1,autoClose:!0,scrollAction:"realign",constrainTo:document.body,forElement:e.element,align:"t0-b0",owner:e,onHide:function(){e.setTimeout((function(){return e.toggle(!1)}),e.onMenuHideTimeout)}},t))),t},set:function(e){this._menu=e,this.toggleable=Boolean(e)}},{key:"pressed",set:function(e){var t=this;e&&t.toggleGroup&&on.forEachSelector("button[data-group=".concat(t.toggleGroup,"]"),(function(e){e!==t.element&&Ce.getById(e.id).toggle(!1)})),t._pressed=e,t.element&&t.element.classList[e?"add":"remove"]("b-pressed")},get:function(){return this._pressed}},{key:"icon",set:function(e){this._icon=e,this.syncIconCls()},get:function(){return this._icon}},{key:"pressedIcon",set:function(e){this._pressedIcon=e,this.syncIconCls()},get:function(){return this._pressedIcon}},{key:"iconAlign",set:function(e){var t=this._iconAlign;e!==t&&(t&&this.element.classList.remove("b-icon-align-".concat(t)),this.element.classList.add("b-icon-align-".concat(e)),this._iconAlign=e)},get:function(){return this._iconAlign}}],[{key:"$name",get:function(){return"Button"}},{key:"defaultConfig",get:function(){return{icon:null,pressedIcon:null,iconAlign:"start",text:"",color:null,toggleable:!1,pressed:!1,toggleGroup:null,ripple:{radius:75},defaultBindProperty:"text",localizableProperties:["text"],menu:null,href:null,target:null,onMenuHideTimeout:300,testConfig:{onMenuHideTimeout:0}}}}]),r}(Yi(Nr));function Qi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ji._$name="Button",ye.register("button",Ji);var Zi=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Qi()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};se()(J()(r.prototype),"construct",this).call(this,t),this.items.forEach((function(t){return t.on("click",e.onItemClick,e)}))}},{key:"onItemClick",value:function(){this._value=null}},{key:"createWidget",value:function(e){var t=this;t.color&&!e.color&&(e.color=t.color),t.toggleGroup&&!e.toggleGroup&&("boolean"==typeof t.toggleGroup&&(t.toggleGroup=we.generateId("toggleGroup")),e.toggleGroup=t.toggleGroup),t.columns&&(e.width="".concat(100/t.columns,"%"));var n=se()(J()(r.prototype),"createWidget",this).call(this,e);if(!(n instanceof Ji))throw new Error("A ButtonGroup can only contain buttons");return n}},{key:"value",get:function(){if(!this._value){var e=[];this.items.forEach((function(t){t.pressed&&void 0!==t.value&&e.push(t.value)})),this._value=e.join(this.valueSeparator)}return this._value},set:function(e){Array.isArray(e)||(e=null==e?[]:"string"==typeof e?e.split(this.valueSeparator):[e]),this._value=e,this.items.forEach((function(t){void 0!==t.value&&(t.pressed=e.indexOf(t.value)>-1)}))}},{key:"disabled",get:function(){return se()(J()(r.prototype),"disabled",this)},set:function(e){ei()(J()(r.prototype),"disabled",e,this,!0),this.items.forEach((function(t){return t.disabled=e}))}},{key:"widgetClassList",get:function(){var e=se()(J()(r.prototype),"widgetClassList",this);return this.columns&&e.push("b-columned"),e}}],[{key:"$name",get:function(){return"ButtonGroup"}},{key:"defaultConfig",get:function(){return{defaultType:"button",cls:null,items:null,color:null,toggleGroup:null,valueSeparator:",",columns:null}}}]),r}(yi);function eo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Zi._$name="ButtonGroup",ye.register("buttonGroup",Zi);var to=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(eo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"doDestroy",value:function(){this.mousedownRemover&&this.mousedownRemover(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onMouseDown",value:function(e){var t=this,n=t.delegate?e.target.closest(t.delegate):t.element;n&&(t.triggerEvent=e,Kn.lockComposedPath(t.triggerEvent),t.activeListenerRemover=Kn.on({mouseup:{element:document,handler:"onMouseUp"},mousemove:{element:n,handler:"onTargetMouseMove"},mouseleave:{element:n,handler:"onTargetMouseLeave"},mouseenter:{element:n,handler:"onTargetMouseEnter"},thisObj:t}),t.setTimeout("startAutoRepeat",t.delay))}},{key:"onMouseUp",value:function(e){var t=this;t.acceleration&&t.acceleration.cancel(),t.activeListenerRemover&&t.activeListenerRemover(),t.clearTimeout("startAutoRepeat"),t.clearTimeout(t.repeatTimer)}},{key:"onTargetMouseLeave",value:function(){this.clearInterval(this.repeatTimer)}},{key:"onTargetMouseEnter",value:function(e){this.triggerEvent=e,this.fireClick()}},{key:"onTargetMouseMove",value:function(e){this.triggerEvent=e}},{key:"startAutoRepeat",value:function(){var e=this;e.interval=e.startInterval=1e3/e.startRate,e.accelerationDelta=e.startInterval-1e3/e.endRate,e.fireClick(),e.acceleration=_n.animate(e.accelerateDuration,e.nextTick,e,"easeOutQuad")}},{key:"nextTick",value:function(e){this.interval=this.startInterval-this.accelerationDelta*e}},{key:"fireClick",value:function(){var e=this,t=new MouseEvent("click",e.triggerEvent);e.triggerEvent.target.dispatchEvent(t),e.repeatTimer=e.setTimeout(e.fireClick,e.interval)}},{key:"element",set:function(e){this._element=e,this.mousedownRemover=Kn.on({element:e,mousedown:"onMouseDown",thisObj:this})},get:function(){return this._element}}],[{key:"defaultConfig",get:function(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3}}}]),r}(or(G));function no(e){return function(){var t,n=J()(e);if(ro()){var r=J()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return X()(this,t)}}function ro(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}to._$name="ClickRepeater";var io=function(e,t){return(e.weight||0)-(t.weight||0)},oo=function(e,t){return(t.weight||0)-(e.weight||0)},ao={array:!0},so=function(e){$()(n,e);var t=no(n);function n(){return D()(this,n),t.apply(this,arguments)}return M()(n,[{key:"doDestroy",value:function(){var e=this,t=e.triggers,r=n._errorTip;if(e.inputListenerRemover&&e.inputListenerRemover(),e.keyListenerRemover&&e.keyListenerRemover(),se()(J()(n.prototype),"doDestroy",this).call(this),t)for(var i=0,o=Object.values(t);i<o.length;i++){o[i].destroy()}r&&r.field===e&&r.hide()}},{key:"construct",value:function(e){var t=this;t.highlightChanged=t.createOnFrame("addUpdatedCls"),se()(J()(n.prototype),"construct",this).call(this,e),n.errorTip,t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}},{key:"onFocusIn",value:function(e){this.valueOnFocus=mt.clone(this.value),se()(J()(n.prototype),"onFocusIn",this).call(this,e)}},{key:"onFocusOut",value:function(e){se()(J()(n.prototype),"onFocusOut",this).call(this,e),this.updateRequired(),this.onEditComplete()}},{key:"onEditComplete",value:function(){}},{key:"select",value:function(e,t){var n=this.focusElement;if(n.value.length){if(0===arguments.length)return void this.selectAll();if(!this.supportsTextSelection)return;Re.isIE11?(n.focus(),n.setSelectionRange(e,t)):n.setSelectionRange(e,t)}}},{key:"moveCaretToEnd",value:function(){var e=this.input;if(e.createTextRange){var t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}},{key:"selectAll",value:function(){this.focusElement.select()}},{key:"updateEmpty",value:function(){var e=this.isEmptyInput,t=this.isEmpty,n=this.element,r=this.clearIcon,i=e&&t;n&&(r&&r.classList[i?"add":"remove"]("b-icon-hidden"),n.classList[i?"add":"remove"]("b-empty"))}},{key:"updateInvalid",value:function(){this.updatingInvalid=!0;var e=this.isValid,t=this.element,n=this.errorTip,r=this.inputWrap;t&&(t.classList[e?"remove":"add"]("b-invalid"),e?n.isVisible&&n.field===this&&n.hide():r.contains(Ui.currentOverElement)&&(n.activeTarget===r&&n.isVisible?n.onBeforeShow():(n.activeTarget=r,n.showBy(r)))),this.updatingInvalid=!1}},{key:"hasChanged",value:function(e,t){return t!==e}},{key:"syncInputFieldValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.input;n&&!t.inputting&&(t.input.value=t.inputValue,t.isConfiguring||t.containsFocus||!t.highlightExternalChange||(n.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),e||t.parent&&t.parent.isSettingValues||t.highlightChanged())),t.updateEmpty(),t.updateInvalid()}},{key:"addUpdatedCls",value:function(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}},{key:"removeUpdatedCls",value:function(){this.input.classList.remove("b-field-updated")}},{key:"internalOnInputFocus",value:function(){var e=this.input.value.length;Re.isIE11&&e&&!this.autoSelect&&this.select(e,e)}},{key:"internalOnChange",value:function(e){var t=this;t.isValid&&t.hasChanged(t._lastValue,t.value)&&(t.triggerChange(e,!0),t._lastValue=t.value)}},{key:"triggerChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Boolean(this._isUserAction),n=this,r=n.value,i=n._lastValue,o=n.isValid;n.trigger("change",{value:r,oldValue:i,event:e,userAction:t,valid:o}),"change"===n.defaultAction&&n.trigger("action",{value:r,oldValue:i,event:e,userAction:t,valid:o})}},{key:"internalOnInput",value:function(e){var t=this;t.inputting=!0,t.value=t.input.value,t.inputting=!1,t.trigger("input",{value:t.value,event:e}),t.changeOnKeyStroke&&t.changeOnKeyStroke(e)}},{key:"internalOnKeyPress",value:function(e){var t=this,n=t.value,r=!1;if("keydown"===e.type)if("Escape"!==e.key||t.readOnly)"Enter"===e.key&&Re.isIE11&&t.internalOnChange(e);else{var i="initialValue"in t?t.initialValue:t.valueOnFocus,o=t.hasChanged(i,n),a=t.input.value!==String(t.inputValue);t.revertOnEscape&&(!t.isValid||o||a)?(o&&(t.value=i),a&&t.syncInputFieldValue(!0),t.clearError(),r=!0):t.clearable&&(n||t.input.value)&&t.clear()}t.isDestroyed||(r&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}},{key:"clear",value:function(){this.value=null,this.trigger("clear")}},{key:"onDisabled",value:function(){this.updateInvalid()}},{key:"updateRequired",value:function(){var e=this;e.isConfiguring||!e.required||""!==e.value&&null!=e.value?e.clearError("fieldRequired",e.updatingInvalid):e.setError("fieldRequired",e.updatingInvalid)}},{key:"setError",value:function(e,t){(this.errors||(this.errors={}))[e]=this.L(e),t||this.updateInvalid()}},{key:"clearError",value:function(e,t){this.errors&&(e?delete this.errors[e]:this.errors={}),t||this.updateInvalid()}},{key:"getErrors",value:function(){if(!this.isValid){var e=this.errors?mt.getTruthyValues(this.errors):[this.input.validationMessage||this.L("invalidValue")];if(e&&e.length)return e}}},{key:"errorTip",get:function(){return this.constructor.errorTip}},{key:"element",set:function(e){var t=this,r=t.initialConfig.value,i=on.createElementFromTemplate(t.inputTemplate(t),ao),o=[{className:"b-field-inner",reference:"inputWrap",children:i}],a=[],s=[],l=t.labels||[];for(var c in t.label&&l.push({reference:"labelElement",html:t.label}),l&&l.forEach((function(e){var n=Object.assign({tag:"label",htmlFor:"".concat(t.id,"_input"),className:"b-align-".concat(e.align||"start")},e);e.align&&"start"!==e.align?o.push(n):o.unshift(n)})),t._thisIsAUsedExpression(t.clearable),t.triggers){var u=t.triggers[c];"start"===u.align?a.unshift(u):s.push(u)}a.sort(io),s.sort(oo),i.unshift.apply(i,Z()(a.map((function(e){return e.element})))),i.push.apply(i,Z()(s.map((function(e){return e.element})))),ei()(J()(n.prototype),"element",{className:l.length?"b-has-label":"",children:o},this,!0),null!=r&&(t.value=r),t.updateEmpty(),t.updateInvalid();var d=t.input||t.focusElement;d&&(t.keyListenerRemover=Kn.on({element:d,thisObj:t,keydown:"internalOnKeyPress",keypress:"internalOnKeyPress",keyup:"internalOnKeyPress"}))},get:function(){return se()(J()(n.prototype),"element",this)}},{key:"focusElement",get:function(){return this.input}},{key:"attributeString",get:function(){var e=this,t=e.attributes.map((function(t){return null!=e[t]?"".concat(t.toLowerCase(),'="').concat(e[t],'"'):""})).join(" ");return e.inputAttributes&&(t+=Object.keys(e.inputAttributes).map((function(t){return"".concat(t,'="').concat(e.inputAttributes[t],'"')})).join(" ")),t}},{key:"editable",get:function(){return this._editable},set:function(e){var t=this,n=t.input;t._editable=e,n&&(n.readOnly=!1===e?"readOnly":null,!1!==e?t.inputListenerRemover=Kn.on({element:n,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"}):t.inputListenerRemover&&t.inputListenerRemover())}},{key:"clearable",set:function(e){this._clearable=e,e&&!this.triggers&&(this.triggers={})},get:function(){return this._clearable}},{key:"triggers",set:function(e){var t=this,n=t._triggers={};for(var r in t.clearable&&((e||(e={})).clear={cls:"b-icon-remove",handler:function(){t._isUserAction=!0,t.clear(),t._isUserAction=!1},weight:1e3}),e)n[r]=Ce.createWidget(mt.assign({type:"trigger",reference:r,parent:t},e[r]),t.defaultTriggerType||"trigger")},get:function(){return this._triggers}},{key:"labelWidth",set:function(e){this.labelElement&&(this.labelElement.style.flex="0 0 ".concat(on.setLength(e)),this.inputWrap.style.flexBasis=null==e?"":0)}},{key:"label",get:function(){return this._label},set:function(e){null==e&&(e=""),this._label=e,this.labelElement&&(this.labelElement.innerHTML=e)}},{key:"readOnly",get:function(){return this._readOnly||this.disabled},set:function(e){var t=this;e=Boolean(e),Boolean(t._readOnly)!==e&&(t._readOnly=e,t.element.classList[e?"add":"remove"]("b-readonly"),e?(t.readWriteEditability=t.editable,t.editable=!1):t.editable=t.readWriteEditability)}},{key:"isValid",get:function(){var e=this;if(!e.disabled){if(e.updateRequired(),e.errors&&mt.getTruthyValues(e.errors).length)return!1;if(e.input&&e.input.validity)return e.input.validity.valid}return!0}},{key:"isEmpty",get:function(){return null==this.value||""===this.value}},{key:"isEmptyInput",get:function(){return!this.input||null==this.input.value||""===this.input.value}},{key:"value",get:function(){return this._value},set:function(e){var t=this,n=t._value;t.hasChanged(n,e)?(t._value=e,t.isConfiguring||(t.updateRequired(),t.inputting||t.triggerChange()),t.inputting||(t._lastValue=e),t.syncInputFieldValue()):""===e&&t.updateRequired()}},{key:"inputValue",get:function(){return null==this.value?"":this.value}},{key:"supportsTextSelection",get:function(){var e=this.focusElement;return e&&("textarea"===e.tagName.toLowerCase()||e.type&&(/text|search|password|tel|url/.test(e.type)||Re.isEdge))}}],[{key:"$name",get:function(){return"Field"}},{key:"defaultConfig",get:function(){return{value:"",name:null,label:null,labels:null,required:null,clearable:null,revertOnEscape:null,labelWidth:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder"],autoSelect:!1,autoComplete:"off",inputAttributes:null,updatedClsDuration:1500,testConfig:{updatedClsDuration:10}}}},{key:"errorTip",get:function(){return n._errorTip||(n._errorTip=new Ui({id:"bryntum-field-errortip",cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:"l-r",scrollAction:"realign",onBeforeShow:function(){var e=we.fromElement(this.activeTarget);if(e){var t=e.getErrors();if(t)return this.html=t.join("<br>"),this.field=e,!0}return!1}}))}}]),n}(Yi(Nr));function lo(){var e=Ti()(['\n            <input type="checkbox" id="','_input" reference="input" ','/>\n            <label class="b-checkbox-label" for="','_input" reference="textLabel">',"</label>\n        "]);return lo=function(){return e},e}function co(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}so.Trigger=function(e){$()(n,e);var t=no(n);function n(){return D()(this,n),t.apply(this,arguments)}return M()(n,[{key:"template",value:function(){return'<div class="b-icon b-align-'.concat(this.align||"end",'"></div>')}},{key:"construct",value:function(e){se()(J()(n.prototype),"construct",this).call(this,e),Kn.on({element:this.element,click:{handler:"onClick",thisObj:this},mousedown:{handler:"onMousedown",thisObj:this}})}},{key:"onClick",value:function(e){var t=this,n=t.field,r="function"==typeof t.handler?t.handler:n[t.handler];n.disabled||n.readOnly||r&&!1!==n.trigger("trigger",{trigger:t})&&r.call(n,e)}},{key:"onMousedown",value:function(e){var t=this.field;!("key"in e)&&on.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout((function(){return t.editable=!0}),500)),e.preventDefault(),document.activeElement!==t.input&&t.focus()}},{key:"field",get:function(){return this.parent}}],[{key:"$name",get:function(){return"FieldTrigger"}},{key:"defaultConfig",get:function(){return{align:null}}}]),n}(Nr),so.SpinTrigger=function(e){$()(n,e);var t=no(n);function n(){return D()(this,n),t.apply(this,arguments)}return M()(n,[{key:"doDestroy",value:function(){this.clickRepeater&&this.clickRepeater.destroy(),se()(J()(n.prototype),"doDestroy",this).call(this)}},{key:"template",value:function(){return'<div class="b-icon b-align-'.concat(this.align||"end",'">\n                    <div reference="upButton" class="b-icon b-spin-up"></div>\n                    <div reference="downButton" class="b-icon b-spin-down"></div>\n                </div>')}},{key:"onClick",value:function(e){var t=this.field;t.disabled||(e.target===this.upButton?t.doSpinUp():e.target===this.downButton&&t.doSpinDown())}},{key:"repeat",set:function(e){var t=this;e?t.clickRepeater=new to(Object.assign({element:t.element},e)):t.clickrepeater&&(t.clickRepeater.destroy(),t.clickrepeater=null)}}],[{key:"$name",get:function(){return"SpinTrigger"}},{key:"defaultConfig",get:function(){return{repeat:!0}}}]),n}(so.Trigger),so._$name="Field",ye.register("trigger",so.Trigger),ye.register("spintrigger",so.SpinTrigger);var uo=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(co()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e);var t=this;t.initialConfig.readOnly&&(t.readOnly=!0),t.isConfiguring=!0,t.initialConfig.checked&&(t.checked=!0),t.isConfiguring=!1}},{key:"inputTemplate",value:function(){var e=this;return Ii.tpl(lo(),e.id,e.toggleGroup?'data-group="'.concat(e.toggleGroup,'"'):"",e.id,e.text||"")}},{key:"getToggleGroupMembers",value:function(){var e=this.checked,t=this.toggleGroup,n=this.input,r=[];return e&&t&&on.forEachSelector("input[type=checkbox][data-group=".concat(t,"]"),(function(e){if(e!==n){var t=Ce.fromElement(e);t&&r.push(t)}})),r}},{key:"uncheckToggleGroupMembers",value:function(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((function(e){return e.checked=!1}))}},{key:"check",value:function(){this.checked=!0}},{key:"uncheck",value:function(){this.checked=!1}},{key:"toggle",value:function(){this.checked=!this.checked}},{key:"internalOnChange",value:function(e){this.triggerChange(!0)}},{key:"triggerChange",value:function(e){var t=this,n=t.input.checked;(!n&&e&&t.toggleGroup&&t.getToggleGroupMembers().filter((function(e){return e.isVisible&&!e.disabled})).length||!t.callPreventable("change",{checked:n,value:n,userAction:e},(function(n){return e&&t.uncheckToggleGroupMembers(),t.trigger("action",n),!0})))&&(t.input.checked=!t.input.checked)}},{key:"element",set:function(e){var t=this;ei()(J()(r.prototype),"element",e,this,!0),t.color&&t.element.classList.add(t.color),t.text&&t.element.classList.add("b-text")},get:function(){return se()(J()(r.prototype),"element",this)}},{key:"text",get:function(){return this._text},set:function(e){this._text=e,this.textLabel&&(this.textLabel.innerHTML=e)}},{key:"value",get:function(){return this.checked},set:function(e){this.checked="false"!==e&&Boolean(e)}},{key:"checked",get:function(){return this.input.checked},set:function(e){var t=this;e=Boolean(e),t.inputting||t.input.checked===e||(t.input.checked=e,t.uncheckToggleGroupMembers(),t.isConfiguring||t.triggerChange(!1))}},{key:"readOnly",get:function(){return this._readOnly},set:function(e){this._readOnly=e,this.element.classList[e?"add":"remove"]("b-readonly"),this.input.disabled=e}}],[{key:"$name",get:function(){return"Checkbox"}},{key:"defaultConfig",get:function(){return{text:"",color:null,value:"",toggleGroup:null,defaultBindProperty:"value",localizableProperties:["label","text"]}}}]),r}(so);uo._$name="Checkbox",ye.register("checkbox",uo),ye.register("check",uo);n(266);function fo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ho=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(fo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.pluggedInto=this.client=e,se()(J()(r.prototype),"construct",this).call(this,t),this.applyPluginConfig(e)}},{key:"applyPluginConfig",value:function(e){var t=this,n=t.pluginConfig||t.constructor.pluginConfig;if(n){var r=n.assign,i=n.chain,o=n.after,a=n.before,s=n.override;r&&t.applyAssign(e,r),(i||o)&&t.applyChain(e,i||o),a&&t.applyChain(e,a,!1),s&&t.applyOverride(e,s)}}},{key:"applyAssign",value:function(e,t){var n=this;t.forEach((function(t){return n.assign(e,t)}))}},{key:"applyChain",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t.forEach((function(t){e[t]?n.chain(e,t,r):n.assign(e,t)}))}},{key:"applyOverride",value:function(e,t){var n=this,r=this;r.overridden||(r.overridden={}),t.forEach((function(t){if(!r[t])throw new Error(n.L("overrideFnMissing",{plugIntoName:e.$name,pluginName:r.$name,fnName:t}));"function"==typeof e[t]&&(r.overridden[t]=e[t].bind(e)),e[t]=r[t].bind(r)}))}},{key:"assign",value:function(e,t){var n=this,r=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(n),t);r&&(r.get||r.set)?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:r.get&&r.get.bind(n),set:r.set&&r.set.bind(n)}):e[t]=n[t].bind(n)}},{key:"chain",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this,i=e.pluginFunctionChain||(e.pluginFunctionChain={});if(i[t]||(i[t]=[e[t].bind(e)]),!r[t])throw new Error(this.L("fnMissing",{plugIntoName:e.$name,pluginName:r.$name,fnName:t}));i[t][n?"push":"unshift"](r[t].bind(r)),e[t]=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return r.functionChainRunner.apply(r,[t].concat(n))}}},{key:"functionChainRunner",value:function(e){for(var t,n=this.client.pluginFunctionChain[e],r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(var a=0;a<n.length;a++)if(!1===(t=n[a].apply(n,i)))return!1;return t}},{key:"doDisable",value:function(e){var t=this.constructor,n="featureClass"in t?t.featureClass:"b-".concat(t.$name.toLowerCase());n&&this.client&&this.client.element&&this.client.element.classList[e?"remove":"add"](n),e?this.trigger("disable"):this.trigger("enable")}},{key:"client",get:function(){return this._client},set:function(e){this._client=e}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,this.doDisable(e)}}],[{key:"initPlugins",value:function(e){for(var t=e.plugins||(e.plugins={}),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=a[o];t[s.$name]=new s(e)}}},{key:"defaultConfig",get:function(){return{disabled:!1}}}]),r}(_e(pe(G)));function go(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ho._$name="InstancePlugin";var vo=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(go()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"initPlugins",value:function(){}},{key:"addPlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ho.initPlugins.apply(ho,[this].concat(t))}},{key:"hasPlugin",value:function(e){return null!=this.getPlugin(e)}},{key:"getPlugin",value:function(e){return"function"==typeof e&&(e=e.$name),this.plugins&&this.plugins[e]}},{key:"plugins",get:function(){return this._plugins||(this._plugins={}),this._plugins},set:function(e){e&&(Array.isArray(e)||(e=[e]),ho.initPlugins.apply(ho,[this].concat(Z()(e)))),this.initPlugins()}},{key:"widgetClass",get:function(){}}]),r}(e||G)};function po(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var yo=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(po()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"state",get:function(){return this._state=this.getState(),this._state},set:function(e){this._state=e,this.applyState(e)}},{key:"widgetClass",get:function(){}}]),r}(e||G)};n(229);function mo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var bo=Symbol("STM_PROP"),ko={parentIndex:1};function wo(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return So(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return So(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function So(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Co(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ro(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var xo,Eo={children:1,data:1,meta:1},Do={},To=function(e){return e instanceof Date||(e=ft.parse(e,this.format||this.dateFormat||ft.defaultFormat)),e||void 0},Mo=function(e,t,n){return e&&e.isEqual?e.isEqual(t,n):mt.isEqual(t,n)},Ao=function(){},Io=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ro()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=o.constructor,s=a.fieldMap,l=t?Array.isArray(t)?t:[t]:[],c=null;if(t=l[0],o.meta=Object.assign({modified:{}},a.metaConfig,n),a.applyConfigs){var u=a.getDefaultConfiguration(),d=Z()(new Set(mt.allKeys(u)));d.length&&(o.useRawData&&o.useRawData.enabled||(e=Object.assign({},e)),c={},d.forEach((function(t){c[t]=e[t]||u[t],delete e[t]})))}if(se()(J()(r.prototype),"construct",this).call(this,c),i?a.hasOwnProperty("fieldMap")||a.exposeProperties():a.exposeProperties(e),!a.hasOwnProperty("idFieldProcessed")){var f=o.meta.idField;f||(a._assignedIdField?f=a.idField:t&&(f=t.idField)),f&&f!==s.id.dataSource&&a.addField({name:"id",dataSource:f}),a.idFieldProcessed=!0}o._internalId=r._internalIdCounter++,o.stores=[],o.unjoinedStores=[],o.originalData||(o.originalData=e),o.data=a.processData(e,!1,t),null==o.id&&o.setData("id",o.generateId(t)),o.data[a.childrenField]&&o.processChildren(l),o.generation=0}},{key:"equals",value:function(e){if(e instanceof this.constructor){for(var t=this.fields,n=0,r=t.length;n<r;n++){var i=t[n],o=i.name;if("id"!==o&&!Mo(i,this[o],e[o]))return!1}return!0}return!1}},{key:"getFieldDefinition",value:function(e){return this.constructor.getFieldDefinition(e)}},{key:"getFieldDefinitionFromDataSource",value:function(e){return this.constructor.fieldDataSourceMap[e]}},{key:"getDataSource",value:function(e){var t=this.constructor.getFieldDefinition(e);if(t)return t.dataSource||t.name}},{key:"initRelations",value:function(){var e=this;e.constructor.relations&&e.stores.forEach((function(t){t.modelRelations||t.initRelations();var n=[];t.modelRelations&&t.modelRelations.forEach((function(t){n.push({related:e.initRelation(t),config:t})})),t.updateRecordRelationCache(e,n)}))}},{key:"initRelation",value:function(e){var t=this.get(e.fieldName),n=void 0!==t&&"string"!=typeof e.store&&e.store.getById(t),r={id:t,placeHolder:!0};return this.meta.relationCache||(this.meta.relationCache={}),this.meta.relationCache[e.relationName]=n||(null!=t?r:null),n}},{key:"removeRelation",value:function(e){this.meta.relationCache[e.relationName]&&(delete this.meta.relationCache[e.relationName],e.nullFieldOnRemove&&this.setData(e.fieldName,null))}},{key:"getForeign",value:function(e){return this.meta.relationCache&&this.meta.relationCache[e]}},{key:"setForeign",value:function(e,t,n){var i=r.asId(t);return this.set(n.fieldName,i)}},{key:"get",value:function(e){var t=this.meta.batchChanges,n=this.data,r=this.constructor.fieldMap[e],i=r?r.dataSource:e;if(t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];if(i){if(!r&&e.includes(".")){var o=e.split(".")[0];r=this.constructor.fieldMap[o]}return r&&r.complexMapping?mt.getPath(n,i):i in n?n[i]:n[e]}}},{key:"setData",value:function(e,t){var n=this.constructor.fieldMap[e],r=n?n.dataSource:e;r&&mt.setPath(this.data,r,t)}},{key:"syncId",value:function(e){var t=this.id;if(t!==e){this.setData("id",e);var n={id:{value:e,oldValue:t}};this.afterChange(n,n)}}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this;if(i.isBatchUpdating)return i.inBatchSet(e,t),null;var o=i.beforeSet?i.beforeSet(e,t,n,r):void 0,a=i.inSet(e,t,n,r);return i.afterSet&&i.afterSet(e,t,n,r,o,a),a}},{key:"fieldToKeys",value:function(e,t){var n;return"string"!=typeof e?(n={},Reflect.ownKeys(e).forEach((function(t){return n[t]=e[t]}))):n=oe()({},e,t),n}},{key:"inBatchSet",value:function(e,t){var n=this;if("string"!=typeof e){var r=this.fieldToKeys(e,t);Object.keys(r).forEach((function(e){n.meta.batchChanges[e]=n.constructor.processField(e,r[e])}))}else this.meta.batchChanges[e]=t}},{key:"inSet",value:function(e,t,n,r){var i=this,o=i.constructor.fieldMap,a=i.constructor.prototype,s=i.data,l={},c=i.fieldToKeys(e,t),u=!1;return n||i.triggerBeforeUpdate(c)?(Object.keys(c).forEach((function(e){if(e!==i.constructor.childrenField){var t=o[e],n=t&&t.readOnly,d=t?t.dataSource:e,f=!t&&e in a,h=f?i[d]:mt.getPath(s,d),g=i.constructor.processField(e,c[e]),v=c[e]={value:g},p=i.getRelationConfig(e);n||Mo(t,h,g)?delete c[e]:(i.generation++,v.oldValue=h,u=!0,Mo(t,i.meta.modified[e],g)?delete i.meta.modified[e]:(i.meta.modified[e]=h,void 0===v.oldValue&&"oldValue"in v&&delete v.oldValue),l[e]=v,f?i[e]=g:mt.setPath(s,d,g),p&&!r&&(i.initRelation(p),i.stores.forEach((function(e){return e.cacheRelatedRecord(i,g,p.relationName,v.oldValue)}))))}})),u&&i.afterChange(c,l,n,r),u?l:null):null}},{key:"afterChange",value:function(e,t,n,r){var i=this;this.stores.forEach((function(o){o.onModelChange(i,e,t,n,r)}))}},{key:"isFieldModified",value:function(e){return this.isModified&&this.meta.modified[e]}},{key:"getFieldPersistentValue",value:function(e){var t,n=this.getFieldDefinition(e);return n&&!n.persist||(t=this[e],n&&n.serialize&&(t=n.serialize.call(this,t,this))),t}},{key:"clearChanges",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n.meta;r.modified={},r.committing=!1,e&&n.stores.forEach((function(e){if(e.modified.remove(n),e.added.remove(n),t){var r=e.collectDescendants(n).all;e.added.remove(r),e.modified.remove(r)}}))}},{key:"generateId",value:function(){return this.constructor.generatedIdIndex||(this.constructor.generatedIdIndex=0),"_generated"+this.$name+ ++this.constructor.generatedIdIndex}},{key:"toJSON",value:function(){return this.data}},{key:"beginBatch",value:function(){this.batching||(this.batching=0,this.meta.batchChanges={}),this.batching++}},{key:"endBatch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.constructor.parentIdField;if(t.batching&&(t.batching--,!(t.batching>0||mt.isEmpty(t.meta.batchChanges)))){var r=Object.assign({},t.meta.batchChanges);t.meta.batchChanges=null,r[n]&&(t.parentId=r[n],delete r[n]),t.set(r,void 0,e),t.cancelBatch()}}},{key:"cancelBatch",value:function(){this.batching=null,this.meta.batchChanges=null}},{key:"triggerBeforeUpdate",value:function(e){var t=this;return!this.stores.some((function(n){if(!1===n.trigger("beforeUpdate",{record:t,changes:e}))return!0}))}},{key:"copy",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this,o=Object.assign({},i.data),a=i.constructor.idField,s=!0;return r&&"object"===re()(r)?(e=r.deep,t=r.id,delete r.id):t=r,e&&i.children?(s=!1,o.children=i.children.map((function(e){return e.copy(r)}))):(delete o.children,delete o.expanded),t?o[a]=t:null==t&&(o[a]=i.generateId(i.firstStore)),n=s?new i.constructor(o):o,n.originalInternalId=i.internalId,n}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=this.parent;n?n.removeChild(t):t.stores.length&&(t.meta.specialRow||t.stores.forEach((function(n){return n.remove(t,e,!1,!0)})))}},{key:"getRelationConfig",value:function(e){return this.firstStore&&this.firstStore.modelRelations&&this.firstStore.modelRelations.find((function(t){return t.fieldName===e}))}},{key:"joinStore",value:function(e){var t=this,n=t.stores,i=t.unjoinedStores;n.includes(e)||(se()(J()(r.prototype),"joinStore",this)&&se()(J()(r.prototype),"joinStore",this).call(this,e),e.register(t),n.push(e),i.includes(e)&&i.splice(i.indexOf(e),1),t.isLoaded&&t.children.forEach((function(t){return t.joinStore(e)})),t.initRelations(),e.tree&&!t.isRoot&&(t.instanceMeta(e.id).collapsed=!t.expanded))}},{key:"unJoinStore",value:function(e){var t=this,n=t.stores,i=t.unjoinedStores;n.includes(e)&&(e.unregister(t),t.children&&t.children.forEach((function(t){return t.unJoinStore(e)})),n.splice(n.indexOf(e),1),i.push(e),se()(J()(r.prototype),"unJoinStore",this)&&se()(J()(r.prototype),"unJoinStore",this).call(this,e),e.uncacheRelatedRecord(t)),n.length||(t.meta.removed=!0)}},{key:"isPartOfStore",value:function(e){return e?e.indexOf(this)>=0:this.stores.length>0}},{key:"instanceMeta",value:function(e){var t=this.meta,n=e.id||e;return t.map||(t.map={}),t.map[n]||(t.map[n]={})}},{key:"indexPath",get:function(){for(var e=[],t=this;t&&!t.isRoot;t=t.parent)e.unshift(t.parentIndex+1);return e}},{key:"subclass",get:function(){return new this.constructor(Object.setPrototypeOf({id:void 0},this.data),this.stores[0],null,!0)}},{key:"fields",get:function(){return this.constructor.internalFields||this.constructor.fields}},{key:"fieldNames",get:function(){return Object.keys(this.data)}},{key:"isPersistable",get:function(){return!0}},{key:"isModified",get:function(){return Boolean(this.meta.modified&&Object.keys(this.meta.modified).length>0)}},{key:"modifications",get:function(){var e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}},{key:"rawModifications",get:function(){var e=this,t={};return e.isModified?(Object.keys(e.meta.modified).forEach((function(n){var r=e.getFieldPersistentValue(n);void 0!==r&&(t[n]=r)})),t):null}},{key:"modificationData",get:function(){var e=this.rawModificationData;return e&&Object.keys(e).length&&mt.setPath(e,this.constructor.getFieldDefinition(this.constructor.idField).dataSource,this.id),e}},{key:"rawModificationData",get:function(){var e=this,t=e.constructor.fieldMap,n={};return e.isModified?(Object.keys(e.meta.modified).forEach((function(r){var i=t[r];if(i){var o=e.getFieldPersistentValue(r);void 0!==o&&mt.setPath(n,i.dataSource,o)}})),n):null}},{key:"persistableData",get:function(){var e=this,t={};return e.fields.forEach((function(n){var r=e.getFieldPersistentValue(n.name);void 0!==r&&mt.setPath(t,n.dataSource,r)})),t}},{key:"isCommitting",get:function(){return Boolean(this.meta.committing)}},{key:"internalId",get:function(){return this._internalId}},{key:"isPhantom",get:function(){return""===this.id||null==this.id||this.hasGeneratedId}},{key:"isModel",get:function(){return!0}},{key:"hasGeneratedId",get:function(){return this.id&&"string"==typeof this.id&&this.id.startsWith("_generated")}},{key:"json",get:function(){return JSON.stringify(this.data)}},{key:"isBatchUpdating",get:function(){return Boolean(this.batching)}},{key:"firstStore",get:function(){return this.stores.length>0&&this.stores[0]}},{key:"isValid",get:function(){return!0}}],[{key:"processData",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=this.fieldMap,o=this.defaultValues,a=r||{},s=a.useRawData,l=void 0===s?{enabled:!1}:s,c=l.enabled?e:Object.assign({},e);if(!(n=n||l.disableDefaultValue))for(t in o)void 0===c[t]&&(c[t]=o[t]);if(!l.disableTypeConversion)for(t in i){var u=i[t],d=u.name,f=u.dataSource,h=f!==d&&!mt.pathExists(e,f)&&d in e,g=!l.disableTypeConversion&&u.convert;if(h||g){var v=h?e[d]:e[f];(!n||h&&d in e||!h&&f in e)&&(mt.setPath(c,f,g?u.convert(v):v),h&&delete c[d])}}return c}},{key:"exposeProperties",value:function(e){var t=this,n=t.superclass,r=t.hasOwnProperty("fields")&&t.fields;if(n.exposeProperties&&!n.hasOwnProperty("fieldMap")&&n.exposeProperties(),t.hasOwnProperty("propertiesExposed")||(t.defaultValues=Object.assign({},n.defaultValues,t.hasOwnProperty("defaults")?t.defaults:null),t.fieldMap=Object.setPrototypeOf({},n.fieldMap||Do),t.fieldDataSourceMap=Object.setPrototypeOf({},n.fieldDataSourceMap||Do),t.propertiesExposed=Object.setPrototypeOf({},n.propertiesExposed||Do),t.hasOwnProperty("idField")&&(t.addField({name:"id",dataSource:t.idField}),t.propertiesExposed[t.idField]=!0),r&&r.length&&r.map(t.addField,t)),t.autoExposeFields&&e&&!t.hasOwnProperty("propertiesExposedForData")){for(var i in e)t.propertiesExposed[i]||t.addField({name:i,dataSource:i,fromData:!0});t.propertiesExposedForData=!0}t.exposeRelations()}},{key:"addField",value:function(e){if(null!=e){"string"==typeof e&&(e={name:e});var t=this,n=t.propertiesExposed,r=t.defaultValues,i=e.name,o=e.dataSource||(e.dataSource=i);return e.hasOwnProperty("persist")||(e.persist=!0),"date"===e.type&&(e.convert=To),t.fieldMap[i]=e,t.fieldDataSourceMap[o]||(t.fieldDataSourceMap[o]=e),o.includes(".")||"model"===e.type?(e.complexMapping=!0,n[o.split(".")[0]]=!0):n[o]=!0,"defaultValue"in e&&(r[o]=e.defaultValue),t.createFieldProperty(i,o,e),e}}},{key:"removeField",value:function(e){var t=this.fieldMap[e];if(t){var n=t.dataSource;delete this.fieldMap[e],delete this.fieldDataSourceMap[n],delete this.prototype[e],this._internalFields=null}}},{key:"createFieldProperty",value:function(e,t,n){Eo[t]||e in this.prototype||Object.defineProperty(this.prototype,e,{enumerable:!0,configurable:!0,get:function(){return this.get(e)},set:n&&n.readOnly?Ao:function(t){this.set(e,t)}})}},{key:"exposeRelations",value:function(){var e=this;e.hasOwnProperty("relationsExposed")||e.relationConfig&&(e.relationsExposed=!0,e.relations=[],e.relationConfig.forEach((function(t){e.relations.push(t);var n=t.relationName;Reflect.ownKeys(e.prototype).includes(n)||Object.defineProperty(e.prototype,n,{enumerable:!0,get:function(){return this.getForeign(n)},set:function(e){this.setForeign(n,e,t)}})})))}},{key:"getFieldDefinition",value:function(e){return this.fieldMap[e]}},{key:"getFieldDataSource",value:function(e){return this.getFieldDefinition(e).dataSource}},{key:"processField",value:function(e,t){var n=this.fieldMap[e];return n&&n.convert?n.convert(t):t}},{key:"asId",value:function(e){return e&&e.isModel?e.id:e}},{key:"idField",set:function(e){this._assignedIdField=!0,this._idField=e},get:function(){return this._idField}},{key:"childrenField",set:function(e){this._childrenField=e},get:function(){return this._childrenField||"children"}},{key:"autoExposeFields",get:function(){return!0}},{key:"fields",get:function(){return[]}},{key:"internalFields",get:function(){var e=this.fieldMap,t=this._internalFields;if(this.hasOwnProperty("fieldMap")&&!t)for(var n in t=this._internalFields=[],e)t.push(e[n]);return t}}]),r}(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Co()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"ingestChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stores,n=this.inProcessChildren,r=this.constructor,i=t[0];if(!0===e)return!!n||[];if(e){Array.isArray(e)||(e=[e]);for(var o,a=e.length,s=[],l=0;l<a;l++)o=(o=e[l])instanceof Io?o:i?i.createRecord(o):new r(o,null,null,!0),s.push(o);return s}}},{key:"processChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stores,t=this,n=t.meta;t.inProcessChildren=!0;var r=t.ingestChildren(t.data[t.constructor.childrenField],e);r&&(r.length?(n.isLeaf=!1,!0===t.children&&(t.children=[]),t.appendChild(r)):!0===r?(n.isLeaf=!1,t.children=!0):t.isRoot||(n.isLeaf=t.constructor.convertEmptyParentToLeaf.onLoad)),t.inProcessChildren=!1}},{key:"ancestorsExpanded",value:function(e){var t=this.parent;return!t||t.isExpanded(e)&&t.ancestorsExpanded(e)}},{key:"isExpanded",value:function(e){var t=this.instanceMeta(e.id);return Object.prototype.hasOwnProperty.call(t,"collapsed")||(t.collapsed=!this.expanded),!t.collapsed}},{key:"getDescendantCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.firstStore,n=this.children;return!n||!Array.isArray(n)||e&&!this.isExpanded(t)?0:n.reduce((function(t,n){return t+n.getDescendantCount(e)}),n.length)}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.children;t||e.call(this,this);for(var r=0,i=n&&n.length;r<i;r++)n[r].traverse(e)}},{key:"traverseBefore",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.children,r=0,i=n&&n.length;r<i;r++)n[r].traverse(e);t||e.call(this,this)}},{key:"traverseWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=!0;return t||(r=!1!==e.call(n,n)),r&&n.isLoaded&&(r=n.children.every((function(t){return t.traverseWhile(e)}))),r}},{key:"bubble",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;for(t||e.call(n,n);n.parent;)n=n.parent,e.call(n,n)}},{key:"bubbleWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=!0;for(t||(r=e.call(n,n));r&&n.parent;)n=n.parent,r=e.call(n,n);return r}},{key:"contains",value:function(e){return e&&"object"===re()(e)&&(e=e.id),!this.traverseWhile((function(t){return t.id!=e}))}},{key:"getTopParent",value:function(e){var t;return e?(t=[],this.bubbleWhile((function(e){return t.push(e),e.parent&&!e.parent.isRoot}))):(t=null,this.bubbleWhile((function(e){return e.parent||(t=e),e.parent&&!e.parent.isRoot}))),t}},{key:"appendChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.insertChild(e,null,t)}},{key:"insertChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"==typeof e){var r=e;e=t,t=this.children[r]}var i=this,o=i.isLeaf,a=Array.isArray(e);if(Array.isArray(e)||(e=[e]),!n&&!i.stores.every((function(t){return!1!==t.trigger("beforeAdd",{records:e,parent:i})})))return null;e=i.ingestChildren(e);var s=t?t.parentIndex:i.children?i.children.length:0,l=i.beforeInsertChild?i.beforeInsertChild(e):void 0,c=i.internalAppendInsert(e,t,n);return o&&c.length&&(i.meta.isLeaf=!1),i.isLeaf===o||i.root.isLoading||n||i.stores.forEach((function(e){var t={isLeaf:{value:!1,oldValue:!0}};e.trigger("update",{record:i,changes:t}),e.trigger("change",{action:"update",record:i,changes:t})})),i.afterInsertChild&&i.afterInsertChild(s,e,l,c),a||!c?c:c[0]}},{key:"tryInsertChild",value:function(){return this.insertChild.apply(this,arguments)}},{key:"internalAppendInsert",value:function(e,t,n){var r,i,o,a,s=this,l=s.stores,c=s.root,u=c.firstStore,d={};if(t&&t.parent!==s&&(t=null),s.children){var f=s.children,h=t?t.parentIndex:f.length;if(f[i=h]===e[0]||f[i=h-1]===e[0])for(r=!0,o=0;r&&o<e.length;o++)e[o]!==f[i+o]&&(r=!1)}if(r)return e;for(o=0;o<e.length;o++){var g=e[o],v=g.parent;if(d[g.id]=g.root===c,u&&g.traverse((function(e){e.root===c&&(d[e.id]=!0)})),v&&!1===v.removeChild(g,d[g.id]))a||(e=e.slice(),a=!0),e.splice(o--,1);else{var p=g.constructor.parentIdField,y=s.isAutoRoot?null:s.id;if(g.parent=s,g.data[p]=y,!s.inProcessChildren&&!s.isLoading){var m={parentId:y},b=g.meta.modified,k=v?v.id:null,w=oe()({},p,{value:s.id,oldValue:k});b[p]===s.id?delete b[p]:"parentId"in b||(b[p]=k),g.afterChange(m,w)}}}if(e.length){var S=s.addToChildren(s.children||(s.children=[]),t,e);s.addToChildren(s.unfilteredChildren,t,e,!0),l.forEach((function(t){t.isChained||(e.forEach((function(e){e.joinStore(t)})),t.onNodeAddChild(s,e,S,d,n))}))}return e}},{key:"removeChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.isLeaf,o=r.children,a=r.stores;if(Array.isArray(e)||(e=[e]),e=e.filter((function(e){return e.parent===r})),!n){var s,l=wo(a);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(!c.isChained&&!1===c.trigger("beforeRemove",{parent:r,records:e,isMove:t}))return!1}}catch(e){l.e(e)}finally{l.f()}}var u,d=r.beforeRemoveChild?r.beforeRemoveChild(e,t):void 0,f=wo(e);try{var h=function(){var e=u.value,i=r.removeFromChildren(o,e);r.removeFromChildren(r.unfilteredChildren,e,!0),a.forEach((function(o){o.isChained||o.onNodeRemoveChild(r,[e],i,{isMove:t,silent:n})})),e.parent=e.parentIndex=e.unfilteredIndex=e.nextSibling=e.previousSibling=null};for(f.s();!(u=f.n()).done;)h()}catch(e){f.e(e)}finally{f.f()}o.length||!r.constructor.convertEmptyParentToLeaf.onRemove||r.isRoot||(r.meta.isLeaf=!0),r.isLeaf===i||n||r.stores.forEach((function(e){var t={isLeaf:{value:!0,oldValue:!1}};e.trigger("update",{record:r,changes:t}),e.trigger("change",{action:"update",record:r,changes:t})})),r.afterRemoveChild&&r.afterRemoveChild(e,d,t)}},{key:"clearChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.children,r=t.stores;n&&(t.children=[],r.forEach((function(r){r.isChained||r.onNodeRemoveChild(t,n,0,{unfiltered:!0,silent:e})})),t.unfilteredChildren&&(t.unfilteredChildren=[]))}},{key:"clear",value:function(){var e=this,t=e.stores,n=e.children&&e.children.slice();if(e.isRoot&&n){var r,i=wo(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!o.isChained&&!1===o.trigger("beforeRemove",{parent:e,records:n,isMove:!1,removingAll:!0}))return!1}}catch(e){i.e(e)}finally{i.f()}e.children.length=0,t.forEach((function(e){n.forEach((function(t){t.stores.includes(e)&&t.unJoinStore(e),t.parent=t.parentIndex=t.nextSibling=t.previousSibling=null})),e.storage.suspendEvents(),e.storage.clear(),e.storage.resumeEvents(),e.added.clear(),e.modified.clear(),e.trigger("removeAll"),e.trigger("change",{action:"removeall"})}))}}},{key:"updateChildrenIndex",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?"unfilteredIndex":"parentIndex",r=null,i=0;i<e.length;i++){var o=e[i];o[n]=i,t||(o.previousSibling=r,r&&(r.nextSibling=o),i===e.length-1&&(o.nextSibling=null),r=o)}}},{key:"addToChildren",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e){var i=r?"unfilteredIndex":"parentIndex",o=t?t[i]:e.length;return e.splice.apply(e,[o,0].concat(Z()(n))),this.updateChildrenIndex(e,r),o}}},{key:"removeFromChildren",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var r=n?"unfilteredIndex":"parentIndex",i=t[r];return i>-1&&(e.splice(i,1),this.updateChildrenIndex(e,n)),i}}},{key:"expanded",get:function(){return this.data.expanded}},{key:"childLevel",get:function(){return this.parent?this.parent.childLevel+1:this.isRoot?-1:0}},{key:"isLeaf",get:function(){return!1!==this.meta.isLeaf&&!this.isRoot}},{key:"isParent",get:function(){return!this.isLeaf}},{key:"isLoaded",get:function(){return this.isParent&&Array.isArray(this.children)}},{key:"descendantCount",get:function(){return this.getDescendantCount()}},{key:"visibleDescendantCount",get:function(){return this.getDescendantCount(!0)}},{key:"allChildren",get:function(){var e=this.children;return e?e.reduce((function(e,t){return e.push(t),e.push.apply(e,t.allChildren),e}),[]):[]}},{key:"firstChild",get:function(){var e=this.children;return e&&e.length&&e[0]||null}},{key:"lastChild",get:function(){var e=this.children;return e&&e.length&&e[e.length-1]||null}},{key:"previousSiblingsTotalCount",get:function(){for(var e=this.previousSibling,t=this.parentIndex;e;)t+=e.descendantCount,e=e.previousSibling;return t}},{key:"root",get:function(){return this.parent&&this.parent.root||this}},{key:"parentId",get:function(){return this.parent&&!this.parent.isRoot?this.parent.id:null},set:function(e){var t=this,n=t.parent,r=e&&t.firstStore.getById(e);r!==n&&(n||r)&&(t.isBatchUpdating?t.meta.batchChanges.parentId=e:r?r.appendChild(t):t.parent.removeChild(t))}}],[{key:"convertEmptyParentToLeaf",set:function(e){!0===e?e={onLoad:!0,onRemove:!0}:!1===e&&(e={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=e},get:function(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}},{key:"parentIdField",set:function(e){this._parentIdField=e,Object.defineProperty(this.prototype,e,{set:function(e){this.parentId=e},get:function(){return this.parentId}})},get:function(){return this._parentIdField||"parentId"}}]),r}(e||G)}(function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(mo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"joinStore",value:function(e){se()(J()(r.prototype),"joinStore",this)&&se()(J()(r.prototype),"joinStore",this).call(this,e),this.stm||(this.stm=e.stm)}},{key:"unJoinStore",value:function(e){this.stm===e.stm&&(this.stm=null),se()(J()(r.prototype),"unJoinStore",this)&&se()(J()(r.prototype),"unJoinStore",this).call(this,e)}},{key:"beforeSet",value:function(e,t,n,i){var o=this,a=se()(J()(r.prototype),"beforeSet",this)?se()(J()(r.prototype),"beforeSet",this).call(this,e,t,n,i):[],s=this.stm;if(s&&!s.disabled&&!ko[e]){var l,c;if("object"==re()(e)){var u=Object.keys(e).reduce((function(t,n){return t[0][n]=e[n],t[1][n]=o.get(n),t}),[{},{}]),d=te()(u,2);l=d[0],c=d[1]}else l=oe()({},e,t),c=oe()({},e,this.get(e));a.push([l,c])}return a}},{key:"afterSet",value:function(e,t,n,i,o,a){var s=this.stm;if(s&&!s.disabled&&!ko[e]){var l=o.pop();if(a){var c=te()(l,2),u=c[0],d=c[1],f=Object.keys(a).reduce((function(e,t){return e[0][t]=u[t],e[1][t]=d[t],e}),[{},{}]),h=te()(f,2),g=h[0],v=h[1];s.onModelUpdate(this,g,v)}}se()(J()(r.prototype),"afterSet",this)&&se()(J()(r.prototype),"afterSet",this).call(this,e,t,n,i,o,a)}},{key:"beforeInsertChild",value:function(e){var t=this,n=se()(J()(r.prototype),"beforeInsertChild",this)?se()(J()(r.prototype),"beforeInsertChild",this).call(this,e):[],i=this.stm;return i&&!i.disabled&&n.push(e.reduce((function(e,n){return n.root===t.root&&e.set(n,{parent:n.parent,index:n.parent?n.parentIndex:void 0}),e}),new Map)),n}},{key:"afterInsertChild",value:function(e,t,n,i){var o=this.stm;if(o&&!o.disabled){var a=n.pop();i&&o.onModelInsertChild(this,e,i,a)}se()(J()(r.prototype),"afterInsertChild",this)&&se()(J()(r.prototype),"afterInsertChild",this).call(this,e,t,n,i)}},{key:"beforeRemoveChild",value:function(e,t){var n=se()(J()(r.prototype),"beforeRemoveChild",this)?se()(J()(r.prototype),"beforeRemoveChild",this).call(this,e,t):[],i=this.stm;return!i||i.disabled||t||n.push(e.reduce((function(e,t){return e.set(t,t.parentIndex),e}),new Map)),n}},{key:"afterRemoveChild",value:function(e,t,n){var i=this.stm;if(i&&!i.disabled&&!n){var o=t.pop();e&&e.length&&i.onModelRemoveChild(this,e,o)}se()(J()(r.prototype),"afterRemoveChild",this)&&se()(J()(r.prototype),"afterRemoveChild",this).call(this,e,t,n)}},{key:"stm",get:function(){return this[bo]},set:function(e){this[bo]=e}}],[{key:"defaultConfig",get:function(){return{stm:null}}}]),r}(xo||G)));Io._idField="id",Io._internalIdCounter=1,Io._assignedIdField=!1,Io.exposeProperties(),Io._$name="Model";var Fo=function(e){return{mixes:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.reduce((function(e,t){return t(e)}),e||G)}}};function Oo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var _o=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Oo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"add",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return 1===n.length&&Array.isArray(n[0])&&(n=n[0]),(e=se()(J()(r.prototype),"add",this)).call.apply(e,[this].concat(Z()(n.filter((function(e){return e.isPersistable})))))}}]),r}(fi);function Po(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Lo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lo(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Lo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ho(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}_o._$name="StoreBag";function jo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Bo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var No={add:1,replace:1};function zo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Vo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Wo(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Uo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uo(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Go(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Yo=function(e,t){return-1!==String(e).toLowerCase().indexOf(t)},$o={string:Yo,number:Yo,boolean:Yo,date:function(e,t){return e instanceof Date&&t instanceof Date?String(e)===String(t):-1!==String(e.getMonth()+1).indexOf(t)||-1!==String(e.getDate()).indexOf(t)||-1!==String(e.getFullYear()).indexOf(t)}};function qo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Xo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ko=function(){return!0};function Jo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Qo=n(10),Zo=n.n(Qo),ea=(n(54),n(23)),ta=n.n(ea);function na(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return ra(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ra(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ia(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var oa=Object.freeze([]),aa=function(){function e(){D()(this,e)}return M()(e,null,[{key:"preWalk",value:function(e,t,n){for(var r,i,o=[e];o.length;)n(r=o.pop()),(i=t(r))&&o.push.apply(o,i.slice().reverse())}},{key:"preWalkWithParent",value:function(e,t,n){for(var r=[{node:e,parent:null}],i=function(){var e=r.pop(),i=e.parent,o=e.node;n(i,o);var a=t(o);a&&r.push.apply(r,Z()(a.slice().reverse().map((function(e){return{node:e,parent:o}}))))};r.length;)i()}},{key:"preWalkUnordered",value:function(e,t,n){for(var r,i,o=[e];o.length;)n(r=o[o.length-1]),(i=t(r))?o.splice.apply(o,[o.length-1,1].concat(Z()(i))):o.length=o.length-1}},{key:"postWalk",value:function(e,t,n){for(var r,i,o=new Map,a=[e];a.length;)r=a[a.length-1],o.has(r)?(n(r),a.pop()):((i=t(r))&&(a=a.concat(i.slice().reverse())),o.set(r,r))}},{key:"prePostWalk",value:function(e,t,n,r){for(var i,o,a=new Map,s=[e];s.length;)i=s[s.length-1],a.has(i)?(r(i),s.pop()):(n(i),(o=t(i))&&(s=s.concat(o.slice().reverse())),a.set(i,i))}}]),e}();function sa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}aa._$name="WalkHelper";function la(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ca=Symbol("STM_PROP");function ua(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return da(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return da(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function da(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fa(e){return function(){var t,n=J()(e);if(ha()){var r=J()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return X()(this,t)}}function ha(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ga=function(e){$()(n,e);var t=fa(n);function n(){return D()(this,n),t.apply(this,arguments)}return M()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;Object.assign(t,{added:new _o,removed:new _o,modified:new _o,idRegister:{},internalIdRegister:{}}),se()(J()(n.prototype),"construct",this).call(this,e),t.initRelations()}},{key:"doDestroy",value:function(){for(var e,t=this,r=t.registeredRecords,i=r.length-1;i>=0;i--)(e=r[i])&&!e.isDestroyed&&e.unJoinStore(t);t.storage.destroy(),delete n.storeMap[t.id],t.stm&&t.stm.removeStore(t),se()(J()(n.prototype),"doDestroy",this).call(this)}},{key:"beginBatch",value:function(){this.suspendEvents()}},{key:"endBatch",value:function(){this.resumeEvents()&&this.trigger("refresh",{action:"batch",data:this.storage.values,records:this.storage.values})}},{key:"onDataChange",value:function(e){var t,r,i=e.source,o=e.action,a=e.added,s=e.removed,l=e.replaced,c=e.oldCount,u=e.item,d=e.from,f=e.to,h=this,g=a&&a.length,v=s&&s.length;if(h._idMap=null,g&&a.forEach((function(e){e.joinStore(h)})),l&&l.forEach((function(e){var t=te()(e,2),n=t[0],r=t[1];n.unJoinStore(h),r.joinStore(h)})),se()(J()(n.prototype),"onDataChange",this).apply(this,arguments),!h.isTree){if(g){var p,y=ua(a);try{for(y.s();!(p=y.n()).done;)(t=p.value).joinStore(h)}catch(e){y.e(e)}finally{y.f()}h.added.add(a),h.removed.remove(a),(r=!h.filterParamName&&h.filtered&&h.reapplyFilterOnAdd)&&h.filter({silent:!0})}if(v){var m,b=ua(s);try{for(b.s();!(m=b.n()).done;)(t=m.value).unJoinStore(h),h.added.includes(t)?h.added.remove(t):h.removed.add(t)}catch(e){b.e(e)}finally{b.f()}h.modified.remove(s),(r=!h.filterParamName&&h.filtered)&&h.filter({silent:!0})}}switch(o){case"clear":h.relationCache={},h.updateDependentStores("removeall"),h.trigger("removeAll"),h.trigger("change",{action:"removeall"});break;case"splice":if(g){h.updateDependentStores("add",a);var k=a.reduce((function(e,t){var n=t.meta.previousIndex;return n>-1&&n<e&&(e=n),e}),a[0].meta.previousIndex),w=i.indexOf(a[0],!i.autoFilter),S={records:a,index:w};k>-1&&(S.oldIndex=k),h.trigger("add",S),h.trigger("change",Object.assign({action:"add"},S)),r&&h.triggerFilterEvent({action:"filter",filters:h.filters,oldCount:c,records:h.storage.allValues})}s.length&&(h.updateDependentStores("remove",s),h.trigger("remove",{records:s}),h.trigger("change",{action:"remove",records:s})),l.length&&(h.trigger("replace",{records:l,all:h.records.length===l.length}),h.trigger("change",{action:"replace",replaced:l,all:h.records.length===l.length}));break;case"filter":h.isGrouped?h.group(null,null,null,null,!0):h.isSorted&&h.performSort(!0);break;case"move":for(var C=h.storage.allValues,R=Math.min(d,f);R<=Math.max(d,f);R++)C[R].parentIndex=R;h.trigger("move",{record:u,from:d,to:f}),h.trigger("change",{action:o,record:u,from:d,to:f})}}},{key:"onModelChange",value:function(e,t,n,r,i){var o=this,a=e.constructor.idField,s={record:e,changes:n,batch:null!=e.batching,fromRelationUpdate:i};if(e.isModified?o.modified.includes(e)||o.added.includes(e)||(o.modified.add(e),o.autoCommit&&o.commit()):o.modified.remove(e),!r){if(a in n){var l=t[a],c=l.oldValue,u=l.value;o.updateDependentRecordIds(c,u),o.onRecordIdChange(e,c,u),o.trigger("idChange",{store:o,record:e,oldValue:c,value:u})}o.onUpdateRecord(e,n),o.trigger("update",s),o.trigger("change",Object.assign({action:"update"},s))}}},{key:"buildRootNode",value:function(){return{}}},{key:"loadData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dataset",n=this,r=n.storage,i=n.allowNoId,o=n.modelClass.fieldMap.id.dataSource;if(n.allCount&&n.clear(!1),n._idMap=null,e){n.storeCollapsedGroups();var a=!(e[0]instanceof Io);if(a){n.modelClass.exposeProperties(e[0]);for(var s=e.length,l=new Array(s),c=0;c<s;c++){var u=e[c];if(!i&&null==u[o])throw new Error("Id required but not found on row ".concat(c));l[c]=n.createRecord(u,!0),l[c].parentIndex=c}r.replaceValues(l,!0,!0)}else r.replaceValues(e.slice(),!0,!0);if(n.storage.allValues.forEach((function(e){e.joinStore(n)})),n.prepareGroupRecords(),n.restoreCollapsedGroups(),!n.filterParamName&&n.isFiltered&&n.filter({silent:!0}),n.isGrouped&&n.group(null,null,!1,!n.sorters.length,!0),!n.sortParamName&&n.sorters.length&&n.sort(null,null,!1,!0),!n.useRawData.disableDuplicateIdCheck){var d=n.idMap;if(Object.keys(d).length<n.storage.values.length){var f=[];throw n.storage.values.forEach((function(e){return d[e.id]?delete d[e.id]:f.push(e)})),new Error("Id collision on ".concat(f.map((function(e){return e.id}))))}}var h={action:t,data:e,records:n.storage.values};n.updateDependentStores(h.action,h.records),n.trigger("refresh",h),n.trigger("change",h)}else n._data=null}},{key:"getRange",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(n?this.storage.allValues:this.storage.values).slice(e,t)}},{key:"createRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new this.modelClass(e,this,null,t)}},{key:"refreshData",value:function(){this.filter(),this.sort()}},{key:"onRecordIdChange",value:function(e,t,n){var r=this,i=r._idMap,o=r.idRegister;r.storage._indicesInvalid=!0,i&&(delete i[t],i[n]=e),r.added.changeId(t,n),r.removed.changeId(t,n),r.modified.changeId(t,n),delete o[t],o[n]=e,e.index=r.storage.indexOf(e)}},{key:"onUpdateRecord",value:function(e,t){var n=t.internalId,r=this.internalIdRegister;n&&(this.storage._indicesInvalid=!0,delete r[n.oldValue],r[n.value]=e),this.reapplyFilterOnUpdate&&this.isFiltered&&this.filter()}},{key:"getCount",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.count:this.originalCount}},{key:"getAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.storage.getAt(e,t)}},{key:"register",value:function(e){var t=this.isTree&&this.idRegister[e.id];if(t&&t!==e)throw new Error("Id collision on ".concat(e.id));this.idRegister[e.id]=e,this.internalIdRegister[e.internalId]=e}},{key:"unregister",value:function(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}},{key:"getById",value:function(e){return e&&e.isModel?e:this.idRegister[e]}},{key:"isVisible",value:function(e){return this.isAvailable(e)}},{key:"isAvailable",value:function(e){var t=this.getById(e);return t&&this.storage.includes(t)||!1}},{key:"getByInternalId",value:function(e){return this.internalIdRegister[e]}},{key:"includes",value:function(e){return this.isTree?null!=this.idRegister[Io.asId(e)]:this.indexOf(e)>-1}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Io.asId(e);if(null==n)return-1;if(this.isTree)return this.storage.indexOf(n);var r=this.idMap[n];return r?r[t?"visibleIndex":"index"]:-1}},{key:"allIndexOf",value:function(e){var t=this;if(this.isTree){var n=this.getById(e),r=-1;return n&&n.bubble((function(e){e.parent?r+=e.parentIndex+1:e===t.rootNode&&t.rootVisible&&(r+=1)})),r}return this.storage.indexOf(e,!0)}},{key:"getDistinctValues",value:function(e){var t,n=[],r={};return this.forEach((function(i){i.meta.specialRow||i.isRoot||(t=i.get(e),r[t]||(n.push(t),r[t]=1))})),n}},{key:"getValueCount",value:function(e,t){var n=0;return this.forEach((function(r){mt.isEqual(r.get(e),t)&&n++})),n}},{key:"toJSON",value:function(){return(this.isTree?this.rootNode.children:this).map((function(e){return e.toJSON()}))}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=function(n,r){if(!n.isRoot&&!n.meta.specialRow)return e.call(t,n,r)};if(this.isTree)this.rootNode.traverseWhile(n);else for(var r=this.storage.values,i=0;i<r.length;i++)if(!1===n(r[i],i))return}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return this.storage.values.map(e,t)}},{key:"reduce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;return n!==this&&(e=e.bind(n)),this.storage.values.reduce(e,t,n)}},{key:Symbol.iterator,value:function(){return this.storage.values[Symbol.iterator]()}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootNode,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t===this.rootNode,r=this;if(r.isTree){if("boolean"==typeof t&&(n=t,t=r.rootNode),r.isChained){var i=e;e=function(e){r.chainedFilterFn(e)&&i(e)}}t.traverse(e,n)}else{var o,a=ua(r.storage);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.traverse(e)}}catch(e){a.e(e)}finally{a.f()}}}},{key:"traverseWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootNode,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t===this.rootNode,r=this;if(r.isTree){if("boolean"==typeof t&&(n=t,t=r.rootNode),r.isChained){var i=e;e=function(e){r.chainedFilterFn(e)&&i(e)}}t.traverseWhile(e,n)}else{var o,a=ua(r.storage);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(!1===s.traverse(e))break}}catch(e){a.e(e)}finally{a.f()}}}},{key:"getNext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.storage.values,o=r.indexOf(e);if(o>=i.length-1){if(!t)return null;o=-1}var a=i[o+1];return n&&a&&a.meta.specialRow?r.getNext(i[o+1],t,!0):a}},{key:"getPrev",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.storage.values,o=r.indexOf(e);if(0===o){if(!t)return null;o=i.length}var a=i[o-1];return n&&a&&a.meta.specialRow?r.getNext(i[o+1],t,!0):a}},{key:"getAdjacent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t?this.getNext(e,n,r):this.getPrev(e,n,r)}},{key:"getNextLeaf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.leaves,i=n.getById(e),o=r.indexOf(i);if(o>=r.length-1){if(!t)return null;o=-1}return r[o+1]}},{key:"getPrevLeaf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.leaves,i=n.getById(e),o=r.indexOf(i);if(0===o){if(!t)return null;o=r.length}return r[o-1]}},{key:"getAdjacentLeaf",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?this.getNextLeaf(e,n):this.getPrevLeaf(e,n)}},{key:"makeChained",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return new this.constructor(Object.assign(n||{},{tree:!1,autoTree:!1,masterStore:this,chainedFilterFn:e,chainedFields:t}))}},{key:"chain",value:function(){return this.makeChained.apply(this,arguments)}},{key:"storage",set:function(e){var t=this;e&&e.isCollection?t._storage=e:t._storage=new Sr(e),t._storage.autoFilter=t.reapplyFilterOnAdd;var n,r=ua(t._storage);try{for(r.s();!(n=r.n()).done;){n.value.joinStore(t)}}catch(e){r.e(e)}finally{r.f()}t._storage.on({change:"onDataChange",thisObj:t})},get:function(){return this._storage||(this.storage={}),this._storage}},{key:"allRecords",get:function(){var e=this;if(e.isTree){var t=e.collectDescendants(e.rootNode,void 0,void 0,{unfiltered:!0}).all;return e.rootVisible&&t.unshift(e.rootNode),t}return e.isGrouped?e.collectGroupRecords():e.storage.allValues}},{key:"idMap",get:function(){var e=this.storage.values,t=!this._idMap,n=this._idMap||(this._idMap={});if(t)for(var r,i=0,o=0;i<e.length;i++)n[(r=e[i]).id]={index:i,visibleIndex:o,record:r},r.meta.specialRow||o++;return n}},{key:"modelClass",get:function(){return this._modelClass},set:function(e){var t=this.fields,n=null;t&&t.length?(n=function(e){$()(r,e);var n=fa(r);function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"fields",get:function(){return t}}]),r}(e)).exposeProperties():n=this.preventSubClassingModel?e:function(e){$()(n,e);var t=fa(n);function n(){return D()(this,n),t.apply(this,arguments)}return n}(e),n.exposeRelations(),this._modelClass=n}},{key:"storeId",set:function(e){this.id=e},get:function(){return this.id}},{key:"id",set:function(e){this._id&&delete n.storeMap[this._id],this._id=!0===e?we.generateId("store-"):e,e&&(n.storeMap[e]=this)},get:function(){return this._id}},{key:"tree",get:function(){return this._tree},set:function(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode())}},{key:"rootNode",get:function(){return this.masterStore?this.masterStore.rootNode:this._rootNode},set:function(e){var t=this,n=t._rootNode;e!==n&&(n&&t.clear(!1),e instanceof Io?(e.instanceMeta(t).collapsed=!1,t._rootNode=e):(t._rootNode=e=new t.modelClass(Object.assign(oe()({expanded:!0},t.modelClass.idField,"".concat(t.id,"-rootNode")),e),t,null,!0),e.isAutoRoot=!0),t._tree=!0,e.isRoot=!0,e.joinStore(t),(e.children&&e.children.length||t.rootVisible)&&(e.isLoading=!0,t.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),t.trigger("rootChange",{oldRoot:n,rootNode:e}))}},{key:"data",set:function(e){var t=this;if(t._thisIsAUsedExpression(t.plugins),t.processConfiguredListeners(),t.tree=!t.isChained&&(t.tree||Boolean(t.autoTree&&e&&e.some((function(e){return e[t.modelClass.childrenField]})))),t.syncDataOnLoad&&t._data)t.syncDataset(e);else{if(t._data=e,t.tree){var n=t.rootNode;n.clearChildren(!0),n.isLoading=!0,n.appendChild(e),t.updateDependentStores("dataset",[n]),n.isLoading=!1,0===e.length?t.trigger("refresh",{action:"dataset",data:[],records:[]}):t.isFiltered&&t.filter()}else t.loadData(e);t.added.clear(),t.removed.clear(),t.modified.clear()}},get:function(){return this._data}},{key:"useRawData",get:function(){return this._useRawData},set:function(e){this._useRawData=!0===e?{enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:e?Object.assign(e,{enabled:!0}):{enabled:!1}}},{key:"originalCount",get:function(){return this.storage.totalCount}},{key:"count",get:function(){return this.storage.count}},{key:"allCount",get:function(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}},{key:"records",get:function(){return this.storage.values}},{key:"first",get:function(){return this.storage.values[0]}},{key:"last",get:function(){return this.storage.values[this.storage.values.length-1]}},{key:"registeredRecords",get:function(){return Object.values(this.idRegister)}},{key:"json",get:function(){return JSON.stringify(this,null,4)}}],[{key:"getStore",value:function(e,t){if(e instanceof n)return e;if(this.storeMap[e])return this.storeMap[e];if(Array.isArray(e)){var r,i=e.map((function(e){return e instanceof Io?r=e.constructor:"string"==typeof e&&(e={text:e}),e}));e={autoCreated:!0,data:i,modelClass:r||function(e){$()(n,e);var t=fa(n);function n(){return D()(this,n),t.apply(this,arguments)}return n}(Io),allowNoId:!0},t||(t=n)}return t?new t(e):void 0}},{key:"properties",get:function(){return{relationCache:{},dependentStoreConfigs:new Map}}},{key:"defaultConfig",get:function(){return{storeId:null,id:!0,fields:null,autoTree:!0,modelClass:Io,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null}}},{key:"stores",get:function(){return Object.values(this.storeMap)}}]),n}(Fo(G).mixes(pe,vo,yo,(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(jo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"traverseFilter",value:function(e){var t=this,n=!e.isRoot&&t.filtersFunction(e),r=e.unfilteredChildren||e.children;return r&&r.length?(e.unfilteredChildren||(e.unfilteredChildren=e.children.slice()),e.children=e.unfilteredChildren.filter((function(e){return t.traverseFilter(e)})),n||Boolean(e.children.length)):n}},{key:"traverseClearFilter",value:function(e){var t=this;e.unfilteredChildren&&(e.children=e.unfilteredChildren.slice(),e.unfilteredChildren=null),e.children&&e.children.forEach((function(e){return t.traverseClearFilter(e)}))}},{key:"processFieldFilter",value:function(e,t){"string"==typeof e&&(e={property:e,value:t}),(e=e instanceof cr?e:new cr(e)).owner=this,this.filters.add(e)}},{key:"filter",value:function(e){var t=this,n=t.filters,r=!1;if(e){var i=re()(e);if("object"===i&&("silent"in e||"replace"in e)&&(r=e.silent,e.replace&&n.clear(),e=e.filters,i=re()(e)),e&&(t.isConfiguring=!0,Array.isArray(e)?e.forEach(t.processFieldFilter,t):"function"===i?n.add(new cr(e)):"string"===i?t.processFieldFilter(e,arguments[1]):t.processFieldFilter(e),t.isConfiguring=!1,!t.isFiltered))return}t.filtersFunction=null,t.performFilter(r)}},{key:"performFilter",value:function(e){var t=this,n=t.storage,r=t.filters,i=t.rootNode,o=t.count;t.tree?(t.isFiltered?t.traverseFilter(i):t.traverseClearFilter(i),n.replaceValues(t.collectDescendants(i).visible,!0)):t.isFiltered?n.addFilter({id:"primary-filter",filterBy:t.filtersFunction}):n.filters.clear(),t.afterPerformFilter(e?null:{action:"filter",filters:r,oldCount:o,records:t.storage.values})}},{key:"afterPerformFilter",value:function(e){this.resetRelationCache(),e&&this.triggerFilterEvent(e)}},{key:"triggerFilterEvent",value:function(e){this.trigger("filter",e),this.filterParamName||(this.trigger("refresh",e),this.trigger("change",e))}},{key:"filterBy",value:function(e){this.filter(e)}},{key:"removeFieldFilter",value:function(e,t){var n=this.filters.getBy("property",e);n&&(this.filters.remove(n),this._filtersFunction=null,t||this.filter())}},{key:"removeFilter",value:function(e,t){var n=e instanceof cr?e:this.filters.get(e);n&&(this.filters.remove(n),this._filtersFunction=null,t||this.filter())}},{key:"clearFilters",value:function(e){this.filters.clear(),this.filter(void 0,void 0,e)}},{key:"convertFilterToString",value:function(e){var t=this.filters.getBy("property",e);return t&&!t.filterBy?String(t):""}},{key:"filters",set:function(e){var t=this,n=t.filters;if(n.clear(),t._filtersFunction=null,e){if("Object"===e.constructor.name)for(var r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];"filterBy"===o[0]&&"function"==typeof o[1]?n.add(new cr({filterBy:o[1]})):n.add(new cr("Object"===o[1].constructor.name?Object.assign({property:o[0]},o[1]):{property:o[0],value:o[1]}))}else Array.isArray(e)?n.add.apply(n,Z()(e.map((function(e){return e instanceof cr?e:new cr(e)})))):e.isCollection?n.add.apply(n,Z()(e.values)):n.add(new cr({filterBy:e}));n.forEach((function(e){return e.owner=t}))}},get:function(){return this._filters||(this._filters=new Sr({extraKeys:["property"]}))}},{key:"filtersFunction",set:function(e){this._filtersFunction=e},get:function(){var e=this,t=e.filters,n=e.isGrouped;if(!e._filtersFunction)if(t.count){var r=cr.generateFiltersFunction(t);e._filtersFunction=function(e){return n&&e.meta.specialRow?e.groupChildren.some(r):r(e)}}else e._filtersFunction=_n.returnTrue;return e._filtersFunction}},{key:"isFiltered",get:function(){return this.filters.values.some((function(e){return!e.disabled}))}},{key:"latestFilterField",get:function(){return this.filters.last?this.filters.last.property:null}},{key:"filtered",get:function(){return this.storage.isFiltered}},{key:"filterState",get:function(){return this.filters.values.map((function(e){return mt.cleanupProperties(e.config)}))}}],[{key:"defaultConfig",get:function(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ho()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(arguments.length>2&&arguments[2],this),r=n.storage;if((e=(Array.isArray(e)?e:[e]).reduce((function(e,t){return(t=n.getById(t))&&e.push(t),e}),[])).length){if(n.tree){for(var i=e.reduce((function(e,t){var n=t.parent;return n&&(e[n.id]||(e[n.id]=[n,[]]),e[n.id][1].push(t)),e}),{}),o=0,a=Object.values(i);o<a.length;o++){var s=a[o];s[0].removeChild(s[1],!1,t)}return e}if(n.isGrouped){var l,c=r.count,u=[],d=new Set,f=Po(e);try{for(f.s();!(l=f.n()).done;){var h=l.value,g=h.instanceMeta(n),v=g.groupParent;v&&v.meta.collapsed&&u.push(h),ue.remove(v.groupChildren,h),v.meta.childCount--,d.add(v)}}catch(e){f.e(e)}finally{f.f()}var p,y=Po(d);try{for(y.s();!(p=y.n()).done;){var m=p.value;n.onModelChange(m,{},{})}}catch(e){y.e(e)}finally{y.f()}u.length&&r.trigger("change",{action:"splice",removed:u,added:[],replaced:[],oldCount:c})}if(!e.length||!t&&!1===n.trigger("beforeRemove",{records:e}))return null;t&&n.suspendEvents(),r.remove(e),t&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit()}return e}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,n=t.storage;if(t.storage.totalCount){if(e&&!1===t.trigger("beforeRemove",{records:n.allValues,removingAll:!0}))return null;if(!e){for(var r,i=t.registeredRecords,o=i.length-1;o>=0;o--)(r=i[o])&&!r.isDestroyed&&r.unJoinStore(t);t.removed.clear()}e||n.suspendEvents(),n.clear(),e||n.resumeEvents(),t.added.clear(),t.modified.clear()}}},{key:"removeAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.storage;if(e){n.suspendEvents();for(var r,i=t.registeredRecords,o=i.length-1;o>=0;o--)(r=i[o])&&!r.isDestroyed&&r.unJoinStore(t)}t.tree?t.rootNode.clear():t.clear(),e&&n.resumeEvents()}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.storage,i=[];if(Array.isArray(e)){if(!e.length)return}else e=[e];if(n.tree=n.tree||Boolean(n.autoTree&&e[0].children),n.tree){var o=new Map,a=[];return e.forEach((function(e){var t=e[n.modelClass.parentIdField];o.has(t)||o.set(t,[]),o.get(t).push(e)})),o.forEach((function(e,r){var i=null==r?n.rootNode:n.getById(r);if(!i)throw new Error("Parent node with id ".concat(r," not found, cannot add children."));a.push.apply(a,Z()(i.appendChild(e,t)))})),a}return t||!1!==n.trigger("beforeAdd",{records:e})?(n.tree=n.tree||Boolean(n.autoTree&&e[0].children),n.tree?n.rootNode.appendChild(e):(e.forEach((function(e){i.push(e instanceof Io?e:n.createRecord(e))})),t&&n.suspendEvents(),r.add(i),t&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),i)):null}},{key:"insert",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this,s=a.storage,l=[],c=a.getAt(e),u=s.values,d=[];if(Array.isArray(t)||(t=[t]),!1===a.trigger("beforeAdd",{records:t}))return null;if(u[r=e]===t[0]||u[r=e-1]===t[0])for(n=!0,i=0;n&&i<t.length;i++)t[i]!==u[r+i]&&(n=!1);if(n)return null;if(t.forEach((function(t){var n=t instanceof Io?t:a.createRecord(t),r=s.indexOf(n);n.children&&n.children.length&&a.autoTree&&(a.tree=!0),l.push(n),r>-1&&(r<e&&c&&e--,d.push(r)),n.meta.previousIndex=r})),a.tree){var f=a.rootNode;return f.insertChild(t,f.children&&f.children[e])}return a.suspendEvents(),a.storage.remove(d),a.resumeEvents(),o&&a.suspendEvents(),s.splice.apply(s,[e,0].concat(l)),o&&a.resumeEvents(),a.autoCommit&&a.doAutoCommit(),l}},{key:"move",value:function(e,t){this.storage.move(e,t)}},{key:"setMultiple",value:function(e,t,n){var r=this,i=[],o=[];r.forEach((function(r){e(r)&&(o.push(r.set(t,n,!0)),i.push(r))})),r.trigger("updateMultiple",{records:i,all:r.records.length===i.length}),r.trigger("change",{action:"updatemultiple",records:i,all:r.records.length===i.length}),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}},{key:"setAll",value:function(e,t){var n=this,r=[];n.forEach((function(n){r.push(n.set(e,t,!0))})),n.trigger("updateMultiple",{records:n.records,all:!0}),n.trigger("change",{action:"updatemultiple",records:n.records,all:!0}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}},{key:"acceptChanges",value:function(){var e=this;e.added.forEach((function(e){return e.clearChanges(!1)})),e.modified.forEach((function(e){return e.clearChanges(!1)})),e.added.clear(),e.modified.clear(),e.removed.clear()}},{key:"commit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.changes;return this.callPreventable("commit",{changes:n},(function(){return e.acceptChanges(),n}),[],t)}},{key:"clearChanges",value:function(){var e=this;e.remove(e.added.values,!0),e.modified.forEach((function(e){return e.clearChanges(!1)})),e.added.clear(),e.modified.clear(),e.removed.clear(),e.trigger("change",{action:"clearchanges"})}},{key:"doAutoCommit",value:function(){this.commit()}},{key:"applyChangesFromStore",value:function(e){var t=this,n=e.changes;n&&(n.added&&t.add(n.added),n.removed&&t.remove(n.removed.map((function(e){return e.id}))),n.modified&&n.modified.forEach((function(e){t.getById(e.id).set(e.modifications)})))}},{key:"changes",get:function(){var e=this;return e.added.count||e.modified.count||e.removed.count?{added:e.added.values.slice(),modified:e.modified.values.slice(),removed:e.removed.values.slice()}:null}},{key:"autoCommit",get:function(){return this._autoCommit},set:function(e){this._autoCommit=e,e&&this.changes&&this.commit()}}],[{key:"defaultConfig",get:function(){return{autoCommit:!1}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(zo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"initRelations",value:function(e){var t=this,n=t.modelClass.relations;e&&t.modelRelations&&t.modelRelations.forEach((function(e){e.storeDetacher&&e.storeDetacher()})),t.modelRelations&&0!==t.modelRelations.length&&!e||!n||(t.modelRelations=[],n&&n.forEach((function(e){var n=Object.assign({},e),r="string"==typeof n.store?t[n.store]:n.store;if(n.dependentStore=t,t.modelRelations.push(n),r){n.storeProperty=n.store,n.store=r;var i=r.dependentStoreConfigs;i.has(t)?i.get(t).push(n):i.set(t,[n]),n.collectionName&&r.initRelationCollection(n,t),r.count>0&&r.updateDependentStores("dataset",r.records)}})))}},{key:"initRelationCollection",value:function(e,t){var n=this,r=e.collectionName;n.collectionStores||(n.collectionStores={}),n.collectionStores[r]={store:t,config:e},n[r+"Store"]||(n[r+"Store"]=t),n.count>0&&n.initModelRelationCollection(r,n.records)}},{key:"initModelRelationCollection",value:function(e,t){var n=this;t.forEach((function(t){t.traverse((function(t){!(e in t)&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n.getCollection(this,e)},set:function(t){return n.setCollection(this,e,t)}})}))}))}},{key:"resetRelationCache",value:function(){this.relationCache={},this.forEach((function(e){return e.initRelations()}))}},{key:"updateRecordRelationCache",value:function(e,t){var n=this;t&&t.forEach((function(t){var r=t.related?t.related.id:e.get(t.config.fieldName);void 0!==r&&n.cacheRelatedRecord(e,r,t.config.relationName,r)}))}},{key:"getCollection",value:function(e,t){var n=this.collectionStores[t],r=n.config,i=n.store;return i.relationCache[r.relationName]&&i.relationCache[r.relationName][e.id]||[]}},{key:"setCollection",value:function(e,t,n){var r=this.collectionStores[t],i=r.config,o=r.store;o.relationCache[i.relationName]||(o.relationCache[i.relationName]={});var a=(o.relationCache[i.relationName][e.id]||[]).slice(),s=[],l=[];o.suspendEvents(),a.forEach((function(e){n.includes(e)||(e[i.fieldName]=null,o.remove(e),l.push(e))})),n.forEach((function(t){if(t instanceof Io)t.stores.includes(o)||(o.add(t),s.push(t));else{var n=o.add(t);t=te()(n,1)[0],s.push(t)}t[i.fieldName]=e.id})),o.resumeEvents(),l.length&&(o.trigger("remove",{records:l}),o.trigger("change",{action:"remove",records:l})),s.length&&(o.trigger("add",{records:s}),o.trigger("change",{action:"add",records:s}))}},{key:"cacheRelatedRecord",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this,o=i.relationCache[n]||(i.relationCache[n]={});null!==r&&i.uncacheRelatedRecord(e,n,r),null!=t&&ue.include(o[t]||(o[t]=[]),e)}},{key:"uncacheRelatedRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this;function i(t,n){var i=r.relationCache[t],o=i&&i[n];if(o){var a=o.indexOf(e);a>=0&&o.splice(a,1),0===o.length&&delete i[n]}}null!=n?i(t,n):e.meta.relationCache&&Object.entries(e.meta.relationCache).forEach((function(e){var t=te()(e,2),n=t[0],r=t[1];i(n,r&&r.id)}))}},{key:"updateDependentStores",value:function(e,t){var n=this;this.dependentStoreConfigs.forEach((function(r){r.forEach((function(r){var i=r.dependentStore,o=i.relationCache[r.relationName];return"dataset"===e?(r.collectionName&&n.initModelRelationCollection(r.collectionName,t),void i.forEach((function(e){var t=e.initRelation(r);t&&i.cacheRelatedRecord(e,t.id,r.relationName,t.id)}))):"removeall"===e?(i.forEach((function(e){e.removeRelation(r)})),void delete i.relationCache[r.relationName]):("add"===e&&r.collectionName&&n.initModelRelationCollection(r.collectionName,t),void("add"!==e&&"remove"!==e||t.forEach((function(t){var n=o&&o[t.id];switch(e){case"remove":n&&n.forEach((function(e){return e.removeRelation(r)}));break;case"add":i.forEach((function(e){e.get(r.fieldName)==t.id&&(e.initRelation(r),i.cacheRelatedRecord(e,t.id,r.relationName))}))}}))))}))}))}},{key:"updateDependentRecordIds",value:function(e,t){this.dependentStoreConfigs&&this.dependentStoreConfigs.forEach((function(n){n.forEach((function(n){var r=n.dependentStore,i=r.relationCache[n.relationName],o=i&&i[e]&&i[e].slice();o&&o.forEach((function(i){i.set(n.fieldName,t,!1,!0),r.cacheRelatedRecord(i,t,n.relationName,e)}))}))}))}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Vo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"sum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t?t.reduce((function(t,n){if(n.meta.specialRow)return t;var r=Number(n[e]);return isNaN(r)?t:t+r}),0):0}},{key:"min",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t&&t.length?t.reduce((function(t,n){return"number"==typeof n[e]&&n[e]<t&&(t=n[e]),t}),t[0][e]):0}},{key:"max",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t&&t.length?t.reduce((function(t,n){return"number"==typeof n[e]&&n[e]>t&&(t=n[e]),t}),t[0][e]):0}},{key:"average",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;if(!t||!t.length)return 0;var n=0,r=t.reduce((function(t,r){if(r.meta.specialRow)return t;var i=parseFloat(r[e]);return isNaN(i)?t:(n++,t+i)}),0);return n>0?r/n:0}},{key:"groupSum",value:function(e,t){return this.sum(t,this.getGroupRecords(e))}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Go()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"search",value:function(e){var t,n,r,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.storage.values,l=s.length,c=[];if(null==e)return null;for("string"==typeof e&&(e=String(e).toLowerCase()),t=0;t<l;t++){n=s[t];var u,d=Wo(a||n.fieldNames);try{for(d.s();!(u=d.n()).done;){var f=u.value;i=(r=n[f])instanceof Date?"date":re()(r),o=$o[i],r&&o&&o(r,e)&&c.push({index:t,data:n,field:f,id:n.id})}}catch(e){d.e(e)}finally{d.f()}}return c}},{key:"findByField",value:function(e,t){var n,r,i,o=this.storage.values,a=o.length,s=[];for(null!=t&&(t=String(t).toLowerCase()),n=0;n<a;n++){r=o[n];var l=(i=r[e])instanceof Date?"date":re()(i),c={date:function(){return Boolean(i)&&i.toLocaleString().includes(t)},string:function(){return Boolean(i)&&i.toLowerCase().includes(t)},number:function(){return"number"==typeof i&&i.toString().includes(t)},object:function(){return i===t},undefined:function(){return i===t}};(null==t&&i===t||t&&c[l]())&&s.push({id:r.id,index:n,data:r})}return s}},{key:"find",value:function(e){return this.storage.values.find(e)}},{key:"findRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(n){return mt.isEqual(n[e],t)};return this.tree?this.query(r)[0]:(n?this.storage.allValues:this.storage.values).find(r)}},{key:"query",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isTree){var n=[];return this.traverse((function(t){e(t)&&n.push(t)})),n}return(t?this.storage.allValues:this.storage.values).filter(e)}},{key:"some",value:function(e){return this.storage.values.some(e)}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(qo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"sort",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=o.allRecords,s=o.sorters?o.sorters.slice():[],l=null;if(e)if(Array.isArray(e))o.sorters=e.map((function(e){return"string"==typeof e?{field:e}:e}));else{var c={field:e};if("object"===re()(e)&&(c.field=e.field,c.fn=e.fn,c.useLocaleSort=e.useLocaleSort,t=e.ascending),n=o.sorters.find((function(e){return e.field===c.field})),null==t){var u=n&&("string"==typeof e&&n.field===e||"object"===re()(e)&&n.field===e.field);t=!u||!n.ascending}c.ascending=t,r?n?(l=n.ascending,n.ascending=t):o.sorters.push(c):o.sorters=[c]}return i||!1!==o.trigger("beforeSort",{sorters:o.sorters,records:a,currentSorters:s})?o.performSort(i):(o.sorters=s,void(null!==l&&(n.ascending=l)))}},{key:"addSorter",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.sort(e,t,!0)}},{key:"removeSorter",value:function(e){var t=this.sorters.findIndex((function(t){return t.field==e}));t>-1&&(this.sorters.splice(t,1),this.sort())}},{key:"clearSorters",value:function(){this.sorters.length=0,this.sort()}},{key:"createSorterFn",value:function(e){var t=this.useLocaleSort;return function(n,r){for(var i=0;i<e.length;i++){var o=e[i],a=o.field,s=o.ascending,l=void 0===s||s,c=o.fn,u=void 0===c?null:c,d=o.useLocaleSort,f=void 0===d?t:d,h=l?1:-1;if(u){var g=u(n,r);if(null!==g)return g*h}var v=n[a],p=r[a];if(null==v)return-h;if(null==p)return h;if(f){if(!0===f)return String(v).localeCompare(p)*h;if("string"==typeof f)return String(v).localeCompare(p,f)*h;if("object"===re()(f))return String(v).localeCompare(p,f.locale,f)*h}if(v>p)return h;if(v<p)return-h}return 0}}},{key:"performSort",value:function(e){var t=this,n=t.rootNode,r=t.storage,i=t.sorters,o=t.createSorterFn(t.isGrouped?t.groupers.concat(i):i);t.isGrouped&&t.storeCollapsedGroups()&&r.replaceValues(t.removeHeadersAndFooters(r.values),!0),t.tree?(n.traverse((function(e){e.isLoaded&&e.isParent&&(e.children=e.children.sort(o),e.updateChildrenIndex(e.children))})),r.replaceValues(t.collectDescendants(n).visible,!0)):r.replaceValues(r.values.sort(o),!0),t.afterPerformSort(e)}},{key:"afterPerformSort",value:function(e){var t=this,n=t.storage;if(t._idMap=null,t.isGrouped&&(n.replaceValues(t.prepareGroupRecords(n.values),!0),t.restoreCollapsedGroups()),!e){var r={action:"sort",sorters:t.sorters,records:t.allRecords};t.trigger("sort",r),t.sortParamName||t.trigger("refresh",r)}}},{key:"isSorted",get:function(){return Boolean(this.sorters.length)||this.isGrouped}}],[{key:"defaultConfig",get:function(){return{sorters:[],useLocaleSort:null}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Bo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e),this.on("change",this.onDataChanged)}},{key:"storeCollapsedGroups",value:function(){var e=this;return e.collapsedGroupsHash={},!(!e.groupRecords||!e.groupRecords.length)&&(e.groupRecords.forEach((function(t){e.expand(t)&&(e.collapsedGroupsHash[t.id]=!0)})),!0)}},{key:"restoreCollapsedGroups",value:function(){var e=this;Object.keys(e.collapsedGroupsHash).forEach((function(t){return e.collapse(e.getById(t))}))}},{key:"onDataChange",value:function(e){var t=e.source,n=e.action,i=e.removed,o=this,a=o.groupers;if(a){var s=t.values;a.length?"splice"===n&&i&&i.length&&(o.storeCollapsedGroups()&&o.storage.replaceValues(o.removeHeadersAndFooters(s),!0),o.storage.replaceValues(o.prepareGroupRecords(s),!0),o.restoreCollapsedGroups()):t.replaceValues(o.removeHeadersAndFooters(s),!0)}se()(J()(r.prototype),"onDataChange",this)&&se()(J()(r.prototype),"onDataChange",this).apply(this,arguments)}},{key:"collapse",value:function(e){return!(!e||e.meta.collapsed)&&(this.excludeGroupRecords(e),e.meta.collapsed=!0,!0)}},{key:"expand",value:function(e){return!(!e||!e.meta.collapsed)&&(this.includeGroupRecords(e),e.meta.collapsed=!1,!0)}},{key:"removeHeadersAndFooters",value:function(e){var t=this;return e.filter((function(e){return!e.meta.specialRow||(t.unregister(e),!1)}),!0)}},{key:"prepareGroupRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.registeredRecords,t=this;if(e=t.removeHeadersAndFooters(e),!t.isGrouped)return e;var n=[],r=t.groupers[0].field,i=[],o=null,a=null,s=0;function l(){var e=a.meta.groupRowFor,r="group-footer-".concat("number"==typeof e?e:L.createId(e)),o=t.getById(r)||new t.modelClass({id:r},t,{specialRow:!0,groupFooterFor:e,groupRecord:a});return t.register(o),o.groupChildren=a.groupChildren,i.push(o),n.push(o),t.allRecords.push(o),a.groupChildren.push(o),s++,o}return e.forEach((function(e){var c=null==e[r]?"__novalue__":e[r],u="group-header-".concat("number"==typeof c?c:L.createId(c));!e.groupChildren||e.groupChildren.length?(mt.isEqual(c,o)||(a&&(t.useGroupFooters&&l(),a.meta.childCount=s),a=t.getById(u)||new t.modelClass({id:u},t,{specialRow:!0,groupRowFor:c,groupField:r}),t.register(a),a.groupChildren=[],n.push(a),t.allRecords.push(a),i.push(a),o=c,s=0),e.instanceMeta(t.id).groupParent=a,n.push(e),a.groupChildren.push(e),s++):t.unregister(e)})),a&&(a.meta.childCount=s,t.useGroupFooters&&l()),t.groupRecords=i,n}},{key:"group",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this;if(r?a.groupers.push(n={field:e,ascending:t,complexMapping:e.includes(".")}):e&&(null==t&&(t=!a.groupInfo||a.groupInfo.field!==e||!a.groupInfo.ascending),a.groupInfo=n={field:e,ascending:t,complexMapping:e.includes(".")},a.groupers=[a.groupInfo]),n){var s=a.modelClass.prototype;n.complexMapping&&!s.hasOwnProperty(e)&&Object.defineProperty(s,e,{get:function(){return mt.getPath(this,e)}})}!1!==i&&a.sort(null,null,!1,!0),o||(a.trigger("group",{isGrouped:a.isGrouped,groupers:a.groupers,records:a.storage.values}),a.trigger("refresh",{action:"group",isGrouped:a.isGrouped,groupers:a.groupers,records:a.storage.values}))}},{key:"addGrouper",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.group(e,t,!0)}},{key:"removeGrouper",value:function(e){var t=this.groupers.findIndex((function(t){return t.field===e}));t>-1&&(this.groupers.splice(t,1),this.group())}},{key:"clearGroupers",value:function(){this.groupers=null}},{key:"isRecordInGroup",value:function(e,t){if(!this.isGrouped)return null;return e[this.groupers[0]&&this.groupers[0].field]===t&&!e.meta.specialRow}},{key:"isInCollapsedGroup",value:function(e){var t=e.instanceMeta(this).groupParent;return t&&t.meta.collapsed}},{key:"getGroupRecords",value:function(e){var t=this;return t.isGrouped?t.storage.values.filter((function(n){return t.isRecordInGroup(n,e)})):null}},{key:"getGroupTitles",value:function(){return this.isGrouped?this.getDistinctValues(this.groupers[0]&&this.groupers[0].field):null}},{key:"onDataChanged",value:function(e){this.isGrouped&&(!e.changes&&No[e.action]||e.changes&&this.groupers.some((function(t){return t.field in e.changes})))&&this.sort()}},{key:"internalIncludeExcludeGroupRecords",value:function(e,t){var n=this,r=n.indexOf(e),i=n.id;if(-1!==r&&!(e.meta.collapsed&&!t||!e.meta.collapsed&&t)){if(e.groupChildren.forEach((function(e){return e.instanceMeta(i).hiddenByCollapse=!t})),t){var o,a=e.groupChildren.filter((function(e){return!n.isAvailable(e)}));(o=n.storage.values).splice.apply(o,[r+1,0].concat(Z()(a)))}else n.storage.values.splice(r+1,e.groupChildren.length);n.storage._indicesInvalid=!0,n._idMap=null}}},{key:"excludeGroupRecords",value:function(e){this.internalIncludeExcludeGroupRecords(e,!1)}},{key:"includeGroupRecords",value:function(e){this.internalIncludeExcludeGroupRecords(e,!0)}},{key:"collectGroupRecords",value:function(){return this.records.reduce((function(e,t){return t.meta.specialRow&&(e.push(t),"groupRowFor"in t.meta&&e.push.apply(e,t.groupChildren)),e}),[])}},{key:"groupers",get:function(){return this._groupers},set:function(e){var t=this;e&&e.length?t._groupers=e:t.groupers&&(delete t._groupers,t.groupRecords.forEach((function(e){e.meta.collapsed&&t.includeGroupRecords(e)})),t.storage.replaceValues(t.removeHeadersAndFooters(t.registeredRecords),!0),t.group(null,null,null,!1),"groupRecords"in t&&delete t.groupRecords)}},{key:"isGrouped",get:function(){return Boolean(this.groupers&&this.groupers.length)}}],[{key:"defaultConfig",get:function(){return{groupers:null}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Xo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).call(this,e),t.masterStore&&(t.methodNamesToRelay.forEach((function(e){return t[e]=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.relayToMaster(e,r)}})),t.removeAll=function(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=t.masterStore).remove.apply(e,[t.getRange()].concat(r))},t.masterStore.on({change:t.onMasterDataChanged,prio:1,thisObj:t}),t.masterStore.chainedStores||(t.masterStore.chainedStores=[]),t.masterStore.chainedStores.push(t),t.fillFromMaster())}},{key:"updateChainedStores",value:function(){this.chainedStores&&this.chainedStores.forEach((function(e){return e.fillFromMaster()}))}},{key:"fillFromMaster",value:function(){var e=this,t=e.masterStore,n=e.isTree;if(!e.isChained)throw new Error("fillFromMaster only allowed on chained store");if(e.keepUncommittedChanges){if(n)throw new Error("Cannot use keepUncommittedChanges on a chained tree store");e.data=[].concat(e.added.values.filter((function(t){return!e.removed.includes(t)})),t.allRecords.filter((function(t){return!e.removed.includes(t)&&!e.added.includes(t)&&e.chainedFilterFn(t)})))}else{var r=t.allRecords.filter(e.chainedFilterFn);if(n&&(e.idRegister={},e.internalIdRegister={},r.forEach((function(t){t.stores.includes(e)?e.register(t):t.joinStore(e)})),e.excludeCollapsedRecords)){var i=e.getChildren(e.rootNode);r=e.doIncludeExclude(i,!0)}e.data=r}}},{key:"commitToMaster",value:function(){var e=this,t=e.masterStore;if(!e.isChained)throw new Error("commitToMaster only allowed on chained store");return t.beginBatch(),t.remove(e.removed.values),t.add(e.added.values),t.endBatch(),e.commit()}},{key:"relayToMaster",value:function(e,t){var n;return(n=this.masterStore)[e].apply(n,Z()(t))}},{key:"onMasterDataChanged",value:function(e){var t=e.action,n=e.changes;if("update"===t&&!(this.chainedFields&&this.chainedFields.some((function(e){return e in n}))))return;this.fillFromMaster()}},{key:"isChained",get:function(){return Boolean(this.masterStore)}},{key:"chainedFilterFn",set:function(e){this._chainedFilterFn=this.thisObj?e.bind(this.thisObj):e},get:function(){return this._chainedFilterFn||Ko}},{key:"methodNamesToRelay",get:function(){var e=this,t=Array.isArray(this.doRelayToMaster),n=Array.isArray(this.dontRelayToMaster);return t&&this.doRelayToMaster.filter((function(t){return!n||!e.dontRelayToMaster.includes(t)}))||[]}}],[{key:"defaultConfig",get:function(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],keepUncommittedChanges:!1,excludeCollapsedRecords:!0}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Jo()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getState",value:function(){var e=this,t={};return e.sorters&&e.sorters.length&&(t.sorters=e.sorters.slice()),e.groupers&&e.groupers.length&&(t.groupers=e.groupers.slice()),e.filters&&e.filters.values.length&&(t.filters=e.filterState),t}},{key:"applyState",value:function(e){var t=this;"sorters"in e&&(t.sorters=e.sorters.slice()),"groupers"in e&&(t.groupers=e.groupers.slice()),("sorters"in e||"groupers"in e)&&t.sort(),"filters"in e&&(t.filters=e.filters.slice(),t.filter())}}]),r}(e||G)}),(function(e){return function(e){$()(o,e);var t,n,r,i=(t=o,function(){var e,n=J()(t);if(ia()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function o(){return D()(this,o),i.apply(this,arguments)}return M()(o,[{key:"loadChildren",value:(r=ta()(Zo.a.mark((function e(t){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"onNodeAddChild",value:function(e,t,n,r){var i,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this,s=e===a.rootNode&&e.isLoading,l=a.storage,c=[],u=[],d=t[0].previousSibling;if(a.collectDescendants(t,c,u,{inCollapsedBranch:!(e.isExpanded(a)&&e.ancestorsExpanded(a))}),!s&&u.length){var f,h=na(u);try{for(h.s();!(f=h.n()).done;){var g=f.value;a.modified.includes(g)||r[g.id]||(a.added.add(g),a.removed.remove(g))}}catch(e){h.e(e)}finally{h.f()}}if(s&&a.rootVisible&&(c.unshift(e),u.unshift(e)),c.length&&(i=0!==n&&d?l.indexOf(d)+d.getDescendantCount(!0,a):l.indexOf(e),l.suspendEvents(),a.storage.splice(++i,0,c),l.resumeEvents()),a.updateDependentStores("add",t),s&&c.length){if(a.sorters.length&&a.sort(null,null,!1,!0),!o){var v={action:"dataset",data:a._data,records:c};a.trigger("refresh",v),a.trigger("change",v)}}else if(!o){var p={action:"add",parent:e,isChild:!0,isMove:r,records:t,allRecords:u,index:i};a.trigger("add",p),a.trigger("change",p)}}},{key:"onNodeRemoveChild",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{isMove:!1,silent:!1,unfiltered:!1},i=this,o=i.storage,a=[],s=[],l=r.isMove,c=r.silent,u=r.unfiltered,d=u&&i.isFiltered,f=d&&e.unfilteredChildren?e.unfilteredChildren:t;if(i.collectDescendants(f,a,s,{inCollapsedBranch:!(e.isExpanded(i)&&e.ancestorsExpanded(i)),unfiltered:d}),!l){var h,g=na(t);try{for(g.s();!(h=g.n()).done;){var v=h.value;v.unJoinStore(i)}}catch(e){g.e(e)}finally{g.f()}if(s.length){var p,y=na(s);try{for(y.s();!(p=y.n()).done;){var m=p.value;m.stores.includes(i)&&m.unJoinStore(i),i.added.includes(m)?i.added.remove(m):i.removed.add(m)}}catch(e){y.e(e)}finally{y.f()}i.modified.remove(s)}}if(a.length?(n=o.indexOf(a[0]))>-1&&(o.suspendEvents(),o.splice(n,a.length),o.resumeEvents()):n=-1,!c){var b={action:"remove",parent:e,isChild:!0,isMove:l,records:t,allRecords:s,index:n};i.trigger("remove",b),i.trigger("change",b)}}},{key:"collectDescendants",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{inCollapsedBranch:!1,unfiltered:!1},i=this,o=r.inCollapsedBranch,a=r.unfiltered,s=Array.isArray(e)?e:i.getChildren(e,a);if(s)for(var l,c=0,u=s.length;c<u;c++)l=s[c],o||t.push(l),n.push(l),i.collectDescendants(l,t,n,{inCollapsedBranch:o||!l.isExpanded(i),unfiltered:a});return{visible:t,all:n}}},{key:"getChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(t||this.isChained)&&e.unfilteredChildren||e.children;return n&&n.length?this.isChained?n.filter(this.chainedFilterFn):n:oa}},{key:"internalToggleTreeSubRecords",value:function(e,t){var n=this,r=n.storage,i=r.indexOf(e),o=n.doIncludeExclude(n.getChildren(e),t);if(o.length&&!1!==i){if(r.suspendEvents(),t){r.splice.apply(r,[i+1,0].concat(Z()(o)));var a={action:"add",isExpand:!0,records:o,index:i+1};n.trigger("add",a),n.trigger("change",a)}else{r.splice(i+1,o.length);var s={action:"remove",isCollapse:!0,records:o,index:i+1};n.trigger("remove",s),n.trigger("change",s)}r.resumeEvents()}}},{key:"doIncludeExclude",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this,i=e&&e.length,o=0;o<i;o++){var a=e[o];if(!r.isChained||r.chainedFilterFn(a)){var s=a.instanceMeta(r.id);t?n.push(a):s.hidden||n.push(a),s.hidden=!t,a.isExpanded(r)&&r.doIncludeExclude(r.getChildren(a),t,n)}}return n}},{key:"toggleCollapse",value:(n=ta()(Zo.a.mark((function e(t,n){var r,i,o,a;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(r=this).getById(t),o=i.instanceMeta(r),void 0===n&&(n=!o.collapsed),o.isLoadingChildren||i.isLeaf||i.isExpanded(r)!==n){e.next=28;break}if(r.trigger("beforeToggleNode",{record:i,collapse:n}),o.collapsed=n,!o.collapsed){e.next=10;break}return r.onNodeCollapse(i),e.abrupt("return",!0);case 10:if(r.onNodeExpand(i),a=!0,i.isLoaded){e.next=27;break}return o.isLoadingChildren=!0,e.prev=14,e.next=17,r.loadChildren(i);case 17:e.next=24;break;case 19:e.prev=19,e.t0=e.catch(14),o.collapsed=!0,a=!1,r.trigger("loadChildrenException",{record:i,exception:e.t0});case 24:return e.prev=24,o.isLoadingChildren=!1,e.finish(24);case 27:return e.abrupt("return",a);case 28:case"end":return e.stop()}}),e,this,[[14,19,24,27]])}))),function(e,t){return n.apply(this,arguments)})},{key:"onNodeCollapse",value:function(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!1)}},{key:"onNodeExpand",value:function(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!0)}},{key:"isTree",get:function(){return this.tree||this.masterStore&&this.masterStore.tree}},{key:"leaves",get:function(){var e=[];return this.isTree?(this.traverse((function(t){t.isLeaf&&e.push(t)})),e):(this.allRecords.forEach((function(t){t.isLeaf&&e.push(t),t.traverse((function(t){t.isLeaf&&e.push(t)}),!0)})),e)}}]),o}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(la()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"add",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.stm;return this.tree||!i||i.disabled?t=se()(J()(r.prototype),"add",this).call(this,e,n):(t=se()(J()(r.prototype),"add",this).call(this,e,n))&&t.length&&i.onStoreModelAdd(this,t,n),t}},{key:"insert",value:function(e,t){var n,i=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.stm;if(this.tree||!a||a.disabled)n=se()(J()(r.prototype),"insert",this).call(this,e,t,o);else{var s=(Array.isArray(t)?t:[t]).reduce((function(e,t){var n=t instanceof Io?i.indexOf(t):void 0;return void 0!==n&&-1!==n&&e.set(t,n),e}),new Map);(n=se()(J()(r.prototype),"insert",this).call(this,e,t))&&n.length&&(e=this.indexOf(n[0]),a.onStoreModelInsert(this,e,n,s,o))}return n}},{key:"remove",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0,a=this.stm;if(this.tree||!a||a.disabled)t=se()(J()(r.prototype),"remove",this).call(this,e,i,o);else{var s=(Array.isArray(e)?e:[e]).map((function(e){return n.getById(e)})).filter((function(e){return!!e})),l=s.reduce((function(e,t){var r=n.indexOf(t);return void 0!==r&&-1!=r&&e.set(t,r),e}),new Map);(t=se()(J()(r.prototype),"remove",this).call(this,e,i,o))&&t.length&&a.onStoreModelRemove(this,t,l,i)}return t}},{key:"removeAll",value:function(e){var t=this.stm;if(t&&!t.disabled){var n=this.tree,i=this.rootNode,o=this.allRecords,a=o.length,s=n?i.children.slice():o.slice();se()(J()(r.prototype),"removeAll",this).call(this,e),a&&0===this.count&&t.onStoreRemoveAll(this,s,e)}else se()(J()(r.prototype),"removeAll",this).call(this,e)}},{key:"stm",get:function(){return this[ca]},set:function(e){var t=this;t.stm!=e&&(t.stm&&t.stm.hasStore(t)&&t.stm.removeStore(t),t[ca]=e,t.stm&&!t.stm.hasStore(t)&&t.stm.addStore(t))}}],[{key:"defaultConfig",get:function(){return{stm:null}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(sa()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"syncDataset",value:function(e){var t=this,n=t.storage,r=t.tree?t.syncTreeDataset(e):t.syncFlatDataset(e),i=r.toAdd,o=r.toRemove,a=r.updated,s=t.syncDataOnLoad.threshold,l=!1;if(s&&("string"==typeof s&&(s=parseInt(s,10)/100*t.count),l=i.length+o.length+a.length>s),t.tree){if(i.length)t.add(i,l).forEach((function(e){delete e.data.parentId,delete e.originalData.parentId,e.meta.modified&&delete e.meta.modified.parentId}));t.remove(o,l)}else l&&n.suspendEvents(),n.splice(t.count-o.length,o,i),l&&n.resumeEvents();s&&!l&&a.forEach((function(e){var n=e.record,r=e.toSet,i=e.wasSet;return t.onModelChange(n,r,i)})),t.acceptChanges();var c={added:i,removed:o,updated:a,thresholdSurpassed:l};l&&this.trigger("refresh",{action:"batch",data:e,records:n.values,syncInfo:c}),t.isFiltered&&t.filter(),t.isGrouped?t.group():t.isSorted&&t.sort(),t.trigger("loadSync",c)}},{key:"syncFlatDataset",value:function(e){if(e){var t=this,n=t.modelClass.idField,r=[],i=[],o=[],a={},s=t.syncDataOnLoad.threshold,l=0;return e.forEach((function(e){var r=e[n],c=t.getById(r);if(c){var u=c.set(e,null,Boolean(s));u&&o.push({record:c,wasSet:u,toSet:e}),l++}else i.push(t.createRecord(e));a[r]=1})),l<t.allCount&&t.forEach((function(e){a[e.id]||r.push(e)})),{toAdd:i,toRemove:r,updated:o}}}},{key:"syncTreeDataset",value:function(e){if(e){var t=this,n=t.modelClass,r=n.idField,i=n.parentIdField,o=[],a=[],s=[],l={},c=t.syncDataOnLoad.threshold;return aa.preWalkWithParent({isRoot:!0,children:e},(function(e){return e.children}),(function(e,n){if(e){var o=n[r],u=t.getById(o);if(u){var d=u.set(n,null,Boolean(c));d&&s.push({record:u,wasSet:d,toSet:n})}else n[i]=e[r],a.push(n);l[o]=1}})),t.traverse((function(e){l[e.id]||o.push(e)})),{toAdd:a,toRemove:o,updated:s}}}}],[{key:"defaultConfig",get:function(){return{syncDataOnLoad:null}}}]),r}(e||G)})));function va(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return pa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pa(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ya(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ga.storeMap={},ga._$name="Store";var ma=function(e,t){return Array.isArray(t[1])?t[1].forEach((function(n){return e.push(t[0]+"="+n)})):e.push(t[0]+"="+t[1]),e},ba=new Promise((function(e){return e()})),ka=function(e){$()(s,e);var t,n,r,i,o,a=(t=s,function(){var e,n=J()(t);if(ya()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function s(){return D()(this,s),a.apply(this,arguments)}return M()(s,[{key:"afterConstruct",value:function(e){se()(J()(s.prototype),"afterConstruct",this).call(this,e),this.autoLoad&&this.load().catch((function(){}))}},{key:"buildQueryString",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Object.entries(Object.assign.apply(Object,[{}].concat(t))).reduce(ma,[]).join("&");return r?"?"+r:""}},{key:"performSort",value:function(e){var t=this;if(t.sortParamName){var n=t.groupRecords,r={};return t.isGrouped&&n&&n.length&&n.forEach((function(e){e.meta.collapsed&&(t.includeGroupRecords(e),r[e.id]=!0)})),t.internalLoad({},"",(function(n){t.data=n.data,t.afterPerformSort(e,r)}))}se()(J()(s.prototype),"performSort",this).call(this,e)}},{key:"performFilter",value:function(e){var t=this;if(t.filterParamName){var n=t.count,r=t.filters;return t.currentPage=1,t.internalLoad({},"",(function(i){t.data=i.data,t.afterPerformFilter(e?null:{action:"filter",filters:r,oldCount:n,records:t.storage.values})}))}se()(J()(s.prototype),"performFilter",this).call(this)}},{key:"encodeFilterParams",value:function(e){var t,n=[],r=va(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.property,a=i.operator,s=i.value,l=i.caseSensitive;n.push({field:o,operator:a,value:s,caseSensitive:l})}}catch(e){r.e(e)}finally{r.f()}return JSON.stringify(n)}},{key:"encodeSorterParams",value:function(e){return JSON.stringify(e.map((function(e){return e})))}},{key:"internalLoad",value:function(e,t,n){var r=this,i=Object.assign({},r.params,e),o={action:"read"+t,params:i};return r.readUrl?new Promise((function(e,a){if(!1===r.trigger("beforeLoad"+t,o))return a(!1);if(r._isLoading=!0,r.trigger("load".concat(t,"Start"),o),r.trigger("beforeRequest",o),r.filterParamName&&r.isFiltered&&(i[r.filterParamName]=r.encodeFilterParams(r.filters.values)),r.sortParamName&&r.isSorted&&(i[r.sortParamName]=r.encodeSorterParams(r.groupers?r.groupers.concat(r.sorters):r.sorters)),r.isPaged){if(!i[r.pageParamName]&&!i[r.pageStartParamName]){var s=Math.min(r.currentPage||1,r.allCount?r.lastPage:1/0);r.pageParamName?i[r.pageParamName]=s:i[r.pageStartParamName]=(s-1)*r.pageSize}i[r.pageSizeParamName]=r.pageSize}var l={headers:r.headers,parseJson:!0};r.useRestfulMethods&&(l.method=r.httpMethods.read),Ae.get(r.readUrl+r.buildQueryString(i),Object.assign(l,r.fetchOptions)).then((function(s){var l=s.parsedJson,c=Array.isArray(l),u=c||l&&!1!==l.success;if(r._isLoading=!1,o.response=s,o.json=l,u){if(r.responseTotalProperty in l&&(r.remoteTotal=parseInt(l[r.responseTotalProperty],10)),r.isPaged){if(!(r.remoteTotal>=0))throw new Error("A paged store must receive its responseTotalProperty in each data packet");var d=r.pageParamName?i[r.pageParamName]:i[r.pageStartParamName]/r.pageSize+1;r.currentPage=Math.min(d,r.lastPage)}o.data=c?l:l[r.responseDataProperty],n(o),r.trigger("load"+t,o),e(o)}else o.exception=!0,o.exceptionType="server",r.trigger("exception",o),a(o);r.trigger("afterRequest",o)})).catch((function(e){r._isLoading=!1,o.exception=!0,e instanceof Response?(o.exceptionType=e.ok?"server":"network",o.response=e,o.error=e.error):(o.exceptionType="server",o.error=e),r.trigger("exception",o),a(o),r.trigger("afterRequest",o)}))})):null}},{key:"load",value:function(e){var t=this;return t.isPaged?t.loadPage((t.currentPage||0)+1,e):t.internalLoad(e,"",(function(e){t.data=e.data}))}},{key:"loadChildren",value:(o=ta()(Zo.a.mark((function e(t){var n;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.abrupt("return",n.internalLoad(oe()({},n.parentIdParamName,t.id),"Children",(function(e){e.parentRecord=t,t.data[t.constructor.childrenField]=e.data,t.processChildren(t.stores)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"loadPage",value:(i=ta()(Zo.a.mark((function e(t,n){var r,i;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.allCount&&(t=Math.min(t,this.lastPage)),(i=(r=this).pageParamName?oe()({},r.pageParamName,t):oe()({},r.pageStartParamName,(t-1)*r.pageSize))[r.pageSizeParamName]=r.pageSize,e.abrupt("return",r.internalLoad(Object.assign(i,n),"Page",(function(e){r.loadData(e.data,"pageLoad")})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"nextPage",value:(r=ta()(Zo.a.mark((function e(t){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isPaged&&this.currentPage!==this.lastPage?this.loadPage(this.currentPage+1,t):ba);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"previousPage",value:(n=ta()(Zo.a.mark((function e(t){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isPaged&&1!==this.currentPage?this.loadPage(this.currentPage-1,t):ba);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"commit",value:function(){var e=this,t=e.changes,n=[];if(e.commitPromise)return!1;if(!t)return ba;if([].concat(Z()(t.added),Z()(t.modified),Z()(t.removed)).forEach((function(e){return e.meta.committing=!0})),!e.disabled&&!1!==e.trigger("beforeCommit",{changes:t})){var r={action:"commit",exception:!1,changes:t},i=e.commitRemoved(r);return i&&n.push(i),(i=e.commitAdded(r))&&n.push(i),(i=e.commitModified(r))&&n.push(i),n.length?(i=1===n.length?n[0]:Promise.all(n),e.commitPromise=new Promise((function(n,o){i.then((function(){e.commitPromise=null,r.exception?(e.trigger("exception",r),o(r)):(e.trigger("commit",{changes:t}),n(r))})).catch((function(){e.commitPromise=null,o(r)}))}))):(e.modified.forEach((function(e){return e.clearChanges(!1)})),e.modified.clear(),e.added.forEach((function(e){return e.clearChanges(!1)})),e.added.clear(),e.removed.clear(),e.trigger("commit",{changes:t}),ba)}}},{key:"doAutoCommit",value:function(){this.commit().catch((function(e){var t=e.response;if(!t||!(t.ok&&t.parsedJson||[500,404].includes(t.status)))throw e}))}},{key:"commitAdded",value:function(e){var t=this,n=t.added,r={action:"create",params:t.params};return n.count&&t.createUrl?new Promise((function(i){var o=n.values.map((function(e){return e.persistableData}));e.create=r;var a=r.body={data:o};if(t.trigger("beforeRequest",r),t.sendAsFormData){var s=new FormData;s.append("data",JSON.stringify(o)),a=s}var l={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(l.method=t.httpMethods.create),Ae.post(t.createUrl+t.buildQueryString(t.params),a,Object.assign(l,t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a),l=s||a&&!1!==a.success;e.response=o,r.json=a,r.response=o,l?(t.processReturnedData(n.values,s?a:a[t.responseDataProperty]),n.clear(),t.trigger("commitAdded"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,e.exceptionType=r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"commitModified",value:function(e){var t=this,n=t.modified,r={action:"update",params:t.params};return n.count&&t.updateUrl?new Promise((function(i){var o=n.map((function(e){return t.writeAllFields?e.persistableData:e.modificationData}));e.update=r;var a=r.body={data:o};if(t.trigger("beforeRequest",r),t.sendAsFormData){var s=new FormData;s.append("data",JSON.stringify(o)),a=s}var l={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(l.method=t.httpMethods.update),Ae.post(t.updateUrl+t.buildQueryString(t.params),a,Object.assign(l,t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a),l=s||a&&!1!==a.success;e.response=o,r.json=a,r.response=o,l?(t.processReturnedData(t.modified.values,s?a:a[t.responseDataProperty],!0),n.clear(),t.trigger("commitModified"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"processReturnedData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.modelClass,o=i.fieldMap.id.dataSource;t.forEach((function(t,r){var a=e[r];a.clearChanges(!1),a.syncId(t[o]),Object.assign(e[r].data,i.processData(t,n))}))}},{key:"commitRemoved",value:function(e){var t=this,n=t.removed,r={action:"delete",params:t.params};return n.count&&t.deleteUrl?new Promise((function(i){e.delete=r;var o=r.body={ids:n.map((function(e){return e.id}))};if(t.trigger("beforeRequest",r),t.sendAsFormData){var a=new FormData;a.append("id",JSON.stringify(o.ids)),o=a}var s={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(s.method=t.httpMethods.delete),Ae.post(t.deleteUrl+t.buildQueryString(t.params),o,Object.assign(s,t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a)||a&&!1!==a.success;e.response=o,r.json=a,r.response=o,s?(n.forEach((function(e){return e.meta.committing=!1})),n.clear(),t.trigger("commitRemoved"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"isLoading",get:function(){return this._isLoading}},{key:"isCommitting",get:function(){return Boolean(this.commitPromise)}},{key:"pageParamName",set:function(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=e},get:function(){return this._pageParamName}},{key:"pageStartParamName",set:function(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=e},get:function(){return this._pageStartParamName}},{key:"isPaged",get:function(){return this.pageParamName||this.pageStartParamName}},{key:"allCount",get:function(){return"remoteTotal"in this?this.remoteTotal:se()(J()(s.prototype),"allCount",this)}},{key:"lastPage",get:function(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}}],[{key:"defaultConfig",get:function(){return{headers:null,fetchOptions:null,sendAsFormData:!1,writeAllFields:null,parentIdParamName:"id",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",pageSize:50,useRestfulMethods:!1,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}}]),s}(ga);function wa(){var e=Ti()(['<input type="','"\n            reference="input"\n            class="','"\n            name="','"\n            id="','"\n            ',"\n            ","/>"]);return wa=function(){return e},e}function Sa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ka._$name="AjaxStore";var Ca=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Sa()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"inputTemplate",value:function(){var e=this,t="inputWidth"in e?'style="width:'.concat(on.setLength(e.inputWidth),'"'):"";return Ii.tpl(wa(),e.inputType||"text",e.inputCls||"",e.name||e.id,e.id+"_input",t,e.attributeString)}},{key:"construct",value:function(e){"hidden"===e.inputType&&(e.hidden=!0),se()(J()(r.prototype),"construct",this).apply(this,arguments)}},{key:"value",set:function(e){ei()(J()(r.prototype),"value","TextField"===this.$name&&null==e?"":e,this,!0)},get:function(){return se()(J()(r.prototype),"value",this)}},{key:"placeholder",set:function(e){this._placeholder=e,this.input&&(this.input.placeholder=e)},get:function(){return this._placeholder}}],[{key:"defaultConfig",get:function(){return{attributes:["placeholder","autoComplete","minLength","maxLength","pattern","tabIndex"],localizableProperties:["label","title","placeholder"]}}},{key:"$name",get:function(){return"TextField"}}]),r}(so);function Ra(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ca._$name="TextField",ye.register("textfield",Ca),ye.register("text",Ca);var xa=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ra()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"doDestroy",value:function(){this.globalTapListener&&this.globalTapListener(),this.picker=null,se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"finalizeInit",value:function(){se()(J()(r.prototype),"finalizeInit",this).call(this);var e=this,t=e.element;!1===e.editable?(t.classList.add("b-not-editable"),Kn.on({element:e.input,click:"onTriggerClick",thisObj:e})):e.globalTapListener=Gr.on({globaltap:"showKeyboard",thisObj:e})}},{key:"createPicker",value:function(){throw new Error("createPicker must be implemented in PickerField subclass implementations")}},{key:"onEditComplete",value:function(){se()(J()(r.prototype),"onEditComplete",this).call(this),this.autoClosePicker()}},{key:"onElementResize",value:function(e){this.pickerVisible&&this.picker.requestAnimationFrame(this.picker.realign,null,this.picker),se()(J()(r.prototype),"onElementResize",this).call(this,e)}},{key:"internalOnKeyPress",value:function(e){var t=this,n=!0;if("keydown"===e.type&&!t.disabled)if(t.pickerVisible){var i=t.picker;"Escape"===e.key?(e.stopImmediatePropagation(),t.hidePicker(),n=!1):i.onInternalKeyDown?i.onInternalKeyDown(e):"ArrowDown"===e.key&&i.focusable&&i.focus()}else"ArrowDown"===e.key&&(e.stopImmediatePropagation(),t.onTriggerClick(e));n&&se()(J()(r.prototype),"internalOnKeyPress",this).call(this,e)}},{key:"onFocusIn",value:function(e){se()(J()(r.prototype),"onFocusIn",this).call(this,e),this.autoExpand&&(this.minChars=0,this.onTriggerClick(e))}},{key:"onFocusOut",value:function(e){this.autoClosePicker(),se()(J()(r.prototype),"onFocusOut",this).call(this,e)}},{key:"onTriggerClick",value:function(e){this.disabled||this.togglePicker("key"in e)}},{key:"showKeyboard",value:function(e){var t=e.event,n=this.input;on.isTouchEvent&&document.activeElement===n&&t.target===n&&(Gr.suspendFocusEvents(),n.blur(),n.focus(),Gr.resumeFocusEvents())}},{key:"togglePicker",value:function(e){this.pickerVisible?this.hidePicker():this.showPicker(e)}},{key:"showPicker",value:function(e){var t=this,n=t.picker;t.pickerHideShowListenersAdded||(n.on({show:"onPickerShow",hide:"onPickerHide",thisObj:t}),t.pickerHideShowListenersAdded=!0),n.autoClose=t.autoClose,n.show(),n.isVisible&&e&&t.focusPicker()}},{key:"onPickerShow",value:function(){var e=this;e.pickerVisible=!0,e.element.classList.add("b-open"),e.trigger("togglePicker",{show:!0}),e.pickerTapOutRemover=Gr.on({globaltap:"onPickerTapOut",thisObj:e}),e.pickerKeyDownRemover=Kn.on({element:e.picker.element,keydown:"onPickerKeyDown",thisObj:e})}},{key:"onPickerHide",value:function(){var e=this;e.pickerVisible=!1,e.element.classList.remove("b-open"),e.trigger("togglePicker",{show:!1}),e.pickerTapOutRemover&&e.pickerTapOutRemover(),e.pickerKeyDownRemover&&e.pickerKeyDownRemover()}},{key:"onPickerTapOut",value:function(e){var t=e.event;this.owns(t.target)||this.autoClosePicker()}},{key:"onPickerKeyDown",value:function(e){if("Tab"===e.key){var t=document.activeElement,n=new KeyboardEvent("keydown",e);this.input.dispatchEvent(n),n.defaultPrevented&&e.preventDefault(),document.activeElement===t?this.input.focus():e.preventDefault(),this.isDestroyed||this.hidePicker()}}},{key:"autoClosePicker",value:function(){this.autoClose&&this.hidePicker()}},{key:"hidePicker",value:function(){this.pickerVisible&&this.picker.hide()}},{key:"focusPicker",value:function(){}},{key:"focus",value:function(){var e=this.input;on.isTouchEvent&&this.editable&&(e.readOnly=!0,this.setTimeout((function(){return e.readOnly=!1}),500)),se()(J()(r.prototype),"focus",this).call(this)}},{key:"picker",get:function(){var e=this._picker;return e instanceof Nr||(this.picker=e=this.createPicker(e||{})),e},set:function(e){var t=this._picker;t&&t.destroy&&(t.hide(),t.destroy()),this._picker=e}}],[{key:"$name",get:function(){return"PickerField"}},{key:"defaultConfig",get:function(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:null,inputType:"text",monitorResize:!0}}}]),r}(Ca);function Ea(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}xa._$name="PickerField";var Da=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ea()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onKeyDown",value:function(e){var t=this,n=t.ownerCmp,r=t.activeItem,i=t.target.querySelector(t.itemSelector),o=(e.key||"").trim()||e.code,a="".concat(e.ctrlKey?"CTRL+":"").concat(e.shiftKey?"SHIFT+":"").concat(e.altKey?"ALT+":"").concat(o);if(i&&t.target.offsetParent){if(null==t.inlineFlow){var s=i.parentNode,l=on.getStyleValue(i,"position"),c=on.getStyleValue(i,"display"),u=on.getStyleValue(i,"float");t.inlineFlow="absolute"===l||"inline"===c||"inline-block"===c||"left"===u||"right"===u||"flex"===on.getStyleValue(s,"display")&&"row"===on.getStyleValue(s,"flex-direction"),t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown")}if(t.processEvent&&!(e=t.processEvent.call(n,e)))return;if(r)switch(o){case t.prevKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),t.navigatePrevious(e);break;case t.nextKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),t.navigateNext(e);break;default:var d=t.keys&&t.keys[a];d&&!t.disabled?t.callback(d,t.thisObj||n,[e]):n.onInternalKeyDown&&n.onInternalKeyDown(e)}else t.activeItem=t.previousActiveItem||t.getDefaultNavigationItem(e);t.activeItem!==r&&t.trigger("navigate",{event:e,item:t.activeItem})}}},{key:"getDefaultNavigationItem",value:function(e){var t=this.target,n=this.itemSelector,r=this.prevKey,i=this.nextKey;return 4&t.compareDocumentPosition(e.target)&&e.key===r?t.querySelector("".concat(n,":last-of-type")):2&t.compareDocumentPosition(e.target)&&e.key===i?t.querySelector("".concat(n)):void 0}},{key:"navigatePrevious",value:function(e){var t=this,n=t.previous;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((function(){t.activeItem=n,t.trigger("navigate",{event:e,item:t.activeItem})}))}},{key:"navigateNext",value:function(e){var t=this,n=t.next;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((function(){t.activeItem=n,t.trigger("navigate",{event:e,item:t.activeItem})}))}},{key:"onTargetFocusIn",value:function(e){e.target.matches(this.itemSelector)&&(this.skipScrollIntoView=!0,this.activeItem=e.target,this.skipScrollIntoView=!1)}},{key:"onTargetFocusOut",value:function(e){e.relatedTarget&&this.target.contains(e.relatedTarget)||(this.activeItem=null)}},{key:"onTargetMouseDown",value:function(e){if(!1===this.ownerCmp.itemsFocusable)this.onFocusGesture(e);else{var t=e.target.closest(this.itemSelector);t&&(e.preventDefault(),on.focusWithoutScrolling(t))}}},{key:"onTargetClick",value:function(e){var t=this;t.disabled||(t.skipScrollIntoView=!0,t.processEvent&&(e=t.processEvent.call(t.ownerCmp,e)),e&&(t.activeItem=e.target.closest(t.itemSelector),t.trigger("navigate",{event:e,item:t.activeItem})),t.skipScrollIntoView=!1)}},{key:"onFocusGesture",value:function(e){(e.target===this.ownerCmp.contentElement||e.target.closest(this.itemSelector)&&!1===this.ownerCmp.itemsFocusable)&&e.preventDefault()}},{key:"acceptNode",value:function(e){return e.offsetParent&&e.matches&&e.matches(this.itemSelector)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},{key:"onTargetChildListChange",value:function(){var e=this.activeItem;e&&!this.target.contains(e)&&(this.activeItem=this.target.querySelector("".concat(this.itemSelector,'[data-id="').concat(e.dataset.id,'"]')))}},{key:"itemSelector",set:function(e){this._itemSelector=e},get:function(){return this._itemSelector||".".concat(this.ownerCmp.itemCls)}},{key:"owner",get:function(){return this.ownerCmp}},{key:"previous",get:function(){var e=this.treeWalker;if(e.currentNode=this.activeItem,e.previousNode(),e.currentNode!==this.activeItem)return e.currentNode}},{key:"next",get:function(){var e=this.treeWalker;if(e.currentNode=this.activeItem,e.nextNode(),e.currentNode!==this.activeItem)return e.currentNode}},{key:"activeItem",get:function(){return this._activeItem},set:function(e){var t=this,n=t.ownerCmp,r=t.activeItem,i=r&&t.target.contains(r);if(i&&(t.previousActiveItem=r),null!=e){if(n.getItem&&(e=t.ownerCmp.getItem(e)),!e)return;if(t.skipScrollIntoView||n.scrollable.scrollIntoView(e,{block:"nearest",focus:on.isFocusable(e)&&e!==document.activeElement,silent:t.scrollSilently}),e===r&&i)return;r&&t.activeItem.classList.remove(t.focusCls),e.classList.add(t.focusCls),t._activeItem=e}else r&&(r.classList.remove(t.focusCls),r===document.activeElement&&t.ownerCmp.revertFocus()),t._activeItem=null}},{key:"target",get:function(){return this._target},set:function(e){var t=this,n={element:e,thisObj:t,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut",mousedown:"onTargetMouseDown",click:"onTargetClick"};t._target=e,t.hasOwnProperty("acceptNode")||(t.acceptNode=t.acceptNode.bind(t),t.acceptNode.acceptNode=t.acceptNode),Kn.on(n),t.treeWalker=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,t.acceptNode,!1),t.keyEventTarget||(t.keyEventTarget=e),(t.targetMutationMonitor=new MutationObserver(t.onTargetChildListChange.bind(t))).observe(e,{childList:!0})}},{key:"keyEventTarget",get:function(){return this._keyEventTarget},set:function(e){this._keyEventTarget=e,Kn.on({element:e,keydown:"onKeyDown",thisObj:this})}}],[{key:"defaultConfig",get:function(){return{ownerCmp:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,testConfig:{scrollDuration:1}}}}]),r}(pe(G));function Ta(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Ma(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ma(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Ma(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Aa(){var e=Ti()(["","",""]);return Aa=function(){return e},e}function Ia(){var e=Ti()(['<div class="','" data-index="','" data-id="','" ',">\n            ","\n            </div>"]);return Ia=function(){return e},e}function Fa(){var e=Ti()(["",""]);return Fa=function(){return e},e}function Oa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Da._$name="Navigator";var _a=document.createRange(),Pa=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Oa()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t,n=this;Array.isArray(e)&&(e={items:e});for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(t=se()(J()(r.prototype),"construct",this)).call.apply(t,[this,e].concat(o));var s=n.element,l=s.classList;n.multiSelect&&l.add("b-multiselect"),n.store.count?n.refresh():l.add("b-empty"),Kn.on({element:s,delegate:n.itemSelector,mouseover:"onMouseOver",click:"onClick",thisObj:n})}},{key:"doDestroy",value:function(){this.detachListeners("store"),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"contentTpl",value:function(){var e=this;return Ii.tpl(Fa(),this.store.records.map((function(t,n){return e.itemWrapperTpl(t,n)})))}},{key:"itemWrapperTpl",value:function(e,t){return Ii.tpl(Ia(),this.getItemClasses(e,t),t,e.id,this.itemsFocusable?'tabindex="-1"':"",this.itemContentTpl(e,t))}},{key:"itemContentTpl",value:function(e,t){return Ii.tpl(Aa(),this.multiSelect?'<div class="b-selected-icon b-icon b-icon-check"></div>':"",this.itemTpl(e,t))}},{key:"getItemClasses",value:function(e){var t=this,n=t._navigator&&t._navigator.activeItem,r=n&&n.dataset.id==e.id,i=t.selected.includes(e);return"".concat(t.itemCls," ").concat(e.cls||""," ").concat(i?t.selectedCls:""," ").concat(r?t.navigator.focusCls:"")}},{key:"onBeforeStoreLoad",value:function(){this.mask(this.L("loading"))}},{key:"onAfterStoreRequest",value:function(){this.unmask()}},{key:"onStoreChange",value:function(e){e.source;var t=e.action,n=e.records,r=e.record;switch(t){case"remove":this.selected.remove(n);break;case"clear":this.selected.clear();break;case"update":return void this.refreshItem(r)}this.refresh()}},{key:"onStoreRefresh",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;if(e.isVisible){var t=e.navigator.activeItem;e.paintListener=null,e.clearItems().insertNode(on.createElementFromTemplate(e.contentTpl(),{fragment:!0})),t&&e.restoreActiveItem(t),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty")}else e.paintListener||(e.paintListener=e.on({paint:"refresh",thisObj:e,once:!0}))}},{key:"clearItems",value:function(){var e=this,t=e.contentElement.querySelector(e.itemSelector),n=e.contentElement.lastChild;if(t){var r=e.contentElement.querySelectorAll("".concat(e.itemSelector,":not(.b-mask)"));_a.setStartBefore(t),_a.setEndAfter(r[r.length-1]),_a.deleteContents()}else n?(_a.setStartAfter(n),_a.setEndAfter(n)):(_a.setStart(e.contentElement,0),_a.setEnd(e.contentElement,0));return _a}},{key:"refreshItem",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r],a=this.getItem(o);if(a){var s=this.store.indexOf(o),l=on.createElementFromTemplate(this.itemWrapperTpl(o,s));on.sync(l,a)}}}},{key:"getItem",value:function(e){if(null!=e)return"number"==typeof e?this.contentElement.querySelector('[data-index="'.concat(e,'"]')):(1===e.nodeType&&(e=e.dataset.id),null!=e.id&&(e=e.id),this.contentElement.querySelector('[data-id="'.concat(e,'"]')))}},{key:"getRecord",value:function(e){return e.target&&(e=e.target),e=e.closest(this.itemSelector),this.store.getAt(parseInt(e.dataset.index))}},{key:"alignTo",value:function(){var e;ei()(J()(r.prototype),"minHeight",this.minAlignHeight,this,!0);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=se()(J()(r.prototype),"alignTo",this)).call.apply(e,[this].concat(n))}},{key:"hide",value:function(){var e;this.navigator.activeItem=null;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=se()(J()(r.prototype),"hide",this)).call.apply(e,[this].concat(n))}},{key:"show",value:function(){var e=this.refreshCount,t=this.navigator.previousActiveItem;ei()(J()(r.prototype),"minHeight",this._minHeight,this,!0),se()(J()(r.prototype),"show",this).call(this),this.refreshCount===e&&this.restoreActiveItem(t,!0)}},{key:"restoreActiveItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.navigator.previousActiveItem,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"nearest",n=this,r=n.navigator,i=n.lastAlignSpec;if(null!=e){if("string"!=typeof t){var o=i?i.zone:1;t=1&o?"nearest":o?"start":"end"}(e=n.getItem(e))&&(n.scrollable.scrollIntoView(e,{block:t}),r.activeItem=e)}}},{key:"onMouseOver",value:function(e){var t=e.currentTarget;!on.isTouchEvent&&t&&this.navigator&&this.activateOnMouseover&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[t],cancelOutstanding:!0})}},{key:"handleMouseOver",value:function(e){this.navigator.activeItem=e}},{key:"onClick",value:function(e){var t=e.target.closest(this.itemSelector);t&&this.onItemClick(t,e)}},{key:"onInternalKeyDown",value:function(e){var t=this.navigator.activeItem;switch(e.key){case" ":if(!e.target.readOnly)break;case"Enter":t&&(this.onItemClick(t,e),e.stopImmediatePropagation(),e.preventDefault())}}},{key:"onItemClick",value:function(e,t){var n=this,r=parseInt(e.dataset.index),i=n.store.getAt(r),o=n.selected,a=o.includes(i);n.trigger("item",{item:e,record:i,index:r,event:t}),e.contains(t.target.closest("[data-noselect]"))||(n.multiSelect?o[a?"remove":"add"](i):o.splice(0,o.count,i)),n.lastClicked=i}},{key:"onSelectionChange",value:function(e){var t,n,r=e.action,i=e.removed,o=e.added,a=(e.replaced,this.selectedCls);if("clear"===r){var s,l=Ta(this.element.querySelectorAll(".".concat(a)));try{for(l.s();!(s=l.n()).done;)(n=s.value).classList.remove(a)}catch(e){l.e(e)}finally{l.f()}}else{var c,u=Ta(i);try{for(u.s();!(c=u.n()).done;)t=c.value,(n=this.getItem(t))&&n.classList.remove(a)}catch(e){u.e(e)}finally{u.f()}var d,f=Ta(o);try{for(f.s();!(d=f.n()).done;)t=d.value,(n=this.getItem(t))&&n.classList.add(a)}catch(e){f.e(e)}finally{f.f()}}}},{key:"items",set:function(e){this.store&&this.store.autoCreated&&this.store.destroy(),this.store=ga.getStore(e)}},{key:"selected",set:function(e){e&&e instanceof Sr||(e=new Sr(e)),this._selected=e,e.on({change:"onSelectionChange",thisObj:this})},get:function(){return this._selected}},{key:"itemSelector",get:function(){return".".concat(this.itemCls)}},{key:"store",get:function(){return this._thisIsAUsedExpression(this.items),this._store},set:function(e){var t=this;if(e instanceof ga||(e=new ga(e)),t._store=e,t.detachListeners("store"),e){var n={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:t};e.readUrl&&(n.beforeLoad="onBeforeStoreLoad",n.afterRequest="onAfterStoreRequest"),t.store.on(n)}t.refresh()}},{key:"navigator",get:function(){return this._navigator},set:function(e){var t=this.element;this._navigator=t?new(e.class||Da)(Object.assign({ownerCmp:this,target:t,keyEventTarget:t},e)):e}},{key:"minHeight",get:function(){return se()(J()(r.prototype),"minHeight",this)},set:function(e){ei()(J()(r.prototype),"minHeight",this._minHeight=e,this,!0)}},{key:"minAlignHeight",get:function(){var e=this.element.lastElementChild,t=this.minHeight;if(null!=t)return this.store.count?Math.min(e.offsetTop+e.offsetHeight,t):0}}],[{key:"$name",get:function(){return"List"}},{key:"defaultConfig",get:function(){return{itemCls:"b-list-item",selectedCls:"b-selected",items:null,store:null,navigator:!0,scrollable:{x:!1,y:!0},itemsFocusable:!0,multiSelect:!1,itemTpl:function(e){return e.text},selected:{},activateOnMouseover:null}}}]),r}(Nr);function La(){var e=Ti()(["","\n            ","\n            ",""]);return La=function(){return e},e}function Ha(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Pa.prototype.navigatorClass=Da,Pa._$name="List",ye.register("list",Pa);var ja=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ha()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"itemContentTpl",value:function(e,t){return Ii.tpl(La(),this.iconTpl?this.iconTpl(e):"",this.itemTpl(e,t),this.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':"")}},{key:"onInternalKeyDown",value:function(e){"Delete"===e.key||"Backspace"===e.key&&this.selected.count?this.callback(this.closeHandler,this.owner,[this.selected.values,{isKeyEvent:!0}]):se()(J()(r.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"onClick",value:function(e){var t=this,n=e.target.closest(".".concat(t.itemCls));if(t.closable&&e.target.classList.contains("b-close-icon")){var i=t.store.getAt(parseInt(n.dataset.index));t.callback(t.closeHandler,t.owner,[[i]])}else se()(J()(r.prototype),"onClick",this).call(this,e)}}],[{key:"$name",get:function(){return"ChipView"}},{key:"defaultConfig",get:function(){return{itemCls:"b-chip",closable:!0,iconTpl:null,closeHandler:null}}}]),r}(Pa);function Ba(e){return function(){var t,n=J()(e);if(Na()){var r=J()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return X()(this,t)}}function Na(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ja._$name="ChipView",ye.register("chipview",ja);var za=Symbol("Combo.queryAll"),Va=Symbol("Combo.queryLast"),Wa=function(e){$()(n,e);var t=Ba(n);function n(){return D()(this,n),t.apply(this,arguments)}return M()(n,[{key:"afterConfigure",value:function(){se()(J()(n.prototype),"afterConfigure",this).call(this),"_value"in this||(this._value=this.valueField===this.displayField?"":null)}},{key:"encodeFilterParams",value:function(e){return e.map((function(e){return e.value}))}},{key:"eachWidget",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,r=[this.chipView,this._picker];n<r.length;n++){var i=r[n];if(i){if(!1===e(i))return;t&&i.eachWidget&&i.eachWidget(e,t)}}}},{key:"onChipViewMousedown",value:function(e){e.preventDefault(),this.containsFocus||this.focus()}},{key:"onChipClose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(t.isKeyEvent&&""===this.input.value||!t.isKeyEvent)&&this.valueCollection.remove(e)}},{key:"syncInputFieldValue",value:function(e){this.multiSelect||se()(J()(n.prototype),"syncInputFieldValue",this).call(this,e)}},{key:"onEditComplete",value:function(){var e=this,t=e.valueCollection.count;se()(J()(n.prototype),"onEditComplete",this).call(this),t&&(e.clearError("validateFilter"),e.syncInputFieldValue()),e.required&&!t&&e.setError("fieldRequired")}},{key:"onTriggerClick",value:function(){var e=this;if(e.pickerVisible)e.hidePicker();else if(!e.readOnly&&!e.disabled)switch(e.triggerAction){case za:e.doFilter(null);break;case Va:e.doFilter(e.lastQuery);break;default:e.doFilter(e.input.value)}}},{key:"internalOnInput",value:function(e){var t=this,n=t.input.value,r=n.length;t.editable&&(t.updateEmpty(),t.syncInputWidth(),r>=t.minChars?t.filterList(n):(t.validateFilter&&!t.filterParamName&&t[r?"setError":"clearError"]("validateFilter"),t.hidePicker()),t.trigger("input",{value:n,event:e}))}},{key:"syncInputWidth",value:function(){var e=this;if(e.multiSelect){var t=e.input,n=e._inputPadding||(e._inputPadding=on.getEdgeSize(t,"padding","lr")),r=t.value||"",i=on.measureText(r+"W",t,!1,e.element)+n.width;t.style.flex="1 1 ".concat(Math.ceil(i),"px")}}},{key:"filterList",value:function(e){this.doFilter(e)}},{key:"doFilter",value:function(e){var t=this,n=t.store,r=t.filterParamName,i=null==e||""==e;t.lastQuery=e,t.primaryFilter.setConfig({value:e,disabled:i}),r&&n.clear(!0),n.filter(),t.showPicker(),n.count?i||(t.picker.navigator.activeItem=0):r||i||!t.validateFilter||t.setError("validateFilter")}},{key:"onRemoteFilter",value:function(){var e=this,t=e._picker;e.store.count?t&&(t.navigator.activeItem=0):e.validateFilter&&e.setError("validateFilter"),e.filterSelected&&e.valueCollection.count&&(e.store.storage.onFiltersChanged(),t&&t.refresh())}},{key:"onValueCollectionChange",value:function(e){var t=e.source,n=this,r=n.multiSelect,i="hidePickerOnSelect"in n?n.hidePickerOnSelect:!r,o=r?t.values.slice():t.first,a=t.values.slice(),s=n._isUserAction||i&&n.pickerVisible||!1,l=n._value;i&&n.hidePicker(),!t.count&&n.required?n.setError("fieldRequired"):(n.clearError("fieldRequired"),n.clearError("validateFilter")),n.validateFilter&&o&&n.clearError("validateFilter"),n.filterSelected&&(n.filterParamName?(n.store.storage.onFiltersChanged(),n._picker&&n._picker.refresh()):n.store.filter()),n._value=null;var c=n._value=n.value;n.syncInputFieldValue(),n.updateEmpty(),n.isConfiguring||(n.trigger("change",{value:c,oldValue:l,userAction:s,valid:n.isValid}),n.trigger("select",{record:o,records:a,userAction:n.containsFocus}),"select"===n.defaultAction&&n.trigger("action",{value:c,record:o,records:a}))}},{key:"onValueCollectionNoChange",value:function(e){var t=e.toAdd;!this.multiSelect&&t.length&&this.pickerVisible&&this.picker.hide()}},{key:"showPicker",value:function(){var e=this,t=e.picker;se()(J()(n.prototype),"showPicker",this).call(this),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),!e.multiSelect&&e.selected&&t.restoreActiveItem(e.selected,!0),e.input.focus()}},{key:"createPicker",value:function(e){var t=this,n=t.multiSelect,r=t.pickerWidth||e.width,i=Ce.createWidget(mt.merge({type:"list",owner:t,floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,store:t.store,selected:t.valueCollection,multiSelect:n,cls:t.listCls,itemTpl:t.listItemTpl||function(e){return e[t.displayField]},forElement:t[t.pickerAlignElement],align:{align:"t-b",axisLock:!0,matchSize:null==r,anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},width:r,navigator:{keyEventTarget:t.input},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},e));return i.element.dataset.emptyText=t.emptyText||t.L("No results"),i}},{key:"onPickerHide",value:function(){se()(J()(n.prototype),"onPickerHide",this).call(this),this.multiSelect&&this.clearTextOnPickerHide&&(this.input.value="")}},{key:"element",set:function(e){var t=this;ei()(J()(n.prototype),"element",e,this,!0),t.multiSelect&&(t.element.classList.add("b-multiselect"),t.chipView=new Ua(mt.assign({parent:t,insertBefore:t.input,store:t.chipStore=new ga({storage:t.valueCollection}),navigator:{class:Ga,keyEventTarget:t.input}},t.chipView)),t.chipView.element.appendChild(t.input),Kn.on({element:t.chipView.element,mousedown:"onChipViewMousedown",thisObj:t}))},get:function(){return se()(J()(n.prototype),"element",this)}},{key:"filterParamName",set:function(e){this._filterParamName=e,!1!==this.hideTrigger&&(this.hideTrigger=Boolean(e))},get:function(){return this._filterParamName}},{key:"hideTrigger",set:function(e){this._hideTrigger=e,this.element.classList[e?"add":"remove"]("b-hide-trigger")},get:function(){return this._hideTrigger}},{key:"keyStrokeFilterDelay",set:function(e){e&&(this.filterList=this.buffer(this.doFilter,e)),this._keyStrokeFilterDelay=e},get:function(){return this._keyStrokeFilterDelay}},{key:"minChars",set:function(e){this._minChars=e},get:function(){return"_minChars"in this?this._minChars:this.filterParamName?4:1}},{key:"items",set:function(e){var t=this;if(null==e){if(t.store&&!t.store.isItemStore)return;e=[]}if(e instanceof ga)return t.store=e;var n,r,i=t.displayField,o=t.valueField;if(Array.isArray(e)?r=e.map((function(e){var r,a,s=e;e instanceof Io?(n=e.constructor,o||(t.valueField=o=n.idField)):"string"==typeof e||"number"==typeof e?(o||(t.valueField=o=t.displayField),r={},oe()(r,o,e),oe()(r,i,e),s=r):(o||(t.valueField=o="value"),Array.isArray(e)&&(a={},oe()(a,o,e[0]),oe()(a,i,e[1]),s=a));return s.selected&&(t.value=s),s})):(o||(t.valueField=o="value"),r=[],Object.entries(e).forEach((function(e){var t,n=te()(e,2),a=n[0],s=n[1];r.push((t={},oe()(t,o,a),oe()(t,i,s),t))}))),t.store)t.store.data=r;else{var a=o===i?{name:"value",dataSource:i}:o;t.store=new ga({isItemStore:!0,data:r,idField:o,modelClass:n||function(e){$()(r,e);var n=Ba(r);function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"idField",get:function(){return t.valueField},set:function(e){ei()(J()(r),"idField",e,this,!0)}},{key:"fields",get:function(){return[a,i]}}]),r}(Io)})}},get:function(){return this.store.allRecords}},{key:"value",set:function(e){var t=this;if(e!==t.value){if(!t.multiSelect&&Array.isArray(e)&&e.length>1)throw new Error("Multiple values cannot be set to a non-multiselect Combo");t._thisIsAUsedExpression(t.items);var n,r=t.valueField,i=t.displayField,o=t.store,a=t.valueCollection;if(t.filterParamName){if(null!=e){var s=t.isConfiguring;return t.primaryFilter.setConfig({value:e,disabled:!1}),o.performFilter(!0).then((function(){var e=t.isConfiguring;t.isConfiguring=s,a.splice(0,a.count,o.allRecords),t.isConfiguring=e}))}}else o.filtered&&(t.primaryFilter.disabled=!0,o.filter());if(null!=e){for(var l=Array.isArray(e)?e.slice():[e],c=0,u=l.length;c<u;c++){var d=l[c];if(d instanceof Io)o.storage.includes(d)||o.add(d);else{var f=d instanceof Object;f&&(d=d[r]),(n=o.storage.getBy(i,d)||o.storage.getBy(r,d))?(f&&n.set(l[c]),l[c]=n):(l.splice(c,1),u--,c--)}}var h=a.generation;a.splice(0,a.count,l),a.generation===h&&t.syncInputFieldValue(),l.length||(t._value=e)}else if(a.count)a.clear();else{var g=t._value;t._value=null,t.syncInputFieldValue(),t.updateEmpty(),t.isConfiguring||t.trigger("change",{value:e,oldValue:g,userAction:t._isUserAction,valid:t.isValid})}}else t.syncInputFieldValue(!0)},get:function(){var e=this;return e.multiSelect?e.valueCollection.map((function(t){return t[e.valueField]})):e.valueCollection.count?e.valueCollection.first[e.valueField]:e._value}},{key:"isEmpty",get:function(){return 0===this.valueCollection.count}},{key:"isValid",get:function(){var e=this;return e.isConfiguring||!e.required||e.valueCollection.count?e.clearError("fieldRequired",!0):e.setError("fieldRequired",!0),se()(J()(n.prototype),"isValid",this)}},{key:"inputValue",get:function(){var e=this,t=e.value;return t=e.selected?e.selected[e.displayField]:t,e.displayValueRenderer&&(t=e.displayValueRenderer(e.selected)),null==t?"":t}},{key:"displayValueRenderer",set:function(e){this._displayValueRenderer=e},get:function(){return this._displayValueRenderer}},{key:"valueCollection",get:function(){return this._valueCollection||(this._valueCollection=new Sr({listeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),this._valueCollection}},{key:"store",set:function(e){var t=this,n=t.filterParamName,r=[],i={thisObj:this};if(Array.isArray(e))return t.initialConfig.store=null,t.items=e;if(!e||e instanceof ga||(e=new(e.readUrl?ka:ga)(e)),n&&(e.filterParamName=n,t.encodeFilterParams&&(e.encodeFilterParams=t.encodeFilterParams),i.filter="onRemoteFilter"),t.valueField||(t.valueField=e.modelClass.idField),!t.primaryFilter){t.primaryFilter=new cr({id:"primary",property:t.displayField,operator:t.filterOperator,disabled:!0,caseSensitive:t.caseSensitive})}r.push(t.primaryFilter),n?t.filterSelected&&(e.storage.autoFilter=!0,e.storage.addFilter({id:"".concat(t.id,"-selected-filter"),filterBy:function(e){return!t.valueCollection.includes(e)}})):t.filterSelected&&(t.selectedItemsFilter=function(e){return!t.valueCollection.includes(e)},r.push(t.selectedItemsFilter),e.reapplyFilterOnAdd=!0),e.filter(r),t._store=e,t._picker&&(t.picker.store=e),e.storage.addIndex(t.displayField),e.storage.addIndex(t.valueField),t.displayValueRenderer&&(i.change="syncInputFieldValue",t.syncInputFieldValue()),e.on(i)},get:function(){return this._store}},{key:"record",get:function(){return this.selected}},{key:"records",get:function(){return this.valueCollection.values.slice()}},{key:"selected",get:function(){return this.valueCollection.first}}],[{key:"$name",get:function(){return"Combo"}},{key:"defaultConfig",get:function(){return{items:null,store:null,valueField:null,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:null,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:za,filterOperator:"startsWith",caseSensitive:!1,multiSelect:null,hidePickerOnSelect:null,chipView:null,filterSelected:null,emptyText:null,value:null,validateFilter:!0,clearTextOnPickerHide:!0}}}]),n}(xa);Wa.queryAll=za,Wa.queryLast=Va;var Ua=function(e){$()(n,e);var t=Ba(n);function n(){return D()(this,n),t.apply(this,arguments)}return M()(n,null,[{key:"$name",get:function(){return"MultiSelectChipView"}},{key:"defaultConfig",get:function(){return{itemsFocusable:!1,multiSelect:!0,closeHandler:"up.onChipClose",itemTpl:function(e){return e[this.owner.displayField]}}}}]),n}(ja),Ga=function(e){$()(n,e);var t=Ba(n);function n(){return D()(this,n),t.apply(this,arguments)}return M()(n,[{key:"onTargetClick",value:function(e){var t=e.target.closest(this.itemSelector);!t||e.shiftKey||t.contains(e.target.closest("[data-noselect]"))||this.ownerCmp.selected.clear(),ei()(J()(n.prototype),"activeItem",t,this,!0)}},{key:"onKeyDown",value:function(e){"Enter"!==e.key&&se()(J()(n.prototype),"onKeyDown",this).call(this,e)}},{key:"navigatePrevious",value:function(e){var t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.previous?se()(J()(n.prototype),"navigatePrevious",this).call(this,e):this.activeItem=null}},{key:"navigateNext",value:function(e){var t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.next?se()(J()(n.prototype),"navigateNext",this).call(this,e):this.activeItem=null}},{key:"activeItem",set:function(e){var t=this.ownerCmp;e=t.getItem(e),ei()(J()(n.prototype),"activeItem",e,this,!0),e&&t.selected.add(t.getRecord(e))},get:function(){return se()(J()(n.prototype),"activeItem",this)}}],[{key:"defaultConfig",get:function(){return{allowShiftKey:!0}}}]),n}(Da);Wa._$name="Combo",ye.register("combo",Wa),ye.register("combobox",Wa),ye.register("dropdown",Wa);var Ya=function(){function e(t){D()(this,e);var n=t.date,r=t.weekStartDay,i=t.sixWeeks;this.constructor.updateDayNumbers(r),this.sixWeeks=i,this.date=n}return M()(e,[{key:"eachDay",value:function(e){for(var t=this.startDayOfMonth;t<=this.endDayOfMonth;t++)e(new Date(this.year,this.month,t))}},{key:"eachWeek",value:function(e){for(var t=this,n=t.weekCount,r=t.startDayOfMonth,i=0;i<n;i++){for(var o=[],a=t.getWeekNumber(new Date(t.year,t.month,Math.max(r,1))),s=0;s<7;s++,r++)o.push(new Date(t.year,t.month,r));e(a,o)}}},{key:"getWeekNumber",value:function(t){var n=this,r=n.weekStartDay;if((t=ft.clearTime(t))<n.startDate||t>n.endDate)return new e({date:t,weekStartDay:r}).getWeekNumber(t);var i=Math.floor((t-n.weekBase)/864e5/7),o=t.getFullYear();if(!i){var a=new Date(n.year,0,0);return new e({date:a,weekStartDay:r}).getWeekNumber(a)}return 53!==i||n.has53weeks||(i=1,o++),[o,i]}},{key:"date",set:function(t){var n="string"==typeof t;if(t=new Date(t),n){if(isNaN(t))throw new Error("CalendarPanel date ingestion must be passed a Date, or a valid argument to the Date constructor");t=ft.add(t,t.getTimezoneOffset(),"minute")}var r=this,i=ft.getFirstDateOfMonth(t),o=ft.getLastDateOfMonth(i),a=r.dayNumbers[i.getDay()],s=r.dayNumbers[o.getDay()];if(r._date=t,r.startDayOfMonth=1-a,r.endDayOfMonth=o.getDate()+(6-s),r.sixWeeks)for(;r.weekCount<6;)r.endDayOfMonth+=7;var l=new Date(r.year,0,1),c=new Date(r.year,1,31),u=r.month?new e({date:l,weekStartDay:r.weekStartDay}):r;r.dayNumbers[l.getDay()]>3?r.weekBase=u.startDate:r.weekBase=new Date(r.year,0,u.startDayOfMonth-7),r.has53weeks=c.getDay()<4},get:function(){return this._date}},{key:"year",set:function(e){this.date.setFullYear(e),this.date=this.date},get:function(){return this.date.getFullYear()}},{key:"month",set:function(e){this.date.setMonth(e),this.date=this.date},get:function(){return this.date.getMonth()}},{key:"dayCount",get:function(){return this.endDayOfMonth+1-this.startDayOfMonth}},{key:"weekCount",get:function(){return this.dayCount/7}},{key:"startDate",get:function(){return new Date(this.year,this.month,this.startDayOfMonth)}},{key:"endDate",get:function(){return new Date(this.year,this.month,this.endDayOfMonth)}}],[{key:"applyLocale",value:function(){this.updateDayNumbers()}},{key:"updateDayNumbers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft.weekStartDay,t=this.prototype,n=t.dayNumbers=[],r=t.canonicalDayNumbers=[];t.weekStartDay=e;for(var i=0;i<7;i++){var o=(e+i)%7;r[i]=o,n[o]=i}}}]),e}();function $a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Fe.on({locale:"applyLocale",thisObj:Ya}),Ya._$name="Month";var qa=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if($a()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){Fe.on({locale:Xa}),Xa(),se()(J()(r.prototype),"construct",this).call(this,e),this.refresh()}},{key:"doDestroy",value:function(){this.tip&&this.tip.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"ingestDate",value:function(e){if(!(e instanceof Date)){if(e=new Date(e),isNaN(e))throw new Error("CalendarPanel date ingestion must be passed a Date, or a valid argument to the Date constructor");var t=e.getTimezoneOffset();t&&(e=ft.add(e,t,"minute"))}return ft.clearTime(e)}},{key:"refresh",value:function(){var e=this,t=ft.clearTime(new Date),n=e.cellElements,r=e.weekElements,i=e.date,o=e.month,a=e.cellCls,s=e.disabledCls,l=e.otherMonthCls,c=e.weekendCls,u=e.todayCls;if(!i)return e.date=t;for(var d=0,f=n.length;d<f;d++)n[d].className=n[d].innerHTML="";for(var h=0;h<7;h++){var g=e.weekdayCells[h];g.className=g.innerHTML="",e.headerRenderer?e.headerRenderer(g,h):g.innerHTML=Ja[e.canonicalDayNumbers[h]],g.classList.add("b-calendar-day-header")}var v=0,p=0;o.eachWeek((function(n,i){var d=r[v].children;d[0].className="b-week-number-cell",e.weekRenderer?e.weekRenderer(d[0],n):d[0].innerHTML=n[1];for(var f=0;f<7;f++){var h=i[f],g=h.getDay(),y=d[f+1],m=y.classList;m.add(a),e.isDisabledDate(h)&&m.add(s),h.getMonth()!==o.month&&m.add(l),0!==g&&6!==g||m.add(c),h.getTime()===t.getTime()&&m.add(u),y.dataset.date=ft.format(h,"YYYY-MM-DD"),y.dataset.cellIndex=p,e.cellRenderer?e.cellRenderer(y,h):y.innerHTML=h.getDate(),p++}v++})),e.floating&&(e.isAligning||e.realign())}},{key:"isDisabledDate",value:function(e){var t=e.getDay(),n=this.disabledDates;if(this.disableWeekends&&(0===t||6===t))return!0;if(n){if("function"==typeof n)return n(e);if(Array.isArray(n))return n.some((function(t){return ft.clearDate(t,!0).getTime()===ft.clearDate(e,!0).getTime()}))}}},{key:"onTipOverCell",value:function(e){var t=e.source,n=e.target;t.date=ft.parse(n.dataset.date,"YYYY-MM-DD")}},{key:"tip",set:function(e){this._tip=new Ui(Object.assign({forElement:this.element,forSelector:".b-calendar-cell"},e)),this._tip.on({pointerOver:"onTipOverCell",thisObj:this})},get:function(){return this._tip}},{key:"element",get:function(){return se()(J()(r.prototype),"element",this)},set:function(e){ei()(J()(r.prototype),"element",e,this,!0),this.weekElements=Array.from(this.element.querySelectorAll(".b-calendar-week")),this.cellElements=Array.from(this.element.querySelectorAll(".b-calendar-week > div"))}},{key:"date",set:function(e){var t=this;e=t._date=t.ingestDate(e),t.month&&t.month.month===e.getMonth()||(t.month=new Ya({date:e,weekStartDay:t.weekStartDay,sixWeeks:t.sixWeeks})),t.refresh()},get:function(){return this._date}},{key:"month",set:function(e){e instanceof Ya?this._month=e:(this.month.month=e,this.refresh())},get:function(){return this._month}},{key:"year",set:function(e){this.month.year=e,this.refresh()},get:function(){return this.month.year}},{key:"showWeekNumber",set:function(e){this.element.classList[e?"add":"remove"]("b-show-week-number"),this.floating&&(this.isAligning||this.realign())}},{key:"bodyConfig",get:function(){var e=se()(J()(r.prototype),"bodyConfig",this),t=[];e.children=[{tag:"div",className:"b-calendar-row b-calendar-weekdays",children:this.dayNameCells},{className:"b-weeks-container notranslate",reference:"weeksElement",children:t}];for(var n=0;n<6;n++){for(var i={className:"b-calendar-row b-calendar-week",children:[]},o=0;o<8;o++)i.children.push({});t.push(i)}return e}},{key:"weekStartDay",set:function(e){var t=this;t.dayNames=[],t.dayNumbers=[],t.canonicalDayNumbers=[],t._weekStartDay=null!=e?e:ft.weekStartDay;for(var n=0;n<7;n++){var r=(t._weekStartDay+n)%7;t.canonicalDayNumbers[n]=r,t.dayNumbers[r]=n,t.dayNames[n]=Ja[r]}},get:function(){return this.hasOwnProperty("_weekStartDay")||(this.weekStartDay=void 0),this._weekStartDay}},{key:"dayNameCells",get:function(){var e=document.createElement("div"),t=[e],n=this.weekdayCells=[];e.className="b-week-number-cell",this._thisIsAUsedExpression(this.weekStartDay);for(var r=0;r<7;r++){var i=document.createElement("div");t.push(i),n.push(i)}return t}}],[{key:"$name",get:function(){return"CalendarPanel"}},{key:"defaultConfig",get:function(){return{weekStartDay:null,sixWeeks:!0,showWeekNumber:!1,disabledDates:null,headerRenderer:null,weekRenderer:null,cellRenderer:null,disableWeekends:null,tip:null,cellCls:"b-calendar-cell",disabledCls:"b-disabled-date",otherMonthCls:"b-other-month",weekendCls:"b-weekend",todayCls:"b-today"}}}]),r}(Ri);function Xa(){Ja.length=0;for(var e=2;e<9;e++)Ka.setDate(e),Ja.push(ft.format(Ka,"ddd"))}var Ka=new Date("2000-01-01T00:00:00"),Ja=[];function Qa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}qa._$name="CalendarPanel",ye.register("calendarpanel",qa);var Za=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Qa()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"$name",get:function(){return"Fit"}},{key:"defaultConfig",get:function(){return{containerCls:"b-fit-container",itemCls:"b-fit-item"}}}]),r}(ii);function es(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Za._$name="Fit",ii.registerLayout(Za);var ts=function(e){$()(i,e);var t,n,r=(t=i,function(){var e,n=J()(t);if(es()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function i(){return D()(this,i),r.apply(this,arguments)}return M()(i,[{key:"afterConfigure",value:function(){var e=this;se()(J()(i.prototype),"afterConfigure",this).call(this),(e.completeKey||e.cancelKey)&&Kn.on({element:e.element,keydown:"onKeyDown",thisObj:e}),Fe.on({locale:"onLocaleChange",thisObj:e})}},{key:"onLocaleChange",value:function(){var e=this.inputField;e&&!e.isDestroyed&&e.syncInputFieldValue&&e.syncInputFieldValue(!0)}},{key:"startEdit",value:function(e){var t=e.target,n=e.align,r=void 0===n?"t0-t0":n,i=e.hideTarget,o=void 0!==i&&i,a=e.matchSize,s=void 0===a||a,l=e.matchFont,c=void 0===l||l,u=e.fitTargetContent,d=void 0!==u&&u,f=e.value,h=e.record,g=e.field,v=void 0===g?this.inputField.name:g,p=e.focus,y=void 0===p||p,m=this,b=m.inputField,k=t instanceof In?t:In.inner(t),w=on.getStyleValue(t,"font-size"),S=on.getStyleValue(t,"font-family");if(!1!==m.trigger("beforestart",{value:f})){if(h&&v&&void 0===f&&(m.record=h,m.dataField=v,f=h[v]),s&&(m.width=k.width,m.height=k.height),b.input&&(c?(b.input.style.fontSize=w,b.input.style.fontFamily=S):b.input.style.fontSize=b.input.style.fontFamily=""),b.clearError&&b.clearError(),b.value=f,b.initialValue=b.value,m.showBy({target:t,align:r}),d){var C=b.input.scrollWidth-b.input.clientWidth;C>0&&(m.width+=C+on.scrollBarWidth)}return y&&m.inputField.focus&&m.inputField.focus(),1===t.nodeType&&(t.classList.add("b-editing"),o&&t.classList.add("b-hide-visibility")),m.trigger("start",{value:b.value}),m.oldValue=b.value,Array.isArray(m.oldValue)&&(m.oldValue=m.oldValue.slice()),!0}return!1}},{key:"refreshEdit",value:function(){if(this.isVisible){var e=this.record,t=this.dataField,n=this.inputField;if(e&&t){var r=e[t];mt.isEqual(n.value,r)||(n.value=r)}}}},{key:"onKeyDown",value:function(e){var t=this;switch(e.key){case t.completeKey:t.completeEdit(),e.stopImmediatePropagation();break;case t.cancelKey:t.cancelEdit(),e.stopImmediatePropagation()}t.trigger("keydown",{event:e})}},{key:"onFocusOut",value:function(e){if(se()(J()(i.prototype),"onFocusOut",this).call(this,e),!this.isFinishing){var t=this["".concat(this.blurAction,"Edit")];t&&t.call(this)}}},{key:"completeEdit",value:(n=ta()(Zo.a.mark((function e(t){var n,r,i,o,a,s,l,c,u,d,f;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).inputField,i=n.oldValue,o=n.record,a=r.invalidAction||(!1===r.allowInvalid?"block":n.invalidAction),s=r.value,r.isValid){e.next=12;break}if("block"!==a){e.next=7;break}return r.focus&&r.focus(),e.abrupt("return",!1);case 7:if("revert"!==a){e.next=10;break}return n.cancelEdit(),e.abrupt("return",!0);case 10:e.next=33;break;case 12:if(!mt.isEqual(s,i)){e.next=17;break}return n.cancelEdit(),e.abrupt("return",!0);case 17:if(l={inputField:r,record:o,value:s,oldValue:i},!1!==n.trigger("beforeComplete",l)){e.next=22;break}r.focus&&r.focus(),e.next=33;break;case 22:if(t||(t=l.finalize||l.editorContext&&l.editorContext.finalize),!t){e.next=31;break}return e.next=26,t(l);case 26:return!0===(c=e.sent)?n.onEditComplete():(r.setError&&(u=c||r.L("invalidValue"),d=function(){f(),r.clearError(u)},f=r.on({change:d,input:d}),r.setError(u)),"block"===a?r.focus&&r.focus():"revert"===a&&(r.value=i,c=!0),c=!1),e.abrupt("return",c);case 31:return n.onEditComplete(),e.abrupt("return",!0);case 33:return e.abrupt("return",!1);case 34:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"cancelEdit",value:function(){var e=this,t=e.inputField,n=e.oldValue,r=e.lastAlignSpec.target,i=t.value;e.isFinishing||!1===e.trigger("beforeCancel",{value:i,oldValue:n})||(e.isFinishing=!0,e.hide(),e.trigger("cancel",{value:i,oldValue:n}),1===r.nodeType&&(r.classList.remove("b-editing"),r.classList.remove("b-hide-visibility")),e.isFinishing=!1)}},{key:"onEditComplete",value:function(){var e=this,t=e.record,n=e.dataField,r=e.inputField,i=e.oldValue,o=e.lastAlignSpec.target,a=r.value;if(!e.isFinishing){if(e.isFinishing=!0,e.hide(),t){var s="set".concat(L.capitalizeFirstLetter(n));t[s]?t[s](a):t[n]=a}e.trigger("complete",{value:a,oldValue:i}),1===o.nodeType&&(o.classList.remove("b-editing"),o.classList.remove("b-hide-visibility")),e.isFinishing=!1}}},{key:"doDestroy",value:function(){this.createdInputField&&this.inputField.destroy(),se()(J()(i.prototype),"doDestroy",this).call(this)}},{key:"onInputFieldChange",value:function(){this.containsFocus&&this.completeEdit()}},{key:"allowInvalid",set:function(e){this._allowInvalid=e,this.invalidAction=e?"allow":"block"},get:function(){return this._allowInvalid}},{key:"owner",set:function(e){this._owner=e},get:function(){return this._owner||we.fromElement(this.element.parentNode)}},{key:"inputField",set:function(e){var t=this;t._inputField&&t._inputField.destroy(),"string"==typeof e&&(e={type:e}),e instanceof Nr?t._inputField=e:(t._inputField=Ce.createWidget(e),t.createdInputField=!0),t.completeOnChange&&t._inputField.on({change:"onInputFieldChange",thisObj:t}),t._inputField.parent=t,t.removeAll(),t.add(e)},get:function(){return this.items[0]}}],[{key:"$name",get:function(){return"Editor"}},{key:"defaultConfig",get:function(){return{positioned:!0,hidden:!0,layout:"fit",inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",allowInvalid:null,invalidAction:"block",completeOnChange:null}}}]),i}(yi);function ns(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ts._$name="Editor",ye.register("editor",ts);var rs=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ns()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;Fe.on({locale:"onLocaleChange",thisObj:t}),t.selection=[],t.refresh=t.createOnFrame(t.refresh),se()(J()(r.prototype),"construct",this).call(this,e),t.element.setAttribute("aria-activedescendant","".concat(t.id,"-active-day")),Kn.on({element:t.element,mouseover:"onPickerMouseover",mousedown:"onPickerMousedown",click:"onPickerClick",keydown:"onPickerKeyDown",thisObj:t})}},{key:"doDestroy",value:function(){this._yearEditor&&this._yearEditor.destroy(),this._monthEditor&&this._monthEditor.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"eachWidget",value:function(e,t){var n=this.items||[];this._yearEditor&&n.unshift(this._yearEditor),this._monthEditor&&n.unshift(this._monthEditor);for(var r=0;r<n.length;r++){var i=n[r];if(!1===e(i))return;t&&i.eachWidget&&i.eachWidget(e,t)}}},{key:"refresh",value:function(){var e=this,t=on.scrollBarWidth;se()(J()(r.prototype),"refresh",this).call(this),e.monthElement.style.minWidth="calc(".concat(e.maxMonthLength+1,"ch + ").concat(t,"px)"),e.monthElement.innerHTML=ft.format(e.month.date,"MMMM"),e.yearElement.style.minWidth=t?"calc(3ch + ".concat(t,"px"):"7ch",e.yearElement.innerHTML=ft.format(e.month.date,"YYYY")}},{key:"cellRenderer",value:function(e,t){var n=this,r=n.activeCls,i=n.selectedCls,o=e.classList;e.innerHTML=t.getDate(),e.setAttribute("aria-label",ft.format(t,"MMMM D, YYYY")),n.isActiveDate(t)&&(o.add(r),e.id="".concat(n.id,"-active-day")),n.isSelectedDate(t)&&o.add(i),(n.minDate&&t<n.minDate||n.maxDate&&t>n.maxDate)&&o.add(n.outOfRangeCls)}},{key:"onPickerMousedown",value:function(e){e.preventDefault()}},{key:"onPickerMouseover",value:function(e){if(this.editOnHover&&on.up(e.target,".b-editable"))return this.onEditGesture(e)}},{key:"onPickerClick",value:function(e){var t=this,n=e.target,r=on.up(n,".".concat(t.cellCls,":not(.").concat(t.disabledCls,"):not(.").concat(t.outOfRangeCls,")")),i=on.up(n,".b-editable");return r?t.onCellClick(e):t.editOnHover&&!on.isTouchEvent||!i?(t._monthEditor&&!t._monthEditor.owns(e)&&t._monthEditor.cancelEdit(),void(t._yearEditor&&!t._yearEditor.owns(e)&&t._yearEditor.cancelEdit())):t.onEditGesture(e)}},{key:"onCellClick",value:function(e){this.onDateActivate(ft.parse(e.target.dataset.date,"YYYY-MM-DD"),e)}},{key:"onEditGesture",value:function(e){var t=this,n=t.month,r=e.target;r===t.monthElement?t.monthEditor.startEdit({target:r,value:n.month,fitTargetContent:!1,hideTarget:!0}):r===t.yearElement&&(t.yearEditor.minWidth="calc(50px + ".concat(on.scrollBarWidth,"px)"),t.yearEditor.startEdit({target:r,value:n.year,fitTargetContent:!0,hideTarget:!0}))}},{key:"onDateActivate",value:function(e,t){var n=this,r=n.lastClickedDate,i=n.selection;n.activeDate=e,n.lastClickedDate=e,n.multiSelect?n.multiRange||r&&e.getTime()===r.getTime()||(r&&t.shiftKey?(i[1]=e,i.sort()):(i.length=0,i[0]=e),n.trigger("selectionChange",{selection:i})):n.value&&n.value.getTime()===e.getTime()?n.hide():n.value=e}},{key:"onPickerKeyDown",value:function(e){var t=this,n=e.key.trim()||e.code,r=t.activeDate,i=new Date(r);if(r){do{switch(n){case"Escape":t.hide();break;case"ArrowLeft":e.preventDefault(),e.ctrlKey?i.setMonth(i.getMonth()-1):i.setDate(i.getDate()-1);break;case"ArrowUp":e.preventDefault(),i.setDate(i.getDate()-7);break;case"ArrowRight":e.preventDefault(),e.ctrlKey?i.setMonth(i.getMonth()+1):i.setDate(i.getDate()+1);break;case"ArrowDown":e.preventDefault(),i.setDate(i.getDate()+7);break;case"Enter":t.onDateActivate(r,e)}}while(t.isDisabledDate(i)&&!t.focusDisabledDates);if(t.minDate&&i<t.minDate)return;if(t.maxDate&&i>t.maxDate)return;t.activeDate=i}}},{key:"gotoPrevMonth",value:function(){var e=this.date;e.setMonth(e.getMonth()-1),this.date=e}},{key:"gotoNextMonth",value:function(){var e=this.date;e.setMonth(e.getMonth()+1),this.date=e}},{key:"isActiveDate",value:function(e){return this.activeDate&&this.ingestDate(e).getTime()===this.activeDate.getTime()}},{key:"isSelectedDate",value:function(e){return this.selection.some((function(t){return t.getTime()===e.getTime()}))}},{key:"onMonthPicked",value:function(e){var t=e.value;this.month=t}},{key:"onYearPicked",value:function(e){var t=e.value;this.year=t}},{key:"onLocaleChange",value:function(){this._monthEditor&&(this._monthEditor.doDestroy(),this._monthEditor=null),this._yearEditor&&(this._yearEditor.doDestroy(),this._yearEditor=null),this._maxMonthLength=0}},{key:"focusElement",get:function(){return this.element}},{key:"minDate",set:function(e){this._minDate=e?this.ingestDate(e):null,this.refresh()},get:function(){return this._minDate}},{key:"maxDate",set:function(e){this._maxDate=e?this.ingestDate(e):null,this.refresh()},get:function(){return this._maxDate}},{key:"activeDate",set:function(e){var t=this;t._activeDate=e?t.ingestDate(e):ft.clearTime(new Date),t.month.month!==t._activeDate.getMonth()&&(t.month.date=t._activeDate),t.refresh()},get:function(){return this._activeDate}},{key:"value",set:function(e){var t,n=this,r=n.selection;e?(e=n.ingestDate(e),n.value&&e.getTime()===n.value.getTime()||(r.length=0,r[0]=e,t=!0),n.date=e):(t=r.length,r.length=0,n.date=new Date),t&&n.trigger("selectionChange",{selection:r})},get:function(){return this.selection[this.selection.length-1]}},{key:"monthEditor",get:function(){var e=this;return e._monthEditor||(e._monthEditor=new ts({owner:e,appendTo:e.element,inputField:e.monthInput=new Wa({editable:!1,autoExpand:!e.editOnHover,items:e.monthItems,highlightExternalChange:!1,picker:{align:{align:"t0-b0"},cls:"b-month-picker-list",scrollable:{overflowX:!1}}}),completeOnChange:!0,listeners:{complete:"onMonthPicked",thisObj:e}})),e._monthEditor}},{key:"yearEditor",get:function(){var e=this;return e._yearEditor||(e._yearEditor=new ts({owner:e,appendTo:e.element,inputField:e.yearInput=new Wa({editable:!1,autoExpand:!e.editOnHover,items:e.yearItems,highlightExternalChange:!1,picker:{cls:"b-year-picker-list",scrollable:{overflowX:!1}}}),completeOnChange:!0,listeners:{complete:"onYearPicked",thisObj:e}})),e._yearEditor}},{key:"monthItems",get:function(){return ft.getMonthNames().map((function(e,t){return[t,e]}))}},{key:"yearItems",get:function(){for(var e=[],t=(new Date).getFullYear(),n=t-20;n<t+21;n++)e.push(n);return e}},{key:"maxMonthLength",get:function(){if(!this._maxMonthLength){this._maxMonthLength=0;for(var e=0,t=this.monthItems;e<12;e++)this._maxMonthLength=Math.max(this._maxMonthLength,t[e][1].length)}return this._maxMonthLength}}],[{key:"$name",get:function(){return"DatePicker"}},{key:"defaultConfig",get:function(){return{focusable:!0,tools:{prevMonth:{align:"start",cls:"b-icon b-icon-angle-left",handler:"gotoPrevMonth"},nextMonth:{align:"end",cls:"b-icon b-icon-angle-right",handler:"gotoNextMonth"}},header:{title:'<div class="b-editable b-datepicker-month" reference="monthElement"></div> <div class="b-editable b-datepicker-year" reference="yearElement"></div>',titleAlign:"center"},minDate:null,maxDate:null,outOfRangeCls:"b-out-of-range",activeCls:"b-active-date",selectedCls:"b-selected-date",focusDisabledDates:null,multiSelect:!1,editOnHover:!0}}}]),r}(qa);function is(){var e=Ti()(['<input type="','"\n            reference="input"\n            class="','"\n            min="','"\n            max="','"\n            placeholder="','"\n            name="','"\n            id="','"/>']);return is=function(){return e},e}function os(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}rs._$name="DatePicker",ye.register("datepicker",rs);var as=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(os()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"inputTemplate",value:function(){var e=this;return Ii.tpl(is(),e.inputType||"text",e.inputCls||"",e.min,e.max,e.placeholder,e.name||e.id,e.id+"_input")}},{key:"createPicker",value:function(e){var t=this;return e=new rs(Object.assign({owner:t,forElement:t[t.pickerAlignElement],floating:!0,scrollAction:"realign",align:{align:"t0-b0",axisLock:!0,anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},value:t.value,minDate:t.min,maxDate:t.max,onSelectionChange:function(e){var n=e.selection,r=e.source;r.isVisible&&(t._isUserAction=!0,t.value=n[0],t._isUserAction=!1,r.hide())}},e)),t.calendarContainerCls&&e.element.classList.add(t.calendarContainerCls),e}},{key:"onBackClick",value:function(){var e=this,t=e.min;if(!e.readOnly&&e.value){var n=ft.add(e.value,-1*e._step.magnitude,e._step.unit);(!t||t.getTime()<=n)&&(e.value=n)}}},{key:"onForwardClick",value:function(){var e=this,t=e.max;if(!e.readOnly&&e.value){var n=ft.add(e.value,e._step.magnitude,e._step.unit);(!t||t.getTime()>=n)&&(e.value=n)}}},{key:"showPicker",value:function(e){this.picker.value=this.picker.activeDate=this.value,se()(J()(r.prototype),"showPicker",this).call(this,e)}},{key:"focusPicker",value:function(){this.picker.focus()}},{key:"transformDateValue",value:function(e){return null!=e&&(ft.isDate(e)||(e="string"==typeof e?ft.parse(e,this.format)||ft.parse(e,this.fallbackFormat):new Date(e)),ft.isValidDate(e))?this.transformTimeValue(e):null}},{key:"transformTimeValue",value:function(e){var t=this.keepTime;if(e=ft.clone(e),t){var n=ft.parse(t,this.timeFormat);ft.isValidDate(n)?ft.copyTimeValues(e,n):ft.isValidDate(this.value)&&ft.copyTimeValues(e,this.value)}else ft.clearTime(e,!1);return e}},{key:"hasChanged",value:function(e,t){return e&&e.getTime&&t&&t.getTime?e.getTime()!==t.getTime():se()(J()(r.prototype),"hasChanged",this).call(this,e,t)}},{key:"updateLocalization",value:function(){se()(J()(r.prototype),"updateLocalization",this).call(this),this.syncInputFieldValue(!0)}},{key:"internalOnKeyPress",value:function(e){se()(J()(r.prototype),"internalOnKeyPress",this).call(this,e),"Enter"===e.key&&this.isValid&&this.picker.hide()}},{key:"triggers",set:function(e){ei()(J()(r.prototype),"triggers",mt.assign(e,this.stepTriggers),this,!0)},get:function(){return se()(J()(r.prototype),"triggers",this)}},{key:"isValid",get:function(){var e=this,t=e.min,n=e.max;e.clearError("minimumValueViolation",!0),e.clearError("maximumValueViolation",!0);var i=e.value;if(i){if(i=i.getTime(),t&&t.getTime()>i)return e.setError("minimumValueViolation",!0),!1;if(n&&n.getTime()<i)return e.setError("maximumValueViolation",!0),!1}return se()(J()(r.prototype),"isValid",this)}},{key:"min",set:function(e){var t=this;t._min=t.transformDateValue(e),t.input&&(t.input.min=t._min),t._picker&&(t._picker.minDate=t._min),t.updateInvalid()},get:function(){return this._min}},{key:"max",set:function(e){var t=this;t._max=t.transformDateValue(e),t.input&&(t.input.max=t._max),t._picker&&(t._picker.maxDate=t._max),t.updateInvalid()},get:function(){return this._max}},{key:"value",set:function(e){var t=this,n=t.value,i=t._picker,o=t.transformDateValue(e);!e||o?(t.clearError("invalidDate"),t.hasChanged(n,o)?(i&&!t.inputting&&(i.value=o),ei()(J()(r.prototype),"value",o,this,!0)):t.inputting||t.syncInputFieldValue()):t.setError("invalidDate")},get:function(){return se()(J()(r.prototype),"value",this)}},{key:"step",set:function(e){var t=this;t.element.classList[e?"add":"remove"]("b-show-steppers"),"number"==typeof e?e={magnitude:e,unit:t._step?t._step.unit:"day"}:"object"!==re()(e)&&(e=ft.parseDuration(e)),e&&e.magnitude&&e.unit&&(e.magnitude=Math.abs(e.magnitude),t._step=e,t.updateInvalid())},get:function(){return this._step}},{key:"inputValue",get:function(){var e=this.value;return e?ft.format(e,this.format):""}},{key:"format",set:function(e){this._format=e,this.syncInputFieldValue(!0)},get:function(){return this._format}}],[{key:"$name",get:function(){return"DateField"}},{key:"defaultConfig",get:function(){return{format:"L",fallbackFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss:SSS",keepTime:!1,pickerFormat:null,triggers:{expand:{cls:"b-icon-calendar",handler:"onTriggerClick",weight:200}},stepTriggers:{back:{cls:"b-icon-angle-left b-step-trigger",handler:"onBackClick",align:"start",weight:100},forward:{cls:"b-icon-angle-right b-step-trigger",handler:"onForwardClick",align:"end",weight:100}},calendarContainerCls:"",min:null,max:null,step:null,picker:null,value:null}}}]),r}(xa);function ss(){var e=Ti()(['\n            <input type="number"\n                reference="input"\n                value="','"\n                name="','"\n                id="','_input"\n                step="any"\n                ',"\n                ","/>\n            "]);return ss=function(){return e},e}function ls(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}as._$name="DateField",ye.register("datefield",as),ye.register("date",as);var cs=/[.,]/,us=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ls()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).call(this,e),t.input.addEventListener("dblclick",(function(){t.select()})),"number"==typeof t.changeOnSpin&&(t.bufferedSpinChange=t.buffer(t.triggerChange,t.changeOnSpin))}},{key:"inputTemplate",value:function(){var e=this,t="inputWidth"in e?'style="width:'.concat(e.inputWidth).concat("number"==typeof e.inputWidth?"px":"",'"'):"";return Ii.tpl(ss(),e._value,e.name||e.id,e.id,t,e.attributeString)}},{key:"internalOnKeyPress",value:function(e){"keydown"===e.type&&("ArrowUp"===e.key?(this.doSpinUp(),e.preventDefault()):"ArrowDown"===e.key&&(this.doSpinDown(),e.preventDefault())),se()(J()(r.prototype),"internalOnKeyPress",this).call(this,e)}},{key:"doSpinUp",value:function(){var e=this,t=e.min,n=e.max,r=(e.value||0)+e.step;!isNaN(t)&&r<t&&(r=t),(isNaN(n)||r<=n)&&e.applySpinChange(r)}},{key:"doSpinDown",value:function(){var e=this,t=e.min,n=e.max,r=(e.value||0)-e.step;!isNaN(n)&&r>n&&(r=n),(isNaN(t)||r>=t)&&e.applySpinChange(r)}},{key:"applySpinChange",value:function(e){var t=this;t._isUserAction=!0,!0!==t.changeOnSpin&&(t.silenceChange=!0,t.bufferedSpinChange&&t.bufferedSpinChange(null,!0)),t.value=e,t._isUserAction=!1,t.silenceChange=!1}},{key:"triggerChange",value:function(){this.silenceChange||se()(J()(r.prototype),"triggerChange",this).apply(this,arguments)}},{key:"internalOnInput",value:function(e){var t=this.input,n=this.formatValue(t.value);t.value!==n&&(t.value=n),se()(J()(r.prototype),"internalOnInput",this).call(this,e)}},{key:"formatValue",value:function(e){return r.formatValue(e,this.leadingZeroes,this.decimalPrecision)}},{key:"step",set:function(e){this.element.classList[e?"remove":"add"]("b-hide-spinner"),this._step=e},get:function(){return this._step}},{key:"min",set:function(e){this._min=e,this.input&&(this.input.min=e)},get:function(){return this._min}},{key:"max",set:function(e){this._max=e,this.input&&(this.input.max=e)},get:function(){return this._max}},{key:"value",set:function(e){var t,n=this;e||0===e?("number"!=typeof e&&(e="string"==typeof e?parseFloat(e):Number(e),(t=isNaN(e))&&(e="")),t||null==n.decimalPrecision||(e=mt.round(e,n.decimalPrecision))):e=void 0;n.value!==e&&(ei()(J()(r.prototype),"value",e,this,!0),n.leadingZeroes&&(n.input.value=n.formatValue(e.toString())))},get:function(){return se()(J()(r.prototype),"value",this)}}],[{key:"formatValue",value:function(e,t,n){if("string"!=typeof e)return e;var r=e.split(cs),i=te()(r,2),o=i[0],a=i[1];return n&&a&&a.length>n&&(a=a.substr(0,n)),t&&o&&o.length<t&&(o=o.padStart(t,"0")),[o,a].filter((function(e){return e})).join(".")}},{key:"$name",get:function(){return"NumberField"}},{key:"defaultConfig",get:function(){return{min:null,max:null,step:1,value:0,decimalPrecision:null,leadingZeroes:null,triggers:{spin:{type:"spintrigger"}},attributes:["placeholder","autoComplete","min","max","tabIndex"],changeOnSpin:!0}}}]),r}(so);function ds(){var e=Ti()(['\n            <div class="','">\n                <input type="range"\n                   reference="input"\n                   id="','_input"\n                   min="','"\n                   max="','"\n                   step="','"\n                   value="','">\n                <label reference="label" for="','_input">',"</label>\n            </div>\n        "]);return ds=function(){return e},e}function fs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}us._$name="NumberField",ye.register("numberfield",us),ye.register("number",us);var hs=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(fs()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).call(this,e),t.updateLabel(),t.showTooltip&&(t.tip=new Ui({forElement:t.input,anchor:!1,align:"b-t",axisLock:!0})),t.input.addEventListener("input",t.onInternalInput.bind(t)),t.input.addEventListener("change",t.onInternalChange.bind(t)),t.input.addEventListener("mouseover",t.onInternalMouseOver.bind(t)),t.input.addEventListener("mouseout",t.onInternalMouseOut.bind(t))}},{key:"template",value:function(e){return Ii.tpl(ds(),e.text?"b-text b-has-label":"",e.id,e.min,e.max,e.step,e.value,e.id,e.text)}},{key:"onInternalInput",value:function(e){var t=this;t._value=parseInt(t.input.value),t.updateUI(),t.trigger("input",{value:t.value})}},{key:"onInternalChange",value:function(e){this.updateUI(),this.triggerChange(!0),this.trigger("action",{value:this.value})}},{key:"onInternalMouseOver",value:function(e){this.updateLabel(),this.tip&&this.tip.showBy({target:this.calcThumbPosition(),offset:5})}},{key:"onInternalMouseOut",value:function(e){this.tip&&this.tip.hide()}},{key:"triggerChange",value:function(e){this.trigger("change",{value:this.value,userAction:e})}},{key:"updateLabel",value:function(){this.text=this._text}},{key:"updateTooltipPosition",value:function(){this.tip&&this.tip.alignTo({target:this.calcThumbPosition(),offset:5})}},{key:"updateUI",value:function(){this.updateLabel(),this.updateTooltipPosition()}},{key:"calcThumbPosition",value:function(){var e=this,t=In.from(e.input),n=(t.width-e.thumbSize)*e.calcPercentProgress()/100;return new In(t.x+n,t.y+t.height/2-e.thumbSize/2,e.thumbSize,e.thumbSize)}},{key:"calcPercentProgress",value:function(){return(this.value-this.min)/(this.max-this.min)*100}},{key:"focusElement",get:function(){return this.input}},{key:"text",get:function(){return this._text},set:function(e){var t=this;t._text=e,t.label&&(t.showValue&&(e=e?"".concat(e," (").concat(t.value,")"):t.value),t.label.innerHTML=e),t.tip&&(t.tip.html=t.value)}},{key:"value",get:function(){return this.input?parseInt(this.input.value):this._value},set:function(e){var t=this;t._value!==e&&(t.input&&(t.input.value=e,t.updateUI(),t.triggerChange(!1)),t._value=e)}},{key:"min",get:function(){return this.input?this.input.min:this._min},set:function(e){var t=this;t.input&&(t.input.min=e,t._value<e&&(t.value=e,t.trigger("input",{value:t.value}))),t._min=e}},{key:"max",get:function(){return this.input?this.input.max:this._max},set:function(e){var t=this;t.input&&(t.input.max=e,t._value>e&&(t.value=e,t.trigger("input",{value:t.value}))),t._max=e}},{key:"step",get:function(){return this.input?this.input.step:this._step},set:function(e){this.input&&(this.input.step=e),this._step=e}}],[{key:"$name",get:function(){return"Slider"}},{key:"defaultConfig",get:function(){return{text:"",showValue:!0,showTooltip:!1,min:0,max:100,step:1,value:null,thumbSize:20,localizableProperties:["text"]}}}]),r}(Nr);function gs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}hs._$name="Slider",ye.register("slider",hs);var vs=["b-slide-out-left","b-slide-out-right","b-slide-in-left","b-slide-in-right"],ps=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(gs()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"setActiveItem",value:function(e){var t=this,n=t.owner,r=n.contentElement,i=n.items,o=e instanceof Nr,a=parseInt(r.dataset.activeIndex),s=i[a],l=n.items[e=o?e=i.indexOf(e):parseInt(e)],c={prevActiveIndex:a,prevActiveItem:s};if(l&&l!==s){var u=s&&s.element,d=l&&l.element;if(c.activeIndex=e,c.activeItem=l,t.animateDetacher){var f,h=t.animateDetacher.event;t.animateDetacher(),h.prevActiveItem.element.classList.remove(vs),(f=h.activeItem.element.classList).remove.apply(f,["b-active"].concat(vs)),t.animateDetacher=null}c.promise=new Promise((function(i,o){u&&t.animateCardChange?(u.classList.add(e>a?"b-slide-out-left":"b-slide-out-right"),d.classList.add("b-active",e<a?"b-slide-in-left":"b-slide-in-right"),n.isAnimating=!0,l.triggerPaint(),t.animateDetacher=Kn.on({element:d,animationend:function(){var o,a;(t.animateDetacher=null,n.isAnimating=!1,(o=d.classList).remove.apply(o,vs),u)&&(a=u.classList).remove.apply(a,["b-active"].concat(vs));r.dataset.activeIndex=e,l.focus(),i(c)},once:!0}),t.animateDetacher.reject=o,t.animateDetacher.event=c):(u&&u.classList.remove("b-active"),d.classList.add("b-active"),r.dataset.activeIndex=e,l.focus(),l.triggerPaint(),i(c))}))}return c}},{key:"renderChildren",value:function(){var e=this.owner,t=e.activeIndex;Re.isIE11&&(this.animateCardChange=!1),e.items&&null!=t&&e.items[t]&&(e.contentElement.dataset.activeIndex=t,e.items[t].element.classList.add("b-active")),se()(J()(r.prototype),"renderChildren",this).call(this)}},{key:"activeIndex",get:function(){return parseInt(this.owner.contentElement.dataset.activeIndex)}},{key:"activeItem",get:function(){return this.owner.items[parseInt(this.owner.contentElement.dataset.activeIndex)]}}],[{key:"$name",get:function(){return"Card"}},{key:"defaultConfig",get:function(){return{containerCls:"b-card-container",itemCls:"b-card-item",animateCardChange:!0}}}]),r}(ii);function ys(){var e=Ti()(['\n                <div>\n                    <div class="b-tabpanel-tabs" reference="tabStrip">\n                        ','\n                    </div>\n                    <div class="b-tabpanel-body" reference="tabPanelBody" data-activeIndex="','">\n                    </div>\n                </div>\n            ']);return ys=function(){return e},e}function ms(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ps._$name="Card",ii.registerLayout(ps);var bs=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ms()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).call(this,e),t.items.forEach((function(e,n){e.titleElement=t.element.querySelector('div.b-tabpanel-tab[data-index="'.concat(n,'"] span'))})),Kn.on({element:t.tabStrip,delegate:".b-tabpanel-tab",click:"onTabElementClick",thisObj:this})}},{key:"createWidget",value:function(e){return(e=se()(J()(r.prototype),"createWidget",this).call(this,e)).on({hide:this.onTabVisibilityChange,show:this.onTabVisibilityChange,thisObj:this}),e}},{key:"onTabElementClick",value:function(e){this.activeTab=e.currentTarget.dataset.index}},{key:"onTabVisibilityChange",value:function(e){var t=e.source;this.element.querySelector('div.b-tabpanel-tab[data-index="'.concat(this.items.indexOf(t),'"]')).classList[t.hidden?"add":"remove"]("b-hidden")}},{key:"tabMinWidth",set:function(e){this._tabMinWidth=e,this.element&&on.forEachSelector(this.element,".b-tabpanel-tab",(function(t){on.setLength(t,"minWidth",e||null)}))},get:function(){return this._tabMinWidth}},{key:"tabMaxWidth",set:function(e){this._tabMaxWidth=e,this.element&&on.forEachSelector(this.element,".b-tabpanel-tab",(function(t){on.setLength(t,"maxWidth",e||null)}))},get:function(){return this._tabMaxWidth}},{key:"layout",set:function(e){ei()(J()(r.prototype),"layout",e,this,!0),this.layout.animateCardChange=this.animateTabChange},get:function(){return se()(J()(r.prototype),"layout",this)}},{key:"contentElement",get:function(){return this.tabPanelBody}},{key:"focusElement",get:function(){var e=this.items[this.activeTab||0];return e&&e.focusElement||this.tabStrip.children[this.activeTab]}},{key:"activeTab",set:function(e){var t=this;if(e<0||e>=t.items.length)throw new Error("Invalid tab index: "+e);if(t.isConfiguring)t._activeTab=e;else{var n=t.layout.setActiveItem(e),r=n.promise,i=n.activeIndex;if(n.activeItem){var o=t.tabStrip,a=o.children[t._activeTab];t._activeTab=i,a&&a.classList.remove("b-active"),o.children[i].classList.add("b-active"),r.then((function(){t.trigger("tabchange",n)}))}}},get:function(){return this._activeTab}},{key:"activeIndex",get:function(){return this.activeTab}},{key:"activeItem",get:function(){return this.layout.activeItem}}],[{key:"$name",get:function(){return"TabPanel"}},{key:"defaultConfig",get:function(){return{template:function(e){return Ii.tpl(ys(),e.items.map((function(t,n){return'\n                        <div tabindex="-1" data-index="'.concat(n,'" class="b-tabpanel-tab ').concat(n===e.activeIndex?"b-active":""," ").concat(t.cls||""," ").concat(t.hidden?"b-hidden":"",'" style="').concat(e.tabMinWidth?"min-width:"+on.setLength(e.tabMinWidth)+";":""," ").concat(e.tabMaxWidth?"max-width:"+on.setLength(e.tabMaxWidth)+";":"",'" >\n                            <span class="b-tabpanel-tab-title">').concat(t.title,"</span>\n                        </div>\n                        ")})),e.activeIndex)},itemCls:"b-tabpanel-item",defaultType:"container",activeTab:0,tabMinWidth:null,tabMaxWidth:null,animateTabChange:!0,layout:"card",suppressChildHeaders:!0}}}]),r}(yi);function ks(){var e=Ti()(['<input type="text"\n                readOnly="readonly"\n                reference="displayElement"\n                placeholder="','"/>']);return ks=function(){return e},e}function ws(){var e=Ti()(['<textarea\n                reference="input"\n                class="','"\n                placeholder="','"\n                name="','"\n                style="resize:','"\n                id="','"></textarea>']);return ws=function(){return e},e}function Ss(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}bs._$name="TabPanel",ye.register("tabpanel",bs),ye.register("tabs",bs);var Cs=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ss()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"startConfigure",value:function(e){this._thisIsAUsedExpression(this.inline),se()(J()(r.prototype),"startConfigure",this).call(this,e)}},{key:"inputTemplate",value:function(){var e=this;return e.inline?Ii.tpl(ws(),e.inputCls||"",e.placeholder,e.name||e.id,e.resize,e.id+"_input"):Ii.tpl(ks(),e.placeholder)}},{key:"showPicker",value:function(){this.picker.width=this.pickerWidth||this[this.pickerAlignElement].offsetWidth,se()(J()(r.prototype),"showPicker",this).call(this,!0)}},{key:"focusPicker",value:function(){this.input.focus()}},{key:"onPickerKeyDown",value:function(e){var t=this,n=t.input;switch(e.key.trim()||e.code){case"Escape":return void t.picker.hide();case"Enter":e.ctrlKey&&(t.syncInputFieldValue(),t.picker.hide())}t.input=t.displayElement;var i=se()(J()(r.prototype),"onPickerKeyDown",this).call(this,e);return t.input=n,i}},{key:"syncInputFieldValue",value:function(e){this.displayElement&&(this.displayElement.value=this.inputValue),se()(J()(r.prototype),"syncInputFieldValue",this).call(this,e)}},{key:"createPicker",value:function(e){var t=this;e.width&&(t.pickerWidth=e.width),e=new Nr(mt.merge({cls:"b-textareafield-picker",owner:t,floating:!0,scrollAction:"realign",forElement:t[t.pickerAlignElement],align:{align:"t-b",axisLock:!0,anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},html:'<textarea id="'.concat(t.id+"_input",'" style="resize:').concat(t.resize,'">').concat(t.value,"</textarea>"),autoShow:!1},e));var n=t.input=e.element.querySelector("#".concat(t.id,"_input"));return t.inputListenerRemover=Kn.on({element:n,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput",keydown:"internalOnKeyPress",keypress:"internalOnKeyPress",keyup:"internalOnKeyPress"}),e}},{key:"focusElement",get:function(){return this.inline||this._picker&&this._picker.isVisible?this.input:this.displayElement}},{key:"value",set:function(e){ei()(J()(r.prototype),"value",null==e?"":e,this,!0)},get:function(){return se()(J()(r.prototype),"value",this)}},{key:"inline",set:function(e){this._inline=e,e||this.triggers||(this.triggers={})},get:function(){return this._inline}},{key:"triggers",set:function(e){this.inline||((e||(e={})).expand={cls:"b-icon-picker",handler:"onTriggerClick"}),ei()(J()(r.prototype),"triggers",e,this,!0)},get:function(){return se()(J()(r.prototype),"triggers",this)}}],[{key:"$name",get:function(){return"TextAreaField"}},{key:"defaultConfig",get:function(){return{triggers:null,inline:!0,resize:"none"}}}]),r}(xa);function Rs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Cs._$name="TextAreaField",ye.register("textareafield",Cs),ye.register("textarea",Cs);var xs=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Rs()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).call(this,e),t._pm=!1,t.fieldHours.on("change",t.onFieldChange,t),t.fieldMinutes.on("change",t.onFieldChange,t),t.buttonAM.on("click",t.onButtonAMClick,t),t.buttonPM.on("click",t.onButtonPMClick,t),Kn.on({element:t.element,keydown:"onPickerKeyDown",thisObj:t}),Kn.on({element:t.fieldHours.element,keydown:"onPickerKeyDown",thisObj:t}),Kn.on({element:t.fieldMinutes.element,keydown:"onPickerKeyDown",thisObj:t}),t.refresh()}},{key:"onFieldChange",value:function(){this._time&&(this.value=this.pickerToTime())}},{key:"onButtonAMClick",value:function(){this._pm=!1,this._time&&(this.value=this.pickerToTime())}},{key:"onButtonPMClick",value:function(){this._pm=!0,this._time&&(this.value=this.pickerToTime())}},{key:"onPickerKeyDown",value:function(e){var t=this;switch(e.key&&e.key.trim()||e.code){case"Escape":t.triggerTimeChange(t._initialValue),t.hide(),e.preventDefault();break;case"Enter":t.value=t.pickerToTime(),t.hide(),e.preventDefault()}}},{key:"pickerToTime",value:function(){var e=this,t=e._pm,n=e.fieldHours.value,r=new Date(e._time);return e._is24Hour||(t&&n<12&&(n+=12),t||12!==n||(n=0)),r.setHours(n),r.setMinutes(e.fieldMinutes.value),e._min&&(r=ft.max(e._min,r)),e._max&&(r=ft.min(e._max,r)),r}},{key:"triggerTimeChange",value:function(e){this.trigger("timeChange",{time:e})}},{key:"refresh",value:function(){var e=this;if(!e.isConfiguring){var t=e._time,n=e._is24Hour,r=t.getHours(),i=e._pm=r>=12,o=e.fieldHours;e.element.classList[n?"add":"remove"]("b-24h"),o.min=n?0:1,o.max=n?23:12,o.value=n?r:r%12||12,e.fieldMinutes.value=t.getMinutes(),e.buttonAM.pressed=!i,e.buttonPM.pressed=i,e.buttonAM.hidden=e.buttonPM.hidden=n}}},{key:"value",set:function(e){var t=this,n=!1;e&&t._time?e.getTime()!==t._time.getTime()&&(t._time=e,n=!0):(t._time=r.defaultConfig.value,n=!0),n&&(t.isVisible&&t.triggerTimeChange(t.value),t.refresh())},get:function(){return this._time}},{key:"format",set:function(e){this._format=e,this._is24Hour=ft.is24HourFormat(this._format),this.refresh()},get:function(){return this._format}},{key:"min",set:function(e){this._min=e},get:function(){return this._min}},{key:"max",set:function(e){this._max=e},get:function(){return this._max}},{key:"initialValue",set:function(e){this.value=e,this._initialValue=e},get:function(){return this._initialValue}},{key:"buttonAM",get:function(){return this.widgetMap.buttonAM}},{key:"buttonPM",get:function(){return this.widgetMap.buttonPM}},{key:"fieldHours",get:function(){return this.widgetMap.fieldHours}},{key:"fieldMinutes",get:function(){return this.widgetMap.fieldMinutes}}],[{key:"$name",get:function(){return"TimePicker"}},{key:"defaultConfig",get:function(){return{items:[{type:"number",ref:"fieldHours",min:0,max:23,highlightExternalChange:!1},{html:"<label>:</label>"},{type:"number",ref:"fieldMinutes",min:0,max:59,highlightExternalChange:!1},{type:"button",text:"AM",toggleGroup:"am-pm",ref:"buttonAM",cls:"b-blue"},{type:"button",text:"PM",toggleGroup:"am-pm",ref:"buttonPM",cls:"b-blue"}],float:"1",autoShow:!1,trapFocus:!0,value:ft.getTime(0),format:null}}}]),r}(Ei);function Es(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}xs._$name="TimePicker",ye.register("timepicker",xs);var Ds=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Es()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"createPicker",value:function(e){var t=this;return new xs(Object.assign({owner:t,floating:!0,forElement:t[t.pickerAlignElement],align:{align:"t0-b0",axisLock:!0,anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},value:t.value,format:t.format,onTimeChange:function(e){var n=e.time;t._isUserAction=!0,t.value=n,t._isUserAction=!1}},e))}},{key:"onBackClick",value:function(){var e=this,t=e.min;if(!e.readOnly&&e.value){var n=ft.add(e.value,-1*e.step.magnitude,e.step.unit);(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"onForwardClick",value:function(){var e=this,t=e.max;if(!e.readOnly&&e.value){var n=ft.add(e.value,e.step.magnitude,e.step.unit);(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"hasChanged",value:function(e,t){return e&&e.getTime&&t&&t.getTime?e.getTime()!==t.getTime():se()(J()(r.prototype),"hasChanged",this).call(this,e,t)}},{key:"showPicker",value:function(e){var t=this,n=t.picker;n.initialValue=t.value,n.format=t.format,n.maxTime=t.max,n.minTime=t.min,t.value=n.value,se()(J()(r.prototype),"showPicker",this).call(this,e)}},{key:"onPickerShow",value:function(){se()(J()(r.prototype),"onPickerShow",this).call(this),this.pickerKeyDownRemover&&this.pickerKeyDownRemover()}},{key:"focusPicker",value:function(){this.picker.focus()}},{key:"transformTimeValue",value:function(e){return null!=e&&(ft.isDate(e)||(e="string"==typeof e?ft.parse(e,this.format):new Date(e)),ft.isValidDate(e))?((e=ft.clone(e)).setFullYear(1970,0,1),e):null}},{key:"updateLocalization",value:function(){se()(J()(r.prototype),"updateLocalization",this).call(this),this.syncInputFieldValue(!0)}},{key:"isValid",get:function(){var e=this;e.clearError("minimumValueViolation",!0),e.clearError("maximumValueViolation",!0);var t=e.value;if(t){if(t=t.getTime(),e._min&&e._min.getTime()>t)return e.setError("minimumValueViolation",!0),!1;if(e._max&&e._max.getTime()<t)return e.setError("maximumValueViolation",!0),!1}return se()(J()(r.prototype),"isValid",this)}},{key:"min",set:function(e){var t=this;t._min=t.transformTimeValue(e),t.input&&(t.input.min=t._min),t.updateInvalid()},get:function(){return this._min}},{key:"max",set:function(e){var t=this;t._max=t.transformTimeValue(e),t.input&&(t.input.max=t._max),t.updateInvalid()},get:function(){return this._max}},{key:"value",set:function(e){var t=this,n=t.value,i=t.transformTimeValue(e);e&&!i||""===e?t.setError("invalidTime"):(t.clearError("invalidTime"),t.hasChanged(n,i)?(t.triggers.expand&&i&&(t.triggers.expand.element.firstElementChild.style.animationDelay=-(60*i.getHours()+i.getMinutes())/10+"s"),ei()(J()(r.prototype),"value",i,this,!0)):t.inputting||t.syncInputFieldValue())},get:function(){return se()(J()(r.prototype),"value",this)}},{key:"step",set:function(e){"number"==typeof e?e={magnitude:e,unit:this._step.unit}:"object"!==re()(e)&&(e=ft.parseDuration(e)),e&&e.magnitude&&e.unit&&(e.magnitude=Math.abs(e.magnitude),this._step=e,this.updateInvalid())},get:function(){return this._step}},{key:"format",set:function(e){this._format=e,this.syncInputFieldValue(!0)},get:function(){return this._format}},{key:"inputValue",get:function(){return ft.format(this.value,this.format)}}],[{key:"$name",get:function(){return"TimeField"}},{key:"defaultConfig",get:function(){var e=this;return{format:"LT",triggers:{back:{cls:"b-icon b-icon-angle-left",handler:"onBackClick",align:"start"},expand:{template:function(){return'<div class="b-align-'.concat(e.align||"end",'"><div class="b-icon-clock-live"></div></div>')},handler:"onTriggerClick",align:"end"},forward:{cls:"b-icon b-icon-angle-right",handler:"onForwardClick",align:"end"}},min:null,max:null,step:"5m",value:null}}}]),r}(xa);Ds._$name="TimeField",ye.register("timefield",Ds),ye.register("time",Ds);var Ts=function(){function e(){D()(this,e)}return M()(e,[{key:"createWidget",value:function(e){return ye.createWidget(e.type,e)}},{key:"getClass",value:function(e){return ye.getClass(e)}},{key:"appendWidget",value:function(e){return this.createWidget(e)}},{key:"appendWidgets",value:function(e,t){var n=this;return e.map((function(e){return n.appendWidget(mt.assign({},t||{},e))}))}},{key:"openPopup",value:function(e,t){return new Ei(mt.assign({forElement:e},"string"==typeof t?{html:t}:t))}},{key:"showContextMenu",value:function(e,t){var n=this;return n.currentContextMenu&&n.currentContextMenu.destroy(),e instanceof HTMLElement?t.forElement=e:Array.isArray(e)?t.forElement={target:Ee()(On,Z()(e))}:e instanceof On&&(t.forElement={target:e}),n.currentContextMenu=new Bi(t),n.currentContextMenu.on("destroy",(function(){n.currentContextMenu=null})),n.currentContextMenu}},{key:"attachTooltip",value:function(e,t){return"string"==typeof t&&(t={html:t}),new Ui(Object.assign({forElement:e},t)),e}},{key:"hasTooltipAttached",value:function(e){return Ui.hasTooltipAttached(e)}},{key:"destroyTooltipAttached",value:function(e){return Ui.destroyTooltipAttached(e)}},{key:"mask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Loading";if(e)return e instanceof HTMLElement&&(e={element:e,text:t}),Qr.mask(e,e.element)}},{key:"unmask",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.mask&&(t?e.mask.close():e.mask.hide())}},{key:"toast",value:function(e){return zi.show(e)}},{key:"defaultStyle",set:function(e){this._defaultStyle=e},get:function(){return this._defaultStyle}}]),e}();Ce._adapter||(Ce.adapter=Ts),Ts._$name="BryntumWidgetAdapter";var Ms=function(){function e(){D()(this,e)}return M()(e,null,[{key:"get",value:function(e,t){var n=e._domData||(e._domData={});return null!=t?n[t]:n}},{key:"set",value:function(e,t,n){3===arguments.length?(e._domData||(e._domData={}))[t]=n:e._domData=t}},{key:"assign",value:function(e,t){Object.assign(e._domData||(e._domData={}),t)}}]),e}();Ms._$name="DomDataStore";var As=function(){function e(t,n){D()(this,e),"number"==typeof t?(this._magnitude=t,this._unit=n):"object"===re()(t)&&Object.assign(this,t)}return M()(e,[{key:"isEqual",value:function(e){return Boolean(e&&this._magnitude===e.magnitude&&this._unit===e.unit)}},{key:"toString",value:function(e){var t=this,n=t.useAbbreviation?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?"".concat(t._magnitude," ").concat(ft[n](t._unit,1!==t._magnitude)):""}},{key:"magnitude",get:function(){return this._magnitude},set:function(e){this._magnitude="number"==typeof e&&e}},{key:"unit",get:function(){return this._unit},set:function(e){this._unit=ft.parseTimeUnit(e)}},{key:"isValid",get:function(){return this._magnitude&&this._unit}},{key:"milliseconds",get:function(){return this.isValid?ft.asMilliseconds(this._magnitude,this._unit):0}}]),e}();function Is(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}As._$name="Duration";var Fs=function(){throw new Error("Abstract method call!")},Os=function(){throw new Error("Method cannot be called at this state!")},_s=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Is()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"canUndo",value:function(e){Fs()}},{key:"canRedo",value:function(e){Fs()}},{key:"onUndo",value:function(e){Fs()}},{key:"onRedo",value:function(e){Fs()}},{key:"onStartTransaction",value:function(e){Fs()}},{key:"onStopTransaction",value:function(e){Fs()}},{key:"onStopTransactionDelayed",value:function(e){Fs()}},{key:"onRejectTransaction",value:function(e){Fs()}},{key:"onEnable",value:function(e){Fs()}},{key:"onDisable",value:function(e){Fs()}},{key:"onAutoRecordOn",value:function(e){Fs()}},{key:"onAutoRecordOff",value:function(e){Fs()}},{key:"onResetQueue",value:function(e){Fs()}},{key:"onModelUpdate",value:function(e){Fs()}},{key:"onStoreModelAdd",value:function(e){Fs()}},{key:"onStoreModelInsert",value:function(e){Fs()}},{key:"onStoreModelRemove",value:function(e){Fs()}},{key:"onStoreModelRemoveAll",value:function(e){Fs()}},{key:"onModelInsertChild",value:function(e){Fs()}},{key:"onModelRemoveChild",value:function(e){Fs()}}]),r}(G);_s._$name="StateBase";var Ps=Symbol("STATE_PROP"),Ls=Symbol("STORES_PROP"),Hs=Symbol("QUEUE_PROP"),js=Symbol("POS_PROP"),Bs=Symbol("TRANSACTION_PROP"),Ns=Symbol("TRANSACTION_TIMER_PROP"),zs=Symbol("AUTO_RECORD_PROP"),Vs=(Object.freeze([Ps,Ls,Hs,js,Bs,Ns,zs]),new Map),Ws=function(e,t){Vs.set(e,t)},Us=function(e){return"string"==typeof e&&(e=Vs.get(e)),e},Gs=function(e,t){var n,r,i=t.undo,o=t.redo;if(i&&!o)r={},oe()(r,Hs,e[Hs].slice(e.position)),oe()(r,js,0),n=r;else if(o&&!i)n=oe()({},Hs,e[Hs].slice(0,e.position));else{var a;a={},oe()(a,Hs,[]),oe()(a,js,0),n=a}return[n,function(){e.notifyStoresAboutQueueReset(t)}]};function Ys(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var $s=new(function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ys()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onUndo",value:function(){Os()}},{key:"onRedo",value:function(){Os()}},{key:"onEnable",value:function(e){return e.autoRecord?"autoreadystate":"readystate"}},{key:"onDisable",value:function(){Os()}},{key:"onAutoRecordOn",value:function(){return oe()({},zs,!0)}},{key:"onAutoRecordOff",value:function(){return oe()({},zs,!1)}},{key:"onStartTransaction",value:function(){Os()}},{key:"onStopTransaction",value:function(){Os()}},{key:"onStopTransactionDelayed",value:function(){Os()}},{key:"onRejectTransaction",value:function(){Os()}},{key:"onResetQueue",value:function(e,t){return Gs(e,t)}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),r}(_s)),qs=$s;function Xs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ws("disabledstate",$s);var Ks=Symbol("ACTION_QUEUE_PROP"),Js=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Xs()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e;this[Ks]=[];for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=se()(J()(r.prototype),"construct",this)).call.apply(e,[this].concat(n))}},{key:"addAction",value:function(e){this[Ks].push(e)}},{key:"undo",value:function(){for(var e=this[Ks],t=e.length-1;t>=0;--t)e[t].undo()}},{key:"redo",value:function(){for(var e=this[Ks],t=0,n=e.length;t<n;++t)e[t].redo()}},{key:"defaultConfig",get:function(){return{title:null}}},{key:"queue",get:function(){return this[Ks].slice(0)}},{key:"length",get:function(){return this[Ks].length}}]),r}(G);function Qs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Js._$name="Transaction";var Zs=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Qs()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"canUndo",value:function(e){return 0<e.position&&e.position<=e.length}},{key:"canRedo",value:function(e){return 0<=e.position&&e.position<e.length}},{key:"onUndo",value:function(e,t){var n,r=e[Hs],i=e.position,o=Math.max(0,i-t);return[(n={},oe()(n,Ps,"restoringstate"),oe()(n,js,o),n),function(){for(e.notifyStoresAboutStateRestoringStart();i!=o;)r[--i].undo();return[e.autoRecord?"autoreadystate":"readystate",function(){e.notifyStoresAboutStateRestoringStop()}]}]}},{key:"onRedo",value:function(e,t){var n,r=e[Hs],i=e.position,o=Math.min(r.length,i+t);return[(n={},oe()(n,Ps,"restoringstate"),oe()(n,js,o),n),function(){e.notifyStoresAboutStateRestoringStart();do{r[i++].redo()}while(i!=o);return[e.autoRecord?"autoreadystate":"readystate",function(){e.notifyStoresAboutStateRestoringStop()}]}]}},{key:"onEnable",value:function(){Os()}},{key:"onDisable",value:function(){return"disabledstate"}},{key:"onAutoRecordOn",value:function(){var e;return e={},oe()(e,Ps,"autoreadystate"),oe()(e,zs,!0),e}},{key:"onAutoRecordOff",value:function(){Os()}},{key:"onStartTransaction",value:function(e,t){var n,r=new Js({title:t});return[(n={},oe()(n,Ps,"recordingstate"),oe()(n,Bs,r),n),function(){e.notifyStoresAboutStateRecordingStart(r)}]}},{key:"onStopTransaction",value:function(){Os()}},{key:"onStopTransactionDelayed",value:function(){Os()}},{key:"onRejectTransaction",value:function(){Os()}},{key:"onResetQueue",value:function(e,t){return Gs(e,t)}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),r}(_s),el=new Zs,tl=el;function nl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ws("readystate",el);var rl=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(nl()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onEnable",value:function(){}},{key:"onDisable",value:function(e){var t,n=e[Bs];return e.notifyStoresAboutStateRecordingStop(n,{disabled:!0}),t={},oe()(t,Ps,"disabledstate"),oe()(t,Bs,null),t}},{key:"onAutoRecordOn",value:function(e){var t;return[(t={},oe()(t,Ps,"autorecordingstate"),oe()(t,zs,!0),t),function(){e[Ps].onStopTransactionDelayed(e)}]}},{key:"onAutoRecordOff",value:function(){Os()}},{key:"onStartTransaction",value:function(){Os()}},{key:"onStopTransaction",value:function(e,t){var n,r=e[Bs],i=e[js],o=e[Hs];return r.length&&(r.title||t||!e.getTransactionTitle?t&&(r.title=t):r.title=e.getTransactionTitle(r),o[i]=r,o.length=++i),[(n={},oe()(n,Ps,"readystate"),oe()(n,js,i),oe()(n,Bs,null),n),function(){e.notifyStoresAboutStateRecordingStop(r,{stop:!0})}]}},{key:"onRejectTransaction",value:function(e){var t,n=e[Bs];return[(t={},oe()(t,Ps,"restoringstate"),oe()(t,Bs,null),t),function(){return n.length&&n.undo(),["readystate",function(){e.notifyStoresAboutStateRecordingStop(n,{rejected:!0})}]}]}},{key:"onStopTransactionDelayed",value:function(){Os()}},{key:"onQueueReset",value:function(){Os()}},{key:"onModelUpdate",value:function(e,t,n,r){e[Bs].addAction(e.makeModelUpdateAction(t,n,r))}},{key:"onModelInsertChild",value:function(e,t,n,r,i,o){e[Bs].addAction(e.makeModelInsertChildAction(t,n,r,i,o))}},{key:"onModelRemoveChild",value:function(e,t,n,r){e[Bs].addAction(e.makeModelRemoveChildAction(t,n,r))}},{key:"onStoreModelAdd",value:function(e,t,n,r){e[Bs].addAction(e.makeStoreModelAddAction(t,n,r))}},{key:"onStoreModelInsert",value:function(e,t,n,r,i,o){e[Bs].addAction(e.makeStoreModelInsertAction(t,n,r,i,o))}},{key:"onStoreModelRemove",value:function(e,t,n,r,i){e[Bs].addAction(e.makeStoreModelRemoveAction(t,n,r,i))}},{key:"onStoreRemoveAll",value:function(e,t,n,r){e[Bs].addAction(e.makeStoreRemoveAllAction(t,n,r))}}]),r}(_s),il=new rl,ol=il;function al(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ws("recordingstate",il);var sl=new(function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(al()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onUndo",value:function(){Os()}},{key:"onRedo",value:function(){Os()}},{key:"onEnable",value:function(){Os()}},{key:"onDisable",value:function(){Os()}},{key:"onAutoRecordOn",value:function(){return oe()({},zs,!0)}},{key:"onAutoRecordOff",value:function(){return oe()({},zs,!1)}},{key:"onStartTransaction",value:function(){Os()}},{key:"onStopTransaction",value:function(){Os()}},{key:"onStopTransactionDelayed",value:function(){Os()}},{key:"onRejectTransaction",value:function(){Os()}},{key:"onQueueReset",value:function(){Os()}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),r}(_s)),ll=sl;function cl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ws("restoringstate",sl);var ul=new(function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(cl()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onAutoRecordOn",value:function(){Os()}},{key:"onAutoRecordOff",value:function(){var e;return e={},oe()(e,Ps,"readystate"),oe()(e,zs,!1),e}},{key:"onStartTransaction",value:function(e,t){var n,r=new Js({title:t});return[(n={},oe()(n,Ps,"autorecordingstate"),oe()(n,Bs,r),n),function(){e.notifyStoresAboutStateRecordingStart(r),e.stopTransactionDelayed()}]}},{key:"onModelUpdate",value:function(e,t,n,r){e.startTransaction(),e.onModelUpdate(t,n,r)}},{key:"onModelInsertChild",value:function(e,t,n,r,i){e.startTransaction(),e.onModelInsertChild(t,n,r,i)}},{key:"onModelRemoveChild",value:function(e,t,n,r){e.startTransaction(),e.onModelRemoveChild(t,n,r)}},{key:"onStoreModelAdd",value:function(e,t,n,r){e.startTransaction(),e.onStoreModelAdd(t,n,r)}},{key:"onStoreModelInsert",value:function(e,t,n,r,i,o){e.startTransaction(),e.onStoreModelInsert(t,n,r,o)}},{key:"onStoreModelRemove",value:function(e,t,n,r,i){e.startTransaction(),e.onStoreModelRemove(t,n,r,i)}},{key:"onStoreRemoveAll",value:function(e,t,n,r){e.startTransaction(),e.onStoreRemoveAll(t,n,r)}}]),r}(Zs)),dl=ul;function fl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ws("autoreadystate",ul);var hl=new(function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(fl()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onDisable",value:function(e){var t,n=e[Bs],r=e[Ns];return r&&this.clearTimeout(r),e.notifyStoresAboutStateRecordingStop(n,{disabled:!0}),t={},oe()(t,Ps,"disabledstate"),oe()(t,Bs,null),oe()(t,Ns,null),t}},{key:"onAutoRecordOn",value:function(e){Os()}},{key:"onAutoRecordOff",value:function(e){var t,n=e[Ns];return n&&this.clearTimeout(n),t={},oe()(t,Ps,"recordingstate"),oe()(t,zs,!1),oe()(t,Ns,null),t}},{key:"onStopTransaction",value:function(e,t){var n,r=e[Bs],i=e[Ns],o=e[js],a=e[Hs];return i&&this.clearTimeout(i),r.length&&(r.title||t||!e.getTransactionTitle?t&&(r.title=t):r.title=e.getTransactionTitle(r),a[o]=r,a.length=++o),[(n={},oe()(n,Ps,"autoreadystate"),oe()(n,js,o),oe()(n,Bs,null),oe()(n,Ns,null),n),function(){e.notifyStoresAboutStateRecordingStop(r,{stop:!0})}]}},{key:"onStopTransactionDelayed",value:function(e){var t,n=e[Ns];return n&&this.clearTimeout(n),n=this.setTimeout((function(){e.stopTransaction()}),e.autoRecordTransactionStopTimeout),t={},oe()(t,Ps,hl),oe()(t,Ns,n),t}},{key:"onRejectTransaction",value:function(e){var t,n=e[Bs],r=e[Ns];return r&&this.clearTimeout(r),[(t={},oe()(t,Ps,"restoringstate"),oe()(t,Bs,null),oe()(t,Ns,null),t),function(){return n.length&&n.undo(),["autoreadystate",function(){e.notifyStoresAboutStateRecordingStop(n,{rejected:!0})}]}]}},{key:"onModelUpdate",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=se()(J()(r.prototype),"onModelUpdate",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onModelInsertChild",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=se()(J()(r.prototype),"onModelInsertChild",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onModelRemoveChild",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=se()(J()(r.prototype),"onModelRemoveChild",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelAdd",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=se()(J()(r.prototype),"onStoreModelAdd",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelInsert",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=se()(J()(r.prototype),"onStoreModelInsert",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelRemove",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=se()(J()(r.prototype),"onStoreModelRemove",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreRemoveAll",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=se()(J()(r.prototype),"onStoreRemoveAll",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}}]),r}(or(rl))),gl=hl;function vl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ws("autorecordingstate",hl);var pl=function(){throw new Error("Abstract method call!")},yl=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(vl()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"undo",value:function(){pl()}},{key:"redo",value:function(){pl()}},{key:"type",get:function(){return this.constructor.name}}]),r}(G);function ml(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}yl._$name="ActionBase";var bl=Symbol("MODEL_PROP"),kl=Symbol("NEW_DATA_PROP"),wl=Symbol("OLD_DATA_PROP"),Sl=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ml()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"undo",value:function(){this.model.set(this.oldData)}},{key:"redo",value:function(){this.model.set(this.newData)}},{key:"type",get:function(){return"UpdateAction"}},{key:"model",get:function(){return this[bl]},set:function(e){this[bl]=e}},{key:"newData",get:function(){return this[kl]},set:function(e){this[kl]=Object.assign({},e)}},{key:"oldData",get:function(){return this[wl]},set:function(e){this[wl]=Object.assign({},e)}}],[{key:"defaultConfig",get:function(){return{model:void 0,newData:void 0,oldData:void 0}}}]),r}(yl);function Cl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Sl._$name="UpdateAction";var Rl=Symbol("PARENT_MODEL_PROP"),xl=Symbol("CHILD_MODELS_PROP"),El=Symbol("INSERT_INDEX_PROP"),Dl=Symbol("CONTEXT_PROP"),Tl=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Cl()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"undo",value:function(){var e=this.parentModel,t=this.context,n=this.childModels;n.sort((function(e,n){var r=t.get(e)||{},i=r.lhsParent,o=r.lhsIndex,a=t.get(n)||{},s=a.rhsParent,l=a.rhsIndex;return i&&i===s?o-l:0})),n.forEach((function(n){var r=t.get(n)||{},i=r.parent,o=r.index;if(i)if(i===e){var a;a=o>n.parentIndex?o+1:o,a=o===i.children.length-1?null:a;var s=i.children[a];i.insertChild(n,s)}else i.insertChild(n,i.children[o]);else e.removeChild(n)}))}},{key:"redo",value:function(){var e=this.parentModel,t=this.insertIndex,n=this.childModels,r=e.children[t];e.insertChild(n,r)}},{key:"type",get:function(){return"InsertChildAction"}},{key:"parentModel",get:function(){return this[Rl]},set:function(e){this[Rl]=e}},{key:"childModels",get:function(){return this[xl]},set:function(e){this[xl]=e.slice(0)}},{key:"insertIndex",get:function(){return this[El]},set:function(e){this[El]=e}},{key:"context",get:function(){return this[Dl]},set:function(e){this[Dl]=e}}],[{key:"defaultConfig",get:function(){return{parentModel:void 0,childModels:void 0,insertIndex:void 0,context:void 0}}}]),r}(yl);function Ml(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Tl._$name="InsertChildAction";var Al=Symbol("PARENT_MODEL_PROP"),Il=Symbol("CHILD_MODELS_PROP"),Fl=Symbol("CONTEXT_PROP"),Ol=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ml()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"undo",value:function(){var e=this.parentModel,t=this.context,n=this.childModels;n.sort((function(e,n){return t.get(e)-t.get(n)})),n.forEach((function(n){e.insertChild(t.get(n),n)}))}},{key:"redo",value:function(){this.parentModel.removeChild(this.childModels)}},{key:"type",get:function(){return"RemoveChildAction"}},{key:"parentModel",get:function(){return this[Al]},set:function(e){this[Al]=e}},{key:"childModels",get:function(){return this[Il]},set:function(e){this[Il]=e.slice(0)}},{key:"context",get:function(){return this[Fl]},set:function(e){this[Fl]=e}}],[{key:"defaultConfig",get:function(){return{parentModel:void 0,childModels:void 0,context:void 0}}}]),r}(yl);function _l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ol._$name="RemoveChildAction";var Pl=Symbol("STORE_PROP"),Ll=Symbol("MODEL_LIST_PROP"),Hl=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(_l()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"undo",value:function(){this.store.remove(this.modelList,this.silent)}},{key:"redo",value:function(){this.store.add(this.modelList,this.silent)}},{key:"type",get:function(){return"AddAction"}},{key:"store",get:function(){return this[Pl]},set:function(e){this[Pl]=e}},{key:"modelList",get:function(){return this[Ll]},set:function(e){this[Ll]=e.slice(0)}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,silent:!1}}}]),r}(yl);function jl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Hl._$name="AddAction";var Bl=Symbol("STORE_PROP"),Nl=Symbol("MODEL_LIST_PROP"),zl=Symbol("INSERT_INDEX_PROP"),Vl=Symbol("CONTEXT_PROP"),Wl=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(jl()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"undo",value:function(){var e=this.store,t=this.modelList,n=this.context,r=this.silent;t.sort((function(e,t){var r=n.get(e),i=n.get(t);return void 0!==r&&void 0!==i?r-i:0})),t.forEach((function(t){var i=n.get(t);void 0!==i?e.insert(i,t,r):e.remove(t,r)}))}},{key:"redo",value:function(){this.store.insert(this.insertIndex,this.modelList,this.silent)}},{key:"type",get:function(){return"InsertAction"}},{key:"store",get:function(){return this[Bl]},set:function(e){this[Bl]=e}},{key:"modelList",get:function(){return this[Nl]},set:function(e){this[Nl]=e.slice(0)}},{key:"insertIndex",get:function(){return this[zl]},set:function(e){this[zl]=e}},{key:"context",get:function(){return this[Vl]},set:function(e){this[Vl]=e}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,insertIndex:void 0,context:void 0,silent:!1}}}]),r}(yl);function Ul(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Wl._$name="InsertAction";var Gl=Symbol("STORE_PROP"),Yl=Symbol("MODEL_LIST_PROP"),$l=Symbol("CONTEXT_PROP"),ql=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ul()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"undo",value:function(){var e=this.store,t=this.context,n=this.modelList,r=this.silent;n.sort((function(e,n){return t.get(e)-t.get(n)})),n.forEach((function(n){var i=t.get(n);e.insert(i,n,r)}))}},{key:"redo",value:function(){this.store.remove(this.modelList,this.silent)}},{key:"type",get:function(){return"RemoveAction"}},{key:"store",get:function(){return this[Gl]},set:function(e){this[Gl]=e}},{key:"modelList",get:function(){return this[Yl]},set:function(e){this[Yl]=e.slice(0)}},{key:"context",get:function(){return this[$l]},set:function(e){this[$l]=e}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,context:void 0,silent:!1}}}]),r}(yl);function Xl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ql._$name="RemoveAction";var Kl=Symbol("STORE_PROP"),Jl=Symbol("ALL_RECORDS_PROP"),Ql=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Xl()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"undo",value:function(){var e=this.store,t=this.allRecords,n=this.silent;e.add(t,n)}},{key:"redo",value:function(){this.store.removeAll(this.silent)}},{key:"type",get:function(){return"RemoveAllAction"}},{key:"store",get:function(){return this[Kl]},set:function(e){this[Kl]=e}},{key:"allRecords",get:function(){return this[Jl]},set:function(e){this[Jl]=e.slice(0)}}],[{key:"defaultConfig",get:function(){return{store:void 0,allRecords:void 0,silent:!1}}}]),r}(yl);function Zl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ql._$name="RemoveAllAction";var ec=function(e,t,n){return new Sl({model:e,newData:t,oldData:n})},tc=function(e,t,n,r){return new Tl({parentModel:e,childModels:n,insertIndex:t,context:r})},nc=function(e,t,n){return new Ol({parentModel:e,childModels:t,context:n})},rc=function(e,t,n){return new Hl({store:e,modelList:t,silent:n})},ic=function(e,t,n,r,i){return new Wl({store:e,insertIndex:t,modelList:n,context:r,silent:i})},oc=function(e,t,n,r){return new ql({store:e,modelList:t,context:n,silent:r})},ac=function(e,t,n){return new Ql({store:e,allRecords:t,silent:n})},sc=function e(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var a=n.call.apply(n,[t[Ps],t].concat(i));if("string"==typeof a)t[Ps]=Us(a);else if(a instanceof _s)t[Ps]=a;else if(Array.isArray(a)){var s=te()(a,2),l=s[0],c=s[1];"string"==typeof l?t[Ps]=Us(l):l instanceof _s?t[Ps]=l:l&&"object"===re()(l)&&((t=Object.assign(t,l))[Ps]=Us(t[Ps])),"function"==typeof c&&e.apply(void 0,[t,c].concat(i))}else a&&"object"===re()(a)&&((t=Object.assign(t,a))[Ps]=Us(t[Ps]))},lc=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Zl()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e,t,n=this;Object.assign(n,(e={},oe()(e,Ps,tl),oe()(e,Ls,[]),oe()(e,Hs,[]),oe()(e,js,0),oe()(e,Bs,null),oe()(e,Ns,null),oe()(e,zs,!1),e));for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];(t=se()(J()(r.prototype),"construct",this)).call.apply(t,[this].concat(o))}},{key:"doDestroy",value:function(){se()(J()(r.prototype),"doDestroy",this).call(this),this.destroyProperties(Ps)}},{key:"hasStore",value:function(e){return this[Ls].includes(e)}},{key:"addStore",value:function(e){this.hasStore(e)||(this[Ls].push(e),e.stm=this)}},{key:"removeStore",value:function(e){this.hasStore(e)&&(this[Ls]=this[Ls].filter((function(t){return t!==e})),e.stm=null)}},{key:"getStoreById",value:function(e){return this[Ls].find((function(t){return t.id===e}))}},{key:"forEachStore",value:function(e){this[Ls].forEach((function(t){return e(t,t.id)}))}},{key:"enable",value:function(){this.disabled=!1}},{key:"disable",value:function(){this.disabled=!0}},{key:"startTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;sc(this,this.state.onStartTransaction,e)}},{key:"stopTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;sc(this,this.state.onStopTransaction,e)}},{key:"stopTransactionDelayed",value:function(){sc(this,this.state.onStopTransactionDelayed)}},{key:"rejectTransaction",value:function(){sc(this,this.state.onRejectTransaction)}},{key:"undo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;sc(this,this.state.onUndo,e)}},{key:"undoAll",value:function(){this.undo(this.length)}},{key:"redo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;sc(this,this.state.onRedo,e)}},{key:"redoAll",value:function(){this.redo(this.length)}},{key:"resetQueue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{undo:!0,redo:!0};sc(this,this.state.onResetQueue,e)}},{key:"resetUndoQueue",value:function(){this.resetQueue({undo:!0})}},{key:"resetRedoQueue",value:function(){this.resetQueue({redo:!0})}},{key:"notifyStoresAboutStateRecordingStart",value:function(e){var t=this;this.forEachStore((function(n){n.onStmRecordingStart&&n.onStmRecordingStart(t,e)})),this.trigger("recordingStart",{stm:this,transaction:e})}},{key:"notifyStoresAboutStateRecordingStop",value:function(e,t){var n=this;this.forEachStore((function(r){r.onStmRecordingStop&&r.onStmRecordingStop(n,e,t)})),this.trigger("recordingStop",{stm:this,transaction:e,reason:t})}},{key:"notifyStoresAboutStateRestoringStart",value:function(){var e=this;this.forEachStore((function(t){t.onStmRestoringStart&&t.onStmRestoringStart(e)})),this.trigger("restoringStart",{stm:this})}},{key:"notifyStoresAboutStateRestoringStop",value:function(){var e=this;this.forEachStore((function(t){t.onStmRestoringStop&&t.onStmRestoringStop(e)})),this.trigger("restoringStop",{stm:this})}},{key:"notifyStoresAboutQueueReset",value:function(e){var t=this;this.forEachStore((function(n){n.onStmQueueReset&&n.onStmQueueReset(t,e)})),this.trigger("queueReset",{stm:this,options:e})}},{key:"onModelUpdate",value:function(e,t,n){sc(this,this.state.onModelUpdate,e,t,n)}},{key:"onModelInsertChild",value:function(e,t,n,r){sc(this,this.state.onModelInsertChild,e,t,n,r)}},{key:"onModelRemoveChild",value:function(e,t,n){sc(this,this.state.onModelRemoveChild,e,t,n)}},{key:"onStoreModelAdd",value:function(e,t,n){sc(this,this.state.onStoreModelAdd,e,t,n)}},{key:"onStoreModelInsert",value:function(e,t,n,r,i){sc(this,this.state.onStoreModelInsert,e,t,n,r,i)}},{key:"onStoreModelRemove",value:function(e,t,n,r){sc(this,this.state.onStoreModelRemove,e,t,n,r)}},{key:"onStoreRemoveAll",value:function(e,t,n){sc(this,this.state.onStoreRemoveAll,e,t,n)}},{key:"state",get:function(){return this[Ps]}},{key:"position",get:function(){return this[js]}},{key:"length",get:function(){return this[Hs].length}},{key:"stores",get:function(){return Array.from(this[Ls])}},{key:"disabled",get:function(){return this.state===qs},set:function(e){var t=this;t.disabled!=e&&sc(t,e?t.state.onDisable:t.state.onEnable,t)}},{key:"isReady",get:function(){return this.state===tl||this.state===dl}},{key:"isRecording",get:function(){return this.state===ol||this.state===gl}},{key:"autoRecord",get:function(){return this[zs]},set:function(e){var t=this;t.autoRecord!=e&&sc(t,e?t.state.onAutoRecordOn:t.state.onAutoRecordOff,t)}},{key:"transaction",get:function(){return this[Bs]}},{key:"queue",get:function(){return this[Hs].map((function(e){return e.title}))}},{key:"isRestoring",get:function(){return this.state===ll}},{key:"canUndo",get:function(){return this.state.canUndo(this)}},{key:"canRedo",get:function(){return this.state.canRedo(this)}}],[{key:"defaultConfig",get:function(){return{disabled:!0,autoRecord:!1,autoRecordTransactionStopTimeout:100,makeModelUpdateAction:ec,makeModelInsertChildAction:tc,makeModelRemoveChildAction:nc,makeStoreModelAddAction:rc,makeStoreModelInsertAction:ic,makeStoreModelRemoveAction:oc,makeStoreRemoveAllAction:ac,getTransactionTitle:null}}}]),r}(pe(G));lc._$name="StateTrackingManager";var cc=function(){function e(){D()(this,e)}return M()(e,null,[{key:"insertRule",value:function(e){var t=this.styleSheet,n=t.cssRules.length;if(t.insertRule(e,0),t.cssRules.length>n)return t.cssRules[0]}},{key:"findRule",value:function(e){var t,n="function"==typeof e;return Array.prototype.find.call(document.head.querySelectorAll("link[rel=stylesheet],style[type*=css]"),(function(r){if(t=Array.prototype.find.call(r.sheet.rules||r.sheet.cssRules,(function(t){return n?e(t):t.selectorText===e})))return!0})),t}},{key:"styleSheet",get:function(){return this._stylesheet||(this._stylesheet=on.createElement({tag:"style",id:"bryntum-private-styles",type:"text/css",parent:document.head}).sheet),this._stylesheet}}]),e}();cc._$name="CSSHelper";var uc=Array.prototype.slice,dc={ignore:{_element:1,parent:1,elementData:1,ns:1},evaluate:function(e,t,n){if("html"===e&&"string"!=typeof t.value&&"compareHtml"in t.object)return t.object.compareHtml===n.object.compareHtml}},fc={tag:1,html:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,_element:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,isReleased:1},hc={class:1,className:1,classname:1},gc=Object.freeze([]),vc=function(){function e(){D()(this,e)}return M()(e,null,[{key:"sync",value:function(e){return this.performSync(e,e.targetElement),e.targetElement}},{key:"performSync",value:function(e,t){var n=e.domConfig,r=e.callback;return(e.configEquality?e.configEquality(n,t.lastDomConfig,dc):mt.isDeeplyEqual(n,t.lastDomConfig,dc))?(this.relinkElements(n,t),r&&r({action:"none",domConfig:n,targetElement:t}),!1):(n?(n.onlyChildren||(this.syncAttributes(n,t),this.syncContent(n,t)),this.syncChildren(e,t),n._element=t):(t.innerHTML=null,t.syncIdMap=null),t.lastDomConfig=n,!0)}},{key:"relinkElements",value:function(e,t){var n=this;e._element=t,e.children&&e.children.forEach((function(e,r){e&&"string"!=typeof e&&n.relinkElements(e,t.lastDomConfig.children[r]._element)}))}},{key:"syncDataset",value:function(e,t){for(var n=t.lastDomConfig,r=e===n,i=Object.keys(e.dataset),o=n&&n.dataset&&Object.keys(n.dataset),a=ue.delta(i,o),s=0;s<a.onlyInA.length;s++){var l=a.onlyInA[s];t.setAttribute("data-".concat(L.hyphenate(l)),e.dataset[l])}for(var c=0;c<a.inBoth.length;c++){var u=a.inBoth[c];(r||e.dataset[u]!=n.dataset[u])&&t.setAttribute("data-".concat(L.hyphenate(u)),e.dataset[u])}for(var d=0;d<a.onlyInB.length;d++)t.removeAttribute("data-".concat(L.hyphenate(a.onlyInB[d])))}},{key:"syncClassList",value:function(e,t){var n=e.className||e.class,r="object"===re()(n)?mt.getTruthyKeys(n).join(" "):n;t.setAttribute("class",r)}},{key:"getSyncAttributes",value:function(e){var t={},n=[];return e&&Object.keys(e).forEach((function(r){if(!fc[r]){var i=r.toLowerCase();t[i]=e[r],n.push(i)}})),{attributes:t,names:n}}},{key:"syncAttributes",value:function(e,t){for(var n=t.lastDomConfig,r=e===n,i=this.getSyncAttributes(e),o=i.attributes,a=i.names,s=r?i:this.getSyncAttributes(n),l=s.attributes,c=s.names,u=r?{onlyInA:gc,onlyInB:gc,inBoth:a}:ue.delta(a,c),d=u.onlyInA,f=u.onlyInB,h=u.inBoth,g=0;g<d.length;g++){var v=d[g],p=o[v];"style"===v?on.applyStyle(t,p,!0):"dataset"===v?this.syncDataset(e,t):hc[v]?this.syncClassList(e,t):t.setAttribute(v,p)}for(var y=0;y<f.length;y++)t.removeAttribute(f[y]);for(var m=0;m<h.length;m++){var b=h[m],k=o[b],w=l[b];null==k?t.removeAttribute(b):"style"===b?!r&&mt.isEqual(k,w,!0)||on.applyStyle(t,k,!0):"dataset"===b?this.syncDataset(e,t):hc[b]?this.syncClassList(e,t):(r||k!==w)&&t.setAttribute(b,k)}}},{key:"syncContent",value:function(e,t){var n=e.html;e.elementData&&(t.elementData=e.elementData),null!=n&&(n instanceof DocumentFragment?1===t.childNodes.length&&0===t.childElementCount&&1===n.childNodes.length&&0===n.childElementCount?on.setInnerText(t,n.firstChild.data):(t.innerHTML="",t.appendChild(n)):String(n).includes("<")?t.innerHTML=n:on.setInnerText(t,n))}},{key:"appendTextNode",value:function(e,t,n){var r=document.createTextNode(e);t.appendChild(r),n&&n({action:"newNode",domConfig:e,targetElement:r})}},{key:"insertElement",value:function(e,t,n,r,i){var o=i.ns?document.createElementNS(i.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(o,n),this.performSync(i,o),null!=r&&(t.syncIdMap[r]=o),i.callback&&i.callback({action:"newElement",domConfig:e,targetElement:o,syncId:r})}},{key:"syncChildren",value:function(e,t){var n=e.domConfig,r=e.syncIdField,i=e.callback,o=e.releaseThreshold,a=e.configEquality,s=e.ns;if(!n.html){var l,c=uc.call(n.children||[]),u=uc.call(t.childNodes),d=t.syncIdMap||{},f=n.syncOptions||{};r=f.syncIdField||r,i=f.callback||i,a=f.configEquality||a,o="releaseThreshold"in f?f.releaseThreshold:o,r&&(t.syncIdMap={});for(var h={syncIdField:r,releaseThreshold:o,callback:i,configEquality:a};c.length;){var g=c.shift();if(l=null,g){var v="string"==typeof g;if(h.domConfig=g,h.ns=g.ns||s,!v){if(r&&g.dataset&&null!=(l=g.dataset[r])&&!g.unmatched){var p=d[l];p?(!g.retainElement&&this.performSync(h,p)&&i&&i({action:"reuseOwnElement",domConfig:g,targetElement:p,syncId:l}),g.retainElement?(p.retainElement=!0,g._element=p):p.retainElement&&(p.retainElement=!1),t.syncIdMap[l]=p,ue.remove(u,p),p.isReleased=!1):(c.push(g),g.unmatched=!0);continue}g.unmatched&&delete g.unmatched}for(var y=void 0,m=0;m<u.length&&!y;m++)u[m].retainElement||(y=u[m],0===m?u.shift():u.splice(m,1));if(y)if(y.nodeType===Node.ELEMENT_NODE&&(g.tag||"div").toLowerCase()===y.tagName.toLowerCase()){var b=y.lastDomConfig,k=this.performSync(h,y);null!=l&&(t.syncIdMap[l]=y),y.isReleased=!1,k&&i&&i({action:"reuseElement",domConfig:g,lastDomConfig:b,targetElement:y,syncId:l})}else v&&y.nodeType===Node.TEXT_NODE?y.data=g:(v?this.appendTextNode(g,t,i):this.insertElement(g,t,y,l,h),y.remove());else v?this.appendTextNode(g,t,i):this.insertElement(g,t,null,l,h)}}var w=0;u.forEach((function(e){var n=e.lastDomConfig;e.retainElement?r&&e.lastDomConfig&&(t.syncIdMap[e.dataset[r]]=e):r&&(null==o||w<o)?(e.isReleased||(e.className="b-released",e.isReleased=!0,i&&i({action:"releaseElement",domConfig:n,lastDomConfig:n,targetElement:e}),n&&(n.isReleased=!0,n.className&&(n.className="b-released")),e.elementData=e.lastConfig=null),w++):(e.remove(),i&&i({action:"removeElement",domConfig:e.lastDomConfig,lastDomConfig:e.lastDomConfig,targetElement:e}))}))}}}]),e}();function pc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}vc._$name="DomSync";function yc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var mc={pageXOffset:0,pageYOffset:0};function bc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var kc="onMouseDown",wc="onMouseMove",Sc="onMouseUp",Cc="onDocumentClick",Rc="onTouchStart",xc="onTouchMove",Ec="onTouchEnd",Dc="onKeyDown",Tc=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(bc()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).call(this,e),t.initListeners(),"container"===t.mode?t.initContainerDrag():t.mode.startsWith("translate")&&t.initTranslateDrag()}},{key:"doDestroy",value:function(){this.abort(!0),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"initListeners",value:function(){var e={element:this.outerElement,mousedown:kc,thisObj:this};Re.isTouchDevice&&(e.touchstart=Rc),Kn.on(e)}},{key:"onPointerDown",value:function(e){var t=this,n=!1,r="touches"in e;if(t.context)t.context.awaitingFinalization||(t.onMouseUp(e),t.reset());else if(t.startEvent=e,(!t.isElementDraggable||t.isElementDraggable(e.target,e))&&(t.mode&&(n||"container"!==t.mode||(n=t.grabContainerDrag(e)),!n&&t.mode.startsWith("translate")&&(n=t.grabTranslateDrag(e))),n)){var i={element:document,thisObj:t,keydown:Dc};if(r?(i.touchmove={handler:xc,passive:!1},i.touchend=i.pointerup=Ec):(i.mousemove=wc,i.mouseup=Sc),t.removeListeners=Kn.on(i),t.dragWithin&&t.dragWithin!==t.outerElement){var o=t.dragWithin.getBoundingClientRect();t.minY=o.top,t.maxY=o.bottom,t.minX=o.left,t.maxX=o.right}}}},{key:"onTouchStart",value:function(e){var t=this;1===e.touches.length&&(t.touchStartTimer=t.setTimeout((function(){t.touchStartTimer=null}),t.touchStartDelay),t.onPointerDown(e))}},{key:"onMouseDown",value:function(e){0===e.button&&this.onPointerDown(e)}},{key:"internalMove",value:function(e){var t=this,n=t.context,r=Kn.getDistanceBetween(t.startEvent,e);if(t.touchStartTimer&&r>t.dragThreshold)t.abort(!0);else if(!t.touchStartTimer&&n&&n.element&&e.target&&e.target.nodeType===Node.ELEMENT_NODE&&(n.started||r>=t.dragThreshold)){if(!n.started&&!1===t.callPreventable("dragStart",{context:n,event:e},(function(){"container"!==t.mode&&(t.lockY?t.mode="translateX":t.lockX&&(t.mode="translateY"));var r=t.lockX?"vertical":t.lockY?"horizontal":"both";n.action.startsWith("translate")?t.startTranslateDrag(e):"container"===n.action&&t.startContainerDrag(e),n.started=!0,t.scrollManager&&t.scrollManager.startMonitoring({direction:r,element:t.dragWithin||t.outerElement,callback:function(e){t.context.element&&t.lastMouseMoveEvent&&(t.lastMouseMoveEvent.isScroll=!0,t.update(t.lastMouseMoveEvent,e))},thisObj:t}),document.body.classList.add("b-draghelper-active")})))return t.abort();"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation()),t.update(e)}}},{key:"onTouchMove",value:function(e){this.internalMove(e)}},{key:"onMouseMove",value:function(e){this.internalMove(e)}},{key:"update",value:function(e,t){var n=this,r=n.context,i=r.dragProxy||r.element,o=e.target,a=document.scrollingElement||document.body;if("touchmove"===e.type){var s=e.changedTouches[0];o=on.elementFromPoint(s.clientX+a.scrollLeft,s.clientY+a.scrollTop)}r.target=o,n.dropTargetSelector?r.valid=Boolean(o.closest(n.dropTargetSelector)):r.valid=!0,r.action&&("container"===r.action&&n.updateContainerProxy(e,t),r.action.startsWith("translate")&&n.updateTranslateProxy(e,t)),n.trigger("drag",{context:r,event:e}),"container"===r.action&&n.updateContainerDrag(e,t),i.classList[r.valid?"remove":"add"](n.invalidCls),e&&(n.lastMouseMoveEvent=e)}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.context;t.scrollManager&&t.scrollManager.stopMonitoring(t.dragWithin||t.outerElement),n&&(n.element.getBoundingClientRect(),n.valid=!1,"container"===n.action?t.abortContainerDrag(void 0,void 0,e):t.abortTranslateDrag(void 0,void 0,e)),t.reset()}},{key:"removeListeners",value:function(){}},{key:"reset",value:function(e){document.body.classList.remove("b-draghelper-active"),this.removeListeners(),e||this.trigger("reset"),this.context=this.lastMouseMoveEvent=null}},{key:"onTouchEnd",value:function(e){this.onMouseUp(e)}},{key:"onDocumentClick",value:function(e){e.stopPropagation()}},{key:"onMouseUp",value:function(e){var t=this,n=t.context;t.removeListeners(),n&&(t.scrollManager&&t.scrollManager.stopMonitoring(t.dragWithin||t.outerElement),"container"===n.action?t.finishContainerDrag(e):n.started&&n.action.startsWith("translate")&&t.finishTranslateDrag(e),n.started?Kn.on({element:document,thisObj:t,click:Cc,capture:!0,expires:t.clickSwallowDuration,once:!0}):t.reset(!0))}},{key:"onKeyDown",value:function(e){"Escape"===e.key&&this.abort()}},{key:"createProxy",value:function(e){var t=e.cloneNode(!0);return t.removeAttribute("id"),t}}],[{key:"defaultConfig",get:function(){return{dragProxyCls:"b-drag-proxy",invalidCls:"b-drag-invalid",draggingCls:"b-dragging",dropPlaceholderCls:"b-drop-placeholder",dragThreshold:5,outerElement:document.body,dragWithin:null,constrain:!0,minX:null,maxX:null,minY:null,maxY:null,mode:null,isElementDraggable:null,targetSelector:null,dropTargetSelector:null,cloneTarget:!1,hideOriginalElement:!1,containers:null,ignoreSelector:null,startEvent:null,lockX:!1,lockY:!1,touchStartDelay:300,transitionDuration:300,clickSwallowDuration:50,ignoreSamePositionDrop:!0,testConfig:{transitionDuration:10,clickSwallowDuration:Re.isEdge?300:50}}}}]),r}(Fo(G).mixes(pe,(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(pc()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"initContainerDrag",value:function(){if(this.mode||(this.mode="container"),"container"===this.mode&&!this.containers)throw new Error("Container drag mode must specify containers")}},{key:"grabContainerDrag",value:function(e){var t=this;if(!t.ignoreSelector||!on.up(e.target,t.ignoreSelector)){var n=on.getAncestor(e.target,t.containers,t.outerElement);if(n){var r=n.getBoundingClientRect();t.context={element:n,valid:!0,action:"container",offsetX:e.pageX-r.left,offsetY:e.pageY-r.top,originalPosition:{parent:n.parentElement,prev:n.previousElementSibling,next:n.nextElementSibling}}}return!0}return!1}},{key:"startContainerDrag",value:function(e){var t=this.context,n=t.element,r=n.cloneNode(!0),i=n.getBoundingClientRect();r.classList.add(this.dragProxyCls),r.classList.add(this.draggingCls),document.body.appendChild(r),t.dragProxy=r,r.style.width=i.width+"px",r.style.height=i.height+"px",on.setTranslateXY(t.dragProxy,i.left,i.top),t.dragging=n,n.classList.add(this.dropPlaceholderCls)}},{key:"updateContainerDrag",value:function(e){var t=this.context;if(t.started&&t.targetElement){var n=on.getAncestor(t.targetElement,this.containers,"b-grid"),r=t.dragging&&t.dragging.contains(document.activeElement);n&&on.isDescendant(t.element,n)||(r&&Gr.suspendFocusEvents(),n&&t.valid?this.moveNextTo(n,e):this.revertPosition(),r&&Gr.resumeFocusEvents(),e.preventDefault())}}},{key:"finishContainerDrag",value:function(e){var t=this,n=this,r=n.context,i=r.dragging,o=r.dragProxy,a=r.valid,s=r.draggedTo,l=r.insertBefore,c=r.originalPosition;i&&(r.valid=a&&s&&(i!==l||c.parent!==s),r.finalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.valid;!e&&t.context&&n.revertPosition(),i.classList.remove(n.dropPlaceholderCls),o.remove(),n.reset()},r.async=!1,n.trigger("drop",{context:r,event:e}),r.async?r.awaitingFinalization=!0:r.finalize())}},{key:"abortContainerDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.context;i.dragging&&(i.dragging.classList.remove(r.dropPlaceholderCls),i.dragProxy.remove(),r.context={}),n||r.trigger(e?"drop":"abort",{context:i,event:t})}},{key:"updateContainerProxy",value:function(e){var t,n=this,r=n.context,i=r.dragProxy,o=e.pageX-r.offsetX,a=e.pageY-r.offsetY;if("number"==typeof n.minX&&(o=Math.max(n.minX,o)),"number"==typeof n.maxX&&(o=Math.min(n.maxX-i.offsetWidth,o)),"number"==typeof n.minY&&(a=Math.max(n.minY,a)),"number"==typeof n.maxY&&(a=Math.min(n.maxY-i.offsetHeight,a)),n.lockX?on.setTranslateY(i,a):n.lockY?on.setTranslateX(i,o):on.setTranslateXY(i,o,a),"touchmove"===e.type){var s=e.changedTouches[0];t=document.elementFromPoint(s.clientX,s.clientY)}else t=e.target;r.targetElement=t}},{key:"moveNextTo",value:function(e,t){var n=this.context,r=n.dragging,i=e.parentElement;if(e!==r){var o=e.getBoundingClientRect().left+e.offsetWidth/2;t.pageX<o?(i.insertBefore(r,e),n.insertBefore=e):e.nextElementSibling?e.nextElementSibling!==r?(n.insertBefore=e.nextElementSibling,i.insertBefore(r,e.nextElementSibling)):n.insertBefore||r.parentElement.lastElementChild===r||(n.insertBefore=e.nextElementSibling):(i.appendChild(r),n.insertBefore=null),n.draggedTo=i}}},{key:"revertPosition",value:function(){var e=this.context,t=e.originalPosition;t.next?t.next&&t.next.previousSibling===e.dragging||!t.next&&e.dragging===t.parent.lastChild||t.parent.insertBefore(e.dragging,t.next):t.parent.appendChild(e.dragging);e.draggedTo=null}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(yc()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"initTranslateDrag",value:function(){var e=this;!e.isElementDraggable&&e.targetSelector&&(e.isElementDraggable=function(t){return on.up(t,e.targetSelector)})}},{key:"grabTranslateDrag",value:function(e){var t=this.getTarget(e);return!!t&&(this.context={valid:!0,action:this.mode,element:t,startPageX:e.pageX,startPageY:e.pageY,startClientX:e.clientX,startClientY:e.clientY},!0)}},{key:"getTarget",value:function(e){return on.up(e.target,this.targetSelector)}},{key:"startTranslateDrag",value:function(e){var t=this,n=t.context,r=n.relatedElements,i=n.dragProxy||n.element;if(i&&!n.started){var o=i,a=i.parentElement,s=t.dragWithin=t.dragWithin||t.cloneTarget&&document.body,l=t.outerElement;if(t.cloneTarget){var c=on.getOffsetX(i,s),u=on.getOffsetY(i,s),d=i.offsetWidth,f=i.offsetHeight;i=this.createProxy(i),on.setTranslateXY(i,c,u),i.style.width="".concat(d,"px"),i.style.height="".concat(f,"px"),i.classList.add(t.dragProxyCls),s.appendChild(i),o.classList.add("b-drag-original"),t.hideOriginalElement&&o.classList.add("b-hidden")}Object.assign(t.context,{element:i,grabbed:o,grabbedParent:a,grabbedNextSibling:i.nextElementSibling,elementStartX:on.getTranslateX(i),elementStartY:on.getTranslateY(i),elementX:on.getOffsetX(i,s||l),elementY:on.getOffsetY(i,s||l),scrollX:0,scrollY:0,scrollManagerElementContainsDragProxy:!t.cloneTarget||s===l}),i.classList.add(t.draggingCls),s&&(n.parentElement=i.parentElement,s!==i.parentElement&&s.appendChild(i),t.updateTranslateProxy(e)),r&&r.forEach((function(e){e.classList.add(t.draggingCls)}))}}},{key:"applyConstraints",value:function(e,t,n){var r=this,i=r.dragWithin,o=i===document.body?window:mc,a=o.pageXOffset,s=o.pageYOffset;return i&&r.constrain&&(t<0&&(t=0),t+e.offsetWidth>i.scrollWidth&&(t=i.scrollWidth-e.offsetWidth),n<0&&(n=0),n+e.offsetHeight>i.scrollHeight&&(n=i.scrollHeight-e.offsetHeight)),"number"==typeof r.minX&&(t=Math.max(r.minX+a,t)),"number"==typeof r.maxX&&(t=Math.min(r.maxX+a,t)),"number"==typeof r.minY&&(n=Math.max(r.minY+s,n)),"number"==typeof r.maxY&&(n=Math.min(r.maxY+s,n)),{constrainedX:t,constrainedY:n}}},{key:"updateTranslateProxy",value:function(e,t){var n=this,r=n.mode,i=n.lockX,o=n.lockY,a=n.context,s=a.dragProxy||a.element,l=a.relatedElements,c=a.relatedElDragFromPos;a.scrollManagerElementContainsDragProxy&&t&&(a.scrollX=t.scrollRelativeLeft,a.scrollY=t.scrollRelativeTop),a.pageX=e.pageX,a.pageY=e.pageY,a.clientX=e.clientX,a.clientY=e.clientY;var u=a.elementStartX+e.pageX-a.startPageX+a.scrollX,d=a.elementStartY+e.pageY-a.startPageY+a.scrollY,f=n.applyConstraints(s,u,d),h=f.constrainedX,g=f.constrainedY;if("translateXY"!==r||i||o?"translateX"===r||o?on.setTranslateX(s,h):("translateY"===r||i)&&on.setTranslateY(s,g):on.setTranslateXY(s,h,g),l){var v=i||"translateY"===r?0:h-a.elementStartX,p=o||"translateX"===r?0:g-a.elementStartY;l.forEach((function(e,t){var n=te()(c[t],2),r=n[0],i=n[1];on.setTranslateXY(e,r+v,i+p)}))}a.newX=h,a.newY=g}},{key:"finishTranslateDrag",value:function(e){var t=this,n=t.context,r=n.newX!==n.elementStartX,i=n.newY!==n.elementStartY,o=n.dragProxy||n.element,a=n.relatedElements;function s(){o.classList.remove(t.invalidCls),o.classList.remove(t.draggingCls),a&&a.forEach((function(e){e.classList.remove(t.invalidCls),e.classList.remove(t.draggingCls)})),o.classList.contains("b-aborting")||(t.hideOriginalElement&&n.grabbed.classList.remove("b-hidden"),n.grabbed.classList.remove("b-drag-original"))}if(!t.ignoreSamePositionDrop||"translateY"!==t.mode&&r||"translateX"!==t.mode&&i){if(!1===n.valid)t.abortTranslateDrag(!0,e);else{var l=In.from(t.dragWithin||t.outerElement);!t.minX&&e.pageX<l.left||!t.maxX&&e.pageX>l.right||!t.minY&&e.pageY<l.top||!t.maxY&&e.pageY>l.bottom?(n.valid=!1,t.abortTranslateDrag(!0,e)):(n.finalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.valid;n.asyncCleanup&&s(),!e&&t.context?t.abortTranslateDrag(!0,null,!0):(t.cloneTarget||n.dragProxy)&&o.remove(),t.reset()},n.async=!1,t.trigger("drop",{context:n,event:e}),n.async?n.awaitingFinalization=!0:n.finalize())}n.asyncCleanup||s()}else t.abortTranslateDrag(!1,e)}},{key:"abortTranslateDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.context,o=i.relatedElements,a=i.relatedElStartPos,s=i.grabbed,l=i.dragProxy||i.element,c=r.cloneTarget&&r.hideOriginalElement?s:l,u=i.elementStartX,d=i.elementStartY;if(l&&i.started){if(!r.cloneTarget&&r.dragWithin&&r.dragWithin!==i.grabbedParent&&i.grabbedParent.insertBefore(l,i.grabbedNextSibling),s.classList.remove("b-hidden"),r.cloneTarget){if(r.hideOriginalElement){var f=on.getTranslateXY(s),h=te()(f,2);u=h[0],d=h[1],on.alignTo(s,l),c.getBoundingClientRect()}l.remove()}c.classList.add("b-aborting"),"translateXY"!==r.mode||r.lockX||r.lockY||(on.setTranslateXY(c,u,d),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),on.setTranslateXY(e,a[t][0],a[t][1])}))),("translateX"===r.mode||r.lockY)&&(on.setTranslateX(c,u),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),on.setTranslateX(e,a[t][0])}))),("translateY"===r.mode||r.lockX)&&(on.setTranslateY(c,d),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),on.setTranslateY(e,a[t][1])}))),r.setTimeout((function(){c.classList.remove("b-aborting"),s.classList.remove("b-dragging"),s.classList.remove("b-drag-original"),r.cloneTarget||(o&&o.forEach((function(e,t){e.classList.remove("b-aborting")})),l.classList.remove("b-aborting"),l.classList.remove(r.draggingCls),l.classList.remove(r.invalidCls))}),r.transitionDuration,void 0,!0),n||r.trigger(e?"drop":"abort",{context:i,event:t})}r.reset()}}]),r}(or(e||G))})));function Mc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Tc._$name="DragHelper";var Ac="onMouseDown",Ic="onMouseMove",Fc="onMouseUp",Oc="onDocumentClick",_c="onTouchStart",Pc="onTouchMove",Lc="onTouchEnd",Hc="onKeyDown",jc=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Mc()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).call(this,e),!t.handleSelector&&Re.isTouchDevice&&(t.handleSize=t.touchHandleSize),t.handleVisibilityThreshold=t.handleVisibilityThreshold||2*t.handleSize,t.initListeners(),t.initResize()}},{key:"doDestroy",value:function(){this.abort(!0),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"initResize",value:function(){var e=this;if(!e.isElementResizable&&e.targetSelector&&(e.isElementResizable=function(t){return on.up(t,e.targetSelector)}),e.grab){var t=e.grab,n=t.edge,r=t.element,i=t.event;e.startEvent=i,e.context={element:r,edge:n,valid:!0,async:!1,elementStartX:on.getTranslateX(r)||r.offsetLeft,elementStartY:on.getTranslateY(r)||r.offsetTop,newX:on.getTranslateX(r)||r.offsetLeft,newY:on.getTranslateY(r)||r.offsetTop,elementWidth:r.offsetWidth,elementHeight:r.offsetHeight,startX:i.clientX+e.scrollLeft,startY:i.clientY+e.scrollTop,started:!0,finalize:function(){return e.reset&&e.reset()}},r.classList.add(e.resizingCls),e.internalStartResize(e.isTouch)}}},{key:"initListeners",value:function(){var e=this,t={element:e.outerElement,mousedown:Ac,thisObj:e};Re.isTouchDevice?t.touchstart=_c:e.handleSelector||(t.mousemove={handler:Ic,delegate:e.targetSelector},t.mouseleave={handler:"onMouseLeaveTarget",delegate:e.targetSelector,capture:!0}),e.removeListeners=Kn.on(t)}},{key:"removeListeners",value:function(){}},{key:"internalStartResize",value:function(e){var t=this,n={element:document,keydown:Hc,thisObj:t};e?(n.touchmove=Pc,n.touchend=n.pointerup=Lc):(n.mousemove=Ic,n.mouseup=Fc),t.removeDragListeners=Kn.on(n),t.scrollManager&&t.scrollManager.startMonitoring({direction:t.direction,element:t.dragWithin||t.outerElement,callback:function(e){return t.context&&t.context.element&&t.lastMouseMoveEvent&&t.update(t.lastMouseMoveEvent,e)},thisObj:t})}},{key:"removeDragListeners",value:function(){}},{key:"reset",value:function(){this.removeDragListeners(),this.context=null}},{key:"onPointerDown",value:function(e,t){var n=this;n.startEvent=t,n.isElementResizable&&!n.isElementResizable(t.target,t)||n.grabResizeHandle(e,t)&&(t.stopImmediatePropagation(),n.internalStartResize(e))}},{key:"onTouchStart",value:function(e){e.touches.length>1||this.onPointerDown(!0,e)}},{key:"onMouseDown",value:function(e){0===e.button&&this.onPointerDown(!1,e)}},{key:"internalMove",value:function(e,t){var n=this,r=n.context;r&&r.element&&(r.started||Kn.getDistanceBetween(n.startEvent,t)>=n.dragThreshold)?(r.started||(n.trigger("resizeStart",{context:r,event:t}),r.started=!0),n.update(t)):e||n.handleSelector||n.checkResizeHandles(t)}},{key:"onTouchMove",value:function(e){this.internalMove(!0,e)}},{key:"onMouseMove",value:function(e){this.internalMove(!1,e)}},{key:"internalEnd",value:function(e,t){var n=this,r=n.context;n.removeDragListeners(),r&&(n.scrollManager&&n.scrollManager.stopMonitoring(n.dragWithin||n.outerElement),n.finishResize(t),!n.context||Re.isFirefox||Re.isSafari||Kn.on({element:document,thisObj:n,click:Oc,capture:!0,once:!0}))}},{key:"onTouchEnd",value:function(e){this.internalEnd(!0,e)}},{key:"onMouseUp",value:function(e){this.internalEnd(!1,e)}},{key:"onDocumentClick",value:function(e){e.stopPropagation()}},{key:"onKeyDown",value:function(e){"Escape"===e.key&&this.abort()}},{key:"update",value:function(e){var t=this,n=t.context,r=In.from(t.outerElement.parentElement);n.currentX=Math.max(Math.min(e.clientX,r.right-1),r.x)+t.scrollLeft,n.currentY=Math.max(Math.min(e.clientY,r.bottom-1),r.y)+t.scrollTop,t.updateResize(e),t.trigger("resizing",{context:n,event:e}),n.element.classList[!1===n.valid?"add":"remove"](t.invalidCls),e&&(t.lastMouseMoveEvent=e)}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.scrollManager&&t.scrollManager.stopMonitoring(t.dragWithin||t.outerElement),t.context&&t.abortResize(null,e)}},{key:"grabResizeHandle",value:function(e,t){var n=this;if(n.allowResize&&!n.allowResize(t.target,t))return!1;var r=n.handleSelector,i="touchstart"===t.type?t.changedTouches[0]:t,o=i.clientX,a=i.clientY,s=n.targetSelector?on.up(t.target,n.targetSelector):t.target;if(s){var l;if(r){if(!t.target.matches(r))return!1;l="horizontal"===n.direction?t.pageX<on.getPageX(s)+s.offsetWidth/2?"left":"right":t.pageY<on.getPageY(s)+s.offsetHeight/2?"top":"bottom"}else if("horizontal"===n.direction?n.overLeftHandle(t,s)?l="left":n.overRightHandle(t,s)&&(l="right"):n.overTopHandle(t,s)?l="top":n.overBottomHandle(t,s)&&(l="bottom"),!l)return n.context=null,!1;if("touchstart"===t.type&&t.preventDefault(),!1!==n.trigger("beforeResizeStart",{element:s,event:t}))return n.context={element:s,edge:l,valid:!0,async:!1,direction:n.direction,isTouch:e,elementStartX:on.getTranslateX(s)||s.offsetLeft,elementStartY:on.getTranslateY(s)||s.offsetTop,newX:on.getTranslateX(s)||s.offsetLeft,newY:on.getTranslateY(s)||s.offsetTop,elementWidth:s.offsetWidth,elementHeight:s.offsetHeight,startX:o+n.scrollLeft,startY:a+n.scrollTop,finalize:function(){return n.reset&&n.reset()}},s.classList.add(n.resizingCls),!0}return!1}},{key:"checkResizeHandles",value:function(e){var t=this,n=t.targetSelector?on.up(e.target,t.targetSelector):e.target;if(!n||t.allowResize&&!t.allowResize(e.target,e))t.currentElement&&t.unHighlightHandle();else if(t.currentElement=t.handleContainerSelector?on.up(e.target,t.handleContainerSelector):e.target,t.currentElement){("horizontal"===t.direction?t.overLeftHandle(e,n)||t.overRightHandle(e,n):t.overTopHandle(e,n)||t.overBottomHandle(e,n))?t.highlightHandle():t.unHighlightHandle()}}},{key:"onMouseLeaveTarget",value:function(e){var t=this;t.currentElement=t.handleContainerSelector?on.up(e.target,t.handleContainerSelector):e.target,t.currentElement&&t.unHighlightHandle()}},{key:"updateResize",value:function(e){var t=this,n=t.context;t.allowEdgeSwitch&&("horizontal"===t.direction?n.edge=n.currentX>n.startX?"right":"left":n.edge=n.currentY>n.startY?"bottom":"top");var r=n.currentX-n.startX,i=n.currentY-n.startY,o=on.getExtremalSizePX(n.element,"minWidth")||t.minWidth,a=on.getExtremalSizePX(n.element,"maxWidth")||t.maxWidth,s=on.getExtremalSizePX(n.element,"minHeight")||t.minHeight,l=on.getExtremalSizePX(n.element,"maxHeight")||t.maxHeight,c="right"===n.edge||"bottom"===n.edge?1:-1,u=n.elementWidth+r*c,d=Math.max(o,u),f=n.elementHeight+i*c,h=Math.max(s,f);a>0&&(d=Math.min(d,a)),l>0&&(h=Math.min(h,l)),n.element.style.flex&&(n.element.style.flex=""),"horizontal"===t.direction?(n.element.style.width=Math.abs(d)+"px",n.newWidth=d,"left"===n.edge||d<0?(n.newX=Math.max(Math.min(n.elementStartX+n.elementWidth-t.minWidth,n.elementStartX+r),0),t.skipTranslate||on.setTranslateX(n.element,n.newX)):"right"===n.edge&&t.allowEdgeSwitch&&!t.skipTranslate&&on.setTranslateX(n.element,n.elementStartX)):(n.element.style.height=Math.abs(h)+"px",n.newHeight=h,"top"===n.edge||h<0?(n.newY=Math.max(Math.min(n.elementStartY+n.elementHeight-t.minHeight,n.elementStartY+i),0),t.skipTranslate||on.setTranslateY(n.element,n.newY)):"bottom"===n.edge&&t.allowEdgeSwitch&&!t.skipTranslate&&on.setTranslateY(n.element,n.elementStartY))}},{key:"finishResize",value:function(e){var t=this.context,n={context:t,event:e};t.element.classList.remove(this.resizingCls);var r=!1;r="horizontal"===this.direction?t.newWidth&&t.newWidth!==t.elementWidth:t.newHeight&&t.newHeight!==t.elementHeight,this.trigger(r?"resize":"cancel",n),t.async||t.finalize()}},{key:"abortResize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.context;r.element.classList.remove(n.resizingCls),"horizontal"===n.direction?(on.setTranslateX(r.element,r.elementStartX),r.element.style.width=r.elementWidth+"px"):(on.setTranslateY(r.element,r.elementStartY),r.element.style.height=r.elementHeight+"px"),!t&&n.trigger("cancel",{context:r,event:e}),n.isDestroyed||n.reset()}},{key:"highlightHandle",value:function(){var e=this,t=e.targetSelector?on.up(e.currentElement,e.targetSelector):e.currentElement;e.currentElement.classList.add("b-resize-handle"),t.classList.add("b-over-resize-handle")}},{key:"unHighlightHandle",value:function(){var e=this,t=e.targetSelector?on.up(e.currentElement,e.targetSelector):e.currentElement;t&&t.classList.remove("b-over-resize-handle"),e.currentElement.classList.remove("b-resize-handle"),e.currentElement=null}},{key:"overAnyHandle",value:function(e,t){return this.overStartHandle(e,t)||this.overEndHandle(e,t)}},{key:"overStartHandle",value:function(e,t){return"horizontal"===this.direction?this.overLeftHandle(e,t):this.overTopHandle(e,t)}},{key:"overEndHandle",value:function(e,t){return"horizontal"===this.direction?this.overRightHandle(e,t):this.overBottomHandle(e,t)}},{key:"getDynamicHandleSize",value:function(e,t){var n=e?2:1,r=this.handleSize;return this.dynamicHandleSize&&r*n>t-this.reservedSpace?Math.max((t-this.reservedSpace)/n,1):r}},{key:"overLeftHandle",value:function(e,t){var n=this,r=t.offsetWidth;if(n.leftHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=In.from(t);return i.width=n.getDynamicHandleSize(n.rightHandle,r),i.contains(Kn.getPagePoint(e))}return!1}},{key:"overRightHandle",value:function(e,t){var n=this,r=t.offsetWidth;if(n.rightHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=In.from(t);return i.x=i.right-n.getDynamicHandleSize(n.leftHandle,r),i.contains(Kn.getPagePoint(e))}return!1}},{key:"overTopHandle",value:function(e,t){var n=this,r=t.offsetHeight;if(n.topHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=In.from(t);return i.height=n.getDynamicHandleSize(n.bottomHandle,r),i.contains(Kn.getPagePoint(e))}return!1}},{key:"overBottomHandle",value:function(e,t){var n=this,r=t.offsetHeight;if(n.bottomHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=In.from(t);return i.y=i.bottom-n.getDynamicHandleSize(n.bottomHandle,r),i.contains(Kn.getPagePoint(e))}return!1}},{key:"scrollLeft",get:function(){return this.scroller?this.scroller.x:this.outerElement.scrollLeft}},{key:"scrollTop",get:function(){return this.scroller?this.scroller.y:this.outerElement.scrollTop}}],[{key:"defaultConfig",get:function(){return{resizingCls:"b-resizing",dragThreshold:5,handleSize:10,dynamicHandleSize:null,reservedSpace:10,touchHandleSize:30,minWidth:1,maxWidth:0,minHeight:1,maxHeight:0,outerElement:document.body,scroller:null,allowResize:null,dragWithin:null,isElementResizable:null,targetSelector:null,leftHandle:!0,rightHandle:!0,topHandle:!0,bottomHandle:!0,handleSelector:null,handleContainerSelector:null,startEvent:null,grab:null,invalidCls:"b-resize-invalid",handleVisibilityThreshold:null,skipTranslate:!1,direction:"horizontal"}}}]),r}(pe(G));jc._$name="ResizeHelper";var Bc=function(){function e(){D()(this,e),this.random100=[46,2,36,46,54,59,18,20,71,55,88,98,13,61,61,40,2,15,3,32,51,45,64,25,81,85,54,13,57,49,64,22,81,94,0,62,17,7,11,2,33,99,85,26,83,83,96,26,20,89,91,38,26,13,11,79,32,30,5,51,70,7,5,56,58,77,37,89,40,80,78,59,26,36,8,51,60,23,86,5,11,96,64,94,87,64,4,78,17,85,35,0,90,86,23,55,53,9,35,59,29,2,64,42,8,49,43,73,6,53,38,9,39,31,32,40,49,13,78,68,20,99,24,78,35,91,73,46,67,76,89,69,30,69,25,3,4,55,1,65,66,76,83,19,67,1,95,24,54,45,56,40,67,92,72,4,69,8,47,50,27,2,38,9,14,83,12,14,62,95,22,47,35,18,38,14,86,64,68,61,52,69,39,93,20,73,32,52,74,6,56,68,99,29,24,92,40,67,6,72,31,41,91,53,80,55,33,97,97,99,18,20,5,27,82,84,61,78,27,67,7,42,75,95,91,25,63,21,70,36,46,0,1,45,84,6,86,15,10,62,96,94,10,23,93,83,94,47,5,29,29,52,51,37,77,96,43,72,43,14,54,14,72,52,4,39,15,26,68,28,25,76,60,50,22,40,72,74,68,58,8,48,40,62,52,24,9,26,47,44,49,96,7,77,90,45,76,47,5,86,1,36,18,42,19,90,34,23,70,32,69,79,0,99,57,80,72,21,19,72,85,68,4,40,86,62,0,63,4,11,69,31,78,31,21,78,29,84,13,53,57,10,26,50,24,30,90,42,51,96,93,21,99,23,81,0,89,43,86,63,93,19,54,71,92,36,4,95,37,99,60,29,23,50,68,95,57,95,77,53,99,78,75,12,92,47,23,14,0,41,98,11,34,64,26,90,50,23,38,31,74,76,16,76,66,23,22,72,48,50,20,36,37,58,5,43,49,64,81,30,8,21,98,75,60,17,50,42,27,38,90,74,45,68,67,27,31,15,58,76,41,99,23,98,53,98,56,19,79,2,4,38,96,24,65,51,43,42,41,60,46,7,90,65,3,27,63,99,51,44,86,1,54,40,15,74,3,81,51,63,87,79,84,72,22,38,96,95,33,41,21,99,21,69,7,49,40,52,41,6,91,19,76,40,54,17,33,11,11,0,1,32,94,33,13,18,45,7,85,61,42,54,45,72,78,96,17,9,80,87,41,96,66,0,8,59,18,21,2,28,64,75,97,32,80,86,97,97,55,2,73,75,11,89,67,58,70,76,12,46,64,17,22,97,25,35,93,57,82,46,57,61,31,74,27,4,32,85,53,86,53,53,42,5,28,50,65,63,70,61,73,37,13,80,7,34,22,3,26,6,62,78,12,56,87,41,58,64,31,27,45,35,18,66,62,43,89,69,94,93,33,74,2,43,85,37,82,41,74,9,15,44,33,42,65,19,1,49,78,12,29,9,78,7,55,12,45,40,33,16,86,14,52,16,73,76,0,98,75,91,78,46,99,95,90,69,78,45,62,55,37,88,49,77,27,83,38,73,39,1,75,40,65,83,54,95,7,73,4,30,26,36,89,21,5,95,11,14,87,45,36,21,77,55,5,66,51,98,48,62,74,58,23,82,30,28,19,53,89,76,98,8,34,70,28,54,16,52,35,93,54,54,72,49,18,93,72,90,71,73,15,60,38,80,76,53,70,39,69,25,5,31,61,46,6,54,34,31,52,33,36,79,76,44,29,28,38,1,66,2,90,91,1,76,78,31,55,37,71,2,3,38,85,0,95,42,2,39,57,87,61,77,98,2,24,80,48,27,47,71,15,7,49,60,86,3,2,29,38,54,36,59,83,27,47,9,36,42,8,73,85,9,16,73,60,39,12,43,25,23,29,28,47,40,77,20,89,22,30,41,59,96,19,56,20,76,73,39,46,72,40,47,37,52,29,79,37,39,50,41,87,66,17,75,31,45,26,88,70,11,90,40,74,9,32,65,72,61,6,93,54,15,84,22,99,47,10,96,4,84,19,85,73,45,25,16,8,94,99,39,28,26,68,87,48,1,65,86,46,86,7,60,82,45,75,38,56,41,35,30,86,91,97,85,45,5,14,69,85,96,37,18,26,16,38,16,1,44,94,85,58,60,20,5,47,52,41,50,71,43,42,67,64,38,65,83,99,78,96,33,20,98,24,6,2,25,16,16,44,63,24,68,56,49,91,15,59,99,27,43,34,28,36,45,1,10,19,54,26,75,17,88,96,63,24,71,93,72,97,66,87,18,86],this.randomCache={},this.rndIndex=0}return M()(e,[{key:"nextRandom",value:function(e){var t,n=this.randomCache;return n[e]?t=n[e]:(t=this.random100.filter((function(t){return t<e})),n[e]=t),t[this.rndIndex++%t.length]}},{key:"reset",value:function(){this.rndIndex=0}},{key:"fromArray",value:function(e){return e[this.nextRandom(e.length)]}}]),e}();Bc._$name="RandomGenerator";var Nc=function(){function e(){D()(this,e)}return M()(e,null,[{key:"reset",value:function(){this.rnd.reset(),this.rndTime.reset(),this.rndRating.reset()}},{key:"generate",value:Zo.a.mark((function e(t){var n,r,i,o,a,s,l,c,u,d,f,h,g,v,p,y,m,b,k,w,S=arguments;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=S.length>1&&void 0!==S[1]&&S[1],r=S.length>2&&void 0!==S[2]?S[2]:1,o=(i=this).rnd,a=i.rndTime,s=i.rndRating,l=i.firstNames,c=i.surNames,u=i.teams,d=i.foods,f=i.colors,h=i.cities,g=0;case 4:if(!(g<t)){e.next=12;break}return v=o.fromArray(l),p=o.fromArray(c),y="".concat(v," ").concat(String.fromCharCode(65+g%25)," ").concat(p),m=o.nextRandom(60)+1,b=new Date(2019,0,m),k=new Date(2019,0,m+o.nextRandom(30)+2),w={id:g+r,title:"Row "+g,name:y,firstName:v,surName:p,city:o.fromArray(h),team:o.fromArray(h)+" "+o.fromArray(u),age:10+o.nextRandom(80),food:o.fromArray(d),color:o.fromArray(f),score:10*o.nextRandom(100),rank:o.nextRandom(100)+1,start:b,finish:k,time:ft.getTime(a.nextRandom(24),5*a.nextRandom(12)),percent:o.nextRandom(100),done:o.nextRandom(100)<50,rating:s.nextRandom(5),relatedTo:Math.min(t-1,g+r+o.nextRandom(10))},n&&(w.rowHeight=5*o.nextRandom(!0===n?20:n)+20),e.next=9,w;case 9:g++,e.next=4;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"generateData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i&&this.reset();for(var o=[],a=e.overrideRowCount?e.overrideRowCount:t,s=this.generate(a,n,r),l=0;l<a;l++)o.push(s.next().value);return o}}]),e}();function zc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Object.assign(Nc,{rnd:new Bc,rndTime:new Bc,rndRating:new Bc,cities:["Stockholm","Barcelona","Paris","Dubai","New York","San Francisco","Washington","Moscow"],firstNames:["Mike","Linda","Don","Karen","Doug","Jenny","Daniel","Melissa","John","Jane","Theo","Lisa","Adam","Mary","Barbara","James","David"],surNames:["McGregor","Ewans","Scott","Smith","Johnson","Adams","Williams","Brown","Jones","Miller","Davis","More","Wilson","Taylor","Anderson","Thomas","Jackson"],teams:["Lions","Eagles","Tigers","Horses","Dogs","Cats","Panthers","Rats","Ducks","Cougars","Hens","Roosters"],foods:["Pancake","Burger","Fish n chips","Carbonara","Taco","Salad","Bolognese","Mac n cheese","Waffles"],colors:["Blue","Green","Red","Yellow","Pink","Purple","Orange","Teal","Black"]}),Nc._$name="DataGenerator";var Vc=["action","target","to","deltaX","deltaY","x","y","text"],Wc=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(zc()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e);var t=this;t.widget&&(t.outerElement=t.widget.element,t.widget.playingDemo=!0),Kn.playingDemo=!0,Object.assign(t,{prevTarget:null,currentStep:0,mouse:on.createElement({parent:t.outerElement,tag:"div",className:"simulated-mouse"}),timeoutId:null,innerIntervalId:null,mouseOutElements:[]}),t.intervalId=t.setInterval(t.nextStep.bind(t),1e3),t.outerElement.classList.add("b-playing-demo"),t.outerElement.addEventListener("click",(function(e){e.isTrusted&&t.abort()}))}},{key:"doDestroy",value:function(){this.abort()}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.mouse.style.top="-100px",t.clearInterval(t.intervalId),t.timeoutId&&t.clearTimeout(t.timeoutId),t.innerIntervalId&&t.clearInterval(t.innerIntervalId),t.outerElement.classList.remove("b-playing-demo"),t.widget&&(t.widget.playingDemo=!1),Kn.playingDemo=!1,t.trigger(e?"done":"abort")}},{key:"triggerEvent",value:function(e,t,n){if(!e)return null;var r;if(t.startsWith("mouse")){var i=this.mouse.getBoundingClientRect();r=new MouseEvent(t,Object.assign({view:window,bubbles:!0,cancelable:!0,clientX:i.left,clientY:i.top},n||{}))}else(r=document.createEvent("Event")).initEvent(t,!0,!1);return e.dispatchEvent(r),r}},{key:"handleMouseMove",value:function(e,t){var n=this,r=n.mouse;r.classList.add("quick"),n.mouseDown&&r.classList.add("drag");var i=In.from(r,n.outerElement),o=i.x,a=i.y,s=0,l=0;if(e.to)if("string"==typeof e.to){var c=n.outerElement.querySelector(e.to);if(c){var u=In.from(c,n.outerElement),d=u.x+u.width/2,f=u.y+u.height/2;s=(d-o)/10,l=(f-a)/10}}else e.to.x?s=(e.to.x-o)/10:(s=e.to[0]/10,l=e.to[1]/10);else e.deltaX?s=e.deltaX/10:e.x&&(s=(e.x-o)/10);e.deltaY&&(l=e.deltaY/10);var h=0;n.innerIntervalId=n.setInterval((function(){if(!n.shouldPause){9==h++&&(clearInterval(n.innerIntervalId),e.then&&e.then());var t=o+s*h,i=a+l*h;r.style.left=t+"px",r.style.top=i+"px";var c=r.getBoundingClientRect(),u=c.left,d=c.top,f=document.elementFromPoint(u,d);f!==n.prevTarget&&(n.prevTarget&&(n.mouseOutElements.push(n.prevTarget),on.isDescendant(n.mouseOutElements[0],f)||(n.mouseOutElements.forEach((function(e){return n.triggerEvent(e,"mouseout")})),n.mouseOutElements.length=0)),n.prevTarget=f,n.triggerEvent(f,"mouseover")),n.triggerEvent(f,e.action,{clientX:u,clientY:d})}}),50)}},{key:"getTarget",value:function(e){var t=e.target;return t?"function"==typeof t?t(e):document.querySelector(t):this.prevTarget||this.outerElement}},{key:"normalizeStep",value:function(e){if(e.action)return"function"==typeof e.action?e.action(e):e;if("function"==typeof e)return e(),e;for(var t in e)e.hasOwnProperty(t)&&!Vc.includes(t)&&(e.action=t.toLowerCase(),e.to=e[t]);return e.target||"string"!=typeof e.to&&"function"!=typeof e.to||(e.target=e.to),e}},{key:"nextStep",value:function(){var e=this;if(!e.shouldPause){if(e.currentStep===e.steps.length){if(!e.repeat)return e.abort(!0);e.currentStep=0}0===e.currentStep&&e.trigger("initialize");var t=e.mouse,n=e.normalizeStep(e.steps[e.currentStep++]),r=e.getTarget(n),i=n.action;if(r&&i)if(t.className="simulated-mouse","mousemove"===i)e.handleMouseMove(n,r);else{if(r!==e.prevTarget){var o=In.from(r,e.outerElement);t.style.left=o.x+o.width/2+"px",t.style.top=o.y+o.height/2+"px"}"mousedown"===i&&(e.mouseDown=!0),"mouseup"===i&&(e.mouseDown=!1),e.timeoutId=e.setTimeout((function(){if(e.prevTarget=r,t.classList.add(i),"type"===i){var o=we.fromElement(r),a=n.text.split("|");o.value=a[1===a.length||o.value!=a[0]?0:1]}else e.triggerEvent(r,i)}),"type"===i?100:550)}}}},{key:"isScrolling",get:function(){var e=this.outerElement.getBoundingClientRect(),t=this.lastTop&&e.top!==this.lastTop;return this.lastTop=e.top,t}},{key:"isInView",get:function(){var e=this.outerElement.getBoundingClientRect();return e.top<window.innerHeight&&e.bottom>0}},{key:"shouldPause",get:function(){return!this.isInView||this.isScrolling||document.hidden||!document.hasFocus()}}],[{key:"defaultConfig",get:function(){return{repeat:!0,outerElement:document.body,callOnFunctions:!0}}}]),r}(pe(or()));Wc._$name="DemoBot";var Uc=function(){function e(){D()(this,e)}return M()(e,null,[{key:"init",value:function(){var e=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],t=function(t){return e.map((function(e){var n=t+L.capitalizeFirstLetter(e);return"moz"===t&&(n=n.replace("screen","Screen"),"mozCancelFullScreen"in document&&"exitFullscreen"===e&&(n="mozCancelFullScreen")),n}))};this.functions="fullscreenEnabled"in document&&e||"webkitFullscreenEnabled"in document&&t("webkit")||"mozFullScreenEnabled"in document&&t("moz")||"msFullscreenEnabled"in document&&t("ms")||[];var n=["fullscreenchange","fullscreenerror"],r=function(e){return n.map((function(t){return e+L.capitalizeFirstLetter(t)}))};this.events="fullscreenEnabled"in document&&n||"webkitFullscreenEnabled"in document&&r("webkit")||"mozFullscreenEnabled"in document&&r("moz")||"msFullscreenEnabled"in document&&["MSFullscreenChange","MSFullscreenError"]||[]}},{key:"request",value:function(e){return e[this.functions[1]]()}},{key:"exit",value:function(){return document[this.functions[2]]()}},{key:"onFullscreenChange",value:function(e){document.addEventListener(this.events[0],e)}},{key:"unFullscreenChange",value:function(e){document.removeEventListener(this.events[0],e)}},{key:"enabled",get:function(){return document[this.functions[0]]}},{key:"isFullscreen",get:function(){return!!document[this.functions[3]]}}]),e}();Uc.init(),Uc._$name="Fullscreen";n(267);var Gc={constructor:1,prototype:1,name:1,length:1,arguments:1,caller:1,callee:1,__proto__:1},Yc=function(){function e(){D()(this,e)}return M()(e,null,[{key:"apply",value:function(e){if(!e.target)throw new Error("Override must specify what it overrides, using static getter target");if(!e.target.class)throw new Error("Override must specify which class it overrides, using target.class");if(!this.shouldApplyOverride(e))return!1;var t=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(e.prototype);return t.splice(t.indexOf("target"),1),this.internalOverrideAll(e.target.class,t,e),this.internalOverrideAll(e.target.class.prototype,n,e.prototype),!0}},{key:"internalOverrideAll",value:function(e,t,n){var r=this;Reflect.ownKeys(n).forEach((function(i){if(t.includes(i)&&!Gc[i]){for(var o=Object.getOwnPropertyDescriptor(n,i),a=e,s=null;!s&&a;)(s=Object.getOwnPropertyDescriptor(a,i))||(a=Object.getPrototypeOf(a));s&&r.internalOverride(a,i,o,s)}}))}},{key:"internalOverride",value:function(e,t,n,r){(e._overridden=e._overridden||{})[t]=e[t],r.get?Object.defineProperty(e,t,{enumerable:!1,configurable:!0,get:n.get}):e[t]=n.value}},{key:"shouldApplyOverride",value:function(e){var t=e.target;if(!t.maxVersion&&!t.minVersion)return!0;if(!t.product)throw new Error("Override must specify product when using versioning");return(!t.maxVersion||!j[t.product].isNewerThan(t.maxVersion))&&(!t.minVersion||!j[t.product].isOlderThan(t.minVersion))}}]),e}();Yc._$name="Override";var $c=0,qc=new WeakMap,Xc=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){var t;return e&&"object"==re()(e)||"function"==typeof e?void 0===(t=qc.get(e))&&(t=++$c,qc.set(e,t)):t=String(e),t})).join("-")},Kc=function(e){var t=new Map;return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=Xc(r),a=t.get(o);return void 0===a&&(a=e.apply(void 0,r),t.set(o,a)),a}},Jc=function(e){var t=new Map,n=function(e){return e[0]},r=function(e){return e[1]},i=function(e,t){return n(e).push(t)};return function(o,a){var s=function(e){var n=t.get(e);return void 0===n&&(n=[[],[]],t.set(e,n)),n}(o);!function(e){return!r(e).length&&!n(e).length}(s)?(i(s,a),r(s).forEach((function(e){return a(e)}))):(i(s,a),e(o,(function(e){(function(e,t){return r(e).some((function(e){return mt.isEqual(e,t)}))})(s,e)||(!function(e,t){r(e).push(t)}(s,e),n(s).forEach((function(t){return t(e)})))})))}},Qc=Symbol("success"),Zc=Symbol("failure"),eu=function(e,t){return[Qc,e,t]},tu=function(e){return[Zc,e]},nu=function(e){return e.length&&e[0]===Qc},ru=function(e){return"function"!=typeof e||e.length?e:e()},iu=Kc((function(e){return Jc((function(t,n){return n(eu(e,t))}))})),ou=Kc((function(e){return Jc((function(t,n){var r=Math.min(e.length,t.length),i=t.substr(0,r),o=t.substr(r);n(i===e?eu(i,o):tu(o))}))})),au=function(e,t){return function(n,r){return ru(e)(n,(function(e){if(nu(e)){var n=te()(e,3),i=n[1],o=n[2];t(i)(o,r)}else r(e)}))}},su=Kc((function(){for(var e=Kc((function(e,t){return Jc(au(e,(function(e){return au(t,(function(t){return iu([].concat(e,t))}))})))})),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.reduce(e,iu([]))})),lu=Kc((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Jc((function(e,n){return t.forEach((function(t){return ru(t)(e,n)}))}))})),cu=Kc((function(e){return function(t,n){var r=new RegExp("^".concat(e)).exec(t);if(r){var i=r[0],o=t.substr(i.length);n(eu(i,o))}else n(tu(t))}})),uu=Kc((function(e,t){return au(e,(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return iu(t.apply(void 0,Z()([].concat.apply([],n))))}))})),du=function(e,t){var n=[];return e(t,(function(e){nu(e)&&(""===te()(e,3)[2]&&n.push(e))})),n},fu={memo:Kc,memoCps:Jc,success:eu,failure:tu,isSuccess:nu,resolveParser:ru,succeed:iu,string:ou,bind:au,seq:su,alt:lu,regexp:cu,red:uu,runParser:du,defineParser:function(e){return function(t,n){return n?ru(e)(t,n):du(ru(e),t)}}};function hu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var gu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(hu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"store",get:function(){return this._store||(this.store=new ga({data:[{id:this.positiveValue,text:this.positiveText||this.L("Yes")},{id:this.negativeValue,text:this.negativeText||this.L("No")}]})),this._store},set:function(e){ei()(J()(r.prototype),"store",e,this,!0)}}],[{key:"$name",get:function(){return"BooleanCombo"}},{key:"type",get:function(){return"booleancombo"}},{key:"defaultConfig",get:function(){return{positiveValue:!0,positiveText:null,negativeValue:!1,negativeText:null,value:!1}}}]),r}(_e(Wa));function vu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}gu._$name="BooleanCombo",ye.register(gu.type,gu);var pu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(vu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"focusElement",get:function(){}},{key:"readOnly",set:function(e){},get:function(){return!0}}],[{key:"$name",get:function(){return"DisplayField"}},{key:"defaultConfig",get:function(){return{readOnly:!0,editable:!1,cls:"b-display-field"}}}]),r}(Ca);function yu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}pu._$name="DisplayField",ye.register("display",pu),ye.register("displayfield",pu);var mu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(yu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"roundMagnitude",value:function(e){return e&&null!=this.decimalPrecision?mt.round(e,this.decimalPrecision):e}},{key:"internalOnChange",value:function(e){var t=this,n=t.value,r=t._lastValue;t.hasChanged(r,n)&&(t._lastValue=n,t.trigger("change",{value:n,event:e,userAction:!0,valid:t.isValid}))}},{key:"onFocusOut",value:function(e){return this.syncInputFieldValue(!0),se()(J()(r.prototype),"onFocusOut",this).call(this,e)}},{key:"calcValue",value:function(){var e=this;return e._unit&&e._magnitude||!e.clearable?new As(e._magnitude,e._unit||r.defaultConfig.defaultUnit):null}},{key:"hasChanged",value:function(e,t){return t&&!e||!t&&e||t&&e&&!e.isEqual(t)}},{key:"onInternalKeyDown",value:function(e){"ArrowUp"===e.key?this.doSpinUp():"ArrowDown"===e.key&&this.doSpinDown()}},{key:"doSpinUp",value:function(){var e=this;e._isUserAction=!0,e.magnitude=(e.magnitude||0)+e.step,e._isUserAction=!1}},{key:"doSpinDown",value:function(){var e=this;(e.allowNegative||(e.magnitude||0)>0)&&(e._isUserAction=!0,e.magnitude=(e.magnitude||0)-e.step,e._isUserAction=!1)}},{key:"inputValue",get:function(){return null==this.value?"":this.value.toString(this.useAbbreviation)}},{key:"unit",set:function(e){this._unit=e,ei()(J()(r.prototype),"value",this.calcValue(),this,!0)},get:function(){return this._unit}},{key:"magnitude",set:function(e){this._magnitude=this.roundMagnitude(e),ei()(J()(r.prototype),"value",this.calcValue(),this,!0)},get:function(){return this._magnitude}},{key:"allowDecimals",get:function(){return 0!==this.decimalPrecision}},{key:"isValid",get:function(){var e=this,t=null==e.value||e.value&&null==e.value.magnitude;return t&&!e.required||!t&&(e.allowNegative||e.value.magnitude>=0)}},{key:"value",set:function(e){var t,n,i=this;if("number"==typeof e)t=i.roundMagnitude(e),n=i._unit;else if("string"==typeof e){var o=ft.parseDuration(e,i.allowDecimals,i._unit||r.defaultConfig.defaultUnit);o&&(n=o.unit,t=i.roundMagnitude(o.magnitude))}else e&&"unit"in e&&"magnitude"in e?(n=e.unit,t=i.roundMagnitude(e.magnitude)):(n=null,t=null);i._magnitude===t&&i._unit===n||(i._magnitude=t,i._unit=n,ei()(J()(r.prototype),"value",i.calcValue(),this,!0))},get:function(){return se()(J()(r.prototype),"value",this)}},{key:"milliseconds",get:function(){return this.value?this.value.milliseconds:0}}],[{key:"$name",get:function(){return"DurationField"}},{key:"defaultConfig",get:function(){return{value:null,step:1,unit:null,defaultUnit:"day",magnitude:null,useAbbreviation:!1,allowNegative:!1,decimalPrecision:null,triggers:{spin:{type:"spintrigger"}}}}}]),r}(Ca);function bu(){var e=Ti()(['\n            <input\n             type="file"\n             reference="input"\n             id="','_input"\n             class="','"\n             ',"\n             ","\n            />\n        "]);return bu=function(){return e},e}function ku(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}mu._$name="DurationField",ye.register("durationfield",mu),ye.register("duration",mu);var wu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ku()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"internalOnChange",value:function(e){se()(J()(r.prototype),"internalOnInput",this).call(this,e),se()(J()(r.prototype),"internalOnChange",this).call(this,e)}},{key:"internalOnInput",value:function(){}},{key:"inputTemplate",value:function(){var e=this;return Ii.tpl(bu(),e.id,e.inputCls||"",e.multiple?"multiple":"",e.accept?'accept="'+e.accept+'"':"")}},{key:"pickFile",value:function(){this.input.click()}},{key:"clear",value:function(){this.input.value=null}},{key:"triggerChange",value:function(e){this.trigger("change",{event:e,value:this.input.value,oldValue:this._lastValue,userAction:!0,valid:!0})}},{key:"files",get:function(){return this.input.files}}],[{key:"$name",get:function(){return"FileField"}},{key:"defaultConfig",get:function(){return{multiple:!1,accept:null}}}]),r}(so);function Su(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}wu._$name="FileField",ye.register("filefield",wu);var Cu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Su()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.items=[Object.assign({type:"button",ref:"fileButton",text:"File"},e.buttonConfig),Object.assign({type:"filefield",ref:"fileField",style:"display: none"},e.fileFieldConfig)].concat(e.items||[]),se()(J()(r.prototype),"construct",this).call(this,e),t.button.on({click:t.onButtonClick,thisObj:t}),t.fileField.on({change:t.onFileFieldChange,thisObj:t}),t._thisIsAUsedExpression(t.fileTip)}},{key:"clear",value:function(){this.fileField.clear(),this.button.badge="",this.trigger("clear")}},{key:"onButtonClick",value:function(e){var t=e.event;this.fileField.pickFile(),t.preventDefault()}},{key:"onFileFieldChange",value:function(){this.button.badge=this.files.length||"",this.trigger("change",{files:this.files})}},{key:"button",get:function(){return this.widgetMap.fileButton}},{key:"fileField",get:function(){return this.widgetMap.fileField}},{key:"files",get:function(){return this.fileField.files}},{key:"fileTip",get:function(){var e=this;return e._fileTip||(e._fileTip=new Ui({cls:"b-file-tip",forElement:e.button.element,showOnHover:!0,align:"b-t",scrollAction:"realign",listeners:{beforeshow:function(){var t=e.files;return!(!t||!t.length)&&(this.html="".concat(Array.from(t).map((function(e){return e.name})).join("<br>")),!0)}}}))}}],[{key:"$name",get:function(){return"FilePicker"}},{key:"defaultConfig",get:function(){return{defaultBindProperty:"value",buttonConfig:null,fileFieldConfig:null}}}]),r}(yi);function Ru(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Cu._$name="FilePicker",ye.register("filepicker",Cu);var xu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ru()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"value",get:function(){return this.checked},set:function(e){e=Boolean(e),ei()(J()(r.prototype),"value",e,this,!0),this.inputting||(this.checked=e)}}],[{key:"$name",get:function(){return"FlagField"}},{key:"type",get:function(){return"flagfield"}},{key:"defaultConfig",get:function(){return{value:""}}}]),r}(uo);function Eu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}xu._$name="FlagField",ye.register(xu.type,xu);var Du=new(function(e){$()(i,e);var t,n,r=(t=i,function(){var e,n=J()(t);if(Eu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function i(){return D()(this,i),r.apply(this,arguments)}return M()(i,[{key:"confirm",value:(n=ta()(Zo.a.mark((function e(t){var n,r,i,o;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.message,r=t.title,i=void 0===r?"":r,(o=this).title=i,o.element.classList.remove(o.showClass),n?(o.showClass="b-show-message-yes-no",o.widgetMap.message.html=n):o.showClass="b-show-yes-no",o.element.classList.add(o.showClass),o.show(),e.abrupt("return",o.promise=new Promise((function(e){o.resolve=e})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"doResolve",value:function(e){var t=this,n=t.resolve;n&&(t.resolve=t.reject=t.promise=null,n(e),t.hide())}},{key:"onInternalKeyDown",value:function(e){"Escape"===e.key&&(e.stopImmediatePropagation(),this.widgetMap.cancelButton.isVisible?this.onCancelClick():this.onNoClick()),se()(J()(i.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"onYesClick",value:function(){this.doResolve(Du.yesButton)}},{key:"onNoClick",value:function(){this.doResolve(Du.noButton)}},{key:"onCancelClick",value:function(){this.doResolve(Du.cancelButton)}}],[{key:"$name",get:function(){return"MessageDialog"}},{key:"defaultConfig",get:function(){return{id:"bryntum-msgdialog",centered:!0,modal:!0,hidden:!0,autoShow:!1,closeAction:"hide",title:"",items:[{type:"widget",id:"bryntum-msgdialog-message",cls:"b-msgdialog-message",ref:"message"},{type:"textfield",id:"bryntum-msgdialog-input",cls:"b-msgdialog-input",ref:"input"}],bbar:{id:"bryntum-msgdialog-bbar",items:[{ref:"yesButton",id:"bryntum-msgdialog-yesbutton",cls:"b-msgdialog-yesbutton",text:"Yes",onClick:"up.onYesClick"},{ref:"noButton",id:"bryntum-msgdialog-nobutton",cls:"b-msgdialog-nobutton",text:"No",onClick:"up.onNoClick"},{ref:"cancelButton",id:"bryntum-msgdialog-cancelbutton",cls:"b-msgdialog-cancelbutton",text:"Cancel",onClick:"up.onCancelClick"}]}}}}]),i}(Ei));function Tu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Du.noButton=0,Du.yesButton=1,Du.cancelButton=3;var Mu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Tu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onStoreBeforeRequest",value:function(){this.eachWidget((function(e){return e.disable()}))}},{key:"updateLocalization",value:function(){var e=this,t=e.widgetMap,n=t.reloadButton,i=t.firstPageButton,o=t.previousPageButton,a=t.nextPageButton,s=t.lastPageButton;i.tooltip=e.L("firstPage"),o.tooltip=e.L("prevPage"),a.tooltip=e.L("nextPage"),s.tooltip=e.L("lastPage"),n.tooltip=e.L("reload"),e.updateSummary(),se()(J()(r.prototype),"updateLocalization",this).call(this)}},{key:"updateSummary",value:function(){var e,t,n,r,i,o=this,a=o.widgetMap,s=a.pageCount,l=a.dataSummary;if(e=t=n=r=i=0,o.store){var c=o.store,u=c.pageSize,d=c.currentPage;e=c.count,t=c.lastPage,i=c.allCount,n=Math.max(0,(d-1)*u+1),r=Math.min(i,n+u-1)}s.html=o.L("pageCountTemplate")({lastPage:t}),l.html=e?o.L("summaryTemplate")({start:n,end:r,allCount:i}):o.L("noRecords")}},{key:"onStoreChange",value:function(){var e=this.widgetMap,t=this.store,n=t.count,r=t.lastPage,i=t.currentPage,o=e.pageNumber,a=e.pageCount,s=e.firstPageButton,l=e.previousPageButton,c=e.nextPageButton,u=e.lastPageButton,d=e.dataSummary;this.eachWidget((function(e){return e.enable()})),o.value=i,o.max=r,d.disabled=o.disabled=a.disabled=!n,s.disabled=l.disabled=i<=1||!n,c.disabled=u.disabled=i>=r||!n,this.updateSummary()}},{key:"onPageNumberChange",value:function(e){var t=e.value;this.store.currentPage!==t&&this.store.loadPage(t)}},{key:"onFirstPageClick",value:function(){this.store.loadPage(1)}},{key:"onPreviousPageClick",value:function(){this.store.previousPage()}},{key:"onNextPageClick",value:function(){this.store.nextPage()}},{key:"onLastPageClick",value:function(){this.store.loadPage(this.store.lastPage)}},{key:"onReloadClick",value:function(){this.store.loadPage(this.store.currentPage)}},{key:"store",set:function(e){var t=this,n={beforerequest:"onStoreBeforeRequest",afterrequest:"onStoreChange",change:"onStoreChange",thisObj:t};t.store&&t.store.un(n),t._store=e,e&&(e.on(n),e.isLoading&&t.onStoreBeforeRequest())},get:function(){return this._store}}],[{key:"$name",get:function(){return"PagingToolbar"}},{key:"defaultConfig",get:function(){return{store:null,localeClass:this,namedItems:{firstPageButton:{onClick:"up.onFirstPageClick",icon:"b-fa-angle-double-left"},previousPageButton:{onClick:"up.onPreviousPageClick",icon:"b-fa-angle-left"},pageNumber:{type:"numberfield",label:"L{page}",min:1,max:1,triggers:null,onChange:"up.onPageNumberChange"},pageCount:{type:"widget",cls:"b-pagecount b-toolbar-text"},nextPageButton:{onClick:"up.onNextPageClick",icon:"b-fa-angle-right"},lastPageButton:{onClick:"up.onLastPageClick",icon:"b-fa-angle-double-right"},reloadButton:{onClick:"up.onReloadClick",icon:"b-fa-redo"},dataSummary:{type:"widget",cls:"b-toolbar-text"}},items:{firstPageButton:!0,previousPageButton:!0,pageNumber:!0,pageCount:!0,nextPageButton:!0,lastPageButton:!0,sep:"|",reloadButton:!0,spacer:"->",dataSummary:!0}}}}]),r}(bi);function Au(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Iu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Iu(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Iu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fu(){var e=Ti()(['\n            <div class="b-splitter"></div>\n        ']);return Fu=function(){return e},e}function Ou(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Mu._$name="PagingToolbar",ye.register("pagingtoolbar",Mu);var _u=function(e){return parseInt(on.getStyleValue(e,"flex-basis"),10)||parseInt(on.getStyleValue(e,"flex-grow"),10)},Pu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ou()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"doDestroy",value:function(){this.mouseDetacher&&this.mouseDetacher(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"template",value:function(){return Ii.tpl(Fu())}},{key:"updateOrientation",value:function(){var e=this,t=this.element;if(e._prevOrientation&&t.classList.remove(e._prevOrientation),!e._currentOrientation&&e.rendered&&t.offsetParent){var n=on.getStyleValue(t.parentElement,"flex-direction");if(n)e._currentOrientation=n.startsWith("column")?"horizontal":"vertical";else{var r=t.previousElementSibling,i=t.nextElementSibling;if(!r||!i)return;var o=r.getBoundingClientRect(),a=i.getBoundingClientRect(),s=o.top<a.top?o:a,l=s===a?o:a;e._currentOrientation=s.top!==l.top?"horizontal":"vertical"}}e._currentOrientation&&t.classList.add("b-".concat(e._currentOrientation)),e._prevOrientation=e._currentOrientation}},{key:"onMouseDown",value:function(e){var t,n=this.element,r=n.previousElementSibling,i=n.nextElementSibling,o=_u(r),a=_u(i),s=[],l=Au(n.parentElement.children);try{for(l.s();!(t=l.n()).done;){var c=t.value;_u(c)&&c!==n&&s.push({element:c,width:c.offsetWidth,height:c.offsetHeight})}}catch(e){l.e(e)}finally{l.f()}this.context={startX:e.pageX,startY:e.pageY,prevWidth:r.offsetWidth,prevHeight:r.offsetHeight,nextWidth:i.offsetWidth,nextHeight:i.offsetHeight,prevHasFlex:o,nextHasFlex:a,flexed:s,prev:r,next:i},this.mouseDetacher=Kn.on({element:document,mousemove:"onMouseMove",mouseup:"onMouseUp",thisObj:this})}},{key:"onMouseMove",value:function(e){var t=this,n=t.context,r=e.pageX-n.startX,i=e.pageY-n.startY;if(e.preventDefault(),Object.assign(n,{deltaX:r,deltaY:i}),n.started||(n.started=!0,t.trigger("start",{context:n,event:e}),n.flexed.forEach((function(e){"vertical"===t.currentOrientation?e.element.style.flexGrow=e.width:e.element.style.flexGrow=e.height,e.element.style.flexBasis="0"}))),"vertical"===t.currentOrientation){var o=n.prevWidth+r,a=n.nextWidth-r;n.prevHasFlex?n.prev.style.flexGrow=o:n.prev.style.width="".concat(o,"px"),n.nextHasFlex?n.next.style.flexGrow=a:n.next.style.width="".concat(a,"px")}else{var s=n.prevHeight+i,l=n.nextHeight-i;n.prevHasFlex?n.prev.style.flexGrow=s:n.prev.style.height="".concat(s,"px"),n.nextHasFlex?n.next.style.flexGrow=l:n.next.style.height="".concat(l,"px")}t.trigger("move",{context:n,event:e})}},{key:"onMouseUp",value:function(e){var t=this;t.mouseDetacher&&t.mouseDetacher(),t.mouseDetacher=null,t.context.started&&t.trigger("end",{context:t.context,event:e}),t.context=null}},{key:"render",value:function(){se()(J()(r.prototype),"render",this).apply(this,arguments);var e=this;e._currentOrientation||(e.updateOrientation(),e._currentOrientation||e.requestAnimationFrame((function(){return e.updateOrientation()})))}},{key:"element",get:function(){return se()(J()(r.prototype),"element",this)},set:function(e){ei()(J()(r.prototype),"element",e,this,!0),Kn.on({element:this.element,mousedown:"onMouseDown",thisObj:this})}},{key:"currentOrientation",get:function(){return this._currentOrientation}},{key:"orientation",get:function(){return this._orientation},set:function(e){this._orientation=e,this._currentOrientation="auto"===e?null:e,this.updateOrientation()}}],[{key:"defaultConfig",get:function(){return{orientation:"auto"}}}]),r}(Nr);function Lu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Pu._$name="Splitter",ye.register("splitter",Pu);var Hu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Lu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;n.masterStore=t,t&&(n._grid=Array.isArray(t)?t[0].grid:t.grid),n.localizableProperties=e.localizableProperties||["text"],e.localeClass&&(n.localeClass=e.localeClass),se()(J()(r.prototype),"construct",this).call(this,e,t,null,!1),n.processConfiguredListeners(e.listeners),"field"in n.data||(n.field="_"+(n.type||"")+ ++r.emptyCount,n.noFieldSpecified=!0),n.hasComplexMapping=n.field&&n.field.includes("."),n.width||n.flex||n.children||n.set({width:r.defaultWidth,flex:null},null,!0)}},{key:"remove",value:function(){var e=this.subGrid,t=this.grid,n=e&&t&&t.focusedCell;n&&n.columnId===this.id&&(document.activeElement===t?t.navigateRight():n.columnId=e.columns.getAdjacentVisibleLeafColumn(this.id,!0,!0).id),se()(J()(r.prototype),"remove",this).call(this)}},{key:"getRawValue",value:function(e){return this.hasComplexMapping?mt.getPath(e,this.field):e[this.field]||e.get(this.field)}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.parent;if(!t.hidden){if(t.hidden=!0,n&&!n.isRoot){var r=n.children.some((function(e){return!0!==e.hidden}));r||n.hidden||(e=!0,n.hide())}t.children&&t.children.forEach((function(e){return e.hide(!0)})),e||t.stores.forEach((function(e){return e.trigger("hideColumn")}))}}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.parent;t.hidden&&(t.hidden=!1,n&&n.hidden&&n.show(),t.children&&t.children.forEach((function(e){return e.show(!0)})),e||t.stores.forEach((function(e){return e.trigger("showColumn")})))}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.hidden&&void 0===e||!0===e?this.show():!this.hidden&&void 0===e||!1===e?this.hide():void 0}},{key:"generateId",value:function(){return r.generatedIdIndex||(r.generatedIdIndex=0),(this.field?this.field.replace(/\./g,"-"):"col")+ ++r.generatedIdIndex}},{key:"measureSize",value:function(e){return on.measureSize(e,this.subGrid?this.subGrid.element:void 0)}},{key:"calculateMinWidth",value:function(){var e=this,t=e.measureSize(e.width),n=e.measureSize(e.minWidth),r=0;return e.children&&(r=e.children.reduce((function(e,t){return e+t.calculateMinWidth()}),0)),Math.max(t,n,r)}},{key:"resizeToFitContent",value:function(){var e=this,t=e.grid,n=e.renderer,r=e.defaultRenderer,i=e.element,o=t.rowManager,a=t.store,s=a.count,l=n||r;if(!(s<=0)){var c,u,d,f,h,g=t.element.querySelector(".b-grid-cell[data-column-id=".concat(e.id,"]")),v=g.cssText,p=g.className,y=0;if(t.resizeToFitIncludesHeader){var m=window.getComputedStyle(i);y=on.measureText(i.innerText,i,!1,i.parentElement)+parseInt(m.paddingLeft),i.parentElement.offScreenDiv.parentElement.remove()}for(s>1e3?u=(c=Math.max(Math.min(o.topIndex+o.rowCount/2-500,s-1e3),0))+1e3:(c=0,u=s),d=c;d<u;d++)f=a.getAt(d),h=e.getRawValue(f),l&&(h=null==(h=l.call(e,{cellElement:g,rowElement:g.parentNode,value:h,record:f,column:e,size:{height:f.rowHeight||0},grid:t,row:{},updatingSingleRow:!1}))?g.innerHTML:String(h)),h&&(y=Math.max(y,on.measureText(h,g,!(e.htmlEncode&&!e.disableHtmlEncode),e.subGrid.element)));return g.className=p,g.cssText=v,e.width=y}}},{key:"getState",value:function(){var e,t=this,n=(e={},oe()(e,t.flex?"flex":"width",t.flex?t.flex:t.width),oe()(e,"id",t.id),oe()(e,"hidden",t.hidden),oe()(e,"index",t.allIndex),oe()(e,"region",t.region),oe()(e,"filterable",t.filterable),oe()(e,"text",t.text),oe()(e,"locked",t.locked),e);return t.children&&(n.children=t.children.map((function(e){return e.getState()}))),n}},{key:"applyState",value:function(e){var t=this;t.beginBatch(),"locked"in e&&(t.locked=e.locked),"minWidth"in e&&(t.minWidth=e.minWidth),"width"in e&&(t.width=e.width),"flex"in e&&(t.flex=e.flex),"width"in e&&t.flex?t.flex=void 0:"flex"in e&&t.width&&(t.width=void 0),"text"in e&&(t.text=e.text),"region"in e&&(t.region=e.region),"renderer"in e&&(t.renderer=e.renderer),"filterable"in e&&(t.filterable=e.filterable),t.endBatch(),"hidden"in e&&t.toggle(!0!==e.hidden)}},{key:"clearCell",value:function(e){e.innerHTML=""}},{key:"canEdit",value:function(e){return!0}},{key:"owner",get:function(){return this._owner||this.subGrid},set:function(e){this._owner=e}},{key:"nextVisibleSibling",get:function(){for(var e=this.region,t=this.nextSibling;t&&(t.hidden||t.region!==e);)t=t.nextSibling;return t}},{key:"isLastInSubGrid",get:function(){return!this.nextVisibleSibling&&(!this.parent||this.parent.isLastInSubGrid)}},{key:"element",get:function(){return this.grid.getHeaderElement(this)}},{key:"textWrapper",get:function(){return on.getChild(this.element,".b-grid-header-text")}},{key:"textElement",get:function(){return on.down(this.element,".b-grid-header-text-content")}},{key:"contentElement",get:function(){return on.down(this.element,".b-grid-header-children")}},{key:"editor",get:function(){var e=this.data.editor;if(e&&!(e instanceof Nr)){var t=this.grid.processCellEditor({editor:e,field:this.field});t?e=this.data.editor=t.editor:("string"==typeof e&&(e={type:e}),e=this.data.editor=Ce.createWidget(Object.assign(this.defaultEditor,e,{owner:this.grid})))}return e},set:function(e){this.data.editor=e}},{key:"defaultEditor",get:function(){return{type:"textfield",name:this.field}}},{key:"grid",get:function(){return this._grid||this.parent&&this.parent.grid}},{key:"locked",get:function(){return"locked"===this.data.region},set:function(e){this.region=e?"locked":"normal"}},{key:"sortable",get:function(){return this.isLeaf&&this.data.sortable},set:function(e){this.set("sortable",e)}},{key:"groupable",get:function(){return this.isLeaf&&this.data.groupable},set:function(e){this.set("groupable",e)}},{key:"allIndex",get:function(){return this.masterStore.indexOf(this)}},{key:"width",get:function(){return this.data.width},set:function(e){var t={width:e};e&&"flex"in this.data&&(t.flex=null),this.set(t)}},{key:"subGrid",set:function(e){this._subGrid=e},get:function(){return this._subGrid||(this.grid?this.grid.getSubGridFromColumn(this):void 0)}},{key:"subGridElement",get:function(){return this.subGrid.element}}],[{key:"fields",get:function(){return["text","field","renderer","width","flex",{name:"editor",defaultValue:{}},"finalizeCellEdit",{name:"revertOnEscape",defaultValue:!0},{name:"invalidAction",defaultValue:"block"},{name:"sortable",defaultValue:!0},{name:"searchable",defaultValue:!0},{name:"filterable",defaultValue:!0},{name:"hideable",defaultValue:!0},{name:"draggable",defaultValue:!0},{name:"groupable",defaultValue:!0},{name:"resizable",defaultValue:!0},"groupRenderer","headerRenderer","tooltipRenderer","cellCls","cls","icon","align",{name:"minWidth",defaultValue:60},{name:"hidden",defaultValue:!1},{name:"locked"},{name:"region"},{name:"showColumnPicker",defaultValue:!0},{name:"enableHeaderContextMenu",defaultValue:!0},{name:"enableCellContextMenu",defaultValue:!0},"headerMenuItems","cellMenuItems","sum","summaries","summaryRenderer","responsiveLevels","tags","touchConfig","tree","filterType",{name:"htmlEncode",defaultValue:!0},{name:"autoSyncHtml",defaultValue:!1},"type",{name:"instantUpdate",defaultValue:!1},{name:"repaintOnResize",defaultValue:!1},"editTargetSelector",{name:"exportable",defaultValue:!0},{name:"exportedType"}]}},{key:"autoExposeFields",get:function(){return!1}},{key:"type",get:function(){return"column"}},{key:"text",get:function(){return this.defaultValues.text}}]),r}(pe(_e(Io)));function ju(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Bu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bu(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Bu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Hu.emptyCount=0,Hu.defaultWidth=100,Hu.exposeProperties(),Hu._$name="Column";var zu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Nu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;e.grid&&(e.grid._columnStore=t,t.id="".concat(e.grid.id,"-columns"),e.grid.on({subGridCollapse:"clearSubGridCaches",subGridExpand:"clearSubGridCaches",thisObj:t})),se()(J()(r.prototype),"construct",this).call(this,e),t.on({change:t.clearCaches,thisObj:t,prio:1})}},{key:"doDestroy",value:function(){var e=[];this.traverse((function(t){return e.push(t)})),se()(J()(r.prototype),"doDestroy",this).call(this),e.forEach((function(e){return e.destroy()}))}},{key:"getById",value:function(e){return se()(J()(r.prototype),"getById",this).call(this,e)||this.idRegister[e]}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.traverseWhile((function(n,r){return e.call(t,n,r)}),!0)}},{key:"clearSubGridCaches",value:function(e){e.columns.clearCaches(),this.clearCaches()}},{key:"clearCaches",value:function(){this._visibleColumns=null}},{key:"onMasterDataChanged",value:function(e){se()(J()(r.prototype),"onMasterDataChanged",this).call(this,e),this.clearCaches()}},{key:"getAdjacentVisibleLeafColumn",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.visibleColumns,i=e instanceof Hu?e:this.getById(e),o=r.indexOf(i)+(t?1:-1);if(!r[o]){if(!n)return null;o=t?0:r.length-1}return r[o]}},{key:"get",value:function(e){return this.findRecord("field",e,!0)}},{key:"createRecord",value:function(e){var t=this.grid,n=void 0===t?{}:t,i=n.store,o=this.modelClass;if(e.type&&!(o=r.getColumnClass(e.type)))throw new Error(this.L("columnTypeNotFound",e));e.locked&&(e.region="locked",delete e.locked);var a=new o(e,this);if(a.data.region||(a.data.region=n.defaultRegion||"normal"),this.autoAddField&&!a.noFieldSpecified&&i&&!i.modelClass.getFieldDefinition(a.field)){var s=a.field;a.constructor.fieldType&&(s={name:a.field,type:a.constructor.fieldType}),i.modelClass.addField(s)}return a}},{key:"indexOf",value:function(e){var t=se()(J()(r.prototype),"indexOf",this).call(this,e);return t>-1?t:this.records.findIndex((function(t){return t.field===e}))}},{key:"modelClass",get:function(){return this._modelClass},set:function(e){this._modelClass=e}},{key:"totalFixedWidth",get:function(){var e,t=0,n=ju(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.hidden||(r.flex?t+=r.measureSize(Hu.defaultWidth):t+=Math.max(r.measureSize(r.width),r.measureSize(r.minWidth)))}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"topColumns",get:function(){return this.isChained?this.masterStore.rootNode.children.filter(this.chainedFilterFn):this.rootNode.children}},{key:"visibleColumns",get:function(){return this._visibleColumns||(this._visibleColumns=this.leaves.filter((function(e){return!(e.hidden||e.subGrid&&e.subGrid.collapsed)}))),this._visibleColumns}},{key:"bottomColumns",get:function(){return this.leaves}}],[{key:"registerColumnType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.columnTypes||(r.columnTypes={}),e.simpleRenderer=t,r.columnTypes[e.type]=e}},{key:"getColumnClass",value:function(e){return r.columnTypes&&r.columnTypes[e]}},{key:"defaultConfig",get:function(){return{modelClass:Hu,tree:!0,autoAddField:!1}}}]),r}(_e(ga));function Vu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(Hu,!0),zu._$name="ColumnStore";var Wu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Vu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.configuredAlign="align"in e,this.configuredEditor="editor"in e,se()(J()(r.prototype),"construct",this).apply(this,arguments);var n=t.grid;n&&(this.owner=n,n.on({paint:"onGridPaint",thisObj:this,prio:1e3}))}},{key:"onGridPaint",value:function(e){var t=e.source;this.store=t.store}},{key:"canEdit",value:function(e){return e.isLeaf}},{key:"sum",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n.length;i<o;i++)e+=parseInt(n[i],10);return e}},{key:"avg",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=n.length,o=0;o<i;o++)e+=parseInt(n[o],10);return e/i}},{key:"onRecordUpdate",value:function(e){var t=e.record,n=e.changes,r=this,i=r.grid.rowManager;r.field in n&&t.isLeaf&&t.bubble((function(e){var t=i.getRowFor(e);if(t){var n=t.getCell(r.field);n&&t.renderCell(n,e)}}),!0)}},{key:"getRawValue",value:function(e){var t=0;if(e.children){for(var n=this.function,r="string"==typeof n&&"function"==typeof Math[n]?{handler:Math[n],thisObj:Math}:this.resolveCallback(n),i=r.handler,o=r.thisObj,a=0,s=e.children.length;a<s;a++)t=i.call(o,t,this.getRawValue(e.children[a]));e.setData(this.field,t)}else t=e[this.field];return t}},{key:"store",set:function(e){var t=this,n={update:"onRecordUpdate",thisObj:t,prio:1e3},r=t._store;if(e!==r){r&&r.un(n),t._store=e;var i=e.modelClass.fieldMap[t.field];i&&"number"===i.type&&(t.configuredAlign||(t.align="end"),t.configuredEditor||(t.editor="number")),e.on(n)}},get:function(){return this._store}}],[{key:"type",get:function(){return"aggregate"}},{key:"fields",get:function(){return["function"]}},{key:"defaults",get:function(){return{function:"sum"}}}]),r}(Hu);function Uu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(Wu,!0),Wu.exposeProperties(),Wu._$name="AggregateColumn";var Gu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Uu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.widgetMap={},this.internalCellCls="b-widget-cell",se()(J()(r.prototype),"construct",this).apply(this,arguments)}},{key:"doDestroy",value:function(){for(var e=0,t=Object.values(this.widgetMap);e<t.length;e++){var n=t[e];n.destroy&&n.destroy()}se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"renderer",value:function(e){var t=this,n=e.cellElement,r=e.column,i=e.value,o=e.record,a=e.isExport,s=r.widgets;if(!a&&s&&(n.widgets||t.clearCell(n),n.widgets=s.map((function(a,s){var l,c;return n.widgets&&(c=(l=n.widgets[s]).element.nextElementSibling,a.recreate&&l&&(delete t.widgetMap[l.id],l.destroy(),n.widgets[s]=null)),l||(t.onBeforeWidgetCreate(a,e),l=Ce.append(a,c?{insertBefore:c}:n)[0],t.widgetMap[l.id]=l,t.onAfterWidgetCreate(l,e)),l.cellInfo={cellElement:n,value:i,record:o,column:r},t.grid&&(l.readOnly=t.grid.readOnly),!1!==t.onBeforeWidgetSetValue(l,e)&&(a.noValueOnRender||(a.valueProperty?l[a.valueProperty]=i:l.defaultBindProperty?l[l.defaultBindProperty]=i:l.text=l.value=i)),t.onAfterWidgetSetValue(l,e),l}))),a)return null}},{key:"onBeforeWidgetCreate",value:function(e,t){}},{key:"onAfterWidgetCreate",value:function(e,t){}},{key:"onBeforeWidgetSetValue",value:function(e,t){}},{key:"onAfterWidgetSetValue",value:function(e,t){}},{key:"clearCell",value:function(e){var t=this;e.widgets&&(e.widgets.forEach((function(e){delete t.widgetMap[e.id],e.destroy()})),e.widgets=null),se()(J()(r.prototype),"clearCell",this).call(this,e)}},{key:"resizeToFitContent",value:function(){}}],[{key:"type",get:function(){return"widget"}},{key:"fields",get:function(){return["widgets"]}},{key:"defaults",get:function(){return{filterable:!1,sortable:!1,editor:!1,searchable:!1}}}]),r}(Hu);function Yu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(Gu),Gu.exposeProperties(),Gu._$name="WidgetColumn";var $u=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Yu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(e,t){var i;return D()(this,r),(i=n.apply(this,arguments)).internalCellCls="b-check-cell",i.grid&&i.grid.on("destroy",(function(){return i.headerCheckbox&&i.headerCheckbox.destroy()})),i}return M()(r,null,[{key:"type",get:function(){return"check"}},{key:"fields",get:function(){return["checkCls","showCheckAll"]}},{key:"defaults",get:function(){return{align:"center",checkCls:null,showCheckAll:!1,widgets:[{type:"checkbox",valueProperty:"checked"}]}}}]),M()(r,[{key:"headerRenderer",value:function(e){var t=e.headerElement,n=e.column;if(t.classList.add("b-check-header"),!n.showCheckAll)return n.text;t.classList.add("b-check-header-with-checkbox"),n.headerCheckbox&&n.headerCheckbox.destroy(),n.headerCheckbox=new uo({appendTo:t,owner:this.grid,listeners:{change:function(e){var t=e.checked;n.trigger("toggleAll",{checked:t})}}})}},{key:"renderer",value:function(e){var t=e.value,n=e.isExport;if(n)return null==t?"":t;se()(J()(r.prototype),"renderer",this).apply(this,arguments)}},{key:"onBeforeWidgetCreate",value:function(e,t){e.cls=this.checkCls}},{key:"onAfterWidgetCreate",value:function(e,t){t.cellElement.widget=e,e.on({beforeChange:"onBeforeCheckboxChange",change:"onCheckboxChange",thisObj:this})}},{key:"onBeforeWidgetSetValue",value:function(e){e.record=e.cellInfo.record,this.isInitialSet=!0}},{key:"onAfterWidgetSetValue",value:function(e){this.isInitialSet=!1}},{key:"onBeforeCheckboxChange",value:function(e){var t=e.source,n=e.checked;if(!this.isInitialSet)return this.trigger("beforeToggle",{record:t.cellInfo.record,checked:n})}},{key:"onCheckboxChange",value:function(e){var t=e.source,n=e.checked;if(!this.isInitialSet){var r=t.cellInfo.record,i=this.field;if(i){var o="set".concat(L.capitalizeFirstLetter(i));r[o]?r[o](n):r.set(i,n)}this.trigger("toggle",{record:r,checked:n})}}}]),r}(Gu);function qu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType($u,!0),$u._$name="CheckColumn";var Xu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(qu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(e,t){var i;return D()(this,r),(i=n.apply(this,arguments)).internalCellCls="b-date-cell",i}return M()(r,null,[{key:"type",get:function(){return"date"}},{key:"fieldType",get:function(){return"date"}},{key:"fields",get:function(){return["format","pickerFormat","step"]}},{key:"defaults",get:function(){return{format:"L",step:1,minWidth:85,filterType:"date"}}}]),M()(r,[{key:"defaultRenderer",value:function(e){var t=e.value;return t?this.formatValue(t):""}},{key:"groupRenderer",value:function(e){var t=e.cellElement,n=e.groupRowFor;t.innerHTML=this.formatValue(n)}},{key:"formatValue",value:function(e){return"string"==typeof e&&(e=ft.parse(e,this.format||void 0)),ft.format(e,this.format||void 0)}},{key:"format",set:function(e){var t=this.editor;this.set("format",e),t&&(t.format=this.format)},get:function(){return this.get("format")}},{key:"defaultEditor",get:function(){return{name:this.field,type:"date",calendarContainerCls:"b-grid-cell-editor-related",format:this.format,step:this.step}}}]),r}(Hu);function Ku(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(Xu,!0),Xu.exposeProperties(),Xu._$name="DateColumn";var Ju=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ku()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(e,t){var i;return D()(this,r),(i=n.apply(this,arguments)).internalCellCls="b-percent-bar-cell",i}return M()(r,null,[{key:"type",get:function(){return"percent"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["lowThreshold"]}},{key:"defaults",get:function(){return{editor:{type:"number",min:0,max:100},lowThreshold:20,filterType:"number",htmlEncode:!1,searchable:!1,summaryRenderer:function(e){return"".concat(e,"%")}}}}]),M()(r,[{key:"renderer",value:function(e){var t=e.value;return{className:"b-percent-bar-outer",children:[{tag:"div",className:{"b-percent-bar":1,"b-zero":0===(t=t||0),"b-low":t<this.lowThreshold},style:{width:t+"%"},html:t+"%"}]}}},{key:"clearCell",value:function(e){e.percentBarElement&&(e.percentBarElement=null),se()(J()(r.prototype),"clearCell",this).call(this,e)}},{key:"resizeToFitContent",value:function(){}}]),r}(Hu);function Qu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ju.sum="average",zu.registerColumnType(Ju,!0),Ju._$name="PercentColumn";var Zu=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Qu()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(e,t){var i;return D()(this,r),(i=n.apply(this,arguments)).internalCellCls="b-number-cell",i}return M()(r,null,[{key:"type",get:function(){return"number"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["min","max","step","unit"]}},{key:"defaults",get:function(){return{filterType:"number"}}}]),M()(r,[{key:"defaultRenderer",value:function(e){var t=e.value,n=void 0===t?0:t;return this.unit?"".concat(n).concat(this.unit):n}},{key:"defaultEditor",get:function(){return{name:this.field,type:"numberfield",max:this.max,min:this.min,step:this.step}}}]),r}(Hu);function ed(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(Zu,!0),Zu.exposeProperties(),Zu._$name="NumberColumn";var td=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ed()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(e,t){var i;return D()(this,r),(i=n.apply(this,arguments)).internalCellCls="b-rating-cell",i}return M()(r,null,[{key:"type",get:function(){return"rating"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["emptyIcon","filledIcon","editable"]}},{key:"defaults",get:function(){return{min:0,max:5,emptyIcon:"b-icon b-icon-star",filledIcon:"b-icon b-icon-star",editable:!0,filterType:"number",searchable:!1,width:"11.2em",htmlEncode:!1,autoSyncHtml:!0,minWidth:"11.2em",editor:!1}}}]),M()(r,[{key:"renderer",value:function(e){for(var t=e.value,n='<div class="b-rating-cell-inner '.concat(this.editable?"":"b-not-editable",'">'),r=0;r<this.max;r++){n+='<i class="b-rating-icon '.concat(r<t?"b-filled "+this.filledIcon:"b-empty "+this.emptyIcon,'"></i>')}return n+="</div>"}},{key:"onCellClick",value:function(e){var t=e.grid,n=e.column,r=e.record,i=(e.cellSelector,e.target),o=e.event;if(i.classList.contains("b-rating-icon")&&!t.readOnly&&n.editable){var a=[].indexOf.call(i.parentNode.childNodes,i);i.classList.contains("b-filled")&&(o.metaKey||o.shiftKey)&&(a-=1),1===r.get(n.field)&&0===a&&(a=-1),r.set(n.field,a+1)}}}]),r}(Zu);function nd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(td,!0),td.exposeProperties(),td._$name="RatingColumn";var rd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(nd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;se()(J()(r.prototype),"construct",this).apply(this,arguments),n.grid&&(n.grid.store.on({change:n.resizeToFitContent,thisObj:n}),n.grid.store.count&&n.grid.on({render:n.resizeToFitContent,thisObj:n,once:!0})),n.internalCellCls="b-row-number-cell"}},{key:"renderer",value:function(e){var t=e.record,n=e.grid;return t.meta.specialRow?"":n.store.indexOf(t,!0)+1}},{key:"resizeToFitContent",value:function(){var e=this.grid,t=e.store.count;if(t&&!this.hidden){var n=e.element.querySelector(".b-grid-cell[data-column-id=".concat(this.id,"]"));if(n){var r=window.getComputedStyle(n),i=parseInt(r["padding-left"]),o=on.measureText(t,n);this.width=o+2*i}}}},{key:"flex",set:function(e){}}],[{key:"defaults",get:function(){return{groupable:!1,sortable:!1,filterable:!1,searchable:!1,resizable:!1,minWidth:50,width:50,align:"right",text:"#",editor:!1}}},{key:"type",get:function(){return"rownumber"}}]),r}(Hu);zu.registerColumnType(rd,!0),rd._$name="RowNumberColumn";var id=n(117),od=n.n(id);function ad(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var sd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ad()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(e,t){var i;D()(this,r),i=n.apply(this,arguments);var o=od()(i);if(!o.template)throw new Error(o.L("noTemplate"));if("function"!=typeof o.template)throw new Error(o.L("noFunction"));return i}return M()(r,null,[{key:"fields",get:function(){return["template"]}},{key:"defaults",get:function(){return{htmlEncode:!1}}}]),M()(r,[{key:"renderer",value:function(e){if(!e.record.meta.specialRow)return this.template({value:e.value,record:e.record,field:e.column.field})}}],[{key:"type",get:function(){return"template"}}]),r}(Hu);function ld(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(sd,!0),sd.exposeProperties(),sd._$name="TemplateColumn";var cd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ld()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(e,t){var i;return D()(this,r),(i=n.apply(this,arguments)).internalCellCls="b-time-cell",i}return M()(r,null,[{key:"type",get:function(){return"time"}},{key:"fieldType",get:function(){return"date"}},{key:"fields",get:function(){return["format"]}},{key:"defaults",get:function(){return{format:"LT",minWidth:140,filterType:"time"}}}]),M()(r,[{key:"defaultRenderer",value:function(e){var t=e.value;return t?this.formatValue(t):""}},{key:"groupRenderer",value:function(e){var t=e.cellElement,n=e.groupRowFor;t.innerHTML=this.formatValue(n)}},{key:"formatValue",value:function(e){return"string"==typeof e&&(e=ft.parse(e,this.format)),ft.format(e,this.format)}},{key:"format",set:function(e){var t=this.editor;this.set("format",e),t&&(t.format=this.format)},get:function(){return this.get("format")}},{key:"defaultEditor",get:function(){return{name:this.field,type:"time",format:this.format}}}]),r}(Hu);function ud(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(cd,!0),cd.exposeProperties(),cd._$name="TimeColumn";var dd=!1,fd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ud()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(e,t){var i;D()(this,r),i=n.apply(this,arguments);var o=od()(i);return o.internalCellCls="b-tree-cell",o.shouldHtmlEncode=o.htmlEncode,o.tempDiv=document.createElement("div"),o.setData("htmlEncode",!1),o.renderer&&(o.originalRenderer=o.renderer),o.renderer=o.treeRenderer.bind(o),i}return M()(r,null,[{key:"defaults",get:function(){return{tree:!0,hideable:!1,minWidth:150}}},{key:"fields",get:function(){return[{name:"expandIconCls",defaultValue:"b-icon b-icon-tree-expand"},{name:"collapseIconCls",defaultValue:"b-icon b-icon-tree-collapse"},{name:"collapsedFolderIconCls"},{name:"expandedFolderIconCls"},{name:"leafIconCls",defaultValue:"b-icon b-icon-tree-leaf"},{name:"editTargetSelector",defaultValue:".b-tree-cell-value"}]}},{key:"type",get:function(){return"tree"}}]),M()(r,[{key:"treeRenderer",value:function(e){var t,n=this,r=e.cellElement,i=e.row,o=e.record,a=e.isExport,s=o.instanceMeta(e.grid.store),l=o.href?"a":"div",c=e.value;if(n.originalRenderer){var u=n.originalRenderer(e);c=!1===u?r.innerHTML:u}if(a)t=null!=c?c:"";else{var d,f="";if(o.isLeaf)r.classList.add("b-tree-leaf-cell"),d=e.iconCls||o.iconCls||n.leafIconCls;else{var h=s.collapsed,g=h?n.expandIconCls:n.collapseIconCls,v=h?n.collapsedFolderIconCls:n.expandedFolderIconCls;if("Row"===i.$name){var p=["b-tree-parent-row"],y=[];s.isLoadingChildren?p.push("b-loading-children"):y.push("b-loading-children"),h?(p.push("b-tree-collapsed"),y.push("b-tree-expanded")):(p.push("b-tree-expanded"),y.push("b-tree-collapsed")),i.removeCls.apply(i,y),i.addCls.apply(i,p)}r.classList.add("b-tree-parent-cell"),f+='<div class="b-tree-expander">'.concat(g?'<i class="'.concat(g,'"></i>'):"","</div>"),dd=d=e.iconCls||o.iconCls||v}c=null!=c?c:"",n.shouldHtmlEncode&&(n.tempDiv.innerText=c,c=n.tempDiv.innerHTML),f+='<div class="b-tree-cell-value">'.concat(d?'<i class="b-tree-icon '.concat(d,'"></i>'):"").concat(c,"</div>");var m=1.7*o.childLevel+(o.isLeaf?dd?1.8:d?.4:.3:0);t="<".concat(l," ").concat(o.href?'href="'.concat(o.href,'"'):""," ").concat("a"===l&&o.target?'target="'.concat(o.target,'"'):"",' class="b-tree-cell-inner" style="padding-left:').concat(m,'em;">').concat(f,"</").concat(l,">")}return t}}]),r}(Hu);function hd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(fd,!0),fd.exposeProperties(),fd._$name="TreeColumn";var gd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(hd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"fields",get:function(){return["iconCls","expanded","cls","rowHeight","href","target"]}}]),r}(Io);gd.exposeProperties(),gd._$name="GridRowModel";var vd=new Map,pd=new Map,yd={Grid:"GridBase",Scheduler:"SchedulerBase",Gantt:"GanttBase"},md=/\$\d+$/,bd=function(){function e(){D()(this,e)}return M()(e,null,[{key:"registerFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r=(r=L.lowercaseFirstLetter(r||e.hasOwnProperty("$name")&&e.$name||e.name)).replace(md,""),Array.isArray(n)||(n=[n||"Grid"]),n.forEach((function(n){var i=yd[n]||n,o=vd.get(i)||new Map,a=pd.get(i)||new Map;o.set(r,e),a.set(e,t),vd.set(i,o),pd.set(i,a)}))}},{key:"getTypeNameFeatures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Grid",t=yd[e]||e,n=vd.get(t),r={};return n&&n.forEach((function(e,t){return r[t]=e})),r}},{key:"getTypeNameDefaultFeatures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Grid",t=yd[e]||e,n=vd.get(t),r=pd.get(t),i={};return n&&r&&n.forEach((function(e,t){r.get(e)&&(i[t]=e)})),i}},{key:"getInstanceFeatures",value:function(e){var t=this;return e.classNameHierarchy().reduce((function(e,n){return Object.assign(e,t.getTypeNameFeatures(n))}),{})}},{key:"getInstanceDefaultFeatures",value:function(e){var t=this;return e.classNameHierarchy().reduce((function(e,n){return Object.entries(t.getTypeNameFeatures(n)).reduce((function(e,r){var i=te()(r,2),o=i[0],a=i[1];return t.isDefaultFeatureForTypeName(a,n)?e[o]=a:delete e[o],e}),e)}),{})}},{key:"isDefaultFeatureForTypeName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Grid",n=yd[t]||t,r=pd.get(n);return r&&r.get(e)||!1}},{key:"isDefaultFeatureForInstance",value:function(e,t){for(var n=t.classNameHierarchy().reverse(),r=null,i=0,o=n.length;i<o&&null===r;++i){var a=pd.get(n[i]);a&&a.has(e)&&(r=a.get(e))}return r||!1}},{key:"reset",value:function(){vd.clear(),pd.clear()}}]),e}();function kd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}bd._$name="GridFeatureManager";var wd={Enter:1,F2:1},Sd={ArrowUp:1,ArrowDown:1,ArrowLeft:1,ArrowRight:1},Cd=function(e){$()(a,e);var t,n,r,i,o=(t=a,function(){var e,n=J()(t);if(kd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function a(){return D()(this,a),o.apply(this,arguments)}return M()(a,[{key:"construct",value:function(e,t){var n=this;n.grid=e,se()(J()(a.prototype),"construct",this).call(this,e,t),n.storeListenerDetacher=e.store.on({update:"onStoreUpdate",thisObj:n}),n.listenerDetacher=e.on({cellclick:"onCellClick",celldblclick:"onCellDblClick",beforerenderrows:"onGridBeforeRenderRows",thisObj:n})}},{key:"confirm",value:(i=ta()(Zo.a.mark((function e(t){var n;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!0,!this.editorContext){e.next=7;break}return Du.owner=this.editorContext.editor.inputField,e.next=5,Du.confirm(t);case 5:n=e.sent,Du.owner=null;case 7:return e.abrupt("return",n===Du.yesButton);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"doDestroy",value:function(){this.cancelEditing(!0),this.listenerDetacher(),this.storeListenerDetacher(),this.grid.columns.allRecords.forEach((function(e){e._cellEditor&&e._cellEditor.destroy()})),se()(J()(a.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e&&this.cancelEditing(!0),se()(J()(a.prototype),"doDisable",this).call(this,e)}},{key:"getEditorForCell",value:function(e){var t=e.column,n=e.selector,r=e.editor,i=this,o=i.grid,a=t._cellEditor;return r.autoSelect=i.autoSelect,a?a.inputField!==r&&(a.remove(a.items[0]),a.add(r)):a=t._cellEditor=new i.editorClass({cls:"b-cell-editor",inputField:r,blurAction:"none",invalidAction:t.invalidAction,completeKey:!1,cancelKey:!1,owner:o,listeners:i.getEditorListeners()}),t.instantUpdate&&!r.cellEditValueSetter&&(mt.wrapProperty(r,"value",null,(function(e){var t=i.editorContext;t&&!mt.isEqual(t.record[t.column.field],e)&&(t.record[t.column.field]=e)})),r.cellEditValueSetter=!0),Object.assign(a.element.dataset,{rowId:n.id,columnId:n.columnId,field:t.field}),a.inputField.revertOnEscape=t.revertOnEscape,i.editor=a}},{key:"getEditorListeners",value:function(){return{focusout:"onEditorFocusOut",focusin:"onEditorFocusIn",start:"onEditorStart",beforecomplete:"onEditorBeforeComplete",complete:"onEditorComplete",cancel:"onEditorCancel",thisObj:this}}},{key:"onEditorStart",value:function(e){var t=e.source,n=this,r=n.editorContext=t.cellEditorContext;if(r){var i=n.grid,o=r.cell,a=r.editor,s=r.column;if(s.editTargetSelector){var l=o.querySelector(s.editTargetSelector);l&&(a.width-=l.offsetLeft,on.addTranslateX(a.element,l.offsetLeft))}o.classList.add("b-editing"),n.grid.on({cellclick:"onCellClickWhileEditing",viewportResize:"onViewportResizeWhileEditing"},n),n.removeEditingListeners=Gr.addListener({globaltap:"onTapOut",thisObj:n}),i.trigger("startCellEdit",{grid:i,editorContext:r})}}},{key:"onEditorBeforeComplete",value:function(e){var t=this.grid,n=e.source.cellEditorContext;return e.grid=t,e.editorContext=n,t.trigger("beforeFinishCellEdit",e)}},{key:"onEditorComplete",value:function(e){var t=e.source,n=this.grid,r=t.cellEditorContext;r.value=t.inputField.value,n.trigger("finishCellEdit",{grid:n,editorContext:r}),this.cleanupAfterEdit(r)}},{key:"onEditorCancel",value:function(){var e=this.editorContext,t=this.muteEvents,n=this.grid;e&&this.cleanupAfterEdit(e),t||n.trigger("cancelCellEdit",{grid:n})}},{key:"cleanupAfterEdit",value:function(e){var t=e.editor;e.cell.classList.remove("b-editing"),t.cellEditorContext=this.editorContext=null,this.grid.un({cellclick:"onCellClickWhileEditing",viewportResize:"onViewportResizeWhileEditing"},this),this.removeEditingListeners(),Gr.suspendFocusEvents(),t.element.remove(),Gr.resumeFocusEvents()}},{key:"getAdjacentEditableCell",value:function(e,t){for(var n=this.addNewAtEnd,r=this.grid,i=r.store,o=r.rowManager,a=e.id,s=e.columnId,l=r.columns,c=l.getAdjacentLeaf(s,t);a;){var u=i.getById(a);if(c){if(s=c.id,!c.hidden&&c.editor&&c.canEdit(u))return{id:a,columnId:c.id};c=l.getAdjacentLeaf(s,t)}else{var d=i.getAdjacent(e.id,t,!1,!0);!d&&t&&n&&(d=i.add("object"===re()(n)?mt.clone(n):{})[0],o.getRowFor(d)||o.displayRecordAtBottom()),a=d&&d.id,d&&(c=t?l.first:l.leaves[l.leaves.length-1])}}return null}},{key:"getEditingContext",value:function(e){e=this.grid.normalizeCellContext(e);var t=this.grid,n=t.columns.getById(e.columnId),r=t.store.getById(e.id),i=t.getCell(e);if(i&&n&&!n.hidden&&n.editor&&r&&!r.meta.specialRow&&n.canEdit(r)){var o=r&&r[n.field];return{column:n,record:r,cell:i,value:void 0===o?null:o,selector:e,editor:n.editor}}return!1}},{key:"startEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;if(!t.editorContext&&!t.disabled){var n=t.grid,r=n.normalizeCellContext(e);n.focusCell(e);var i=t.getEditingContext(r);if(!i||!1===n.trigger("beforeCellEditStart",{grid:n,editorContext:i}))return!1;if(i){on.focusWithoutScrolling(n.focusElement);var o=i.editor=t.getEditorForCell(i),a=i.cell,s=i.record,l=i.column;return o.inputField.highlightExternalChange=!1,o.cellEditorContext=i,o.render(t.grid.getSubGridFromColumn(l).element),o.startEdit({target:a,record:s,field:o.inputField.name||i.column.field}),!0}}return!1}},{key:"cancelEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.editorContext,r=t.editor,i=t.grid;n&&(r.containsFocus&&(t.editorContext=null,r.inputField.owns(on.activeElement)&&on.focusWithoutScrolling(i.focusElement),t.editorContext=n),t.muteEvents=e,r.cancelEdit(),t.muteEvents=!1)}},{key:"finishEditing",value:(r=ta()(Zo.a.mark((function e(){var t,n,r;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.editorContext,n=!1,!t){e.next=7;break}return r=t.column,e.next=6,t.editor.completeEdit(r.bindCallback(r.finalizeCellEdit));case 6:n=e.sent;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"onCellClickWhileEditing",value:function(e){var t=e.event,n=e.cellSelector,r=this;r.editorContext.editor.owns(t.target)||(r.getEditingContext(n)?r.finishEditing()?r.startEditing(n):(r.grid.focusCell(r.editorContext.selector),r.editor.inputField.focus()):r.finishEditing())}},{key:"onViewportResizeWhileEditing",value:function(){var e=this.editorContext,t=e.editor,n=e.column;t.width=n.element.offsetWidth}},{key:"onCellClick",value:function(e){var t=e.source,n=e.record,r=e.cellSelector,i=e.cellElement,o=e.target,a=e.event,s=t.focusedCell||{},l=t.columns.getById(r.columnId);if(l.onCellClick)l.onCellClick({grid:t,column:l,record:n,cellSelector:r,cellElement:i,target:o,event:a});else{if(o.closest(".b-tree-expander"))return this.cancelEditing(),!1;on.isTouchEvent&&r.id==s.id&&r.columnId==s.columnId&&this.startEditing(r)}}},{key:"onCellDblClick",value:function(e){var t=e.cellSelector;this.editorContext&&!this.finishEditing()||this.startEditing(t)}},{key:"onStoreUpdate",value:function(e){var t=e.changes,n=e.record,r=this.editorContext;r&&r.editor.isVisible&&n===r.record&&r.editor.dataField in t&&r.editor.refreshEdit()}},{key:"onGridBeforeRenderRows",value:function(){this.editorContext&&this.editorContext.editor.isVisible&&this.cancelEditing()}},{key:"onElementKeyDown",value:(n=ta()(Zo.a.mark((function e(t){var n,r,i,o,a,s,l;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,!t.handled&&n.grid.focusElement.contains(t.target)){e.next=3;break}return e.abrupt("return");case 3:if(n.editorContext){e.next=13;break}if(r=t.key,!(i=n.autoEdit&&(1===r.length||"Backspace"===r))&&!wd[r]||!n.grid.focusedCell){e.next=11;break}if(t.preventDefault(),n.startEditing(n.grid.focusedCell)){e.next=9;break}return e.abrupt("return");case 9:o=n.editor.inputField,a=o.input,i&&a&&(a.value="Backspace"===r?"":r,o.internalOnInput(t),o.moveCaretToEnd());case 11:e.next=39;break;case 13:if("Enter"!==t.key){e.next=25;break}return t.preventDefault(),t.stopPropagation(),e.next=18,n.finishEditing();case 18:if(!e.sent){e.next=25;break}if(n.isEditing){e.next=25;break}if(!(t.ctrlKey||t.metaKey||t.altKey||n.grid.touch)){e.next=24;break}return e.abrupt("return");case 24:t.shiftKey?n.grid.navigateUp()&&n.startEditing(n.grid.focusedCell):n.grid.navigateDown()&&n.startEditing(n.grid.focusedCell);case 25:if("F2"===t.key&&(t.preventDefault(),n.finishEditing()),"Escape"===t.key&&(t.stopPropagation(),t.preventDefault(),n.cancelEditing()),"Tab"!==t.key){e.next=38;break}if(t.preventDefault(),!(s=n.grid.focusedCell)){e.next=38;break}if(!(l=n.getAdjacentEditableCell(s,!t.shiftKey))){e.next=38;break}return e.next=35,n.finishEditing();case 35:if(!e.sent){e.next=38;break}n.grid.focusCell(l,{animate:100}),n.startEditing(l);case 38:Sd[t.key]&&(t.handled=!0);case 39:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onElementMouseDown",value:function(e){2===e.button&&this.editorContext&&e.preventDefault()}},{key:"onEditorFocusOut",value:function(e){var t=this,n=t.grid;t.editorContext&&!t.editor.isFinishing&&t.editor.inputField.owns(e.target)&&(e.toWidget!==n||n.isLocationEqual(t.grid.focusedCell,t.editorContext.selector))&&("cancel"===t.blurAction?t.cancelEditing():t.finishEditing())}},{key:"onEditorFocusIn",value:function(e){var t=e.toWidget;t===this.editor.inputField&&this.autoSelect&&t.selectAll&&!t.readOnly&&!t.disabled&&t.selectAll()}},{key:"onTapOut",value:function(e){var t=e.event,n=this;n.grid.bodyContainer.contains(t.target)||n.editor.owns(t.target)||("cancel"===n.blurAction?n.cancelEditing():n.finishEditing())}},{key:"onElementClick",value:function(e){e.target.classList.contains("b-grid-body-container")&&this.editorContext&&this.finishEditing()}},{key:"disabled",set:function(e){ei()(J()(a.prototype),"disabled",e,this,!0)},get:function(){var e=this.grid;return Boolean(se()(J()(a.prototype),"disabled",this)||e.disabled||e.readOnly)}},{key:"isEditing",get:function(){return Boolean(this.editorContext)}},{key:"activeRecord",get:function(){return this.editorContext&&this.editorContext.record||null}}],[{key:"$name",get:function(){return"CellEdit"}},{key:"defaultConfig",get:function(){return{autoSelect:!0,blurAction:"complete",addNewAtEnd:null,autoEdit:!1,editorClass:ts}}},{key:"pluginConfig",get:function(){return{assign:["startEditing"],before:["onElementKeyDown","onElementMouseDown"],chain:["onElementClick"]}}}]),a}(or(ho));function Rd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Cd._$name="CellEdit",bd.registerFeature(Cd,!0);var xd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Rd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,this.processConfig(t))}},{key:"initTip",value:function(){var e=this;e.tip=new Ui(Object.assign({forElement:e.client.element,forSelector:".b-grid-cell",hoverDelay:1e3,trackMouse:!1,cls:"b-celltooltip-tip",getHtml:e.getTooltipContent.bind(e),listeners:{pointerOver:"onPointerOver",thisObj:e}},e.initialConfig)),e.relayEvents(e.tip,["beforeshow","show"])}},{key:"onPointerOver",value:function(e){var t=e.target;return!1!==this.client.getColumnFromElement(t).tooltipRenderer}},{key:"processConfig",value:function(e){return"function"==typeof e?{tooltipRenderer:e}:e}},{key:"setConfig",value:function(e){se()(J()(r.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){this.tip&&this.tip.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e?this.tip&&(this.tip.destroy(),this.tip=null):this.initTip(),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"getTooltipContent",value:function(e){var t,n=e.tip,r=e.activeTarget,i=e.event,o=this,a=o.client.getRecordFromElement(r),s=o.client.getColumnFromElement(r);return o.forSelector||a!==o.lastRecord||s!==o.lastColumn?(o.lastRecord=a,o.lastColumn=s,s.tooltipRenderer?!1===(t=s.tooltipRenderer({cellElement:r,record:a,column:s,event:i,tip:n,cellTooltip:o}))&&j.deprecate("Grid","5.0.0","Returning false to indicate loading is deprecated. Please see https://bryntum.com/docs/grid/#guides/upgrades/3.0.1.md for more information"):o.tooltipRenderer&&!1!==s.tooltipRenderer&&!1===(t=o.tooltipRenderer({cellElement:r,record:a,column:s,event:i,tip:n,cellTooltip:o}))&&j.deprecate("Grid","5.0.0","Returning false to indicate loading is deprecated. Please see https://bryntum.com/docs/grid/#guides/upgrades/3.0.1.md for more information"),t):o.tip._html}}],[{key:"$name",get:function(){return"CellTooltip"}},{key:"defaultConfig",get:function(){return{tooltipRenderer:null}}}]),r}(ho);function Ed(){var e=Ti()(['\n                        <div class="b-target-button" data-name="','" data-disabled="','">\n                            <i class="','"></i>\n                            ',"\n                        </div>\n                    "]);return Ed=function(){return e},e}function Dd(){var e=Ti()(['\n                <div class="b-group">\n                    <div class="b-buttons">\n                    ','\n                    </div>\n                    <div class="b-title">',"</div>\n                </div>\n            "]);return Dd=function(){return e},e}function Td(){var e=Ti()(['\n            <div class="b-columndragtoolbar">     \n            <div class="b-title"></div>          \n            ',"\n            </div>"]);return Td=function(){return e},e}function Md(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}xd._$name="CellTooltip",bd.registerFeature(xd);var Ad=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Md()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){e.features.columnReorder&&e.features.columnReorder.on("beforedestroy",this.onColumnReorderBeforeDestroy,this),this.grid=e,se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){var e=this;e.grid.features.columnReorder&&!e.grid.features.columnReorder.isDestroyed&&e.detachFromColumnReorder(),e.element&&e.element.remove(),e.element=null,se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.initialized&&(e?this.detachFromColumnReorder():this.init()),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"init",value:function(){var e=this,t=e.grid;t.features.columnReorder&&(e.reorderDetacher=t.features.columnReorder.on({gridheaderdragstart:function(n){var r=n.context,i=t.columns.getById(r.element.dataset.columnId);e.showToolbar(i)},gridheaderdrag:function(t){var n=t.context;return e.onDrag(n)},gridheaderabort:function(){e.hideToolbar()},gridheaderdrop:function(t){var n=t.context;n.valid?e.hideToolbar():e.onDrop(n)},thisObj:e}),e.initialized=!0)}},{key:"onColumnReorderBeforeDestroy",value:function(){this.detachFromColumnReorder()}},{key:"detachFromColumnReorder",value:function(){var e=this;e.grid.features.columnReorder.un("beforedestroy",e.onColumnReorderBeforeDestroy,e),e.reorderDetacher&&e.reorderDetacher(),e.reorderDetacher=null}},{key:"render",value:function(){this.initialized||this.init()}},{key:"showToolbar",value:function(e){var t=this,n=t.grid.getColumnDragToolbarItems(e,[]),r=[];t.clearTimeout(t.buttonHideTimer),t.clearTimeout(t.toolbarHideTimer),n.forEach((function(e){var t=r.find((function(t){return t.text===e.group}));t||(t={text:e.group,buttons:[]},r.push(t)),t.buttons.push(e)})),t.element=on.append(t.grid.element,t.template(r)),t.groups=r,t.buttons=n,t.column=e}},{key:"hideToolbar",value:function(){var e=this;return new Promise((function(t){e.element&&!e.toolbarHideTimer&&(e.element.classList.add("b-remove"),e.toolbarHideTimer=e.setTimeout((function(){e.toolbarHideTimer=null,e.element&&e.element.remove(),e.element=null,t()}),200))}))}},{key:"onDrag",value:function(e){var t=this;if(e.dragProxy.getBoundingClientRect().top-t.grid.element.getBoundingClientRect().top>100?t.element.classList.add("b-closer"):t.element.classList.remove("b-closer"),t.hoveringButton&&(t.hoveringButton.classList.remove("b-hover"),t.hoveringButton=null),e.targetElement&&e.targetElement.closest(".b-columndragtoolbar")){t.element.classList.add("b-hover");var n=e.targetElement.closest(".b-columndragtoolbar  .b-target-button:not([data-disabled=true])");n&&(n.classList.add("b-hover"),t.hoveringButton=n)}else t.element.classList.remove("b-hover")}},{key:"onDrop",value:function(e){var t=this;if(e.targetElement&&e.targetElement.matches(".b-columndragtoolbar .b-target-button:not([data-disabled=true])")){var n=e.targetElement,r=t.buttons.find((function(e){return e.name===n.dataset.name}));r&&(n.classList.add("b-activate"),t.buttonHideTimer=t.setTimeout((function(){t.hideToolbar(),r.onDrop({column:t.column})}),100))}else t.hideToolbar()}},{key:"template",value:function(e){return Ii.tpl(Td(),e.map((function(e){return Ii.tpl(Dd(),e.buttons.map((function(e){return Ii.tpl(Ed(),e.name,e.disabled,e.icon,e.text)})),e.text)})))}}],[{key:"$name",get:function(){return"ColumnDragToolbar"}},{key:"pluginConfig",get:function(){return{after:["render"]}}}]),r}(or(ho));function Id(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ad.featureClass="b-hascolumndragtoolbar",Ad._$name="ColumnDragToolbar",bd.registerFeature(Ad,Re.isTouchDevice);var Fd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Id()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.grid=e,se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"getColumnPickerItems",value:function(e){var t=this;if(t.groupByRegion)return t.grid.regions.map((function(e){var n=t.grid.getSubGrid(e).columns.topColumns;return{text:L.capitalizeFirstLetter(e),menu:t.buildColumnMenu(n),disabled:0===n.length,region:e}}));if(t.groupByTag){var n={};return e.topColumns.forEach((function(e){e.tags&&e.hideable&&e.tags.forEach((function(e){n[e]||(n[e]=1)}))})),Object.keys(n).sort().map((function(e){return{text:L.capitalizeFirstLetter(e),menu:t.buildColumnMenu(t.getColumnsForTag(e)),tag:e,onBeforeSubMenu:function(e){var n=e.item,r=e.itemEl;t.refreshTagMenu(n,r)}}}))}return t.buildColumnMenu(e.topColumns)}},{key:"getColumnsForTag",value:function(e){return this.grid.columns.records.filter((function(t){return t.tags&&t.tags.includes(e)&&!1!==t.hideable}))}},{key:"refreshTagMenu",value:function(e,t){this.getColumnsForTag(e.tag).forEach((function(t){var n=e.items.find((function(e){return e.column===t}));n&&(n.checked=!0!==t.hidden)}))}},{key:"buildColumnMenu",value:function(e){var t=this,n=e.length>0&&e[0].region,r=this.grid;return e.reduce((function(e,i){var o=t.grid.columns.visibleColumns.filter((function(e){return e.region===i.region}));if(!1!==i.hideable){var a={grid:r,text:i.text,column:i,name:i.id,checked:!0!==i.hidden,disabled:!0!==i.hidden&&1===o.length,cls:i.region!==n?"b-separator":""};n=i.region,i.children&&(a.menu=t.buildColumnMenu(i.children)),e.push(a)}return e}),[])}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.grid,i=n.disabled,o=r.columns;if(!1!==e.showColumnPicker&&o.some((function(e){return e.hideable}))&&t.push({text:n.L("columnsMenu"),name:"columnPicker",icon:"b-fw-icon b-icon-columns",cls:"b-separator",weight:100,menu:n.getColumnPickerItems(o),onToggle:n.onColumnToggle,disabled:i}),!1!==e.hideable){var a=o.visibleColumns.filter((function(t){return t.region===e.region}));t.push({text:n.L("hideColumn"),icon:"b-fw-icon b-icon-hide-column",weight:101,name:"hideColumn",disabled:1===a.length||i,onItem:function(){return e.hide()}})}}},{key:"onColumnToggle",value:function(e){var t=e.menu,n=e.item,r=e.checked;if(!!n.column.hidden!=!r){n.column[r?"show":"hide"]();var i=n.grid,o=n.column,a=i.columns,s=t.items,l=a.visibleColumns.filter((function(e){return e.region===n.column.region})),c=i.features.contextMenu.currentMenu.items.find((function(e){return"hideColumn"===e.name}));if(1===l.length){var u=s.find((function(e){return e.name===l[0].id}));u&&(u.disabled=!0),c&&o.region===n.column.region&&(c.disabled=!0)}else l.forEach((function(e){var t=s.find((function(t){return t.column===e}));t&&(t.disabled=!1)})),c&&o.region===n.column.region&&(c.disabled=!1);n.menu&&n.menu.eachWidget((function(e){e.checked=r}));var d=t.owner;if(d&&d.column===o.parent){var f=s.some((function(e){return!0===e.checked}));d.checked=f}}}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this.grid.columns.visibleColumns.filter((function(t){return t.region===e.region}));return!1!==e.hideable&&n.length>1&&t.push({text:this.L("hideColumnShort"),group:this.L("Column"),icon:"b-fw-icon b-icon-hide-column",weight:101,name:"hideColumn",onDrop:function(e){return e.column.hide()}}),t}}],[{key:"$name",get:function(){return"ColumnPicker"}},{key:"defaultConfig",get:function(){return{groupByRegion:!1,groupByTag:!1}}},{key:"pluginConfig",get:function(){return{chain:["getHeaderMenuItems","getColumnDragToolbarItems"]}}}]),r}(ho);function Od(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Fd._$name="ColumnPicker",bd.registerFeature(Fd,!0);var _d=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Od()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.ignoreSelectors=[".b-grid-header-resize-handle",".b-field"],this.grid=e,se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){this.dragHelper&&this.dragHelper.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"init",value:function(){var e=this,t=e.grid,n=t.element,r=on.children(n,".b-grid-headers");r.push.apply(r,Z()(on.children(n,".b-grid-header-children"))),e.dragHelper?e.dragHelper.containers=r:(e.dragHelper=new Tc({name:"columnReorder",mode:"container",dragThreshold:10,targetSelector:".b-grid-header",outerElement:n.querySelector("header.b-grid-header-container"),containers:r,isElementDraggable:function(n){if(Boolean(on.up(n,e.ignoreSelectors.join(",")))||e.disabled)return!1;var r=on.up(n,this.targetSelector),i=r&&t.columns.getById(r.dataset.columnId),o=i&&0===i.childLevel&&1===t.subGrids[i.region].columns.count;return Boolean(i)&&!1!==i.draggable&&!o},ignoreSelector:".b-filter-icon,.b-grid-header-resize-handle",listeners:{dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,thisObj:e}}),e.relayEvents(e.dragHelper,["dragStart","drag","drop","abort"],"gridHeader"))}},{key:"onDrag",value:function(e){var t=e.context,n=e.event,r=we.fromElement(n.target,"header");r&&r.subGrid.sealedColumns?t.valid=!1:this.grid.features.columnDragToolbar||(t.valid=Boolean(n.target.closest(".b-grid-headers")))}},{key:"onDragStart",value:function(){if(!this.grid.features.columnDragToolbar){var e=this.grid.element.querySelector(".b-grid-header-container").getBoundingClientRect();this.dragHelper.minY=e.top,this.dragHelper.maxY=e.bottom}this.grid.headerContainer.classList.add("b-dragging-header")}},{key:"onDrop",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this.grid,r=t.dragging,i=on.up(t.target,".b-grid-header"),o=n.columns.get(i.dataset.column),a=t.draggedTo.dataset.region||o.region,s=t.insertBefore,l=n.columns.getById(r.dataset.columnId),c=s?n.columns.getById(s.dataset.columnId):n.subGrids[a].columns.last.nextSibling,u=c?c.parent:n.columns.rootNode;if(n.headerContainer.classList.remove("b-dragging-header"),a!==l.region||o!==l.previousSibling&&c!==l.nextSibling){var d=l.parent&&1===l.parent.children.length&&l.parent;d&&d.parent.removeChild(d),r.remove(),l.region=a,u.insertChild(l,c)}else this.dragHelper.abort()}},{key:"onInvalidDrop",value:function(){this.grid.headerContainer.classList.remove("b-dragging-header")}},{key:"renderContents",value:function(){this.init()}},{key:"render",value:function(){this.init()}}],[{key:"$name",get:function(){return"ColumnReorder"}},{key:"pluginConfig",get:function(){return{after:["render","renderContents"]}}}]),r}(or(ho));function Pd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}_d.featureClass="b-column-reorder",_d._$name="ColumnReorder",bd.registerFeature(_d,!0);var Ld=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Pd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;n.grid=e,se()(J()(r.prototype),"construct",this).call(this,e,t),n.resizer=new jc({name:"columnResize",targetSelector:".b-grid-header",handleSelector:".b-grid-header-resize-handle",outerElement:e.element,listeners:{beforeresizestart:n.onBeforeResizeStart,resizestart:n.onResizeStart,resizing:n.onResizing,resize:n.onResize,thisObj:n}})}},{key:"doDestroy",value:function(){this.resizer&&this.resizer.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onBeforeResizeStart",value:function(){return!this.disabled}},{key:"onResizeStart",value:function(e){var t=e.context,n=this.grid,r=this.resizer,i=t.column=n.columns.getById(t.element.dataset.columnId);r.minWidth=i.minWidth,t.element.style.minWidth="",n.element.classList.add("b-column-resizing")}},{key:"onResizing",value:function(e){var t=e.context;t.valid&&this.liveResize&&(this.grid.dragResizing=!0,t.column.width=t.newWidth)}},{key:"onResize",value:function(e){var t=e.context,n=this.grid,r=t.column;if(n.element.classList.remove("b-column-resizing"),t.valid&&(this.liveResize?(n.dragResizing=!1,n.afterColumnsResized()):r.width=t.newWidth,Re.isIE11&&r.parent&&r.parent.flex)){var i=r.parent;n.getHeaderElement(i.id).style.flexBasis=i.children.reduce((function(e,t){return e+n.getHeaderElement(t.id).offsetWidth}),0)+"px"}}},{key:"liveResize",set:function(e){"auto"===e&&(e=!Re.isMobileSafari),this._liveResize=e},get:function(){return this._liveResize}}],[{key:"$name",get:function(){return"ColumnResize"}},{key:"defaultConfig",get:function(){return{liveResize:"auto"}}},{key:"pluginConfig",get:function(){return[]}}]),r}(ho);function Hd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ld._$name="ColumnResize",bd.registerFeature(Ld,!0);var jd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Hd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.grid=e,se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){this.currentMenu&&this.currentMenu.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onElementContextMenu",value:function(e){"contextmenu"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementClick",value:function(e){"click"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementDblClick",value:function(e){"dblclick"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(".b-grid-header.b-depth-0"))switch(e.key){case" ":case"ArrowDown":this.showContextMenu(e)}}},{key:"showContextMenu",value:function(e){if(!this.disabled){var t=on.up(e.target,".b-grid-header"),n=this.grid.getEventData(e);t?this.handleHeaderContextMenu(t,e):n&&!this.disableCellContextMenu&&this.handleCellContextMenu(n,e)}}},{key:"handleHeaderContextMenu",value:function(e,t){if(e.dataset.column){var n=this,r=n.grid,i=r.columns.getById(e.dataset.columnId);if(!1!==i.enableHeaderContextMenu){var o=[].concat(Z()(n.headerItems),Z()(i.headerMenuItems||[])),a=n.processHeaderItems,s={items:o,column:i,event:t,element:e};r.getHeaderMenuItems(i,o),(!a||!1!==a(s))&&o.length>0&&(t.preventDefault(),o.sort((function(e,t){return(e.weight||150)-(t.weight||150)})),o.forEach((function e(t){t.column||(t.column=i);var n=t.menu;n&&(Array.isArray(n)||(n=n.items||n.widgets),n.forEach(e))})),!1!==r.trigger("headerContextMenuBeforeShow",s)&&(n.currentMenu=Ce.showContextMenu("keydown"===t.type?e:[t.clientX+1,t.clientY+1],{owner:n.client,constrainTo:document,cls:"b-context-menu",items:o,scrollAction:"hide",onItem:function(e){e.source;var t=e.item,n=e.element;r.trigger("contextMenuItem",{source:r,item:t,column:i,element:n})},onToggle:function(e){e.source;var t=e.item,n=e.checked,o=e.element;r.trigger("contextMenuToggleItem",{source:r,item:t,column:i,checked:n,element:o})},onDestroy:function(){n.currentMenu=null},listeners:{show:function(e){var t=e.source;s.menu=t,r.trigger("headerContextMenuShow",s)}}})))}}}},{key:"handleCellContextMenu",value:function(e,t){var n=this,r=n.grid,i=e.cellElement,o=r.columns.getById(e.columnId);if(!1!==o.enableCellContextMenu){r.focusCell(e.cellSelector,{doSelect:!r.isSelected(e.id),event:t});var a=e.record,s=[].concat(Z()(n.cellItems||[]),Z()(o.cellMenuItems||[])),l=n.processCellItems,c={items:s,column:o,event:t,record:a,element:i};r.getCellMenuItems(o,a,s),(!l||!1!==l(c))&&s.length>0&&(s.forEach((function(e){e.column=o,e.record=a})),t.preventDefault(),s.sort((function(e,t){return(e.weight||150)-(t.weight||150)})),!1!==r.trigger("cellContextMenuBeforeShow",c)&&(n.currentMenu=Ce.showContextMenu([t.clientX+1,t.clientY+1],{owner:n.client,items:s,onBeforeItem:function(e){Object.assign(e,c)},onItem:function(e){var t=e.item;r.trigger("contextMenuItem",{source:r,item:t,column:o,record:a,cell:i})},onClose:function(e){"outside"!==e.reason&&r.focus()},onDestroy:function(){n.currentMenu=null},listeners:{show:function(e){var t=e.source;c.menu=t,r.trigger("cellContextMenuShow",c)}}})))}}},{key:"hideContextMenu",value:function(e){this.currentMenu&&this.currentMenu.hide(e)}},{key:"triggerEvent",get:function(){return this._triggerEvent||this.client.contextMenuTriggerEvent},set:function(e){this._triggerEvent=e}}],[{key:"$name",get:function(){return"ContextMenu"}},{key:"defaultConfig",get:function(){return{headerItems:[],processHeaderItems:null,cellItems:[],processCellItems:null,triggerEvent:null,disableCellContextMenu:null}}},{key:"pluginConfig",get:function(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onElementKeyDown"]}}}]),r}(ho);function Bd(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Nd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nd(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Nd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}jd.featureClass="",jd._$name="ContextMenu",bd.registerFeature(jd,!0);var Vd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(zd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;n.grid=e,n.store=e.store,n.closeFilterEditor=n.closeFilterEditor.bind(n),se()(J()(r.prototype),"construct",this).call(this,e,t),n.store.on({filter:n.onStoreFilter},n),t&&"object"===re()(t)&&n.store.filter(t,null,n.client.isConfiguring)}},{key:"doDestroy",value:function(){var e=this;e.filterTip&&e.filterTip.destroy(),e.filterEditorPopup&&e.filterEditorPopup.destroy(),e.store.un({sort:e.onStoreFilter},e),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"refreshHeaders",value:function(e){var t=this,n=t.grid,r=n.headerContainer;if(r){on.children(r,".b-filter-icon.b-latest").forEach((function(e){return e.classList.remove("b-latest")})),t.filterTip||(t.filterTip=new Ui({forElement:r,forSelector:".b-filter-icon",getHtml:function(e){return e.activeTarget.dataset.filterText}}));var i,o=Bd(n.columns);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(!1!==a.filterable){var s=t.store.filters.getBy("property",a.field),l=a.element;if(l){var c=a.textWrapper,u=c&&c.querySelector(".b-filter-icon"),d=void 0;d=s?t.L("filter")+": "+("string"==typeof s?s:"".concat(s.operator," ").concat(s.displayValue||s.value||"")):t.L("applyFilter"),u?u.dataset.filterText=d:(u=on.createElement({parent:c,tag:"div",className:"b-filter-icon",dataset:{filterText:d}}),l.classList.add("b-filterable")),a.field===t.store.latestFilterField&&u.classList.add("b-latest"),l.classList[s?"add":"remove"]("b-filter")}a.meta.isFiltered=!!s}}}catch(e){o.e(e)}finally{o.f()}e&&n.refreshRows()}}},{key:"applyFilter",value:function(e){var t=this.store,n=this.grid.columns.get(e.property);"function"==typeof n.filterable?t.filter({filterBy:function(t){return n.filterable(Object.assign({},e,{record:t}))},value:e.value,property:e.property,operator:e.operator,displayValue:e.displayValue}):t.filter(e)}},{key:"getPopupDateItems",value:function(e,t,n,r,i,o,a){var s=this,l=o,c=a;function u(e){var t=e.source,n=e.value;null==n?a():(s.applyFilter({property:r,operator:t.operator,value:n,displayValue:t._value}),o())}return[{type:"date",ref:"on",placeholder:s.L("on"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:t&&"="===t.operator?t.value:n,operator:"=",onChange:u,onClose:l,onClear:c},{type:"date",ref:"before",placeholder:s.L("before"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-before"></i>',value:t&&"<"===t.operator?t.value:null,operator:"<",onChange:u,onClose:l,onClear:c},{type:"date",ref:"after",cls:"b-last-row",placeholder:s.L("after"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-after"></i>',value:t&&">"===t.operator?t.value:null,operator:">",onChange:u,onClose:l,onClear:c}]}},{key:"getPopupNumberItems",value:function(e,t,n,r,i,o,a){var s=this,l=o,c=a;function u(e){var t=e.source,n=e.value;null==n?a():(s.applyFilter({property:r,operator:t.operator,value:n}),o())}return[{type:"number",placeholder:s.L("equals"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:t&&"="===t.operator?t.value:n,operator:"=",onChange:u,onEsc:l,onClear:c},{type:"number",placeholder:s.L("lessThan"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:t&&"<"===t.operator?t.value:null,operator:"<",onChange:u,onEsc:l,onClear:c},{type:"number",cls:"b-last-row",placeholder:s.L("moreThan"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:t&&">"===t.operator?t.value:null,operator:">",onChange:u,onEsc:l,onClear:c}]}},{key:"getPopupStringItems",value:function(e,t,n,r,i,o,a){var s=this;return[{type:e,cls:"b-last-row",placeholder:s.L("filter"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:t?t.value||t:n,onChange:function(e){var t=e.value;""===t?a():(s.applyFilter({property:r,value:t}),o())},onClose:o,onClear:a}]}},{key:"getPopupItems",value:function(e,t,n,r,i,o,a){switch(e){case"date":return this.getPopupDateItems.apply(this,arguments);case"number":return this.getPopupNumberItems.apply(this,arguments);default:return this.getPopupStringItems.apply(this,arguments)}}},{key:"showFilterEditor",value:function(e,t){var n=this,r=n.store,i="string"==typeof e?n.grid.columns.getById(e):e,o=i.element,a=r.modelClass.fieldMap[i.field],s=r.filters.getBy("property",i.field),l={string:"text",number:"number",date:"date"}[a&&a.type||i.filterType||i.type||"string"]||"text";!1!==i.filterable&&(n.closeFilterEditor(),n.filterEditorPopup=Ce.openPopup(o,{owner:this.grid,width:"16em",cls:"b-filter-popup",scrollAction:"realign",items:n.getPopupItems(l,s,t,i.field,n.store,n.closeFilterEditor,(function(){n.store.removeFieldFilter(i.field),n.closeFilterEditor()}))}))}},{key:"closeFilterEditor",value:function(){this.filterEditorPopup&&this.filterEditorPopup.setTimeout(this.filterEditorPopup.destroy),this.filterEditorPopup=null}},{key:"getMenuDateItems",value:function(e,t){var n=this,r=t[e.field],i=function(t){n.applyFilter({property:e.field,operator:t,value:r,displayValue:e.formatValue?e.formatValue(r):r})};return[{text:n.L("on"),icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterDateEquals",disabled:n.disabled,onItem:function(){return i("=")}},{text:n.L("before"),icon:"b-fw-icon b-icon-filter-before",name:"filterDateBefore",disabled:n.disabled,onItem:function(){return i("<")}},{text:n.L("after"),icon:"b-fw-icon b-icon-filter-after",name:"filterDateAfter",disabled:n.disabled,onItem:function(){return i(">")}}]}},{key:"getMenuNumberItems",value:function(e,t){var n=this,r=function(r){n.applyFilter({property:e.field,operator:r,value:t[e.field]})};return[{text:n.L("equals"),icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterNumberEquals",disabled:n.disabled,onItem:function(){return r("=")}},{text:n.L("lessThan"),icon:"b-fw-icon b-icon-filter-less",name:"filterNumberLess",disabled:n.disabled,onItem:function(){return r("<")}},{text:n.L("moreThan"),icon:"b-fw-icon b-icon-filter-more",name:"filterNumberMore",disabled:n.disabled,onItem:function(){return r(">")}}]}},{key:"getMenuStringItems",value:function(e,t){var n=this;return[{text:this.L("equals"),icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterStringEquals",disabled:this.disabled,onItem:function(){n.applyFilter({property:e.field,value:t[e.field]})}}]}},{key:"getCellMenuItems",value:function(e,t,n){var r=this,i=t.getFieldDefinition(e.field);if(!1!==e.filterable){var o=[];switch(e.meta.isFiltered&&o.push({text:r.L("removeFilter"),icon:"b-fw-icon b-icon-clear",cls:"b-separator",name:"filterRemove",disabled:r.disabled,onItem:function(){r.store.removeFieldFilter(e.field)}}),e.filterType||e.type||i&&i.type){case"date":o.push.apply(o,Z()(r.getMenuDateItems.apply(r,arguments)));break;case"number":o.push.apply(o,Z()(r.getMenuNumberItems.apply(r,arguments)));break;default:o.push.apply(o,Z()(r.getMenuStringItems.apply(r,arguments)))}e.meta.isFiltered&&o.length>1&&(o[1].cls=""),n.push.apply(n,o)}}},{key:"getHeaderMenuItems",value:function(e,t){var n=this;e.meta.isFiltered?(t.push({text:n.L("editFilter"),name:"editFilter",icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:n.disabled,onItem:function(){n.showFilterEditor(e)}}),t.push({text:n.L("removeFilter"),name:"removeFilter",icon:"b-fw-icon b-icon-remove",disabled:n.disabled,onItem:function(){n.store.removeFieldFilter(e.field)}})):!1!==e.filterable&&t.push({text:n.L("filter"),name:"filter",icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:n.disabled,onItem:function(){n.showFilterEditor(e)}})}},{key:"onStoreFilter",value:function(){this.refreshHeaders(!1)}},{key:"renderHeader",value:function(){this.refreshHeaders(!1)}},{key:"onElementClick",value:function(e){var t=e.target;if(this.filterEditorPopup&&this.closeFilterEditor(),t.classList.contains("b-filter-icon")){var n=on.up(t,".b-grid-header");return this.showFilterEditor(n.dataset.columnId),!1}}}],[{key:"$name",get:function(){return"Filter"}},{key:"pluginConfig",get:function(){return{chain:["renderHeader","getCellMenuItems","getHeaderMenuItems","onElementClick"]}}}]),r}(ho);function Wd(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Ud(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ud(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Ud(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Vd._$name="Filter",bd.registerFeature(Vd);var Yd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Gd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;Object.assign(n,{filterFieldCls:"b-filter-bar-field",filterFieldInputCls:"b-filter-bar-field-input",filterableColumnCls:"b-filter-bar-enabled",filterFieldInputSelector:".b-filter-bar-field-input",filterableColumnSelector:".b-filter-bar-enabled",filterParseRegExp:/^\s*([<>=*])?(.*)$/,storeTrackingSupended:0,store:e.store,grid:e}),n.onColumnFilterFieldChange=n.onColumnFilterFieldChange.bind(n),se()(J()(r.prototype),"construct",this).call(this,e,Array.isArray(t)?{filter:t}:t),n.store.on({filter:n.onStoreFilter,thisObj:n}),n.filter&&n.store.filter(n.filter),n.gridDetacher=e.on("beforeelementclick",n.onBeforeElementClick,n)}},{key:"doDestroy",value:function(){this.destroyFilterBar(),this.gridDetacher&&this.gridDetacher(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var t=this,n=this.grid.columns;n&&n.forEach((function(n){var r=t.getColumnFilterField(n);r&&(r.disabled=e)})),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"destroyFilterBar",value:function(){this.grid.columns&&this.grid.columns.forEach(this.destroyColumnFilterField,this)}},{key:"hideFilterBar",value:function(){var e=this,t=e.grid.columns;e.clearStoreFiltersOnHide&&e.suspendStoreTracking(),t&&t.forEach((function(t){return e.hideColumnFilterField(t,!0)})),e.grid.store.filter(),e.clearStoreFiltersOnHide&&e.resumeStoreTracking(),e.hidden=!0}},{key:"showFilterBar",value:function(){this.renderFilterBar(),this.hidden=!1}},{key:"toggleFilterBar",value:function(){this.hidden?this.showFilterBar():this.hideFilterBar()}},{key:"renderFilterBar",value:function(){var e=this;this.grid.columns.visibleColumns.forEach((function(t){return e.renderColumnFilterField(t)})),this.rendered=!0}},{key:"renderColumnFilterField",value:function(e){var t=this,n=t.grid,r=t.getColumnFilterable(e);if(r&&!e.hidden){var i=e.element,o=t.getColumnFilterField(e);if(o)t.onColumnFilterFieldChange({source:o,value:o.value}),o.render(i),o.show();else{var a=n.store.filters.getBy("property",e.field),s="".concat(e.filterType||"text","field");o=Ce.append(Object.assign({type:s,owner:t.grid,clearable:!0,column:e,name:e.field,value:a&&t.buildFilterString(a),cls:t.filterFieldCls,inputCls:t.filterFieldInputCls,keyStrokeChangeDelay:t.keyStrokeFilterDelay,onChange:t.onColumnFilterFieldChange,onClear:t.onColumnFilterFieldChange,disabled:t.disabled},r.filterField),i)[0],t.setColumnFilterField(e,o)}i.classList.add(t.filterableColumnCls)}}},{key:"updateColumnFilterFields",value:function(){var e,t,n,r=this.grid,i=Wd(r.columns);try{for(i.s();!(n=i.n()).done;){var o=n.value;(e=this.getColumnFilterField(o))&&(t=r.store.filters.getBy("property",o.field),e.value=t&&this.buildFilterString(t)||"")}}catch(e){i.e(e)}finally{i.f()}}},{key:"getColumnFilterable",value:function(e){if(!e.isRoot&&!1!==e.filterable&&e.field)return"function"==typeof e.filterable&&(e.filterable={filterFn:e.filterable}),e.filterable}},{key:"destroyColumnFilterField",value:function(e){var t=this.getColumnFilterField(e);t&&(this.hideColumnFilterField(e),t.destroy(),this.setColumnFilterField(e,void 0))}},{key:"hideColumnFilterField",value:function(e,t){var n=this.grid.store,r=e.element,i=this.getColumnFilterField(e);i&&(i.hide(),this.clearStoreFiltersOnHide&&e.field&&n.removeFieldFilter(e.field,t),r.classList.remove(this.filterableColumnCls))}},{key:"getColumnFilterField",value:function(e){return this._columnFilters&&this._columnFilters[e.data.id]}},{key:"setColumnFilterField",value:function(e,t){this._columnFilters=this._columnFilters||{},this._columnFilters[e.data.id]=t}},{key:"parseFilterValue",value:function(e){var t=String(e).match(this.filterParseRegExp);return{operator:t[1]||"*",value:t[2]}}},{key:"buildFilterString",value:function(e){var t;return e&&!e.initialConfig.filterBy&&(t=("*"===e.operator?"":e.operator)+e.value),t}},{key:"onStoreFilter",value:function(){!this.storeTrackingSupended&&this.rendered&&this.updateColumnFilterFields()}},{key:"suspendStoreTracking",value:function(){this.storeTrackingSupended++}},{key:"resumeStoreTracking",value:function(){this.storeTrackingSupended--}},{key:"renderHeader",value:function(){this.renderFilterBar()}},{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(this.filterFieldInputSelector))switch(e.key){case"ArrowLeft":case"ArrowRight":e.handled=!0}}},{key:"onBeforeElementClick",value:function(e){if(e.event.target.closest("."+this.filterFieldCls))return!1}},{key:"onColumnFilterFieldChange",value:function(e){var t=e.source,n=e.value,r=this,i=r.grid.store,o=r.getColumnFilterable(t.column);r.suspendStoreTracking(),null==n||""===n||Array.isArray(n)&&0===n.length?i.removeFieldFilter(t.name):o.filterFn?i.filter({filterBy:function(e){return o.filterFn({property:t.name,value:n,record:e})},property:t.name}):i.filter(Object.assign({property:t.name},r.parseFilterValue(n))),r.resumeStoreTracking()}},{key:"getHeaderMenuItems",value:function(e,t){var n=this;t.push({text:n.L(n.hidden?"enableFilterBar":"disableFilterBar"),name:"toggleFilterBar",icon:"b-fw-icon b-icon-filter",cls:"b-separator",onItem:function(){return n.toggleFilterBar()}})}}],[{key:"$name",get:function(){return"FilterBar"}},{key:"defaultConfig",get:function(){return{keyStrokeFilterDelay:300,clearStoreFiltersOnHide:!0}}},{key:"pluginConfig",get:function(){return{before:["onElementKeyDown"],chain:["renderHeader","getHeaderMenuItems"]}}}]),r}(ho);function $d(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return qd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qd(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function qd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Yd.featureClass="b-filter-bar",Yd._$name="FilterBar",bd.registerFeature(Yd);var Kd=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Xd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;e.features.tree||(n._thisIsAUsedExpression(e.features.groupSummary),t=n.processConfig(t),Object.assign(n,{grid:e,rowManager:e.rowManager,store:e.store}),se()(J()(r.prototype),"construct",this).call(this,e,t),n.store.on({group:n.onStoreGroup,groupingoff:n.onStoreGroupingOff,thisObj:n}),n.rowManager.on({rendercell:n.renderCell,thisObj:n}))}},{key:"processConfig",value:function(e){return"string"==typeof e?{field:e,ascending:null}:e}},{key:"setConfig",value:function(e){null===e?this.store.clearGroupers():se()(J()(r.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var t=this.store;if(e&&t.isGrouped){var n=t.sorters;n.unshift.apply(n,Z()(t.groupers)),t.clearGroupers(),t.sort(n)}se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"toggleCollapse",value:function(e,t){this.internalToggleCollapse(e,t)}},{key:"internalToggleCollapse",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.store,o=i.getById(e),a=o.meta;void 0!==a.groupRowFor&&((t=void 0===t?!a.collapsed:t)?i.excludeGroupRecords(o):i.includeGroupRecords(o),a.collapsed=t,r.grid.trigger("toggleGroup",{groupRecord:o,collapse:t}),n||r.rowManager.renderFromRecord(o))}},{key:"collapseAll",value:function(){var e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((function(t){return e.internalToggleCollapse(t,!0,!0)})),e.grid.refreshRows(!0))}},{key:"expandAll",value:function(){var e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((function(t){return e.internalToggleCollapse(t,!1,!0)})),e.grid.refreshRows())}},{key:"renderCell",value:function(e){if(this.store.isGrouped&&!this.disabled){var t=e.cellElement,n=e.rowElement,r=e.column,i=this.grid,o=e.record.meta,a=i.columns.visibleColumns[0],s=i.subGrids[i.regions[0]].columns.visibleColumns;Object.prototype.hasOwnProperty.call(o,"groupRowFor")?(r.clearCell(t),n.classList[o.collapsed?"add":"remove"]("b-grid-group-collapsed"),n.classList.add("b-group-row"),("rownumber"===a.type&&r===s[1]||"rownumber"!==a.type&&r===s[0])&&t.classList.add("b-group-title"),this.buildGroupHeader(e)):t===n.firstElementChild&&(n.classList.remove("b-group-row"),n.classList.remove("b-grid-group-collapsed"),t.classList.remove("b-group-title"))}}},{key:"buildGroupHeader",value:function(e){var t=this,n=e.record,r=e.cellElement,i=e.column,o=e.persist,a=t.grid,s=n.meta,l=s.childCount-(a.features.groupSummary?1:0),c=a.columns.visibleColumns[0],u=i&&a.subGrids[a.regions[0]].columns.visibleColumns,d="rownumber"===c.type&&i===u[1]||"rownumber"!==c.type&&i===u[0],f=null,h=!0;if(o||i){var g=a.columns.get(s.groupField);g&&g.groupRenderer?d&&(f=g.groupRenderer(Object.assign({},e,{groupRowFor:s.groupRowFor,groupRecords:n.groupChildren,groupColumn:g,count:l})),h=!1):t.groupRenderer&&(f=t.groupRenderer(Object.assign({},e,{groupRowFor:s.groupRowFor,groupRecords:n.groupChildren,groupColumn:g,count:l,isFirstColumn:d}))),d&&null==f&&h&&(f="".concat("__novalue__"===s.groupRowFor?"":s.groupRowFor," (").concat(l,")"))}else t.groupRenderer&&(f=t.groupRenderer(e));return"string"==typeof f&&(r.innerHTML=f),r.childElementCount>0&&(r._hasHtml=!0),r.innerHTML}},{key:"renderHeader",value:function(e){var t=this.store,n=this.grid;if(t.isGrouped){var r,i=$d(t.groupers);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=n.columns.get(o.field),s=a&&n.getHeaderElement(a.id);s&&(s.classList.add("b-group"),s.classList.add(o.ascending?"b-asc":"b-desc"))}}catch(e){i.e(e)}finally{i.f()}}}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.store;!1!==e.groupable&&t.push({text:n.L("groupAscending"),icon:"b-fw-icon b-icon-group-asc",name:"groupAsc",cls:"b-separator",weight:110,disabled:n.disabled,onItem:function(e){var t=e.item.column;return r.group(t.field,!0)}},{text:n.L("groupDescending"),icon:"b-fw-icon b-icon-group-desc",name:"groupDesc",weight:110,disabled:n.disabled,onItem:function(e){var t=e.item.column;return r.group(t.field,!1)}}),r.isGrouped&&t.push({text:n.L("stopGrouping"),icon:"b-fw-icon b-icon-clear",name:"groupRemove",cls:e.groupable?"":"b-separator",weight:110,disabled:n.disabled,onItem:function(e){e.item.column;return r.clearGroupers()}})}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this,r=n.store;t.push({text:n.L("groupAscendingShort"),group:n.L("Group"),icon:"b-icon b-icon-group-asc",name:"groupAsc",cls:"b-separator",weight:110,disabled:n.disabled,onDrop:function(e){var t=e.column;return r.group(t.field,!0)}}),t.push({text:n.L("groupDescendingShort"),group:n.L("Group"),icon:"b-icon b-icon-group-desc",name:"groupDesc",weight:110,disabled:n.disabled,onDrop:function(e){var t=e.column;return r.group(t.field,!1)}});var i=r.groupers&&r.groupers.some((function(t){return t.field===e.field}))&&!n.disabled;return t.push({text:n.L("stopGroupingShort"),group:n.L("Group"),icon:"b-icon b-icon-clear",name:"groupRemove",disabled:!i,weight:110,onDrop:function(e){var t=e.column;return r.removeGrouper(t.field)}}),t}},{key:"onStoreGroup",value:function(e){var t=e.groupers,n=this.grid,r=n.element,i=r&&on.children(r,".b-grid-header.b-group");if(r){var o,a=$d(i);try{for(a.s();!(o=a.n()).done;){var s=o.value;on.removeClasses(s,["b-group","b-asc","b-desc"])}}catch(e){a.e(e)}finally{a.f()}if(t){var l,c=$d(t);try{for(c.s();!(l=c.n()).done;){var u=l.value,d=n.getHeaderElementByField(u.field);d&&on.addClasses(d,["b-group",u.ascending?"b-asc":"b-desc"])}}catch(e){c.e(e)}finally{c.f()}}}}},{key:"onStoreGroupingOff",value:function(){var e,t=$d(on.children(this.grid.element,".b-grid-header.b-group"));try{for(t.s();!(e=t.n()).done;){var n=e.value;on.removeClasses(n,["b-group","b-asc","b-desc"])}}catch(e){t.e(e)}finally{t.f()}this.grid.refreshRows()}},{key:"onElementTouchStart",value:function(e){var t=e.target,n=on.up(t,".b-grid-header"),r=n&&this.grid.getColumnFromElement(n);e.touches.length>1&&r&&!1!==r.groupable&&!this.disabled&&this.store.group(r.field)}},{key:"onElementClick",value:function(e){var t=this.store,n=e.target,r=on.up(n,".b-group-row"),i=on.up(n,".b-grid-header"),o=i&&i.dataset.column;if(!n.classList.contains("b-resizer")&&!this.disabled){if(i&&o){var a=t.groupers&&t.groupers.find((function(e){return e.field===o}));if(a&&!e.shiftKey)return t.group(o,!a.ascending),!1;e.shiftKey&&!1!==this.grid.columns.get(o).groupable&&(e.altKey?t.removeGrouper(o):t.group(o)),e.preventDefault()}return r?(this.internalToggleCollapse(Ms.get(r).id),!1):void 0}}},{key:"onElementKeyDown",value:function(e){var t=this;!t.disabled&&t.store.isGrouped&&e.target===t.client.focusElement&&" "===e.key&&t.grid.focusedCell&&(e.preventDefault(),t.internalToggleCollapse(t.grid.focusedCell.id))}},{key:"onStoreDataChange",value:function(e){var t=e.source;t.isGrouped&&t.count>0||this.overridden.onStoreDataChange(e)}},{key:"renderer",set:function(e){this.groupRenderer=e}},{key:"field",set:function(e){this._field=e,this.store.group(e,this.ascending)},get:function(){return this._field}}],[{key:"$name",get:function(){return"Group"}},{key:"defaultConfig",get:function(){return{field:null,renderer:null}}},{key:"pluginConfig",get:function(){return{assign:["collapseAll","expandAll"],chain:["renderHeader","getHeaderMenuItems","getColumnDragToolbarItems","onElementTouchStart","onElementClick","onElementKeyDown"],override:["onStoreDataChange"]}}}]),r}(ho);function Jd(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Qd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qd(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Qd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Kd._$name="Group",bd.registerFeature(Kd,!0,["Grid","Scheduler"]);var ef=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Zd()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.grid=e,this.store=e.store,se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"doDisable",value:function(e){e&&this.clear(),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"showQuickFind",value:function(){var e=this,t=e.grid.getHeaderElement(e.columnId);if(t){if(!e.headerField){var n=on.createElement({tag:"div",className:"b-quick-hit-header",children:[{tag:"div",className:"b-quick-hit-field"},{tag:"div",className:"b-quick-hit-badge"}]},!0),r=te()(n,3),i=r[0],o=r[1],a=r[2];"header"===e.mode?t.appendChild(i):(i.className+=" b-quick-hit-mode-grid",e.grid.element.appendChild(i)),e.headerField={header:i,field:o,badge:a,colHeader:t}}e.headerField.field.innerHTML=e.find,e.headerField.badge.innerHTML=e.found.length,t.classList.add("b-quick-find-header"),e.renderListenerInitialized||(e.grid.rowManager.on({rendercell:e.renderCell,thisObj:e}),e.renderListenerInitialized=!0)}}},{key:"hideQuickFind",value:function(){var e,t=this,n=Jd(t.prevFound||t.found);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=t.grid.getRowById(r.id);i&&i.renderCell(i.getCell(t.columnId),r.data)}}catch(e){n.e(e)}finally{n.f()}t.headerField&&(t.headerField.header.parentNode.removeChild(t.headerField.header),t.headerField.colHeader.classList.remove("b-quick-find-header"),t.headerField=null),t.renderListenerInitialized&&(t.grid.rowManager.un({rendercell:t.renderCell},t),t.renderListenerInitialized=!1),t.grid.trigger("hideQuickFind")}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.columnId,n=this,r=n.grid.columns.getById(t)||n.grid.columns.get(t),i=n.store.findByField(r.field,e),o=1,a=n.grid;Object.assign(n,{foundMap:{},prevFound:n.found,found:i,find:e,columnId:r.id}),e?n.showQuickFind():n.hideQuickFind(),n.currentColumn&&n.currentColumn!==r&&(n.currentColumn.disableHtmlEncode=!1);var s,l=Jd(on.children(a.element,".b-quick-hit"));try{for(l.s();!(s=l.n()).done;){var c=s.value;c.classList.remove("b-quick-hit"),c.classList.remove("b-quick-hit-cell");var u=Ms.get(c).row;u.renderCell(c)}}catch(e){l.e(e)}finally{l.f()}if(r.disableHtmlEncode=!0,n.currentColumn=r,i){i.length>0&&n.gotoClosestHit(a.focusedCell,i);var d,f=Jd(i);try{for(f.s();!(d=f.n()).done;){var h=d.value;n.foundMap[h.id]=o++;var g=a.getRowById(h.data.id);if(g&&g.renderCell(g.getCell(r.id)),o>1e3)break}}catch(e){f.e(e)}finally{f.f()}n.grid.trigger("quickFind",{find:e,found:i})}}},{key:"clear",value:function(){this.found&&this.found.length&&this.search("")}},{key:"gotoHit",value:function(e){var t=this.grid,n=this.found[e];return n&&t.focusCell({columnId:this.columnId,id:n.id}),!!n}},{key:"gotoClosestHit",value:function(e,t){var n=e?this.grid.store.indexOf(e.id):0,r=t.slice().sort((function(e,t){return Math.abs(e.index-n)-Math.abs(t.index-n)}));this.gotoHit(t.indexOf(r[0]))}},{key:"gotoFirstHit",value:function(){this.gotoHit(0)}},{key:"gotoLastHit",value:function(){this.gotoHit(this.found.length-1)}},{key:"gotoNextHit",value:function(){var e=this.grid,t=e._focusedCell?e._focusedCell.id:e.lastFocusedCell.id,n=e.store.indexOf(t)||0,r=this.found.find((function(e){return e.index>n}));r?e.focusCell({columnId:this.columnId,id:r.id}):this.gotoFirstHit()}},{key:"gotoPrevHit",value:function(){var e,t=this.grid,n=t._focusedCell?t._focusedCell.id:t.lastFocusedCell.id,r=t.store.indexOf(n)||0,i=this.found;if(i.length){for(var o=i.length-1;o--;o>=0)if(i[o].index<r){e=i[o];break}e?t.focusCell({columnId:this.columnId,id:e.id}):this.gotoLastHit()}}},{key:"renderCell",value:function(e){var t=this,n=e.cellElement,r=t.foundMap&&t.columnId===e.column.id&&t.foundMap[e.record.id];if(r){var i=e.column.htmlEncode||e.column.shouldHtmlEncode;if(n.classList.add("b-quick-hit"),i){var o=on.down(n,".b-grid-cell-value,.b-tree-cell-value")||n,a=o.innerText,s=a&&a.toLowerCase().indexOf(t.find.toLowerCase());if(s>-1){var l=s+t.find.length,c=a.slice(s,l),u="";" "===a[s-1]&&(u="&nbsp;"),a=a.slice(0,s)+'<span class="b-quick-hit-text">'.concat(u).concat(c,"</span>")+a.slice(l),o.innerHTML=a+'<div class="b-quick-hit-cell-badge">'.concat(r,"</div>")}else n.classList.add("b-quick-hit-cell")}else n.classList.add("b-quick-hit-cell")}}},{key:"onElementKeyDown",value:function(e){var t=this,n=this.grid.features.filter;t.disabled||on.up(e.target,Re.isIE11?".b-widget:not(.b-grid-subgrid):not(.b-grid)":".b-widget:not(.b-grid)")||t.find.length>0&&("Backspace"===e.key?(e.preventDefault(),t.find=t.find.substr(0,t.find.length-1),t.search(t.find)):"Escape"===e.key?(e.preventDefault(),t.find="",t.search(t.find)):"F3"===e.key||"g"===e.key.toLowerCase()&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),e.shiftKey?t.gotoPrevHit():t.gotoNextHit()):n&&t.columnId&&t.foundCount&&e.ctrlKey&&e.shiftKey&&"F"===e.key&&n.showFilterEditor(t.grid.columns.getById(t.columnId),t.find))}},{key:"onElementKeyPress",value:function(e){var t=this;if(!t.disabled&&!on.up(e.target,Re.isIE11?".b-widget:not(.b-grid-subgrid):not(.b-grid)":".b-widget:not(.b-grid)")&&"Enter"!==e.key&&t.grid._focusedCell){var n=t.grid.columns.getById(t.grid._focusedCell.columnId);n&&!1!==n.searchable&&(t.columnId=t.grid._focusedCell.columnId,e.key&&1===e.key.length&&(t.find+=e.key,t.search(t.find)))}}},{key:"onCellNavigate",value:function(e,t,n,r){!(this.prevFound||this.found)||n&&n.columnId===this.columnId||this.clear()}},{key:"foundCount",get:function(){return this.found?this.found.length:0}}],[{key:"$name",get:function(){return"QuickFind"}},{key:"defaultConfig",get:function(){return{mode:"header",find:""}}},{key:"pluginConfig",get:function(){return{chain:["onElementKeyDown","onElementKeyPress","onCellNavigate"]}}}]),r}(ho);function tf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ef._$name="QuickFind",bd.registerFeature(ef);var nf=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(tf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.grid=e,se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onElementDblClick",value:function(e){var t=this,n=t.grid,r=on.up(e.target,".b-grid-splitter-collapsed");if(r&&!t.expanding){t.expanding=!0;var i=r.dataset.region,o=n.getSubGrid(i);o.collapsed||(i=n.getLastRegions()[1],o=n.getSubGrid(i)),o.expand().then((function(){return t.expanding=!1}))}}},{key:"startMove",value:function(e,t){var n=this.grid,r=e.dataset.region,i=n.element,o=n.regions[n.regions.indexOf(r)+1],a=n.getSubGrid(o),s=n.getSubGrid(r),l=s,c=1;if(null!=l.flex&&null==a.flex&&(l=a,c=-1),!e.classList.contains("b-grid-splitter-collapsed")){var u=l.element.offsetWidth+a.element.offsetWidth;this.dragContext={element:e,headerEl:l.header.element,subGridEl:l.element,subGrid:l,splitterSubGrid:s,originalWidth:l.element.offsetWidth,originalX:t,minWidth:l.minWidth||0,maxWidth:Math.min(u,l.maxWidth||u),flip:c},i.classList.add("b-moving-splitter"),s.toggleSplitterCls("b-moving")}}},{key:"endMove",value:function(){var e=this.dragContext;e&&(this.grid.element.classList.remove("b-moving-splitter"),e.splitterSubGrid.toggleSplitterCls("b-moving",!1),this.dragContext=null)}},{key:"onCollapseClick",value:function(e,t){var n=this.grid,r=t.dataset.region,i=n.getLastRegions();if(i[0]===r){var o=n.getSubGrid(i[1]);if(o.collapsed)return void o.expand()}e.collapse()}},{key:"onExpandClick",value:function(e,t){var n=this.grid,r=t.dataset.region,i=n.getLastRegions();if(i[0]===r&&!e.collapsed)return void n.getSubGrid(i[1]).collapse();e.expand()}},{key:"updateMove",value:function(e){var t=this.dragContext;if(t){var n=e-t.originalX,r=Math.min(t.maxWidth,t.originalWidth+n*t.flip);t.subGrid.width=Math.max(r,t.minWidth)}}},{key:"onElementTouchStart",value:function(e){var t=e.target.closest(".b-grid-splitter");t&&this.startMove(t,e.touches[0].clientX)}},{key:"onElementTouchMove",value:function(e){this.dragContext&&(this.updateMove(e.touches[0].clientX),e.preventDefault())}},{key:"onElementTouchEnd",value:function(e){this.dragContext&&(this.endMove(),e.preventDefault())}},{key:"onElementMouseDown",value:function(e){var t=e.target,n=t.closest(":not(.b-row-reordering):not(.b-dragging-event):not(.b-dragging-task):not(.b-dragging-header):not(.b-dragselecting) .b-grid-splitter"),r=n&&this.grid.getSubGrid(n.dataset.region);0===e.button&&(t.classList.contains("b-grid-splitter")||t.classList.contains("b-grid-splitter-inner")?this.startMove(n,e.clientX):t.classList.contains("b-icon-collapse-gridregion")?this.onCollapseClick(r,n):t.classList.contains("b-icon-expand-gridregion")&&this.onExpandClick(r,n))}},{key:"onElementMouseMove",value:function(e){this.dragContext&&(this.updateMove(e.clientX),e.preventDefault())}},{key:"onElementMouseUp",value:function(e){this.dragContext&&(this.endMove(),e.preventDefault())}},{key:"onSubGridCollapse",value:function(e){var t=this.grid.resolveSplitter(e);this.grid.getLastRegions()[1]===e.region&&t.classList.add("b-grid-splitter-allow-collapse")}},{key:"onSubGridExpand",value:function(e){this.grid.resolveSplitter(e).classList.remove("b-grid-splitter-allow-collapse")}},{key:"render",value:function(){var e=this.grid,t=e.regions,n=e.subGrids;t.length>2&&(n[t[0]].splitterElement.classList.add("b-left-only"),n[t[1]].splitterElement.classList.add("b-right-only"))}}],[{key:"$name",get:function(){return"RegionResize"}},{key:"pluginConfig",get:function(){return{chain:["onElementTouchStart","onElementTouchMove","onElementTouchEnd","onElementMouseDown","onElementMouseMove","onElementDblClick","onElementMouseUp","onSubGridCollapse","onSubGridExpand","render"]}}}]),r}(ho);function rf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}nf.featureClass="b-split",nf._$name="RegionResize",bd.registerFeature(nf);var of=function(e){$()(o,e);var t,n,r,i=(t=o,function(){var e,n=J()(t);if(rf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function o(){return D()(this,o),i.apply(this,arguments)}return M()(o,[{key:"construct",value:function(e,t){this.grid=e,se()(J()(o.prototype),"construct",this).apply(this,arguments)}},{key:"doDestroy",value:function(){this.dragHelper&&this.dragHelper.destroy(),se()(J()(o.prototype),"doDestroy",this).call(this)}},{key:"init",value:function(){var e=this,t=e.grid;e.dragHelper=new Tc({name:"rowReorder",mode:"translateXY",cloneTarget:!0,dragThreshold:10,targetSelector:".b-grid-row",lockX:!0,transitionDuration:t.transitionDuration,scrollManager:t.scrollManager,dragWithin:t.verticalScroller,outerElement:t.verticalScroller,ignoreSamePositionDrop:!1,createProxy:function(e){var t=e.cloneNode(!0),n=document.createElement("div");return t.removeAttribute("id"),t.style.transform="",n.appendChild(t),n},listeners:{beforedragstart:e.onBeforeDragStart,dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,reset:e.onReset,prio:1e4,thisObj:e}}),e.dropIndicator=on.createElement({parent:t.bodyContainer,className:"b-row-drop-indicator"}),e.relayEvents(e.dragHelper,["beforeDragStart","dragStart","drag","drop","abort"],"gridRow")}},{key:"onBeforeDragStart",value:function(e){var t=e.context,n=this.grid,r=n.regions[0],i=n.subGrids[r].element;return!(this.disabled||n.readOnly||on.isTouchEvent||!i.contains(t.element))&&!(t.record=this.grid.getRecordFromElement(t.element)).meta.specialRow}},{key:"onDragStart",value:function(e){var t=e.context,n=this,r=n.grid.features.cellEdit,i=n.grid.getRecordFromElement(t.grabbed);if(!i)throw new Error("Failed to find record for dragged element");r&&(n.cellEditDisabledState=r.disabled,r.disabled=!0),n.grid.features.contextMenu&&n.grid.features.contextMenu.hideContextMenu(!1),n.grid.element.classList.add("b-row-reordering");var o=t.element.querySelector(".b-focused");o&&o.classList.remove("b-focused"),on.removeClasses(t.element.firstElementChild,["b-selected","b-hover"]),n.record=i}},{key:"onDrag",value:function(e){var t=e.context,n=e.event,r=this,i=r.grid,o=i.store,a=i.rowManager;if(r.dragHelper.outerElement.contains(n.target)&&n.target.closest(".b-grid-subgrid")){var s,l,c,u,d=t.valid,f=r.grid.rowManager.getRowAt(n.clientY);if(f){var h=f.top+r.grid._bodyRectangle.y-r.grid.scrollable.y+f.height/2;l=f.dataIndex,s=f&&o.getAt(l),c=n.clientY>h}else l=o.count-1,s=o.last,f=r.grid.rowManager.getRow(l),c=!0;if(s===r.record&&(d=!1),o.tree){if(on.removeClsGlobally(r.grid.element,"b-row-reordering-target-parent"),u=c?s.nextSibling:s,r.record.contains(s)&&(d=!1),t.parent=s.parent,!t.parent.isRoot){var g=a.getRowById(t.parent);g&&g.addCls("b-row-reordering-target-parent")}r.clearTimeout(r.hoverTimer),s&&s.isParent&&!s.isExpanded(o)&&(r.hoverTimer=r.setTimeout((function(){return r.grid.expand(s)}),r.hoverExpandTimeout))}else u=c?o.getAt(l+1):s;on.setTranslateY(r.dropIndicator,f.top+(c?f.height:0)),t.insertBefore=u,t.valid=d}else t.valid=!1}},{key:"onDrop",value:(r=ta()(Zo.a.mark((function e(t){var n,r=this;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.context).valid&&(n.asyncCleanup=n.async=!0,n.element.classList.add("b-dropping"),this.setTimeout((function(){return r.finalizeReorder(n)}),this.finalizeDelay));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"finalizeReorder",value:(n=ta()(Zo.a.mark((function e(t){var n,r,i,o;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).grid,i=r.store,t.valid=t.valid&&i.includes(n.record),!t.valid){e.next=14;break}if(!i.tree){e.next=12;break}if(t.valid=i.includes(n.record),!t.valid){e.next=10;break}return e.next=8,t.parent.tryInsertChild(n.record,t.insertBefore);case 8:o=e.sent,t.valid=!1!==o;case 10:e.next=13;break;case 12:i.insert(t.insertBefore?i.indexOf(t.insertBefore):i.count,n.record);case 13:i.clearSorters();case 14:t.finalize(t.valid),r.element.classList.remove("b-row-reordering");case 16:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onReset",value:function(){var e=this.grid.features.cellEdit;this.grid.element.classList.remove("b-row-reordering"),e&&(e.disabled=this.cellEditDisabledState),on.removeClsGlobally(this.grid.element,"b-row-reordering-target-parent")}},{key:"render",value:function(){this.init()}}],[{key:"$name",get:function(){return"RowReorder"}},{key:"defaultConfig",get:function(){return{hoverExpandTimeout:1e3,finalizeDelay:300}}},{key:"pluginConfig",get:function(){return{after:["render"]}}}]),o}(or(ho));function af(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return sf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sf(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function sf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}of.featureClass="",of._$name="RowReorder",bd.registerFeature(of,!1),bd.registerFeature(of,!0,"Gantt");var cf=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(lf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,t),Object.assign(this,{store:e.store,grid:e,find:"",hitEls:[]})}},{key:"doDestroy",value:function(){this.clear(!0),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e&&this.clear(),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"search",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;if(!e)return r.clear();if((n||e!==r.find)&&!r.disabled){var i=r.grid,o=i.columns.visibleColumns.filter((function(e){return!1!==e.searchable})),a=o.map((function(e){return e.field})),s=r.store.search(e,a),l=1;Object.assign(r,{foundMap:{},prevFound:r.found,found:s,find:e});var c,u=af(on.children(i.element,".b-search-hit"));try{for(u.s();!(c=u.n()).done;){var d=c.value;d.classList.remove("b-search-hit"),d.classList.remove("b-search-hit-cell");var f=Ms.get(d).row;f.renderCell(d)}}catch(e){u.e(e)}finally{u.f()}if(s){r.hitColumns&&r.hitColumns.forEach((function(e){return e.disableHtmlEncode=!1})),r.hitColumns=[];var h,g=af(s);try{for(g.s();!(h=g.n()).done;){var v=h.value;r.foundMap[v.field+"-"+v.id]=l++;var p=r.grid.columns.get(v.field);if(p&&(p.disableHtmlEncode=!0,r.hitColumns.push(p)),l>1e3)break}}catch(e){g.e(e)}finally{g.f()}return r.listenersInitialized||(r.grid.rowManager.on({rendercell:r.renderCell},r),r.store.on({refresh:r.onStoreRefresh},r),r.listenersInitialized=!0),i.refreshRows(),r.grid.trigger("search",{grid:i,find:e,found:s}),t&&!r.isHitFocused&&r.gotoNextHit(!0),s}}}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.grid;t.foundMap&&delete t.foundMap,delete t.find,on.forEachSelector(n.element,".b-search-hit",(function(e){return on.removeClasses(e,["b-search-hit","b-search-hit-cell"])})),on.removeEachSelector(n.element,".b-search-hit-cell-badge,.b-search-hit-text"),t.listenersInitialized&&(n.rowManager.un({rendercell:t.renderCell},t),t.store.un({refresh:t.onStoreRefresh},t),t.listenersInitialized=!1),e||(n.refreshRows(),t.grid.trigger("clearSearch",{grid:n}))}},{key:"gotoNextHit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(t.found&&t.found.length){var n=t.grid,r=n.focusedCell||n.lastFocusedCell,i=r&&!e?n.store.indexOf(r.id):-1,o=t.found.findIndex((function(e){return e.index>i}));-1!==o&&t.gotoHit(o)}}},{key:"gotoPrevHit",value:function(){var e=this;if(e.found&&e.found.length)for(var t=e.grid,n=t.focusedCell||t.lastFocusedCell,r=n?t.store.indexOf(n.id):0,i=e.found,o=i.length-1;o--;o>=0){if(i[o].index<r){e.gotoHit(o);break}}}},{key:"gotoHit",value:function(e){var t=this.grid,n=this.found[e];return n&&t.focusCell({field:n.field,id:n.id}),!!n}},{key:"gotoFirstHit",value:function(){this.gotoHit(0)}},{key:"gotoLastHit",value:function(){this.gotoHit(this.found.length-1)}},{key:"renderCell",value:function(e){var t=e.cellElement,n=e.column,r=e.record,i=e.value,o=e.cellContent,a=this,s=a.foundMap&&a.foundMap[n.field+"-"+r.id];if(s){t.classList.add("b-search-hit");var l=on.down(t,".b-grid-cell-value")||t,c=String(a.find).toLowerCase();if(String(i).toLowerCase()===c)l.innerHTML='<span class="b-search-hit-text">'.concat(o,'</span><div class="b-search-hit-cell-badge">').concat(s,"</div>");else{var u=String(a.find).toLowerCase(),d=o&&o.toLowerCase().indexOf(u);if(d>-1){var f=d+u.length,h=o.slice(d,f);l.innerHTML="".concat(o.slice(0,d),'<span class="b-search-hit-text">').concat(h,"</span>").concat(o.slice(f),'<div class="b-search-hit-cell-badge">').concat(s,"</div>")}else t.classList.add("b-search-hit-cell")}a.hitEls.push(t)}}},{key:"getCellMenuItems",value:function(e,t,n){var r=this;return e.searchable&&n.push({text:r.L("searchForValue"),icon:"b-fw-icon b-icon-search",cls:"b-separator",name:"search",disabled:r.disabled,onItem:function(e){var t=e.item,n=t.column,i=t.record,o=window.getSelection().toString();o||(o=i[n.field]),r.search(o)}}),n}},{key:"onElementKeyDown",value:function(e){this.find&&""!==this.find&&("F3"===e.key||"g"===e.key.toLowerCase()&&(e.ctrlKey||e.metaKey))&&(e.preventDefault(),e.shiftKey?this.gotoPrevHit():this.gotoNextHit())}},{key:"onStoreRefresh",value:function(){this.search(this.find,!1,!0)}},{key:"foundCount",get:function(){return this.found&&this.found.length||0}},{key:"isHitFocused",get:function(){var e=this.grid,t=e.focusedCell?e.store.indexOf(e.focusedCell.id):-1,n=e.focusedCell?e.columns.getById(e.focusedCell.columnId):null;return-1!==t&&this.found.some((function(e){return e.index===t&&n&&e.field===n.field}))}}],[{key:"$name",get:function(){return"Search"}},{key:"pluginConfig",get:function(){return{chain:["getCellMenuItems","onElementKeyDown"]}}}]),r}(ho);function uf(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return df(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return df(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function df(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ff(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}cf.featureClass="b-search",cf._$name="Search",bd.registerFeature(cf);var hf=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ff()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;t=n.processConfig(t),n.store=e.store,n.grid=e,n.store.on({sort:n.syncHeaderSortState,thisObj:n}),se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"processConfig",value:function(e){return"string"==typeof e||Array.isArray(e)?{field:e,ascending:null}:e}},{key:"setConfig",value:function(e){se()(J()(r.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"syncHeaderSortState",value:function(){var e=this,t={};if(!e.grid.isConfiguring){for(var n,r=e.store.sorters,i=r.length,o=new bt,a=0;a<i;a++){var s=r[a];s.field&&(t[s.field]={ascending:s.ascending,sortIndex:a+1})}var l,c=uf(e.grid.columns.bottomColumns);try{for(c.s();!(l=c.n()).done;){var u=l.value,d=u.element;if(d){var f=u.textWrapper&&u.textWrapper.dataset;f&&f.sortIndex&&delete f.sortIndex,o.value=d.classList,!1!==u.sortable?(o.add(e.sortableCls),(n=t[u.field])?(i>1&&f&&(f.sortIndex=n.sortIndex),o.add(e.sortedCls),n.ascending?(o.add(e.sortedAscCls),o.remove(e.sortedDescCls)):(o.add(e.sortedDescCls),o.remove(e.sortedAscCls))):(o.remove(e.sortedCls),o["b-group"]||(o.remove(e.sortedAscCls),o.remove(e.sortedDescCls)))):o.remove(e.sortableCls),on.syncClassList(d,o)}}}catch(e){c.e(e)}finally{c.f()}}}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.disabled;if(!1!==e.sortable&&(t.push({text:n.L("sortAscending"),icon:"b-fw-icon b-icon-sort-asc",name:"sortAsc",cls:"b-separator",weight:105,disabled:r,onItem:function(e){var t=e.item.column;return n.store.sort(t.field,!0)}}),t.push({text:n.L("sortDescending"),icon:"b-fw-icon b-icon-sort-desc",name:"sortDesc",weight:105,disabled:r,onItem:function(e){var t=e.item.column;return n.store.sort(t.field,!1)}}),n.multiSort&&n.grid.columns.records.filter((function(e){return e.sortable})).length>1)){var i=this.grid.store.sorters.find((function(t){return t.field===e.field}));t.push({text:n.L("multiSort"),icon:"b-fw-icon b-icon-sort",name:"multiSort",weight:105,disabled:r,menu:[{text:i?n.L("toggleSortAscending"):n.L("addSortAscending"),icon:"b-fw-icon b-icon-sort-asc",name:"addSortAsc",disabled:i&&i.ascending,weight:105,onItem:function(e){var t=e.item.column;return n.store.addSorter(t.field,!0)}},{text:i?n.L("toggleSortDescending"):n.L("addSortDescending"),icon:"b-fw-icon b-icon-sort-desc",name:"addSortDesc",disabled:i&&!i.ascending,weight:105,onItem:function(e){var t=e.item.column;return n.store.addSorter(t.field,!1)}},{text:n.L("removeSorter"),icon:"b-fw-icon b-icon-remove",name:"remove-sorter",weight:105,disabled:!i,onItem:function(e){var t=e.item.column;return n.store.removeSorter(t.field)}}]})}return t}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this,r=n.store,i=n.disabled;if(!1!==e.sortable){t.push({text:n.L("sortAscendingShort"),group:n.L("Sort"),icon:"b-icon b-icon-sort-asc",name:"sortAsc",cls:"b-separator",weight:105,disabled:i,onDrop:function(e){var t=e.column;return r.sort(t.field,!0)}}),t.push({text:n.L("sortDescendingShort"),group:n.L("Sort"),icon:"b-icon b-icon-sort-desc",name:"sortDesc",weight:105,disabled:i,onDrop:function(e){var t=e.column;return r.sort(t.field,!1)}});var o=r.sorters.find((function(t){return t.field===e.field}));Array.prototype.push.apply(t,[{text:n.L("addSortAscendingShort"),group:n.L("Multisort"),icon:"b-icon b-icon-sort-asc",name:"multisortAddAsc",disabled:i||o&&o.ascending,weight:105,onDrop:function(e){var t=e.column;return r.addSorter(t.field,!0)}},{text:n.L("addSortDescendingShort"),group:n.L("Multisort"),icon:"b-icon b-icon-sort-desc",name:"multisortAddDesc",disabled:i||o&&!o.ascending,weight:105,onDrop:function(e){var t=e.column;return r.addSorter(t.field,!1)}},{text:n.L("removeSorterShort"),group:n.L("Multisort"),icon:"b-icon b-icon-remove",name:"multisortRemove",weight:105,disabled:i||!o,onDrop:function(e){var t=e.column;return r.removeSorter(t.field)}}])}return t}},{key:"onElementClick",value:function(e){var t=this.store,n=e.target,r=on.up(n,".b-grid-header.b-sortable"),i=r&&r.dataset.column;if(!this.ignoreRe.test(n.className)&&!this.disabled&&r&&i){var o=this.grid.columns.getById(r.dataset.columnId);if(t.isGrouped&&t.groupers.find((function(e){return e.field===i}))&&!e.shiftKey)return;if(o.sortable&&!e.shiftKey)if(e.ctrlKey&&e.altKey)t.removeSorter(o.field);else{var a=o.field;"function"==typeof o.sortable?a={field:o.field,fn:o.sortable}:"object"===re()(o.sortable)&&((a=o.sortable).field||(a.field=a.property||o.field)),t.sort(a,null,e.ctrlKey)}}}},{key:"renderHeader",value:function(){this.syncHeaderSortState()}},{key:"field",set:function(e){var t=this.grid.columns.get(e);t&&"object"===re()(t.sortable)&&(t.sortable.field=t.sortable.property||e,e=t.sortable),this.store.sort(e,this.ascending)}}],[{key:"$name",get:function(){return"Sort"}},{key:"defaultConfig",get:function(){return{multiSort:!0,ignoreRe:new RegExp(["b-grid-header-resize-handle","b-filter-icon"].join("|")),sortableCls:"b-sortable",sortedCls:"b-sort",sortedAscCls:"b-asc",sortedDescCls:"b-desc"}}},{key:"pluginConfig",get:function(){return{chain:["onElementClick","getHeaderMenuItems","getColumnDragToolbarItems","renderHeader"]}}}]),r}(ho);function gf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}hf.featureClass="b-sort",hf._$name="Sort",bd.registerFeature(hf,!0);var vf=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(gf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,t),e.rowManager.on({renderrow:"onRenderRow",thisObj:this})}},{key:"doDisable",value:function(e){this.client.refreshRows(),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"onRenderRow",value:function(e){var t=e.row;this.disabled||t.addCls(t.dataIndex%2==0?"b-even":"b-odd")}}],[{key:"$name",get:function(){return"Stripe"}}]),r}(ho);function pf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}vf._$name="Stripe",bd.registerFeature(vf);var yf=new Promise((function(e){return e()})),mf=function(e){$()(c,e);var t,n,r,i,o,a,s,l=(t=c,function(){var e,n=J()(t);if(pf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function c(){return D()(this,c),l.apply(this,arguments)}return M()(c,[{key:"construct",value:function(e,t){se()(J()(c.prototype),"construct",this).call(this,e,t);var n=e.columns.find((function(e){return e instanceof fd}));Object.assign(this,{grid:e,store:e.store,rowManager:e.rowManager,treeColumn:n}),this.store.on({beforeLoadChildren:"onBeforeLoadChildren",loadChildren:"onLoadChildren",loadChildrenException:"onLoadChildrenException",beforeToggleNode:"onBeforeToggleNode",thisObj:this})}},{key:"doDisable",value:function(e){}},{key:"toggleCollapse",value:(s=ta()(Zo.a.mark((function e(t,n){var r,i,o,a,s,l,c,u,d=arguments;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.length>2&&void 0!==d[2]&&d[2],i=(r=this).store,o=r.grid,a=o.rowManager,s=i.getById(t),l=s.instanceMeta(i),e.next=4,i.toggleCollapse(s,n);case 4:if(!e.sent){e.next=10;break}(c=a.getRowFor(s))&&(u=c.getCell(r.treeColumn.id),c.renderCell(u,s)),r.isTogglingNode||(o.element.classList.add("b-toggling-node"),r.isTogglingNode=!0,r.requestAnimationFrame((function(){o.element.classList.remove("b-toggling-node"),r.isTogglingNode=!1}))),o.trigger(l.collapsed?"collapseNode":"expandNode",{source:o,record:s}),o.trigger("toggleNode",{source:o,record:s,collapse:n});case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"collapse",value:(a=ta()(Zo.a.mark((function e(t){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.toggleCollapse(t,!0));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"expand",value:(o=ta()(Zo.a.mark((function e(t){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.toggleCollapse(t,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"onBeforeToggleNode",value:function(e){var t=e.record,n=e.collapse;this.grid.trigger("beforeToggleNode",{record:t,collapse:n})}},{key:"onBeforeLoadChildren",value:function(e){var t=e.source,n=e.params,r=t.getById(n[t.modelClass.idField]),i=this.grid.rowManager.getRowFor(r);i&&i.addCls("b-loading-children")}},{key:"onLoadChildren",value:function(e){var t=e.source,n=e.params,r=t.getById(n[t.modelClass.idField]),i=this.grid.rowManager.getRowFor(r);i&&i.removeCls("b-loading-children")}},{key:"onLoadChildrenException",value:function(e){var t=e.record,n=this.grid.rowManager.getRowFor(t);n&&n.removeCls("b-loading-children")}},{key:"expandOrCollapseAll",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.store.rootNode,r=this.grid,i=this.store,o=[],a=[];return r.trigger("beforeToggleAllNodes",{source:r,collapse:t}),i.suspendEvents(),i.traverse((function(n){var r=n.instanceMeta(i);n.isLeaf||(t&&!r.collapsed?(e.toggleCollapse(n,!0,!0),a.push.apply(a,Z()(n.children))):!t&&r.collapsed&&(Array.isArray(n.children)&&a.push.apply(a,Z()(n.children)),o.push(e.toggleCollapse(n,!1,!0))))}),n,n===i.rootNode),i.resumeEvents(),(t?yf:Promise.all(o)).then((function(){r.refreshRows(t),a.length&&(t?i.trigger("remove",{records:a,isCollapse:!0,isCollapseAll:!0}):i.trigger("add",{records:a,isExpand:!0,isExpandAll:!0})),r.trigger("toggleAllNodes",{source:r,collapse:t})}))}},{key:"collapseAll",value:(i=ta()(Zo.a.mark((function e(){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.expandOrCollapseAll(!0));case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"expandAll",value:(r=ta()(Zo.a.mark((function e(){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.expandOrCollapseAll(!1));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"expandTo",value:(n=ta()(Zo.a.mark((function e(t){var n,r,i,o,a;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==(r=(n=this).store.getById(t)).instanceMeta(n.store).hiddenByCollapse){e.next=3;break}return e.abrupt("return");case 3:for(i=!1,o=r.parent,a=[];o&&!o.isRoot;)a.push(o),o=o.parent;return e.next=7,a.reverse().forEach(function(){var e=ta()(Zo.a.mark((function e(t){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.instanceMeta(n.store).collapsed&&(i=!0),e.next=3,n.toggleCollapse(t,!1,!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:return i&&n.grid.refreshRows(),e.next=10,n.grid.scrollRowIntoView(r);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onElementClick",value:function(e){var t=e.target,n=this.grid.getEventData(e);(t.closest(".b-tree-expander")||this.expandOnCellClick&&n&&n.record.isParent)&&this.toggleCollapse(n.record)}},{key:"onElementKeyDown",value:function(e){e.target===this.client.focusElement&&" "===e.key&&(e.preventDefault(),this.toggleCollapse(this.grid.focusedCell.id))}},{key:"navigateRight",value:function(e){var t=this.grid,n=t.focusedCell;if(n){var r=t.store.getById(n.id);if(t.columns.getById(n.columnId).tree&&(e.shiftKey||1===t.columns.count))return r.isParent&&r.instanceMeta(t.store).collapsed?this.expand(r):t.navigateDown(e),!1}}},{key:"navigateLeft",value:function(e){var t=this.grid,n=t.focusedCell;if(n){var r=t.store.getById(n.id);if(t.columns.getById(n.columnId).tree&&(e.shiftKey||1===t.columns.count))return r.isParent&&!r.instanceMeta(t.store).collapsed?this.collapse(r):r.parent&&t.focusCell({id:r.parent.id,columnId:n.columnId}),!1}}}],[{key:"$name",get:function(){return"Tree"}},{key:"defaultConfig",get:function(){return{expandOnCellClick:!1}}},{key:"pluginConfig",get:function(){return{assign:["collapseAll","expandAll","collapse","expand","expandTo","toggleCollapse"],before:["navigateRight","navigateLeft"],chain:["onElementClick","onElementKeyDown"]}}}]),c}(or(ho));mf.featureClass="b-tree",mf._$name="Tree",bd.registerFeature(mf,!1,"Grid"),bd.registerFeature(mf,!0,"TreeGrid");var bf={all:"all",visible:"visible"},kf={A6:{width:4.13,height:5.81},A5:{width:5.81,height:8.25},A4:{width:8.25,height:11.69},A3:{width:11.69,height:16.49},Legal:{width:8.5,height:14},Letter:{width:8.5,height:11}},wf={portrait:"portrait",landscape:"landscape"},Sf={pdf:"pdf",png:"png"};function Cf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Rf=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Cf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e;this.inConstruct=!0;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=se()(J()(r.prototype),"construct",this)).call.apply(e,[this].concat(n)),this.inConstruct=!1}},{key:"buildLocalizedItems",value:function(){return[]}},{key:"updateLocalizedItems",value:function(){var e=this;if(e.store&&!e.inConstruct){var t=e.value;e.store.data=e.buildLocalizedItems(),e.value=null,e.value=t,e.syncInputFieldValue(!0)}}},{key:"updateLocalization",value:function(){this.updateLocalizedItems(),se()(J()(r.prototype),"updateLocalization",this).call(this)}},{key:"items",set:function(e){!0===e&&(e=this.buildLocalizedItems()),ei()(J()(r.prototype),"items",e,this,!0)},get:function(){return se()(J()(r.prototype),"items",this)}}],[{key:"$name",get:function(){return"LocalizableComboItems"}},{key:"defaultConfig",get:function(){return{items:!0}}}]),r}(e||Wa)};function xf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ef=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(xf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return r}(Rf(Wa));function Df(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ef._$name="LocalizableCombo",ye.register("localizablecombo",Ef);var Tf=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Df()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildLocalizedItems",value:function(){return[{id:bf.all,text:this.L(bf.all)},{id:bf.visible,text:this.L(bf.visible)}]}}],[{key:"$name",get:function(){return"ExportRowsCombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),r}(Ef);function Mf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Tf._$name="ExportRowsCombo",ye.register(Tf.$name,Tf);var Af=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Mf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildLocalizedItems",value:function(){return[{id:wf.portrait,text:this.L(wf.portrait)},{id:wf.landscape,text:this.L(wf.landscape)}]}}],[{key:"$name",get:function(){return"ExportOrientationCombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),r}(Ef);function If(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Af._$name="ExportOrientationCombo",ye.register(Af.$name,Af);var Ff=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(If()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildDialogItems",value:function(e){var t=this,n=e.exporters,r=e.client,i=t.L("labelWidth");function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return Object.keys(e).map((function(e){return{id:e,text:t(e)}}))}return t.columnsStore=r.columns.chain((function(e){return e.isLeaf})),[{labelWidth:i,type:"combo",ref:"columnsField",label:"L{columns}",localeClass:this,store:t.columnsStore,value:t.columnsStore.allRecords,valueField:"id",displayField:"text",multiSelect:!0},{labelWidth:i,type:"exportrowscombo",ref:"rowsRangeField",label:"L{rows}",localeClass:this,value:bf.all},{labelWidth:i,type:"localizablecombo",ref:"exporterTypeField",label:"L{exporterType}",localeClass:this,editable:!1,value:n[0].type,buildLocalizedItems:function(){return n.map((function(e){return{id:e.type,text:e.title}}))},onChange:function(e){var t=e.value;this.owner.widgetMap.alignRowsField.hidden="multipage"!==t}},{labelWidth:i,type:"checkbox",ref:"alignRowsField",label:"L{alignRows}",localeClass:this,checked:!0,hidden:"multipage"!==n[0].type},{labelWidth:i,type:"combo",ref:"fileFormatField",label:"L{fileFormat}",localeClass:this,editable:!1,value:Sf.pdf,items:o(Sf,(function(e){return e.toUpperCase()})),onChange:function(e){var n=e.value,r=e.oldValue;if(t.hidePNGMultipageOption){var i=t.widgetMap.exporterTypeField,o=i.store.find((function(e){return"singlepage"===e.id}));n===Sf.png&&o?(this._previousDisabled=i.disabled,i.disabled=!0,this._previousValue=i.value,i.value="singlepage"):r===Sf.png&&this._previousValue&&(i.disabled=this._previousDisabled,i.value=this._previousValue)}}},{labelWidth:i,type:"combo",ref:"paperFormatField",label:"L{paperFormat}",localeClass:this,editable:!1,value:"A4",items:o(kf)},{labelWidth:i,type:"exportorientationcombo",ref:"orientationField",label:"L{orientation}",localeClass:this,value:wf.portrait}]}},{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=e.client;if(!n)throw new Error("`client` config is required");var i,o=t.buildDialogItems(e);e.items?Array.isArray(e.items)?(i=e.items).push.apply(i,Z()(o)):o.forEach((function(t){e.items[t.ref]=t,delete t.ref})):e.items=o;e.width=e.width||t.L("width"),se()(J()(r.prototype),"construct",this).call(this,e),t.widgetMap.exportButton.on("click",t.onExportClick,t),t.widgetMap.cancelButton.on("click",t.onCancelClick,t),Fe.on({locale:"onLocaleChange",prio:-1,thisObj:t})}},{key:"onLocaleChange",value:function(){var e=this.L("labelWidth");this.width=this.L("width"),this.eachWidget((function(t){t instanceof so&&(t.labelWidth=e)}))}},{key:"onExportClick",value:function(){var e=this.values;this.trigger("export",{values:e})}},{key:"onCancelClick",value:function(){this.trigger("cancel"),this.hide()}},{key:"values",get:function(){var e=/field/i,t={};return this.eachWidget((function(n){e.test(n.ref)&&(t[n.ref.replace(e,"")]=n instanceof uo?n.checked:n.value)})),t}}],[{key:"$name",get:function(){return"ExportDialog"}},{key:"defaultConfig",get:function(){return{autoShow:!1,autoClose:!1,closable:!0,centered:!0,client:null,hidePNGMultipageOption:!0,title:"L{exportSettings}",bbar:[{type:"button",ref:"exportButton",color:"b-green",localeClass:this,text:"L{export}"},{type:"button",ref:"cancelButton",color:"b-gray",localeClass:this,text:"L{cancel}"}]}}}]),r}(Ei);Ff._$name="ExportDialog";var Of=n(118),_f=n.n(Of),Pf=n(127),Lf=n.n(Pf);function Hf(){var e=Ti()(['\n            <!DOCTYPE html>\n            <html class="','" style="width: ',"in; height: ",'in;">\n                <head>\n                    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />\n                    <title>',"</title>\n                    ",'\n                </head>\n                <body class="b-export ','" style="width: ',"in; height: ","in; ",'">\n                    <div class="b-export-content">\n                        ','\n                        <div class="b-export-body"><div class="b-export-viewport">',"</div></div>\n                        ","\n                    </div>\n                </body>\n            </html>"]);return Hf=function(){return e},e}function jf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Bf=function(e){$()(c,e);var t,n,r,i,o,a,s,l=(t=c,function(){var e,n=J()(t);if(jf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function c(){return D()(this,c),l.apply(this,arguments)}return M()(c,[{key:"pageTpl",value:function(e){var t=e.title,n=e.header,r=e.footer,i=e.styles,o=e.htmlClasses,a=e.bodyStyle,s=e.bodyClasses,l=void 0===s?[]:s,c=e.paperHeight,u=e.paperWidth,d=e.html;return l.push("b-".concat(this.constructor.type)),Ii.tpl(Hf(),o,u,c,t,i.join(""),l.join(" "),u,c,a,n&&'<div class="b-export-header" style="width: 100%">'.concat(n,"</div>"),d,r&&'<div class="b-export-footer" style="width: 100%">'.concat(r,"</div>"))}},{key:"getStyleTagURLConverter",value:function(e){return function(t,n){var r;try{var i;/^#/.test(n)?r=t:(i=!0===e?window.location.href:this.keepPathName?window.location.href.replace(window.location.origin,e):e,r="url('".concat(new URL(n,i).href,"')"))}catch(e){r=t}return r}.bind(this)}},{key:"saveState",value:function(e){var t=e.client;this.state=t.state}},{key:"restoreState",value:(s=ta()(Zo.a.mark((function e(t){var n,r;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.client,r=!1,n.scrollable.y!==this.state.scroll.scrollTop&&(r=!0),n.state=this.state,!r){e.next=7;break}return e.next=7,new Promise((function(e){n.scrollable.on({scrollEnd:function(){e()},once:!0})}));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"beforeExport",value:function(){this.element=document.createElement("div")}},{key:"cloneElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.element,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n&&(t.innerHTML=""),Re.isChrome?t.appendChild(e.cloneNode(!0)):t.innerHTML=e.outerHTML,on.removeEachSelector(t,".b-grid-row"),t.querySelector(".b-gridbase > .b-mask").remove()}},{key:"measureElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e instanceof HTMLElement&&(e=e.outerHTML);var t=on.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:'<div style="height: 1px"></div>'.concat(e,'<div style="height: 1px"></div>')}),n=t.offsetHeight-2;return t.remove(),n}},{key:"prepareHTML",value:function(e){e instanceof HTMLElement&&(e=e.outerHTML);for(var t=on.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:e}),n=t.querySelectorAll("img"),r=0,i=n.length;r<i;r++)n[r].setAttribute("src",n[r].src);var o=t.innerHTML;return t.remove(),o}},{key:"createPlaceholder",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t&&(e.innerHTML=""),on.createElement({parent:e,id:we.generateId("export")})}},{key:"getVirtualScrollerHeight",value:function(e){var t=0;return e.eachSubGrid((function(e){e.overflowingHorizontally&&(t=on.scrollBarWidth)})),0===t?t:t+1}},{key:"inchToPx",value:function(e){return 96*e}},{key:"getScaleValue",value:function(e,t){return Math.floor(1e4*e/t)/1e4}},{key:"export",value:(a=ta()(Zo.a.mark((function e(t){var n,r;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this).beforeExport(),n.saveState(t),e.next=5,n.prepareComponent(t);case 5:return e.prev=5,e.next=8,n.getPages(t);case 8:r=e.sent;case 9:return e.prev=9,e.next=12,n.restoreComponent(t);case 12:return n.stylesheets=null,e.next=15,new Promise((function(e){return n.requestAnimationFrame(e)}));case 15:return e.next=17,n.restoreState(t);case 17:return e.finish(9);case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,this,[[5,,9,18]])}))),function(e){return a.apply(this,arguments)})},{key:"getPages",value:(o=ta()(Zo.a.mark((function e(t){var n,r,i;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.pagesExtractor(t),r=[];case 1:return e.next=3,n.next();case 3:if(e.t0=i=e.sent,!e.t0){e.next=6;break}e.t0=!i.done;case 6:if(!e.t0){e.next=10;break}r.push(i.value),e.next=1;break;case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"prepareComponent",value:(i=ta()(Zo.a.mark((function e(t){var n,r,i,o,a,s,l;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,r=t.client,i=t.columns,o=t.rowsRange,a=n.exportMeta={totalWidth:0,totalHeight:0-n.getVirtualScrollerHeight(r),subGrids:{}},r.columns.forEach((function(e){i.includes(e.id)?e.show():e.hide()})),!(r.rowManager.rowCount>0)){e.next=13;break}if(o!==bf.all){e.next=9;break}return a.firstVisibleDataIndex=r.rowManager.rows[0].dataIndex,e.next=7,r.scrollable.scrollTo(0,0);case 7:e.next=13;break;case 9:return s=a.firstVisibleDataIndex=r.rowManager.rows.find((function(e){return e.bottom>r.scrollable.y})).dataIndex,e.next=12,r.scrollRowIntoView(r.store.getAt(s),{block:"start"});case 12:t.alignRows=!0;case 13:this.cloneElement(r.element),l=n.element,r.eachSubGrid((function(e){var t=n.createPlaceholder(l.querySelector('[id="'.concat(e.id,'"]')),!1),i=e.columns.visibleColumns.reduce((function(e,t){return"number"==typeof t.width?e+=t.width:e+=r.getHeaderElement(t.id).offsetWidth,e}),0);a.totalWidth+=i;var o=e.splitterElement;o&&(a.totalWidth+=o.offsetWidth),a.subGrids[e.region]={id:e.id,headerId:e.header&&e.header.id||null,footerId:e.footer&&e.footer.id||null,rows:[],placeHolder:t,width:i}}));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta;return Object.values(t.subGrids).forEach((function(t){var n=t.width;[t.id,t.headerId,t.footerId].forEach((function(t){t&&(e.querySelector('[id="'.concat(t,'"]')).style.width="".concat(n,"px"))}))})),e.innerHTML}},{key:"restoreComponent",value:(r=ta()(Zo.a.mark((function e(){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"scrollRowIntoView",value:(n=ta()(Zo.a.mark((function e(t,n){var r=this;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollRowIntoView(t.store.getAt(n),{block:"start"});case 2:return e.next=4,new Promise((function(e){return r.requestAnimationFrame(e)}));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"stylesheets",get:function(){var e=this,t=this;if(t._stylesheets)return t._stylesheets;var n=t.translateURLsToAbsolute,r=window.origin,i=Array.from(document.querySelectorAll('link[rel="stylesheet"], style')),o=[];return i.forEach((function(i){var a,s;(i=i.cloneNode(!0),n&&i.href)&&(a=!0===n?i.href:e.keepPathName?i.href.replace(r,n):new URL(i.getAttribute("href"),n),i.setAttribute("href",a));if(s=Re.isIE11&&i.styleSheet&&/style/i.test(i.tagName)?'<style type="text/css">'.concat(i.styleSheet.cssText,"</style>"):i.outerHTML,n&&/style/i.test(i.tagName)){var l=t.getStyleTagURLConverter(n);s=s.replace(/url\(['"]?(.+?)['"]?\)/g,l)}o.push(s)})),o.push("<style>\n                body, html {\n                    overflow: auto;\n                }\n                \n                body {\n                    position: relative;\n                    margin: 0;\n                }\n            </style>"),t._stylesheets=o},set:function(e){this._stylesheets=e}}],[{key:"defaultConfig",get:function(){return{translateURLsToAbsolute:!0,keepPathName:!0}}}]),c}(or(pe(_e(G))));function Nf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Bf.prototype.pagesExtractor=function(){var e=Lf()(Zo.a.mark((function e(){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,"";case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Bf._$name="Exporter";var zf=function(e){$()(l,e);var t,n,r,i,o,a,s=(t=l,function(){var e,n=J()(t);if(Nf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function l(){return D()(this,l),s.apply(this,arguments)}return M()(l,[{key:"stateNextPage",value:(a=ta()(Zo.a.mark((function e(t){var n,r;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.client,++(r=this.exportMeta).currentPage,++r.verticalPosition,delete r.lastExportedRowBottom,!(r.verticalPosition>=r.verticalPages)){e.next=10;break}return r.verticalPosition=r.currentPageTopMargin=0,++r.horizontalPosition,e.next=10,this.scrollRowIntoView(n,r.firstVisibleDataIndex,{block:"start"});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"prepareComponent",value:(o=ta()(Zo.a.mark((function e(t){var n,r,i,o,a,s,c,u,d,f,h,g,v,p,y,m,b,k,w,S,C,R;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se()(J()(l.prototype),"prepareComponent",this).call(this,t);case 2:r=(n=this).exportMeta,i=t.client,o=t.headerTpl,a=t.footerTpl,s=t.alignRows,c=kf[t.paperFormat],u=t.orientation===wf.portrait,d=u?c.width:c.height,f=u?c.height:c.width,h=n.inchToPx(d),g=n.inchToPx(f),v=Math.ceil(r.totalWidth/h),p=r.totalHeight+i.height-i.bodyHeight+i.scrollable.scrollHeight,y=g,o&&(y-=n.measureElement(o({totalWidth:r.totalWidth,totalPages:-1,currentPage:-1}))),a&&(y-=n.measureElement(a({totalWidth:r.totalWidth,totalPages:-1,currentPage:-1}))),b=i.store.count,t.rowsRange===bf.visible&&(b=Math.min(i.store.count,i.rowManager.visibleRowCount),k=i.rowManager.rows[b-1].bottom,p=p-i.scrollable.scrollHeight+k),s?(w=i.rowManager.rowOffsetHeight,S=Math.floor((y-i.headerHeight)/w),C=Math.floor(y/w),R=b-S,m=1+Math.ceil(R/C)):m=Math.ceil(p/y),Object.assign(r,{paperWidth:d,paperHeight:f,pageWidth:h,pageHeight:g,horizontalPages:v,verticalPages:m,totalHeight:p,contentHeight:y,totalRows:b,totalPages:v*m,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0}),this.adjustRowBuffer(i);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"restoreComponent",value:(i=ta()(Zo.a.mark((function e(t){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se()(J()(l.prototype),"restoreComponent",this).call(this,t);case 2:this.restoreRowBuffer(t.client);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"adjustRowBuffer",value:function(e){var t=this.exportMeta.contentHeight,n=e.rowManager;this.oldRowManagerConfig={prependRowBuffer:n.prependRowBuffer,appendRowBuffer:n.appendRowBuffer};var r=Math.ceil(t/n.rowOffsetHeight);n.prependRowBuffer=r,n.appendRowBuffer=r,e.renderRows()}},{key:"restoreRowBuffer",value:function(e){e.rowManager.prependRowBuffer=this.oldRowManagerConfig.prependRowBuffer,e.rowManager.appendRowBuffer=this.oldRowManagerConfig.appendRowBuffer}},{key:"buildPage",value:(r=ta()(Zo.a.mark((function e(t){var n,r,i,o,a,s,l,c,u,d,f,h,g,v,p,y,m,b,k,w,S,C,R,x,E,D,T,M;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=(n=this).exportMeta,i=t.client,o=t.headerTpl,a=t.footerTpl,s=t.alignRows,l=r.totalWidth,c=r.totalPages,u=r.currentPage,d=r.subGrids,f=r.currentPageTopMargin,h=r.verticalPosition,g=r.totalRows,v=i.rowManager,p=v.rows,Object.values(d).forEach((function(e){return e.rows=[]})),t.rowsRange===bf.all&&(r.totalHeight=i.height-i.bodyHeight+i.scrollable.scrollHeight-n.getVirtualScrollerHeight(i)),y=0,m=0,b=t.rowsRange===bf.visible?p.findIndex((function(e){return e.bottom>i.scrollable.y})):p.findIndex((function(e){return e.bottom+f+i.headerHeight>0})),C=b,R=0===h?0:p[b].top+f+i.headerHeight,o&&(w=n.prepareHTML(o({totalWidth:l,totalPages:c,currentPage:u})),y=n.measureElement(w)),a&&(S=n.prepareHTML(a({totalWidth:l,totalPages:c,currentPage:u})),m=n.measureElement(S)),k=r.pageHeight-y-m-R,0===h&&(k-=i.headerHeight),E=0;k>0;)D=p[b],s&&k<D.offsetHeight?(E=-k,k=0,n.exportMeta.lastExportedRowBottom=p[b-1].bottom):(n.collectRow(D),k-=D.offsetHeight,x=D.dataIndex,++b===p.length&&k>0?x+1===i.store.count&&(k=0):t.rowsRange===bf.visible&&b-C===g&&(k=0));return e.next=13,n.onRowsCollected(p.slice(C,b),t);case 13:if(t.rowsRange!==bf.visible){e.next=17;break}r.scrollableTopMargin=i.scrollable.y,e.next=21;break;case 17:return T=v.on("offsetrows",(function(e){var t=e.offset;return E+=t})),e.next=20,n.scrollRowIntoView(i,x+1);case 20:T();case 21:return M=n.buildPageHtml(),e.abrupt("return",{html:M,header:w,footer:S,offset:E});case 23:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onRowsCollected",value:(n=ta()(Zo.a.mark((function e(){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(e){var n=te()(e,2),r=n[0],i=n[1];t[r].rows.push(i.outerHTML)}))}},{key:"buildPageHtml",value:function(){var e=this.exportMeta.subGrids,t=this.prepareExportElement();return Object.values(e).forEach((function(e){var n=e.placeHolder,r=e.rows,i=n.outerHTML;t=t.replace(i,r.join(""))})),t}},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta;return t.scrollableTopMargin&&(e.querySelector(".b-grid-vertical-scroller").style.marginTop="-".concat(t.scrollableTopMargin,"px")),se()(J()(l.prototype),"prepareExportElement",this).call(this)}}],[{key:"type",get:function(){return"multipage"}},{key:"title",get:function(){return this.L("multipage")}}]),l}(Bf);function Vf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zf.prototype.pagesExtractor=function(){var e=Lf()(Zo.a.mark((function e(t){var n,r,i,o,a,s,l,c,u,d,f,h,g,v,p;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(n=this).exportMeta,i=n.stylesheets,o=r.totalWidth,a=r.totalPages,s=r.paperWidth,l=r.paperHeight,c=r.contentHeight;case 1:if(!((u=r.currentPage)<a)){e.next=18;break}return n.trigger("exportStep",{text:n.L("exportingPage",{currentPage:u,totalPages:a}),progress:Math.round((u+1)/a*90)}),e.next=5,_f()(n.buildPage(t));case 5:return d=e.sent,f=d.html,h=d.header,g=d.footer,v=d.offset,p=[].concat(Z()(i),["\n                <style>\n                    #".concat(t.client.id," {\n                        height: ").concat(r.totalHeight,"px !important;\n                        width: ").concat(o,"px !important;\n                    }\n                    \n                    .b-export-body .b-export-viewport {\n                        margin-left : ").concat(-s*r.horizontalPosition,"in;\n                        margin-top  : ").concat(r.currentPageTopMargin,"px;\n                    }\n                </style>\n            ")]),r.currentPageTopMargin-=c+v,e.next=14,_f()(n.stateNextPage(t));case 14:return e.next=16,{html:n.pageTpl({html:f,header:h,footer:g,styles:p,paperWidth:s,paperHeight:l})};case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),zf._$name="MultiPageExporter";var Wf=function(e){$()(o,e);var t,n,r,i=(t=o,function(){var e,n=J()(t);if(Vf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function o(){return D()(this,o),i.apply(this,arguments)}return M()(o,[{key:"prepareComponent",value:(r=ta()(Zo.a.mark((function e(t){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se()(J()(o.prototype),"prepareComponent",this).call(this,t);case 2:Object.assign(this.exportMeta,{verticalPages:1,horizontalPages:1,totalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onRowsCollected",value:(n=ta()(Zo.a.mark((function e(){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=0;return e.map((function(e){var n=te()(e,2),r=n[0],i=n[1],o=r.replace(/translate\(\d+px, \d+px\)/,"translate(0px, ".concat(t,"px)"));return t+=i,o}))}},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(n){var r=te()(n,2),i=r[0],o=r[1];t[i].rows.push([o.outerHTML,e.offsetHeight])}))}},{key:"buildPageHtml",value:function(){var e=this,t=e.exportMeta.subGrids,n=e.prepareExportElement();return Object.values(t).forEach((function(t){var r=t.placeHolder,i=t.rows,o=r.outerHTML;n=n.replace(o,e.positionRows(i).join(""))})),n}}],[{key:"type",get:function(){return"singlepage"}},{key:"title",get:function(){return this.L("singlepage")}},{key:"defaultConfig",get:function(){return{centerContentHorizontally:!1}}}]),o}(Bf);function Uf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Wf.prototype.pagesExtractor=function(){var e=Lf()(Zo.a.mark((function e(t){var n,r,i,o,a,s,l,c,u,d,f,h,g,v,p,y,m,b,k,w,S,C,R,x,E,D,T,M,A;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,r=t.client,i=r.rowManager,o=r.store,a=n.stylesheets,s=t.orientation===wf.portrait,l=kf[t.paperFormat],c=s?l.width:l.height,u=s?l.height:l.width,d=t.rowsRange===bf.visible&&o.count?Math.min(o.count,i.visibleRowCount):o.count,f=n.exportMeta,h=f.totalHeight,g=f.totalWidth,v=0,p=-1,!(i.rows.length>0)){e.next=16;break}t.rowsRange===bf.visible&&(p=i.rows.find((function(e){return e.bottom>r.scrollable.y})).dataIndex-1);case 4:if(!(v<d)){e.next=16;break}return b=i.rows,k=b[b.length-1],w=v,b.forEach((function(e){e.dataIndex>p&&v<d&&(++v,h+=e.offsetHeight,n.collectRow(e))})),S=b.findIndex((function(e){return e.dataIndex===p+1})),C=S+(v-w),e.next=10,_f()(n.onRowsCollected(b.slice(S,C),t));case 10:if(!(v<d)){e.next=14;break}return p=k.dataIndex,e.next=14,_f()(n.scrollRowIntoView(r,p+1));case 14:e.next=4;break;case 16:return R=n.buildPageHtml(),h+=r.height-r.bodyHeight,x=h,t.headerTpl&&(y=n.prepareHTML(t.headerTpl({totalWidth:g})),E=n.measureElement(y),h+=E),t.footerTpl&&(m=n.prepareHTML(t.footerTpl({totalWidth:g})),D=n.measureElement(m),h+=D),T=Math.min(1,n.getScaleValue(n.inchToPx(c),g)),M=Math.min(1,n.getScaleValue(n.inchToPx(u),h)),A=Math.min(T,M),a.push("<style>\n                #".concat(r.id," {\n                    height: ").concat(x,"px !important;\n                    width: ").concat(g,"px !important;\n                }\n                \n                .b-export-content {\n                    ").concat(n.centerContentHorizontally?"left: 50%;":"","\n                    transform: scale(").concat(A,") ").concat(n.centerContentHorizontally?"translateX(-50%)":"",";\n                    transform-origin: top left;\n                    height: ").concat(1===A?"inherit":"auto !important",";\n                }\n            </style>")),e.next=25,{html:n.pageTpl({html:R,header:y,footer:m,styles:a,paperWidth:c,paperHeight:u})};case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Wf._$name="SinglePageExporter";var Gf=function(e){$()(i,e);var t,n,r=(t=i,function(){var e,n=J()(t);if(Uf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function i(){return D()(this,i),r.apply(this,arguments)}return M()(i,[{key:"getExporter",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=n.exportersMap,i=t,o=i.type;if(r.has(o))e=r.get(o);else{var a=this.exporters.find((function(e){return e.type===o}));if(!a)throw new Error("Exporter type ".concat(o," is not found. Make sure you've configured it"));delete(t=mt.clone(t)).type,(e=new a(t)).relayAll(n),r.set(o,e)}return e}},{key:"buildRequest",value:function(e,t){return{html:JSON.stringify(e),fileFormat:t.fileFormat,format:t.paperFormat,orientation:t.orientation}}},{key:"buildExportConfig",value:function(e){var t=this,n=t.client,r=t.exportServer,i=t.clientURL,o=t.fileFormat,a=t.paperFormat,s=t.rowsRange,l=t.alignRows,c=t.orientation,u=t.exporters,d=t.translateURLsToAbsolute,f=t.keepPathName,h=t.headerTpl,g=t.footerTpl;return mt.assign({client:n,exportServer:r,clientURL:i,fileFormat:o,paperFormat:a,rowsRange:s,alignRows:l,orientation:c,translateURLsToAbsolute:d,keepPathName:f,headerTpl:h,footerTpl:g,exporterType:u[0].type,fileName:n.$name},e)}},{key:"export",value:(n=ta()(Zo.a.mark((function e(){var t,n,r,i,o,a,s,l,c,u,d=arguments;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:{},r=(n=this).client,i=n.pagesPerRequest,(t=n.buildExportConfig(t)).exporterConfig=mt.assign({type:t.exporterType,translateURLsToAbsolute:t.translateURLsToAbsolute,keepPathName:t.keepPathName},t.exporterConfig||{}),!1===r.trigger("beforeExport",t)){e.next=33;break}if(r.ignoreViewBox=!0,r.mask(r.loadMask),e.prev=7,a=n.getExporter(t.exporterConfig),0!==i){e.next=19;break}return e.next=12,a.export(t);case 12:return s=e.sent,n.trigger("exportStep",{progress:90,text:n.L("Waiting for response from server...")}),e.next=16,Ae.post(t.exportServer,{html:s,orientation:t.orientation,format:t.paperFormat,fileFormat:t.fileFormat,fileName:t.fileName,clientURL:t.clientURL},Object.assign({credentials:"omit",parseJson:!0},n.fetchOptions));case 16:l=e.sent,o={response:l},l.ok&&(c=l.parsedJson,n.openAfterExport&&(c.success?Re.isIE11?window.open(c.url,"ExportedPanel"):((u=document.createElement("a")).download=t.fileName,u.href=c.url,n.openInNewTab&&(u.target="_blank"),document.body.appendChild(u),u.click(),document.body.removeChild(u)):Ce.toast(c.msg)));case 19:e.next=25;break;case 21:throw e.prev=21,e.t0=e.catch(7),o=e.t0 instanceof Response?{response:e.t0}:{error:e.t0},e.t0;case 25:return e.prev=25,n.exportDialog&&n.exportDialog.close(),r.unmask(),r.ignoreViewBox=!1,n.trigger("export",o),o.error?Ce.toast(n.L("Export failed")):o.response.ok||Ce.toast(n.L("Server error")),r.trigger("export",o),e.finish(25);case 33:return e.abrupt("return",o);case 34:case"end":return e.stop()}}),e,this,[[7,21,25,33]])}))),function(){return n.apply(this,arguments)})},{key:"showExportDialog",value:function(){var e=this;e.exportDialog||(e.exportDialog=new Ff({client:e.client,exporters:e.exporters,listeners:{export:e.onExportDialogExport,thisObj:e}})),e.exportDialog.show()}},{key:"onExportDialogExport",value:function(e){var t=e.values,n=this;n.mask=new Qr({progress:0,maxProgress:100,text:"Generating pages...",element:n.exportDialog.element});var r=n.on({export:function(){n.mask.close(),r()},exportstep:function(e){var t=e.progress,r=e.text;n.mask.progress=t,n.mask.text=r}});n.currentExportPromise=n.export(t),n.currentExportPromise.then((function(){return n.currentExportPromise=null}))}},{key:"currentExportPromise",get:function(){return this._currentExportPromise},set:function(e){this._currentExportPromise=e}},{key:"exportersMap",get:function(){return this._exportersMap||(this._exportersMap=new Map)}}],[{key:"$name",get:function(){return"PdfExport"}},{key:"defaultConfig",get:function(){return{exportServer:void 0,fileName:null,fileFormat:"pdf",clientURL:null,paperFormat:"A4",orientation:"portrait",rowsRange:"all",alignRows:!1,pagesPerRequest:0,exporterConfig:null,exporterType:"singlepage",exporters:[Wf,zf],translateURLsToAbsolute:!0,keepPathName:!0,openAfterExport:!0,openInNewTab:!1,headerTpl:null,footerTpl:null,fetchOptions:null}}}]),i}(_e(ho));function Yf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Gf._$name="PdfExport",bd.registerFeature(Gf,!1,"Grid");var $f=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Yf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"export",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return e=mt.assign({},t.config,e),t.normalizeColumns(e),t.generateExportData(e)}},{key:"generateExportData",value:function(e){var t=this.generateColumns(e);return{rows:this.generateRows(e),columns:t}}},{key:"normalizeColumns",value:function(e){var t=this,n=e.columns||this.target.columns.visibleColumns.filter((function(e){return!1!==e.exportable}));e.columns=n.map((function(e){return"string"==typeof e?t.target.columns.find((function(t){return t.field===e}))||{field:e}:e}))}},{key:"generateColumns",value:function(e){var t=this;return e.columns.map((function(n){return t.processColumn(n,e)}))}},{key:"generateRows",value:function(e){var t=e.columns;if(!t.length)return[];var n=this;return n.target.store.map((function(r){return n.processRecord(r,t,e)})).filter((function(e){return e.length}))}},{key:"getColumnType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.target.store,n=e.exportedType||"object";if(void 0===e.exportedType&&e.field){var r=t.modelClass.getFieldDefinition(e.field);r&&r.type&&(n=r.type)}return n}},{key:"processColumn",value:function(e,t){var n=this.target,r=t.defaultColumnWidth,i=e.field,o=e.text,a=e.width,s=e.minWidth;if(i in n.store.modelClass.fieldMap||(i=""),!o||!a){var l=n.columns.find((function(e){return e.field===i}));o||(o=l&&l.text||i),null==a&&(a=l&&l.width||r)}return a=Math.max(a||r,s||r),{field:i,value:o,width:a,type:this.getColumnType(e)}}},{key:"processRecord",value:function(e,t,n){var r,i=this.target,o=n.showGroupHeader,a=n.indent,s=n.indentationSymbol;return e?e.meta.specialRow?o&&e.meta.groupRowFor&&(r=t.map((function(t){return i.features.group.buildGroupHeader({cellElement:on.createElement(),grid:i,record:e,column:t})}))):r=t.map((function(t){var r=e[t.field],o=t.renderer||t.defaultRenderer;return!o||r&&t instanceof Xu&&n.exportDateAsInstance||(r=o.call(t,{value:r,record:e,column:t,grid:i,isExport:!0})),a&&t.tree&&(r="".concat(s.repeat(e.childLevel)).concat(r)),r})):r=t.map((function(){return""})),r}}],[{key:"defaultConfig",get:function(){return{target:null,defaultColumnWidth:100,exportDateAsInstance:!0,showGroupHeader:!0,columns:null,indent:!0,indentationSymbol:""}}}]),r}(G);$f._$name="TableExporter";var qf=function(){function e(t){D()(this,e),this._value=t}return M()(e,[{key:"toString",value:function(){return Boolean(this.value)?"":""}},{key:"value",get:function(){return this._value}}]),e}();function Xf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}qf._$name="BooleanUnicodeSymbol";var Kf=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Xf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"processValue",value:function(e){return null==e||Number.isNaN(e)||"function"==typeof e||"object"===re()(e)&&"[object Object]"===String(e)?"":e}},{key:"generateExportData",value:function(e){var t=this,n=t.exporter.export(e.exporterConfig),r=n.rows,i=n.columns;return{rows:r.map((function(n){return n.map((function(n,r){n instanceof Date?n=ft.format(n,e.dateFormat):"boolean"==typeof n&&(n=new qf(n)),t.convertEmptyValueToEmptyString&&(n=t.processValue(n));return{value:n,type:"string"}}))})),columns:i.map((function(e){var t=e.field,n=e.value,r=e.width;e.type;return"string",{field:t,value:n,width:r,type:"string"}}))}}},{key:"export",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;if(!t.zipcelx)throw new Error('ExcelExporter: "zipcelx" library is required');if(!t.disabled){(e=mt.assign({},t.config,e)).filename||(e.filename=t.client.$name);var n=e,r=n.filename,i=t.generateExportData(e),o=i.rows,a=i.columns;t.zipcelx({filename:r,sheet:{data:[a].concat(o),cols:a}})}}},{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,t),this.zipcelx||"undefined"!=typeof zipcelx&&(this.zipcelx=zipcelx)}},{key:"exporter",get:function(){return this._exporter||(this._exporter=new this.exporterClass(Object.assign({target:this.client},this.exporterConfig)))}}],[{key:"$name",get:function(){return"ExcelExporter"}},{key:"defaultConfig",get:function(){return{filename:null,dateFormat:"YYYY-MM-DD",exporterClass:$f,exporterConfig:null,zipcelx:null,convertEmptyValueToEmptyString:!0}}}]),r}(ho);function Jf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Kf._$name="ExcelExporter",bd.registerFeature(Kf,!1,"Grid");var Qf=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Jf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"startMonitoring",value:function(e){var t=this,n=e instanceof HTMLElement?{element:e}:e,r=n.element,i=n.verticalElement||t.verticalElement||r;if(r&&(r.scrollWidth>r.offsetWidth||i.scrollHeight>i.offsetHeight)){if(t.monitoring.find((function(e){return e.element===r})))return;n.direction=n.direction||t.direction,Object.assign(n,{verticalElement:i,scrollManager:t,startScrollLeft:r.scrollLeft,startScrollTop:i.scrollTop,scrollLeft:r.scrollLeft,scrollTop:i.scrollTop,scrollRelativeLeft:0,scrollRelativeTop:0});var o=t.onMouseMove.bind(n);t.mouseMoveDetacher=Kn.on({mousemove:o,touchmove:o,mouseleave:function(){return t.clearTimeout(t.scrollTimeout)},element:r}),n.scrollWidth=r.scrollWidth,t.monitoring.push(n)}}},{key:"stopMonitoring",value:function(e){var t=this,n=t.monitoring.find((function(t){return t.element===e}));n&&(t.stopScroll(n),t.mouseMoveDetacher&&t.mouseMoveDetacher(),t.monitoring.splice(t.monitoring.indexOf(n),1))}},{key:"startScroll",value:function(e){e.scrolling=!0,this.performScroll(e)}},{key:"stopScroll",value:function(e){e.scrolling=!1,e.scrollRequested&&(this.cancelAnimationFrame(e.frameId),e.scrollRequested=!1),this.clearTimeout(this.scrollTimeout),this.scrollTimeout=null}},{key:"performScroll",value:function(e){var t=this;if(e.scrolling&&!e.scrollRequested){var n=e.element,r=e.verticalElement;0!==e.scrollDeltaX&&(e.scrollLeft+=e.scrollDeltaX,e.scrollLeft=Math.max(Math.min(e.scrollLeft,e.scrollWidth-n.clientWidth),0),e.scrollRelativeLeft=e.scrollLeft-e.startScrollLeft,n.scrollLeft=e.scrollLeft),0!==e.scrollDeltaY&&(e.scrollTop+=e.scrollDeltaY,e.scrollTop=Math.max(Math.min(e.scrollTop,r.scrollHeight-r.clientHeight),0),e.scrollRelativeTop=e.scrollTop-e.startScrollTop,r.scrollTop=e.scrollTop),0===e.scrollRelativeLeft&&0===e.scrollRelativeTop||!e.callback||e.callback.call(e.thisObj||this,e),e.scrollRequested=!0,e.frameId=this.requestAnimationFrame((function(){e.scrollRequested=!1,t.performScroll(e)}))}}},{key:"onMouseMove",value:function(e){var t=this,n=t.scrollManager,r=t.element,i=t.verticalElement,o=r.getBoundingClientRect(),a=i.getBoundingClientRect(),s=n.zoneWidth,l=n.scrollSpeed;t.scrollDeltaX=0,"vertical"!==t.direction&&(e.clientX>o.right-s?t.scrollDeltaX=Math.round((s-(o.right-e.clientX))/l)+1:e.clientX<o.left+s&&(t.scrollDeltaX=-Math.round((s+(o.left-e.clientX))/l)-1)),t.scrollDeltaY=0,"horizontal"!==t.direction&&(e.clientY>a.bottom-s?t.scrollDeltaY=Math.round((s-(a.bottom-e.clientY))/l)+1:e.clientY<a.top+s&&(t.scrollDeltaY=-Math.round((s+(a.top-e.clientY))/l)-1)),0===t.scrollDeltaX&&0===t.scrollDeltaY?n.stopScroll(t):n.scrollTimeout||(n.scrollTimeout=n.setTimeout((function(){return n.startScroll(t)}),n.startScrollDelay))}}],[{key:"defaultConfig",get:function(){return{zoneWidth:50,scrollSpeed:5,verticalElement:null,direction:"both",monitoring:[],startScrollDelay:500,testConfig:{scrollSpeed:2,startScrollDelay:0}}}}]),r}(or(G));function Zf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Qf._$name="ScrollManager";var eh=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Zf()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"fixCellWidths",value:function(){var e,t=this,n=!1;t.columns.traverse((function(r){var i=t.getBarCellElement(r.id),o=on.setLength(r.width),a=on.setLength(r.minWidth);if(i){if(e=Re.isIE11?"calc(".concat(o," - ").concat(t.getLrPadding(i),"px)"):o,n=n||Boolean(r.flex),r.isParent&&null==r.width&&null==r.flex){var s=r.children.reduce((function(e,t){return e+(!t.hidden&&t.flex||0)}),0);i.style.flex=s>0?"".concat(s," 0 auto"):"",s>0&&r.traverse((function(e){return e.data.minWidth=null}))}else if(parseInt(r.minWidth)>=0&&(i.style.minWidth=a),i.style.flex=i.style.flexBasis=i.style.width="",r.flex)!isNaN(parseInt(r.flex))&&r.children?i.style.flex="".concat(r.flex," 0 auto"):i.style.flex=r.flex;else if(parseInt(r.width)>=0){var l=r.parent;!t.isHeader||l.isRoot||l.width?i.style.flexBasis=e:i.style.width=o}r.height>=0&&(i.style.height=on.setLength(r.height))}})),t.element.classList[n?"add":"remove"]("b-has-flex")}},{key:"getLrPadding",value:function(e){if(!this.cellLrPadding){var t=e.ownerDocument.defaultView.getComputedStyle(e);this.cellLrPadding=parseInt(t.getPropertyValue("padding-left"))+parseInt(t.getPropertyValue("padding-right"))+parseInt(t.getPropertyValue("border-left-width"))+parseInt(t.getPropertyValue("border-right-width"))}return this.cellLrPadding}},{key:"getBarCellElement",value:function(e){return this.element.querySelector('[data-column-id="'.concat(e,'"]'))}},{key:"columns",get:function(){return this._columns||this.subGrid.columns},set:function(e){this._columns=e}}],[{key:"$name",get:function(){return"Bar"}},{key:"defaultConfig",get:function(){return{scrollable:{}}}}]),r}(Nr);function th(){var e=Ti()(['\n                <div\n                    class="b-grid-footer '," ",'"\n                    data-column="','" data-column-id="','" data-all-index="','"\n                    >\n                    ',"\n                </div>"]);return th=function(){return e},e}function nh(){var e=Ti()(['\n            <div class="b-grid-footer-scroller b-grid-footer-scroller-','">\n                <div reference="footersElement" class="b-grid-footers b-grid-footers-','" data-region="','"></div>\n            </div>\n        ']);return nh=function(){return e},e}function rh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}eh._$name="Bar";var ih=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(rh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"startConfigure",value:function(e){e.scrollable.overflowX="hidden-scroll",se()(J()(r.prototype),"startConfigure",this).call(this,e)}},{key:"refreshContent",value:function(){this.element.firstElementChild.innerHTML=this.contentTemplate(),this.fixFooterWidths()}},{key:"onPaint",value:function(e){e.firstPaint&&this.refreshContent()}},{key:"template",value:function(){var e=this.subGrid.region;return Ii.tpl(nh(),e,e,e)}},{key:"getFooter",value:function(e){return this.getBarCellElement(e)}},{key:"contentTemplate",value:function(){return this.columns.visibleColumns.map((function(e){return e.hidden?"":Ii.tpl(th(),e.align?"b-grid-footer-align-".concat(e.align):"",e.cls||"",e.field||"",e.id,e.allIndex,e.footerText||"")})).join("")}},{key:"fixFooterWidths",value:function(){this.fixCellWidths()}},{key:"subGrid",get:function(){return this._subGrid},set:function(e){this._subGrid=this.owner=e}},{key:"overflowElement",get:function(){return this.footersElement}}],[{key:"$name",get:function(){return"Footer"}},{key:"defaultConfig",get:function(){return{isFooter:!0}}}]),r}(eh);function oh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ih._$name="Footer";var ah=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(oh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){Object.assign(this,{_elements:{},_elementsArray:[],_cells:{},_allCells:[],_regions:[],lastHeight:0,lastTop:-1,_dataIndex:0,_top:0,_height:0,_id:null,forceInnerHTML:!1,isGroupFooter:!1},e),se()(J()(r.prototype),"construct",this).call(this)}},{key:"doDestroy",value:function(){var e=this;e.rowManager.isDestroying||(e.removeElements(),e.rowManager.idMap[e.id]===e&&delete e.rowManager.idMap[e.id]),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"addElement",value:function(e,t){var n=this,r=t.firstElementChild;for(n._elements[e]=t,n._elementsArray.push(t),n._regions.push(e),Ms.assign(t,{index:n.index}),n._cells[e]=[];r;)n._cells[e].push(r),n._allCells.push(r),Ms.set(r,{column:r.dataset.column,columnId:r.dataset.columnId,rowElement:r.parentNode,row:n}),r=r.nextElementSibling;t.dataset.index=n.index}},{key:"getElement",value:function(e){return this._elements[e]}},{key:"eachElement",value:function(e){for(var t=0;t<this._elementsArray.length;t++)e(this._elementsArray[t],t)}},{key:"eachCell",value:function(e){this._allCells.forEach(e)}},{key:"getCells",value:function(e){return this._cells[e]}},{key:"getCell",value:function(e){return this._allCells.find((function(t){var n=Ms.get(t);return n.columnId===e||n.column===e}))}},{key:"removeElements",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.rowManager.trigger("removeRow",{row:t}),e||t._elementsArray.forEach((function(e){return e.remove()})),t._elements={},t._cells={},t._elementsArray.length=t._regions.length=t._allCells.length=t.lastHeight=t.height=0,t.lastTop=-1}},{key:"setHeightIfBigger",value:function(e){e>this.height&&(this.height=e)}},{key:"updateElementsHeight",value:function(){var e=this;if(e.rowManager.storeKnownHeight(e.id,e.offsetHeight),e.lastHeight!==e.height){for(var t=e._elementsArray,n=0;n<t.length;n++)t[n].style.height="".concat(e.offsetHeight,"px");e.lastHeight=e.height}}},{key:"addCls",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.eachElement((function(e){return on.addClasses(e,t)}))}},{key:"removeCls",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.eachElement((function(e){return on.removeClasses(e,t)}))}},{key:"setTop",value:function(e){this._top!==e&&(this._top=e,this.translateElements())}},{key:"setBottom",value:function(e){this.setTop(e-this.offsetHeight)}},{key:"translateElements",value:function(){var e=this,t=e.grid.positionMode;if(e.lastTop!==e.top){for(var n=e._elementsArray,r=0;r<n.length;r++){var i=n[r].style;"translate"===t?i.transform="translate(0,".concat(e.top,"px)"):"translate3d"===t?i.transform="translate3d(0,".concat(e.top,"px,0)"):"position"===t&&(i.top="".concat(e.top,"px"))}e.rowManager.trigger("translateRow",{row:e}),e.lastTop=e.top}}},{key:"offset",value:function(e){var t=this._top+e;return t<0&&(e-=t,t=0),this.setTop(t),e}},{key:"render",value:function(e,t){var n,r,i,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this,l=s.cells,c=s.grid,u=s._id,d=s._elementsArray,f=Ms.get(d[0]),h=s.rowManager,g=h._rowHeight,v=s.height,p=o&&c.transitionDuration?"".concat(s.cls," b-grid-row-updating"):s.cls,y=0;t||!1===t||(t=c.store.getById(f.id),e=c.store.indexOf(t));var m=t&&c.isSelected(t.id);for(h.trigger("beforeRenderRow",{row:s,record:t,oldId:u});y<d.length;y++)(n=d[y]).className=p,m&&n.classList.add("b-selected"),t?(t.cls&&t.cls.split(" ").forEach((function(e){return n.classList.add(e)})),f.displayed=!0):(f.displayed=!1,n.classList.add("b-grid-row-not-displayed"));for(o&&c.transitionDuration&&s.setTimeout((function(){d.forEach((function(e){e.classList.remove("b-grid-row-updating")}))}),c.transitionDuration),s.height=0,t?(s.id=t.id,s.dataIndex=e):(s.id=null,s.dataIndex=null),y=0;y<l.length;y++)r=l[y],i=s.renderCell(r,t,y,o),s.setHeightIfBigger(!h.fixedRowHeight&&i&&i.height||g);s.updateElementsHeight(),o&&(v!==s.height&&h.translateFromRow(s,a),h.trigger("updateRow",{row:s,record:t,oldId:u}),h.trigger("renderDone")),h.trigger("renderRow",{row:s,record:t,oldId:u}),s.forceInnerHTML=!1}},{key:"renderCell",value:function(e,t,n){var r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this,a=Ms.get(e),s=o.grid.columns.getById(a.columnId),l=a.rowElement,c=Ms.get(l),u=s.internalCellCls,d=s.cellCls,f=s.align,h=s.renderer,g=s.defaultRenderer,v=s.id,p={columnId:v,id:c.id},y=h||g;if(!t){if(null===c.id)return void(e.className="b-grid-cell");if(!(t=o.grid.store.getById(c.id)))return}var m=(r={"b-grid-cell":1},oe()(r,u,u),oe()(r,d,t.meta.specialRow&&"b-check-cell"===s.internalCellCls?void 0:d),oe()(r,"b-cell-dirty",t.isFieldModified(s.field)),oe()(r,"b-grid-cell-align-".concat(f),f),oe()(r,"b-selected",o.grid.isSelected(p)),oe()(r,"b-focused",o.grid.isFocused(p)),r);on.syncClassList(e,m);var b={height:t.get("rowHeight")||0},k=s.getRawValue(t),w=!0,S={cellElement:e,rowElement:l,value:k,record:t,column:s,size:b,grid:o.grid,row:a.row,updatingSingleRow:i};y&&void 0===(k=y.call(s,S))&&(w=!1),o.grid.processCellContent&&(w=o.grid.processCellContent({cellContent:k,cellElement:e,record:t,cellElementData:a,rendererData:S}));var C=S.cellContent=null==k?"":String(k);if(w)if(o.forceInnerHTML)e.innerHTML=C;else if(s.htmlEncode&&!s.disableHtmlEncode)if(Re.isLinux||e._hasHtml)e.innerText=C,e._hasHtml=!1;else{var R=e.firstChild;R?R.data=C:e.innerText=C}else{var x="string"==typeof k,E="object"===re()(k);!s.autoSyncHtml||x&&!e.childElementCount?E?vc.sync({targetElement:e,domConfig:{onlyChildren:!0,children:[k]}}):e.innerHTML=C:x?on.sync(C,e.firstElementChild):vc.sync({domConfig:k,targetElement:e})}return o.rowManager.trigger("renderCell",S),b}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"dataIndex",get:function(){return this._dataIndex},set:function(e){if(this._dataIndex!==e){var t=this._elementsArray;this._dataIndex=e;for(var n=0;n<t.length;n++)t[n].dataset.index=e}}},{key:"id",get:function(){return this._id},set:function(e){var t=this,n={id:e},r=t.rowManager.idMap,i=t._elementsArray,o=t._allCells;if(t._id!=e||r[e]!==t){r[t._id]===t&&delete r[t._id],r[e]=t,t._id=e;for(var a=0;a<i.length;a++)Ms.assign(i[a],n);for(var s=0;s<o.length;s++)Ms.assign(o[s],n);for(var l=0;l<i.length;l++)i[l].dataset.id=e}}},{key:"elements",get:function(){return this._elements}},{key:"cells",get:function(){return this._allCells}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"offsetHeight",get:function(){return this.height+this.grid._rowBorderHeight}},{key:"isFirst",get:function(){return 0===this.dataIndex}},{key:"top",get:function(){return this._top}},{key:"bottom",get:function(){return this._top+this._height+this.grid._rowBorderHeight}}],[{key:"defaultConfig",get:function(){return{cls:"b-grid-row"}}}]),r}(or(G));function sh(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return lh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lh(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function lh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ch(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ah._$name="Row";var uh=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ch()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){e.grid._rowManager=this,this.scrollTargetRecordId=null,this.refreshDetails={topRowIndex:0,topRowTop:0},se()(J()(r.prototype),"construct",this).call(this,e.grid,e)}},{key:"doDestroy",value:function(){this._rows.forEach((function(e){return e.destroy()})),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"initWithHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return n.autoHeight&&(e=n.store.allCount*n.rowOffsetHeight),n.viewHeight=e,n.calculateRowCount(t),e}},{key:"reinitialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.calculateRowCount(!1,!0,!0),t.topIndex+t.rowCount-1>t.store.count&&(e=!0);var n=t.topRow&&!e?t.topRow.top:0;t.scrollTargetRecordId=null,e&&(t.topIndex=t.lastScrollTop=0);var r=t.topRow;r&&(r.dataIndex=t.topIndex,r.setTop(n)),t.estimateTotalHeight(),t.renderFromRow(r)}},{key:"matchRowCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t._rows,r=n.length,i=r-t.rowCount,o=t.grid;if(i)if(i<0){for(var a=[],s=r,l=r?n[r-1].dataIndex+1:0;s<t.rowCount;s++,l++)a.push(new ah({rowManager:t,grid:o,index:s,dataIndex:l}));n.push.apply(n,a),t.trigger("addRows",{rows:a}),e||t.renderFromRow(n[Math.max(0,r-1)])}else{var c=n.splice(r-i,i);t.trigger("removeRows",{rows:c}),c.forEach((function(e){return e.destroy()}))}}},{key:"calculateRowCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.store,o=Math.ceil(r.viewHeight/r.rowOffsetHeight),a=o+r.prependRowBuffer+r.appendRowBuffer;return!r.grid.columns.count||isNaN(o)?(r.rowCount=0,0):(a<r.rowCount&&!t||(r.visibleRowCount=o,r.rowCount=Math.min(i.count,a),e||(r._rows&&r.rowCount!==r._rows.length?r.matchRowCount(n):r.rowCount||r.trigger("changeTotalHeight",{totalHeight:r.totalHeight}),r.grid.toggleEmptyText())),r.rowCount)}},{key:"removeAllRows",value:function(){var e=this,t=e.topRow,n=t?e.refreshDetails={topRowIndex:t.dataIndex,topRowTop:t.top}:e.refreshDetails,r=e._rows.slice();return e.trigger("removeRows",{rows:r}),e._rows.forEach((function(e){return e.destroy()})),e._rows.length=0,e.idMap={},n}},{key:"setPosition",value:function(e){var t=this.topRow,n=e.topRowIndex,r=e.topRowTop;t.setTop(r),t.dataIndex=n}},{key:"getRow",value:function(e){return this.rowCount&&this.rows[e-this.topIndex]}},{key:"getRowById",value:function(e){return e.isModel&&(e=e.id),this.idMap[e]}},{key:"getRowFromElement",value:function(e){return(e=e.closest(".b-grid-row"))&&this.getRow(e.dataset.index)}},{key:"getRowAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t||(e-=In.from(this.grid.bodyContainer,null,!0).round(1).top,e+=this.grid.scrollable.y),e=Zt(e),this.rows.find((function(t){return e>=t.top&&e<t.bottom}))}},{key:"getRowFor",value:function(e){return e instanceof HTMLElement?this.getRowFromElement(e):this.getRowById(e)}},{key:"getNextRow",value:function(e){var t="number"==typeof e?e:e.index;return this.getRow((t+1)%this.rowCount)}},{key:"offsetRows",value:function(e){if(0!==e)for(var t=this.rows,n=t.length,r=0;r<n;r++)t[r].offset(e);this.trigger("offsetRows",{offset:e})}},{key:"getRecordCoords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r="string"==typeof e||"number"==typeof e?e:e.id,i=n.getRowById(e),o=n.client._bodyRectangle;return t||(o=n.client._bodyRectangle=In.client(n.client.bodyContainer)),i?new In(o.x,t?Math.round(i.top):Math.round(i.top+o.y-n.client.scrollable.y),o.width,i.offsetHeight):n.getRecordCoordsByIndex(n.store.indexOf(r),t)}},{key:"getRecordCoordsByIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.topRow,i=n.bottomRow,o=n.client._bodyRectangle,a=n.store.getAt(e),s=a.id,l=n.heightMap.get(s)||n.averageRowHeight||n._rowHeight+n.grid._rowBorderHeight,c=r.dataIndex,u=i.dataIndex,d=e>u?{index:e-u-1,y:i.bottom,from:"bottomRow"}:e>c/2?{index:e-c,y:r.top,from:"topRow"}:{index:e,y:0,from:"top"},f=Math.floor(d.y+d.index*l),h=new In(o.x,t?f:f+o.y-n.client.scrollable.y,o.width,l);return h.virtual=!0,h.block=h.bottom<o.y?"start":h.y>o.bottom?"end":"nearest",h}},{key:"forEach",value:function(e){this.rows.forEach(e)}},{key:Symbol.iterator,value:function(){return this.rows[Symbol.iterator]()}},{key:"storeKnownHeight",value:function(e,t){this.fixedRowHeight||this.heightMap.set(e,t)}},{key:"invalidateKnownHeight",value:function(e){if(!this.fixedRowHeight){var t=this.heightMap;Array.isArray(e)||(e=[e]),e.forEach((function(e){e&&t.delete(e.id)}))}}},{key:"clearKnownHeights",value:function(){this.heightMap.clear()}},{key:"calculateTop",value:function(e){if(this.fixedRowHeight)return e*this.rowOffsetHeight;for(var t=this.heightMap,n=this.rowOffsetHeight,r=this.store,i=0,o=0;o<e;o++){var a=r.getAt(o).id;t.has(a)?i+=t.get(a):i+=n}return i}},{key:"updateAverageRowHeight",value:function(){var e=this;if(!e.fixedRowHeight){var t=0;e.heightMap.forEach((function(e){return t+=e})),e.totalKnownHeight=t,e.averageRowHeight=t/e.heightMap.size}}},{key:"resetAverageRowHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.fixedRowHeight||(t.averageRowHeight=null,e&&t.clearKnownHeights())}},{key:"returnToTop",value:function(){var e=this;e.topIndex=0,e.lastScrollTop=0,e.topRow.dataIndex=0,e.topRow.setTop(0),e.refresh(),e.grid.scrollable.y=0}},{key:"renderFromRecord",value:function(e){var t=this.getRowById(e.id);t&&this.renderFromRow(t)}},{key:"renderFromRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t._rows,r=t.store,i=r.count;if(0!==t.calculateRowCount(!1,i<n.length,!0)){for(var o,a=e?n.indexOf(e):0,s=e?e.dataIndex:n[0].dataIndex,l=i-s-1,c=Math.min(n.length-1,a+l),u=n.length-c-1,d=a>0?n[a-1].bottom:n[a].top,f=a;f<=c;f++)(o=n[f]).dataIndex=s,o.setTop(d),o.render(s,r.getAt(s++),!1),d+=o.offsetHeight;for(;u-- >0;)t.displayRecordAtTop();t.updateAverageRowHeight(),t.estimateTotalHeight(),t.trigger("renderDone")}}},{key:"renderRows",value:function(e){var t,n,r=!1,i=sh(e=Array.from(e));try{for(i.s();!(n=i.n()).done;){var o=n.value;t=o.height,o.render(null,null,!1),r|=o.height!==t}}catch(e){i.e(e)}finally{i.f()}r&&(this.translateFromRow(e[0],!0),this.estimateTotalHeight()),this.trigger("renderDone")}},{key:"translateFromRow",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this,o=e.bottom;for(n=e.dataIndex+1,t=i.getRow(n);t;t=i.getRow(++n))t.setTop(o),o+=t.offsetHeight;i.updateAverageRowHeight(),r||i.estimateTotalHeight()}},{key:"refresh",value:function(){var e=this.topRow;e&&(this.idMap={},this.renderFromRow(e),this.trigger("refresh"))}},{key:"jumpToPosition",value:function(e,t){var n=this,r=n.rowOffsetHeight,i=n.store.count,o=null==t?Math.floor(e/r)-n.prependRowBuffer:t-Math.floor(n.rowCount/2),a=Math.max(Math.min(o,i-n.rowCount),0),s=n.client.scrollable.y,l=Math.min(n.client._bodyRectangle.height+s+n.appendBufferHeight,n.totalHeight);if(n.lastScrollTop=e,n.topRow.dataIndex=n.topIndex=a,n.topRow.setTop(n.calculateTop(a),!1),n.refresh(),!n.allHeightsKnown){if(n.bottomRow.bottom<l){for(;n.bottomRow.bottom<l&&n._rows[n.prependRowBuffer].top<s&&n.bottomRow.dataIndex<i-1;)n.displayRecordAtBottom();n.updateAverageRowHeight()}n.estimateTotalHeight()}if(null!=t){var c=n.grid.scrollable,u=n.getRow(t),d=u&&In.from(u._elementsArray[0]).center.y,f=c.viewport.center.y;u&&(c.y=e=Math.floor(c.y+(d-f)))}return e}},{key:"warpIfNeeded",value:function(e){var t,n=this,r={newScrollTop:e,deltaTop:e-n.lastScrollTop};Math.abs(r.deltaTop)>n.rowCount*n.rowOffsetHeight*3&&(n.scrollTargetRecordId&&(t=n.store.indexOf(n.scrollTargetRecordId)),r.newScrollTop=n.jumpToPosition(e,t),r.deltaTop=0);return r}},{key:"updateRenderedRows",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.client._bodyRectangle;if(0===r.rowCount)return 0;var o=r.estimatedTotalHeight;if(t||Math.abs(e-r.lastScrollTop)>r.rowOffsetHeight||r.topRow.top>e||r.bottomRow.bottom<e+i.height){var a=r.warpIfNeeded(e);r.scrollTargetRecordId=null,r.lastScrollTop=a.newScrollTop,a.deltaTop>0?r.fillBelow(a.newScrollTop):a.deltaTop<0&&r.fillAbove(a.newScrollTop),r.fixedRowHeight||n||r.correctError(a,i,e),o=r.estimateTotalHeight()}return o}},{key:"correctError",value:function(e,t,n){var r=this,i=0;(r.allHeightsKnown||e.deltaTop<0&&n<2*t.height||e.deltaTop>0&&n>r.estimatedTotalHeight-2*t.height-3)&&(i=r.topRow.top-r.calculateTop(r.topRow.dataIndex)),i&&(r.offsetRows(-i),r.grid.scrollable.y=r.lastScrollTop=r.grid.scrollable.y-i)}},{key:"fillAbove",value:function(e){for(var t=this,n=e-t.topRow.top-t.prependBufferHeight,r=0;r>n&&t.topIndex>0;)r-=t.displayRecordAtTop();t.updateAverageRowHeight(),t.trigger("renderDone")}},{key:"fillBelow",value:function(e){for(var t=this,n=e-t.topRow.top-t.prependBufferHeight,r=t.store.count,i=t.rowCount,o=0;o<n&&t.topIndex+i<r&&t.topRow.top+t.topRow.offsetHeight<e;)o+=t.displayRecordAtBottom();t.updateAverageRowHeight(),t.trigger("renderDone")}},{key:"estimateTotalHeight",value:function(){var e=this;if(!e.grid.renderingRows){var t,n=e.store.count,r=n-e.heightMap.size,i=e.bottomRow;if(e.fixedRowHeight)t=n*e.rowOffsetHeight;else if(t=e.totalKnownHeight+Math.floor(r*e.rowOffsetHeight),i&&r){var o=i.bottom;(o>t||e.topIndex+e.rowCount>=n&&t>o)&&(t=o,i.dataIndex<n-1&&(t+=(n-1-i.dataIndex)*e.rowOffsetHeight))}return t!==e.estimatedTotalHeight&&!1!==e.trigger("changeTotalHeight",{totalHeight:t})&&(e.estimatedTotalHeight=t),t}}},{key:"displayRecordAtTop",value:function(){var e=this,t=e.topIndex-1,n=e.store.getAt(t),r=e.bottomRow,i=r.top;return e.trigger("beforeTranslateRow",{row:r,newRecord:n}),r._top=e.topRow.top-e.rowOffsetHeight,r.estimatedTop=!e.fixedRowHeight,r.render(t,n,!1),r._top=i,r.setBottom(e.topRow.top),r.estimatedTop=!1,e.topIndex--,e._rows.unshift(e._rows.pop()),r.offsetHeight}},{key:"displayRecordAtBottom",value:function(){var e=this,t=e.topIndex+e.rowCount,n=e.store.getAt(t),r=e.topRow;return e.trigger("beforeTranslateRow",{row:r,newRecord:n}),r.dataIndex=t,r.setTop(e.bottomRow.bottom),r.render(t,n,!1),e.topIndex++,e._rows.push(e._rows.shift()),r.offsetHeight}},{key:"store",get:function(){return this.client.store}},{key:"rows",get:function(){return this._rows}},{key:"topRow",get:function(){return this._rows[0]}},{key:"bottomRow",get:function(){var e=Math.min(this.rowCount,this.store.count);return this.rows[e-1]}},{key:"rowHeight",get:function(){return this._rowHeight},set:function(e){var t=this,n=t.grid,r=t._rowHeight;if(mt.assertNumber(e,"rowHeight"),e<10&&(console.warn("The rowHeight of ".concat(e," was increased to 10 which is the minimum.")),e=10),t.trigger("beforeRowHeight",{height:e}),t._rowHeight=e,t.prependBufferHeight=t.prependRowBuffer*t.rowOffsetHeight,t.appendBufferHeight=t.appendRowBuffer*t.rowOffsetHeight,t.rows.length){var i=t.averageRowHeight,o=i,a=n.scrollable.y,s=t.getRowAt(a,!0),l=s.top-a;t.resetAverageRowHeight(!0),i-=n._rowBorderHeight,i*=e/r,t.averageRowHeight=i+=n._rowBorderHeight,t.calculateRowCount(!1,!0,!0),t.topRow.setTop(t.topRow.dataIndex*i),t.refresh(),a*(i/o)!==a&&n.scrollRowIntoView(s.id,{block:"start",edgeOffset:l})}t.trigger("rowHeight",{height:e})}},{key:"rowOffsetHeight",get:function(){return Math.floor(this.averageRowHeight)||this._rowHeight+this.grid._rowBorderHeight}},{key:"totalHeight",get:function(){return Math.floor(this.store.count*this.rowOffsetHeight)}},{key:"allHeightsKnown",get:function(){return this.fixedRowHeight||this.heightMap.size>=this.store.count}}],[{key:"pluginConfig",get:function(){return{chain:["getRowById","topRow","bottomRow","getRecordCoords","getRow","getRowFor","getRowFromElement","destroy"],assign:["rowHeight"]}}},{key:"defaultConfig",get:function(){return{prependRowBuffer:5,appendRowBuffer:5,rowHeight:null,fixedRowHeight:null,autoHeight:!1}}},{key:"properties",get:function(){return{idMap:{},topIndex:0,lastScrollTop:0,_rows:[],heightMap:new Map,totalKnownHeight:0,estimatedTotalHeight:0}}}]),r}(ho);function dh(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return fh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fh(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function fh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}uh._$name="RowManager";var gh={x:1},vh=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(hh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"addScroller",value:function(e){(this.xScrollers||(this.xScrollers=[])).push(e)}},{key:"addPartner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gh;if("string"==typeof t&&(t=oe()({},t,1)),t.x)for(var n=0;n<this.xScrollers.length;n++)this.xScrollers[n].addPartner(e.xScrollers[n],"x");t.y&&se()(J()(r.prototype),"addPartner",this).call(this,e,"y")}},{key:"updateOverflowX",value:function(e){this.xScrollers&&this.xScrollers.forEach((function(t){return t.overflowX=e})),this.widget.virtualScrollers.classList[!1===e?"add":"remove"]("b-hide-display")}},{key:"scrollIntoView",value:function(e,t){if(1!==e.nodeType)return se()(J()(r.prototype),"scrollIntoView",this).call(this,e,t);var n,i=dh(this.xScrollers);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.element.contains(e))return o.scrollIntoView(e,t)}}catch(e){i.e(e)}finally{i.f()}}},{key:"x",set:function(e){this.xScrollers&&(this.xScrollers[0].x=e)},get:function(){return this.xScrollers?this.xScrollers[0].x:0}}]),r}(Mr);function ph(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return yh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yh(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function yh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mh(){var e=Ti()(['\n                <div class="b-grid-header" data-column="','" data-column-id="','" ','>\n                    <div class="b-grid-header-text">\n                        <div class="b-grid-header-text-content"></div>\n                    </div>\n                    ','\n                    <div class="b-grid-header-resize-handle"></div>\n                </div>\n            ']);return mh=function(){return e},e}function bh(){var e=Ti()(['\n            <div class="b-grid-header-scroller b-grid-header-scroller-','">\n                <div reference="headersElement" class="b-grid-headers b-grid-headers-','" data-region="','" data-max-depth="','" reference="headersElement"></div>\n            </div>\n        ']);return bh=function(){return e},e}function kh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}vh._$name="GridScroller";var wh=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(kh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"startConfigure",value:function(e){e.scrollable.overflowX="hidden-scroll",se()(J()(r.prototype),"startConfigure",this).call(this,e)}},{key:"template",value:function(){var e=this.region;return Ii.tpl(bh(),e,e,e,this.maxDepth)}},{key:"contentTemplate",value:function(e){var t=this;return e.hidden?"":Ii.tpl(mh(),e.field||"",e.id,e.isLeaf?'tabindex="0"':"",e.children?'\n                    <div class="b-grid-header-children">\n                            '.concat(e.children.map((function(e){return t.contentTemplate(e)})).join(""),"\n                    </div>\n                    "):"")}},{key:"calculateMinWidthForSafari",value:function(){var e=0;return this.columns.visibleColumns.forEach((function(t){e+=t.calculateMinWidth()})),e}},{key:"fixHeaderWidths",value:function(){this.fixCellWidths()}},{key:"refreshHeaders",value:function(){var e=this;e.columns.traverse((function(t){var n=e.getBarCellElement(t.id);if(n){var r,i=new bt((r={"b-grid-header":1,"b-grid-header-parent":t.isParent},oe()(r,"b-level-".concat(t.childLevel),1),oe()(r,"b-depth-".concat(t.meta.depth),1),oe()(r,"b-grid-header-align-".concat(t.align),t.align),oe()(r,"b-grid-header-resizable",t.resizable&&t.isLeaf),oe()(r,t.cls,t.cls),oe()(r,"b-last-parent",t.isParent&&t.isLastInSubGrid),oe()(r,"b-last-leaf",t.isLeaf&&t.isLastInSubGrid),r)),o=t.text;n.className=i,t.headerRenderer&&(o=t.headerRenderer.call(t.thisObj||e,{column:t,headerElement:n})),t.icon&&(o='<i class="'.concat(t.icon,'"></i>')+(o||""));var a=n.querySelector(".b-grid-header-text-content");a&&(a.innerHTML=o||"")}})),e.fixHeaderWidths()}},{key:"initDepths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.columns.topColumns,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=0;t&&t.meta&&t.meta.depth++;var i,o=ph(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.meta.depth=0,a.children&&(n.initDepths(a.children.filter(n.columns.chainedFilterFn),a),a.meta.depth&&t&&(t.meta.depth+=a.meta.depth)),a.meta.depth>r&&(r=a.meta.depth)}}catch(e){o.e(e)}finally{o.f()}return t||(n.maxDepth=r),r}},{key:"getHeader",value:function(e){return this.getBarCellElement(e)}},{key:"refreshContent",value:function(){var e=this;e.content=e.columns.topColumns.map((function(t){return e.contentTemplate(t)})).join(""),e.refreshHeaders()}},{key:"onPaint",value:function(e){e.firstPaint&&this.refreshContent()}},{key:"subGrid",get:function(){return this._subGrid},set:function(e){this._subGrid=e,this.id=e.id+"-header"}},{key:"region",get:function(){return this.subGrid&&this.subGrid.region}},{key:"overflowElement",get:function(){return this.headersElement}},{key:"columns",get:function(){var e=this,t=se()(J()(r.prototype),"columns",this);return e.columnsDetacher||(e.columnsDetacher=t.on({change:function(){e.initDepths()},thisObj:e}),e.initDepths()),t},set:function(e){ei()(J()(r.prototype),"columns",e,this,!0)}},{key:"contentElement",get:function(){return this.element.firstElementChild}}],[{key:"$name",get:function(){return"Header"}},{key:"defaultConfig",get:function(){return{isHeader:!0}}}]),r}(eh);function Sh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}wh._$name="Header";var Ch={touchstart:"onElementTouchStart",touchmove:"onElementTouchMove",touchend:"onElementTouchEnd",mouseover:"onElementMouseOver",mouseout:"onElementMouseOut",mousedown:"onElementMouseDown",mousemove:"onElementMouseMove",mouseup:"onElementMouseUp",click:"onHandleElementClick",dblclick:"onElementDblClick",keydown:"onElementKeyDown",keyup:"onElementKeyUp",keypress:"onElementKeyPress",contextmenu:"onElementContextMenu",focus:"onGridElementFocus"};function Rh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var xh={string:1,object:1,function:1};function Eh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Dh=Object.freeze({doSelect:!0}),Th=Object.freeze({x:!1,y:!1});function Mh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ah(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Ih(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ih(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Ih(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Oh={string:1,number:1},_h={dataset:1,batch:1};function Ph(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Lh=function(e){return e.columns.suspendEvents()},Hh=function(e){return e.columns.resumeEvents()},jh=function(e){e.columns.clearCaches(),e.columns.fillFromMaster()},Bh=function(e,t){return e.stateSortIndex-t.stateSortIndex};function Nh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var zh=new Promise((function(e){return e()})),Vh={block:"nearest"},Wh=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Nh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"scrollIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vh,n=this,r=n.getDeltaTo(e,t),i=r.xDelta,o=r.yDelta,a=i||o?n.scrollBy(i,o,t):zh;return(t.highlight||t.focus)&&a.then((function(){t.highlight&&(e instanceof In?e.translate(-i,-o).highlight():on.highlight(e)),t.focus&&e.focus&&e.focus()})),a}},{key:"scrollBy",value:function(e,t,n){var i=t&&this.yScroller.scrollBy(0,t,n),o=e&&se()(J()(r.prototype),"scrollBy",this).call(this,e,0,n);if(o&&o.cancel&&i&&i.cancel){var a=o.cancel,s=i.cancel;return o.cancel=i.cancel=function(){a(),s()},Promise.all([o,i])}return o||i}},{key:"scrollTo",value:function(e,t,n){var i=null!=t&&this.yScroller.scrollTo(null,t,n),o=null!=e&&se()(J()(r.prototype),"scrollTo",this).call(this,e,null,n);if(n&&n.animate||this.syncPartners(),o&&o.cancel&&i&&i.cancel){var a=o.cancel,s=i.cancel;return o.cancel=i.cancel=function(){a(),s()},Promise.all([o,i])}return o||i}},{key:"viewport",get:function(){return In.from(this.element).intersect(In.from(this.yScroller.element))}},{key:"y",set:function(e){this.yScroller&&(this.yScroller.y=e)},get:function(){return this.yScroller?this.yScroller.y:0}},{key:"maxY",get:function(){return this.yScroller?this.yScroller.maxY:0}},{key:"scrollHeight",get:function(){return this.yScroller?this.yScroller.scrollHeight:0}},{key:"clientHeight",get:function(){return this.yScroller?this.yScroller.clientHeight:0}}]),r}(Mr);function Uh(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Gh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gh(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Gh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Yh(){var e=Ti()(['\n                <div reference="splitterElement" data-region="','" class="b-grid-splitter ','">\n                    <div class="b-grid-splitter-inner b-grid-splitter-main">\n                        <div class="b-grid-splitter-buttons" reference="splitterButtons">\n                            <i class="b-icon b-icon-collapse-gridregion"></i>\n                            <i class="b-icon b-icon-expand-gridregion"></i>\n                        </div>\n                    </div>\n                </div>']);return Yh=function(){return e},e}function $h(){var e=Ti()(['\n            <div class="b-grid-subgrid b-grid-subgrid-'," b-grid-horizontal-scroller ",'" data-region="','">\n                <div reference="virtualScrollerElement" class="b-virtual-scroller" data-region="','">\n                    <div reference="virtualScrollerWidth" class="b-virtual-width"></div>\n                </div>\n                ',"\n            </div>\n        "]);return $h=function(){return e},e}function qh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Wh._$name="SubGridScroller";var Xh=function(e){$()(o,e);var t,n,r,i=(t=o,function(){var e,n=J()(t);if(qh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function o(){return D()(this,o),i.apply(this,arguments)}return M()(o,[{key:"construct",value:function(e){se()(J()(o.prototype),"construct",this).call(this,e),this.initHeader(),this.rowManager.on("addrows",this.onAddRow,this)}},{key:"doDestroy",value:function(){var e=this;e.header&&e.header.destroy(),e.footer&&e.footer.destroy(),e.fakeScroller&&e.fakeScroller.destroy(),e.virtualScrollerElement&&e.virtualScrollerElement.remove(),e.splitterElement&&e.splitterElement.remove(),se()(J()(o.prototype),"doDestroy",this).call(this)}},{key:"initHeader",value:function(){var e=this,t=e.element.style,n=t.width,r=t.flex,i=Object.assign({subGrid:e,hidden:e.hideHeaders,parent:e},e.headerConfig);r?i.flex=r:n&&(i.width=n),e.header=new e.headerClass(i)}},{key:"initElements",value:function(){this.footerElement=on.down(this.grid.element,".b-grid-footer-scroller-"+this.region),this.updateHasFlex()}},{key:"toggleSplitterCls",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=[n.splitterElement,n.headerSplitter,n.footerSplitter,n.scrollerSplitter];r.forEach((function(n){return n&&n.classList[t?"add":"remove"](e)}))}},{key:"template",value:function(){var e=this.grid,t=this.region,n=!e||t===e.regions[e.regions.length-1];return Ii.tpl($h(),t,this.collapsed?"b-grid-subgrid-collapsed":"",t,t,n?"":Ii.tpl(Yh(),t,this.collapsed?"b-grid-splitter-collapsed":""))}},{key:"rowTemplate",value:function(){return'<div class="b-grid-row">'.concat(this.columns.visibleColumns.map(this.cellTemplate).join(""),"</div>")}},{key:"cellTemplate",value:function(e){return'<div class="b-grid-cell" data-column="'.concat(e.field||"",'" data-column-id="').concat(e.id,'"></div>')}},{key:"render",value:function(){var e=this,t=e.grid,n=e.region,r=[{className:"b-grid-splitter-inner"}],i={region:n};if(t&&(t.virtualScrollers.appendChild(e.virtualScrollerElement),e.renderHeader(t.headerContainer),e.renderFooter(t.footerContainer),e.initElements()),se()(J()(o.prototype),"render",this).apply(this,arguments),e.splitterElement){var a=e.splitterElement.className.trim();e.element.parentNode.insertBefore(e.splitterElement,e.element.nextElementSibling),e.header&&(e.headerSplitter=on.createElement({className:a,children:r,dataset:i,parent:e.header.element.parentNode,nextSibling:e.header.element.nextSibling}),Kn.on({element:e.headerSplitter,mouseenter:"onSplitterMouseOver",mouseleave:"onSplitterMouseOut",thisObj:e})),e.footer&&(e.footerSplitter=on.createElement({className:a,children:r,dataset:i,parent:e.footer.element.parentNode,nextSibling:e.footer.element.nextSibling}),Kn.on({element:e.footerSplitter,mouseenter:"onSplitterMouseOver",mouseleave:"onSplitterMouseOut",thisObj:e})),e.scrollerSplitter=on.createElement({className:"".concat(a," b-splitter-scroller"),children:r,dataset:i,parent:e.virtualScrollerElement.parentNode,nextSibling:e.virtualScrollerElement.nextSibling}),Kn.on({element:e.splitterElement,mouseenter:"onSplitterMouseOver",mouseleave:"onSplitterMouseOut",thisObj:e})}e._collapsed&&e.collapse()}},{key:"renderHeader",value:function(e){this.header&&this.header.render(e,!1)}},{key:"renderFooter",value:function(e){this.footer&&(this.footer.render(e,!1),this.grid.footerContainer.classList.remove("b-hidden"))}},{key:"refreshHeader",value:function(){this.header.refreshContent()}},{key:"refreshFooter",value:function(){this.footer&&this.footer.refreshContent()}},{key:"eachWidget",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=[];n.header&&r.unshift(n.header),n.footer&&r.push(n.footer);for(var i=0;i<r.length;i++){var o=r[i];if(!1===e(o))return;t&&o.eachWidget&&o.eachWidget(e,t)}}},{key:"fixCellWidths",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t||(t=this.columns.bottomColumns.filter((function(e){return!e.hidden})));for(var n=e.firstElementChild,r=0;n;){var i=t[r];i.minWidth&&on.setLength(n,"minWidth",i.minWidth),i.flex?(n.style.flex=i.flex,n.style.width=""):i.width?(n.style.flex="",n.style.width=on.setLength(i.width),Re.isIE11&&(n.style.minWidth=n.style.width)):n.style.flex=n.style.width=n.style.minWidth="",n=n.nextElementSibling,r++}}},{key:"fixWidths",value:function(){var e=this,t=e.element,n=e.header,r=e.footer;if(!e.collapsed){if(e.flex)n.flex=e.flex,r&&(r.flex=e.flex),t.style.flex=e.flex;else{if(e.hasCalculatedWidth&&!e.columns.some((function(e){return!e.hidden&&e.flex}))&&e.totalFixedWidth!==e.width)return e.width=e.totalFixedWidth,void(e.hasCalculatedWidth=!0);var i=e.width;if(!i){i=0;var o,a=Uh(e.columns);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.flex||s.hidden||(i+=s.width)}}catch(e){a.e(e)}finally{a.f()}}t.style.width="".concat(i,"px"),n.width=i,r&&(r.width=i)}e.syncScrollingPartners(!1)}}},{key:"fixRowWidthsInSafariEdge",value:function(){if(Re.isSafari||Re.isEdge){var e=this.region,t=this.header,n=t.calculateMinWidthForSafari();this.rowManager.forEach((function(t){var r=t.getElement(e);r&&(r.style.width="".concat(n,"px"))})),t.headersElement.style.width="".concat(n,"px")}}},{key:"onInternalResize",value:function(e,t,n,r,i){var a=this,s=a.grid;se()(J()(o.prototype),"onInternalResize",this).call(this,e,t,n,r,i),a.splitterElement&&a.syncSplitterButtonPosition(),s&&(t!==r&&(s.trigger("horizontalScroll",{subGrid:a,grid:s,scrollLeft:a.scrollable.x}),a.refreshFakeScroll(),a.fixRowWidthsInSafariEdge()),a.trigger("afterInternalResize",a))}},{key:"syncParallelSplitters",value:function(e){var t=this.grid;if(this.splitterElement)this.toggleSplitterCls("b-grid-splitter-collapsed",e);else{var n=t.getSubGrid(t.getPreviousRegion(this.region));n&&n.splitterElement&&n.syncParallelSplitters(e)}}},{key:"onSplitterMouseOver",value:function(){var e=this.nextSibling;this.collapsed||e&&e.collapsed||this.toggleSplitterCls("b-hover"),this.startSplitterButtonSyncing()}},{key:"onSplitterMouseOut",value:function(){var e=this.nextSibling;this.toggleSplitterCls("b-hover",!1),this.collapsed||e&&e.collapsed||this.stopSplitterButtonSyncing()}},{key:"startSplitterButtonSyncing",value:function(){var e=this;e.splitterElement&&(e.syncSplitterButtonPosition(),e.splitterSyncScrollListener||(e.splitterSyncScrollListener=e.grid.scrollable.on({scroll:"syncSplitterButtonPosition",thisObj:e})))}},{key:"stopSplitterButtonSyncing",value:function(){this.splitterSyncScrollListener&&(this.splitterSyncScrollListener(),this.splitterSyncScrollListener=null)}},{key:"syncSplitterButtonPosition",value:function(){this.splitterButtons.style.transform="translateY(".concat(this.grid.scrollable.y+this.grid.bodyHeight/2-(this.headerSplitter?this.grid.headerHeight:0),"px)")}},{key:"updateHasFlex",value:function(){var e=this.columns.visibleColumns.some((function(e){return e.flex}));on.toggleClasses(this.element,["b-has-flex"],e)}},{key:"refreshFakeScroll",value:function(){var e=this,t=e.element,n=e.virtualScrollerElement,r=e.virtualScrollerWidth,i=e.totalFixedWidth,o=e.store,a=e.scrollable;a.scrollWidth=o&&o.count?null:i,n.style.width="".concat(t.offsetWidth,"px"),i>a.clientWidth?t.classList.add("b-overflowing-horizontally"):t.classList.remove("b-overflowing-horizontally"),e.collapsed||(a.scrollWidth>a.clientWidth+(Re.isEdge?1:0)?(r.style.width="".concat(a.scrollWidth,"px"),e.header.element.classList.add("b-overflowing"),e.footer&&e.footer.element.classList.add("b-overflowing"),e.overflowingHorizontally=!0,e.grid.virtualScrollers.classList.remove("b-hide-display")):(r.style.width=0,e.header.element.classList.remove("b-overflowing"),e.footer&&e.footer.element.classList.remove("b-overflowing"),e.overflowingHorizontally=!1))}},{key:"initScroll",value:function(){var e=this,t=e.scrollable,n=e.virtualScrollerElement;e.syncPartnersOnFrame=e.createOnFrame(e.syncScrollingPartners),Re.isFirefox&&t.element.addEventListener("wheel",(function(e){e.deltaX&&(t.x+=e.deltaX,e.preventDefault())})),t.yScroller=e.grid.scrollable,t.yScroller.addScroller(t),e.fakeScroller=new Mr({element:n,overflowX:!0}),t.on({scroll:"onSubGridScroll",scrollend:"onSubGridScrollEnd",thisObj:e}),t.addPartner(e.fakeScroller,"x"),e.header&&t.addPartner(e.header.scrollable,"x"),e.footer&&t.addPartner(e.footer.scrollable,"x")}},{key:"onSubGridScrollEnd",value:function(){this.forceScrollUpdate||this.syncScrollingPartners(),this.scrolling=!1}},{key:"onSubGridScroll",value:function(){this.forceScrollUpdate?(this.syncScrollingPartners(),this.forceScrollUpdate=!1):this.syncPartnersOnFrame()}},{key:"syncScrollingPartners",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,n=t.grid;!t.scrolling&&e&&(t.scrolling=!0),n.trigger("horizontalScroll",{subGrid:t,grid:n,scrollLeft:t.scrollable.x})}},{key:"scrollColumnIntoView",value:function(e,t){var n=this,r=n.header.scrollable;if(e=e instanceof Hu?e:n.columns.get(e)||n.columns.getById(e)||n.columns.getAt(e)){var i=n.header.getHeader(e.id);if(i)return r.scrollIntoView(In.from(i,null,!0),t)}}},{key:"onAddRow",value:function(e){var t=e.rows,n=this,r=n.rowTemplate(),i=n.columns.bottomColumns.filter((function(e){return!e.hidden})),o=document.createDocumentFragment();t.forEach((function(e){var t=on.createElementFromTemplate(r);o.appendChild(t),e.addElement(n.region,t),n.fixCellWidths(t,i)})),n.fixRowWidthsInSafariEdge(),n.element.insertBefore(o,n.insertRowsBefore)}},{key:"clearRows",value:function(){this.emptyCache();var e=this.element.querySelectorAll(".b-grid-row"),t=document.createRange();e.length&&(t.setStartBefore(e[0]),t.setEndAfter(e[e.length-1]),t.deleteContents())}},{key:"addNewRowElement",value:function(){var e=on.append(this.element,this.rowTemplate());return this.fixCellWidths(e),e}},{key:"toggleTransitionClasses",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=n.resolveSplitter(r);r.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),r.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),i.classList[e?"remove":"add"]("b-grid-splitter-animate")}},{key:"collapse",value:(r=ta()(Zo.a.mark((function e(){var t,n,r,i,o;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=t.splitterElement?t:t.previousSibling,o=0,n.eachSubGrid((function(e){e!==t&&!e._collapsed&&++o})),0!==o){e.next=6;break}return e.next=6,r.expand();case 6:return e.abrupt("return",new Promise((function(e){if(!t._beforeCollapseState){t._beforeCollapseState={};var n=!1;t.width&&(n=!0,t.on({afterinternalresize:function(){e(t)},thisObj:t,once:!0})),t._beforeCollapseState.width=t.width,t._beforeCollapseState.elementWidth=t.element.style.width,""===r.element.style.flex&&(t._beforeCollapseState.nextRegionWidth=r.width,r.width+=t._beforeCollapseState.width),""!==t.element.style.flex&&(t._beforeCollapseState.flex=t.element.style.flex,t.header.element.style.flex=t.element.style.flex=""),t.element.classList.add("b-grid-subgrid-collapsed"),t.virtualScrollerElement.classList.add("b-collapsed"),t.header.element.classList.add("b-collapsed"),t.footer&&t.footer.element.classList.add("b-collapsed"),t.width="",t._collapsed=!0,n||e(!1)}})).then((function(e){t.isDestroyed||!1===e||(t.syncParallelSplitters(!0),t.grid.trigger("subGridCollapse",t),i.startSplitterButtonSyncing&&i.startSplitterButtonSyncing())})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"expand",value:(n=ta()(Zo.a.mark((function e(){var t,n,r,i;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=this).grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=t.splitterElement?t:t.previousSibling,e.abrupt("return",new Promise((function(e){if(null!=t._beforeCollapseState){var n=!1;t.width!==t._beforeCollapseState.elementWidth&&(n=!0,t.on({afterinternalresize:function(){t.setTimeout((function(){return e(t)}),10)},thisObj:t,once:!0})),""===r.element.style.flex&&(r.width=t._beforeCollapseState.nextRegionWidth),t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,t.virtualScrollerElement.classList.remove("b-collapsed"),t.header.element.classList.remove("b-collapsed"),t.footer&&t.footer.element.classList.remove("b-collapsed"),t._beforeCollapseState.flex?(t.width=t._beforeCollapseState.width,t.header.flex=t.flex=t._beforeCollapseState.flex,t.footer&&(t.footer.flex=t._beforeCollapseState.flex),t._width=null):t.width=t._beforeCollapseState.elementWidth,t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,n||e(!1),delete t._beforeCollapseState}})).then((function(e){!1!==e&&(i.stopSplitterButtonSyncing(),t.syncParallelSplitters(!1),t.grid.trigger("subGridExpand",t))})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"totalFixedWidth",get:function(){return this.columns.totalFixedWidth}},{key:"width",set:function(e){var t=this;t.hasCalculatedWidth=!1,ei()(J()(o.prototype),"width",e,this,!0),t.header&&(t.header.width=e),t.footer&&(t.footer.width=e),t.isPainted&&t.onElementResize()},get:function(){return se()(J()(o.prototype),"width",this)}},{key:"flex",set:function(e){var t=this;t.hasCalculatedWidth=!1,t.header&&(t.header.flex=e),t.footer&&(t.footer.flex=e),ei()(J()(o.prototype),"flex",e,this,!0),t.isPainted&&t.onElementResize()},get:function(){return se()(J()(o.prototype),"flex",this)}},{key:"viewRectangle",get:function(){return new In(this.scrollable.x,this.scrollable.y,this._width,this.rowManager.viewHeight)}},{key:"scrolling",set:function(e){this._scrolling=e},get:function(){return this._scrolling}},{key:"rowElements",get:function(){return this.fromCache(".b-grid-row",!0)}},{key:"emptyText",get:function(){return this._emptyText},set:function(e){this._emptyText=e,this.element.dataset.emptyText=e}},{key:"collapsed",get:function(){return this._collapsed},set:function(e){this.isConfiguring?this._collapsed=e:e?this.collapse():this.expand()}}],[{key:"$name",get:function(){return"SubGrid"}},{key:"defaultConfig",get:function(){return{localizableProperties:["emptyText"],localeClass:"Grid",insertRowsBefore:null,appendTo:null,hideHeaders:null,monitorResize:!0,collapsed:null,scrollable:{overflowX:!0},scrollerClass:Wh,hasCalculatedWidth:null,sealedColumns:null,emptyText:null}}}]),o}(Nr);function Kh(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Jh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jh(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Jh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Xh._$name="SubGrid";var Zh={TemplateColumn:{noTemplate:"TemplateColumn needs a template",noFunction:"TemplateColumn.template must be a function"},ColumnStore:{columnTypeNotFound:function(e){return"Column type '".concat(e.type,"' not registered")}},ColumnPicker:{columnsMenu:"Columns",hideColumn:"Hide column",hideColumnShort:"Hide"},Filter:{applyFilter:"Apply filter",filter:"Filter",editFilter:"Edit filter",on:"On",before:"Before",after:"After",equals:"Equals",lessThan:"Less than",moreThan:"More than",removeFilter:"Remove filter"},FilterBar:{enableFilterBar:"Show filter bar",disableFilterBar:"Hide filter bar"},Group:{groupAscending:"Group ascending",groupDescending:"Group descending",groupAscendingShort:"Ascending",groupDescendingShort:"Descending",stopGrouping:"Stop grouping",stopGroupingShort:"Stop"},Search:{searchForValue:"Search for value"},Sort:{sortAscending:"Sort ascending",sortDescending:"Sort descending",multiSort:"Multi sort",removeSorter:"Remove sorter",addSortAscending:"Add ascending sorter",addSortDescending:"Add descending sorter",toggleSortAscending:"Change to ascending",toggleSortDescending:"Change to descending",sortAscendingShort:"Ascending",sortDescendingShort:"Descending",removeSorterShort:"Remove",addSortAscendingShort:"+ Ascending",addSortDescendingShort:"+ Descending"},Tree:{noTreeColumn:"To use the tree feature one column must be configured with tree: true"},Grid:{featureNotFound:function(e){return"Feature '".concat(e,"' not available, make sure you have imported it")},invalidFeatureNameFormat:function(e){return"Invalid feature name '".concat(e,"', must start with a lowercase letter")},removeRow:"Delete record",removeRows:"Delete records",moveColumnLeft:"Move to left section",moveColumnRight:"Move to right section"},GridBase:{loadFailedMessage:"Data loading failed!",syncFailedMessage:"Data synchronization failed!",serverResponseLabel:"Server response:",unspecifiedFailure:"Unspecified failure",unknownFailure:"Unknown error",networkFailure:"Network error",parseFailure:"Failed to parse server response",loadMask:"Loading...",syncMask:"Saving changes, please wait...",noRows:"No records to display"},PdfExport:{"Waiting for response from server...":"Waiting for response from server...","Export failed":"Export failed","Server error":"Server error"},ExportDialog:{width:"40em",labelWidth:"12em",exportSettings:"Export settings",export:"Export",exporterType:"Control pagination",cancel:"Cancel",fileFormat:"File format",rows:"Rows",alignRows:"Align rows",columns:"Columns",paperFormat:"Paper format",orientation:"Orientation"},ExportRowsCombo:{all:"All rows",visible:"Visible rows"},ExportOrientationCombo:{portrait:"Portrait",landscape:"Landscape"},SinglePageExporter:{singlepage:"Single page"},MultiPageExporter:{multipage:"Multiple pages",exportingPage:function(e){var t=e.currentPage,n=e.totalPages;return"Exporting page ".concat(t,"/").concat(n)}}};for(var eg in Ir)Zh[eg]=Ir[eg];var tg=Zh;function ng(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return rg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rg(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function rg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ig(){var e=Ti()(['\n            <div>\n                <header reference="headerContainer" class="b-grid-header-container ','"></header>\n                <div reference="bodyContainer" class="b-grid-body-container" tabIndex="-1">\n                    <div reference="verticalScroller" class="b-grid-vertical-scroller"></div>\n                </div>\n                <div reference="virtualScrollers" class="b-virtual-scrollers ','" style="','"></div>\n                <footer reference="footerContainer" class="b-grid-footer-container b-hidden"></footer>\n            </div>\n        ']);return ig=function(){return e},e}function og(e){return function(){var t,n=J()(e);if(ag()){var r=J()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return X()(this,t)}}function ag(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Fe.registerLocale("En",{desc:"English",locale:Zh});var sg=new Promise((function(e){return e()})),lg={block:"nearest",inline:"nearest"},cg={dataset:1,filter:1},ug=function(e){$()(n,e);var t=og(n);function n(){return D()(this,n),t.apply(this,arguments)}return M()(n,[{key:"finishConfigure",value:function(e){var t=this;se()(J()(n.prototype),"finishConfigure",this).call(this,e),t.scrollManager=new Qf({grid:t,verticalElement:t.scrollable.element}),Fe.on({locale:"onBeforeLocaleChange",prio:1,thisObj:t}),Fe.on({locale:"onLocaleChange",prio:-1,thisObj:t}),Gr.on({theme:"onThemeChange",thisObj:t}),t.on({subGridExpand:"onSubGridExpand",prio:-1,thisObj:t}),t.bufferedFixElementHeights=t.buffer("fixElementHeights",350,t),t.setGridClassList(t.element.classList)}},{key:"onSubGridExpand",value:function(){this.renderContents()}},{key:"onBeforeLocaleChange",value:function(){this._suspendRenderContentsOnColumnsChanged=!0}},{key:"onLocaleChange",value:function(){this._suspendRenderContentsOnColumnsChanged=!1,this.isPainted&&this.renderContents()}},{key:"finalizeInit",value:function(){se()(J()(n.prototype),"finalizeInit",this).call(this),this.store.isLoading&&this.onStoreBeforeRequest()}},{key:"doDestroy",value:function(){for(var e=this,t=0,r=Object.values(e.features);t<r.length;t++){var i=r[t];i.destroy&&i.destroy()}e.columns&&(e.columns=null),e.store&&(e.store=null),se()(J()(n.prototype),"doDestroy",this).call(this)}},{key:"setGridClassList",value:function(e){var t=this;for(var n in e.add("b-grid-".concat(t.positionMode)),t.enableTextSelection||e.add("b-grid-notextselection"),t.autoHeight&&e.add("b-autoheight"),t.readOnly&&e.add("b-readonly"),t.fillLastColumn&&e.add("b-fill-last-column"),t.showDirty&&e.add("b-show-dirty"),t.features){var r=t.features[n],i=void 0;(i=Object.prototype.hasOwnProperty.call(r.constructor,"featureClass")?r.constructor.featureClass:"b-".concat(r instanceof G?r.$name:r.constructor.name))&&e.add(i.toLowerCase())}}},{key:"template",value:function(e){var t=Re.isFirefox?"height:".concat(on.scrollBarWidth,"px"):"";return Ii.tpl(ig(),this.hideHeaders?"b-hidden":"",on.scrollBarWidth?"":"b-overlay-scrollbar",t)}},{key:"onColumnsChanged",value:function(e){var t=e.action,n=e.changes,r=e.record,i=this;if(i.isPainted){if("update"===t){if("width"in n||"minWidth"in n||"flex"in n){if(i.isPainted){var o=r.region;i.columns.visibleColumns.forEach((function(e){e.region===o&&e.repaintOnResize&&i.refreshColumn(e)}))}return}if("hidden"in n){var a=i.getSubGridFromColumn(r.id);a.header.fixHeaderWidths(),a.footer&&a.footer.fixFooterWidths(),a.updateHasFlex()}}("dataset"===t||n&&"region"in n&&!i.regions.includes(n.region.value))&&(i.initSubGrids(),i.eachSubGrid((function(e){e.render(i.verticalScroller),e.initScroll()}))),i._suspendRenderContentsOnColumnsChanged||i.renderContents()}}},{key:"onColumnsResized",value:function(e){var t=e.changes,n=e.record,r=this,i=t.width&&null==n.flex,o=t.minWidth&&null==n.flex,a=t.flex&&null==n.width,s=on.setLength(n.width),l=on.setLength(n.minWidth),c=r.getSubGridFromColumn(n.id);c.header.fixHeaderWidths(),c.footer&&c.footer.fixFooterWidths(),c.updateHasFlex(),r.cellEls&&n===r.lastColumnResized||(r.cellEls=on.children(r.element,".b-grid-cell[data-column-id=".concat(n.id,"]")),r.lastColumnResized=n);var u,d=ng(r.cellEls);try{for(d.s();!(u=d.n()).done;){var f=u.value;i?(f.style.width=s,f.style.flex="",Re.isIE11&&(f.style.minWidth=s)):o?f.style.minWidth=l:a?(f.style.flex=n.flex,f.style.width=""):f.style.flex=f.style.width=f.style.minWidth=""}}catch(e){d.e(e)}finally{d.f()}r.dragResizing||r.afterColumnsResized()}},{key:"afterColumnsResized",value:function(){var e=this;e.refreshVirtualScrollbars(),e.eachSubGrid((function(e){e.collapsed||(e.fixWidths(),e.fixRowWidthsInSafariEdge(),e.refreshFakeScroll())})),e.onHeightChange(),e.lastColumnResized=e.cellEls=null}},{key:"processCellEditor",value:function(e){}},{key:"bindStore",value:function(e){var t=this;e&&e.on({name:"store",refresh:t.onStoreDataChange,update:t.onStoreUpdateRecord,add:t.onStoreAdd,remove:t.onStoreRemove,move:t.onStoreMove,replace:t.onStoreReplace,removeall:t.onStoreRemoveAll,beforerequest:t.onStoreBeforeRequest,afterrequest:t.onStoreAfterRequest,clearchanges:t.onStoreDataChange,exception:t.onStoreException,commit:t.onStoreCommit,thisObj:t})}},{key:"onStoreUpdateRecord",value:function(e){var t=e.source,n=e.record,r=e.changes,i=this;if(i.forceFullRefresh)i.rowManager.refresh(),i.forceFullRefresh=!1;else{var o;if(n.isFieldModified("id")&&(o=i.getRowFor(n.meta.modified.id)),!(o=o||i.getRowFor(n)))return;if(i.fullRowRefresh||n.meta.specialRow){var a=t.indexOf(n);-1!==a&&o.render(a,n)}else i.columns.visibleColumns.forEach((function(e){var t=e.field;if(!(e.constructor.simpleRenderer&&!Object.prototype.hasOwnProperty.call(e.data,"renderer"))||r[t]){var i=o.getCell(t);i&&o.renderCell(i,n)}}))}}},{key:"refreshFromRowOnStoreAdd",value:function(e){var t=this.rowManager;t.renderFromRow(e),t.trigger("changeTotalHeight",{totalHeight:t.totalHeight}),1===this.store.count&&this.callEachSubGrid("refreshFakeScroll")}},{key:"onStoreAdd",value:function(e){var t=e.source,n=e.records,r=e.index,i=e.oldIndex,o=e.isChild,a=e.oldParent,s=e.isMove,l=e.isExpandAll;if(this.isPainted&&!l&&(!o||n[0].ancestorsExpanded(t))){this.rowManager.calculateRowCount(!1,!0,!0);var c=this,u=c.rowManager,d=u.topIndex,f=u.rows,h=u.rowCount,g=u.topIndex+u.rowCount-1,v=r,p=r+n.length-1,y=g>=t.count-n.length-1;a||i>-1||o&&s?u.refresh():v>=d&&v<d+h?c.refreshFromRowOnStoreAdd.apply(c,[f[v-d]].concat(Array.prototype.slice.call(arguments))):p>=d&&p<d+h?u.refresh():(y&&r>g&&u.fillBelow(c._scrollTop),u.trigger("changeTotalHeight",{totalHeight:u.totalHeight}))}}},{key:"onStoreException",value:function(e){var t=e.action,n=e.type,r=e.response,i=e.exceptionType,o=e.error,a=this;if(a.activeMask){var s;switch(n){case"server":s=r.message||a.L("unspecifiedFailure");break;case"exception":s="network"===i?a.L("networkFailure"):o&&o.message||a.L("parseFailure");break;default:s=r.status&&r.statusText?"".concat(r.status," - ").concat(r.statusText):a.L("unknownFailure")}a.activeMask.icon=a.loadMaskErrorIcon,a.activeMask.text='<div class="b-grid-load-failure">\n                <div class="b-grid-load-fail">'.concat("read"===t?a.L("loadFailedMessage"):a.L("syncFailedMessage"),"</div>\n                ").concat(r&&r.url?'<div class="b-grid-load-fail">'.concat(r.url,"</div>"):"","\n                ").concat(s?'<div class="b-grid-load-fail">'.concat(s,"</div>"):"","\n            </div>"),a.loadmaskHideTimer=a.setTimeout((function(){a.unmaskBody()}),a.loadMaskHideTimeout)}}},{key:"onStoreDataChange",value:function(e){var t=e.action,r=e.changes,i=e.source;se()(J()(n.prototype),"onStoreDataChange",this)&&se()(J()(n.prototype),"onStoreDataChange",this).apply(this,arguments);var o=this,a=i.isGrouped&&r&&i.groupers.some((function(e){return e.field in r}));"dataset"===t&&o.rowManager.resetAverageRowHeight(!0),o.isPainted&&!a&&o.renderRows(null,cg[t]),o.toggleEmptyText()}},{key:"onStoreBeforeRequest",value:function(){this.loadMask&&this.maskBody(this.loadMask)}},{key:"onStoreAfterRequest",value:function(){this.activeMask&&!this.loadmaskHideTimer&&(this.unmaskBody(),this.toggleEmptyText())}},{key:"onStoreRemove",value:function(e){var t=e.records,r=e.isCollapse,i=e.isChild,o=e.isMove,a=e.isCollapseAll;if(this.isPainted&&!o&&!a){se()(J()(n.prototype),"onStoreRemove",this)&&se()(J()(n.prototype),"onStoreRemove",this).apply(this,arguments);var s=Math.pow(2,53)-1,l=this,c=l.rowManager,u=t.reduce((function(e,t){var n=c.getRowById(t.id);return n&&(e.push(n),s=Math.min(s,c.rows.indexOf(n))),e}),[]);if(c.invalidateKnownHeight(t),l.animateRemovingRows&&u.length&&!r&&!i){var d=u[0];l.isAnimating=!0,Kn.onTransitionEnd({element:d._elementsArray[0],property:"left",timeout:l.transitionDurationTimeout,thisObj:l,handler:function(){l.isAnimating=!1,u.forEach((function(e){return!e.isDestroyed&&e.removeCls("b-removing")})),c.refresh(),l.trigger("rowRemove")}}),u.forEach((function(e){return e.addCls("b-removing")}))}else c.calculateRowCount(!1,!0,!0),c.rows[s]?c.renderFromRow(c.rows[s]):c.trigger("changeTotalHeight",{totalHeight:c.totalHeight}),l.trigger("rowRemove",{isCollapse:r})}}},{key:"onStoreMove",value:function(e){var t=e.from,n=e.to,r=this.rowManager,i=r.topIndex,o=r.rowCount,a=[t,n].sort(),s=te()(a,2),l=s[0],c=s[1];l>=i&&l<i+o?r.renderFromRow(r.rows[l-i]):c>=i&&c<i+o&&r.refresh()}},{key:"onStoreReplace",value:function(e){var t=this,n=e.records,r=e.all,i=this.rowManager;if(r)i.clearKnownHeights(),i.refresh();else{var o=n.reduce((function(e,n){var r=te()(n,2)[1],i=t.getRowFor(r);return i&&e.push(i),e}),[]);i.invalidateKnownHeight(n),i.renderRows(o)}}},{key:"onStoreRemoveAll",value:function(){se()(J()(n.prototype),"onStoreRemoveAll",this)&&se()(J()(n.prototype),"onStoreRemoveAll",this).apply(this,arguments),this.isPainted&&(this.rowManager.clearKnownHeights(),this.renderRows(),this.toggleEmptyText())}},{key:"onStoreCommit",value:function(e){var t=this,n=e.changes;if(this.showDirty&&n.modified.length){var r=[];n.modified.forEach((function(e){var n=t.rowManager.getRowFor(e);n&&r.push(n)})),this.rowManager.renderRows(r)}}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.subGrids,i=n.regions,o=!0;Object.entries(r).forEach((function(a){var s=te()(a,2),l=s[0],c=s[1];if(!c.sealedColumns&&e.draggable&&l!==e.region&&(!e.parent&&r[e.region].columns.count>1||e.parent&&e.parent.children.length>1)){var u=c.element.compareDocumentPosition(r[e.region].element)===document.DOCUMENT_POSITION_PRECEDING,d=i.length>2?n.L("Move column to ")+l:n.L(u?"moveColumnRight":"moveColumnLeft");t.push({targetSubGrid:l,text:d,icon:"b-fw-icon "+(u?"b-icon-column-move-right":"b-icon-column-move-left"),name:"moveColumn",cls:o?"b-separator":"",onItem:function(e){var t=e.item,i=t.column;i.traverse((function(e){return e.region=l})),n.columns.insert(n.columns.indexOf(r[t.targetSubGrid].columns.last)+1,i),n.scrollColumnIntoView(i)}}),o=!1}}))}},{key:"getCellMenuItems",value:function(e,t,n){var r=this;r.showRemoveRowInContextMenu&&!r.readOnly&&t&&!t.meta.specialRow&&(r.selectedRecords.length>1?n.push({text:r.L("removeRows"),icon:"b-fw-icon b-icon-trash",name:"removeRows",onItem:function(){return r.store.remove(r.selectedRecords)}}):n.push({text:r.L("removeRow"),icon:"b-fw-icon b-icon-trash",name:"removeRow",onItem:function(){return r.store.remove(t)}}))}},{key:"getColumnDragToolbarItems",value:function(e,t){return t}},{key:"normalizeCellContext",value:function(e){var t=this.columns,n=this.store;if(e instanceof n.modelClass)return{record:e,id:e.id,columnId:t.bottomColumns[0].id};if(!("columnId"in e)){if("field"in e){var r=t.get(e.field);e.columnId=r&&r.id}else if("column"in e){var i="number"==typeof e.column?t.bottomColumns[e.column]:e.column;e.columnId=i&&i.id}"columnId"in e||(e.columnId=t.bottomColumns[0].id)}if("id"in e){if(e.element&&!n.getById(e.id)){var o=this.getRecordFromElement(e.element);o&&(e.id=o.id)}}else"row"in e?e.id=n.getAt(e.row).id:"record"in e&&(e.id=e.record.id);return e}},{key:"getCell",value:function(e){var t,n=null;return"id"in(e=this.normalizeCellContext(e))&&(t=this.getRowById(e.id)),t&&"columnId"in e&&(n=t.getCell(e.columnId)),n}},{key:"getHeaderElement",value:function(e){return"string"!=typeof e&&(e=e.id),this.fromCache('.b-grid-header[data-column-id="'.concat(e,'"]'))}},{key:"getHeaderElementByField",value:function(e){var t=this.columns.get(e);return t?this.getHeaderElement(t):null}},{key:"getRecordFromElement",value:function(e){var t=e.closest(".b-grid-row");return t?this.store.getAt(t.dataset.index):null}},{key:"getColumnFromElement",value:function(e){var t=on.up(e,".b-grid-cell, .b-grid-header");if(!t)return null;if(t.matches(".b-grid-header"))return this.columns.getById(t.dataset.columnId);var n=Ms.get(t);return this.columns.getById(n.columnId)}},{key:"fixSizes",value:function(){this.callEachSubGrid("fixWidths")}},{key:"onRowManagerChangeTotalHeight",value:function(e){var t=e.totalHeight;return this.refreshTotalHeight(t)}},{key:"refreshTotalHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rowManager.totalHeight,t=this;if(t.renderingRows||!t.isVisible)return!1;t.rowManager.bottomRow&&(e=Math.max(e,t.rowManager.bottomRow.bottom));var n=t.scrollable,r=Math.abs(t.virtualScrollHeight-e),i=t._bodyRectangle.height,o=e-i;if(r){var a=o-t._scrollTop<2*i||t._verticalScrollHeight&&t._verticalScrollHeight-i<t._scrollTop;n.scrollHeight=t.virtualScrollHeight=e,t.scrolling&&!a||r<100?t.bufferedFixElementHeights():(t.virtualScrollHeightDirty&&t.virtualScrollHeightDirty(),t.bufferedFixElementHeights.cancel(),t.fixElementHeights())}}},{key:"fixElementHeights",value:function(){var e=this,t=e.virtualScrollHeight,n="".concat(t,"px");e._verticalScrollHeight=t,e.verticalScroller.style.height=n,e.virtualScrollHeightDirty=!1,e.autoHeight&&(e.bodyContainer.style.height=n,e._bodyHeight=t,e._bodyRectangle=In.client(e.bodyContainer)),e.refreshVirtualScrollbars()}},{key:"enableScrollingCloseToEdges",value:function(e){"string"==typeof e&&(e=this.subGrids[e]),this.scrollManager.startMonitoring({element:e.element})}},{key:"disableScrollingCloseToEdges",value:function(e){"string"==typeof e&&(e=this.subGrids[e]),this.scrollManager.stopMonitoring(e.element)}},{key:"onRowManagerRequestScrollChange",value:function(e){var t=e.bottom;this.scrollable.y=t-this.bodyHeight}},{key:"initScroll",value:function(){var e=this;if(!e.scrollInitialized){var t,n=e.createOnFrame((function(){(t=e.scrollable.y)!==e._scrollTop&&(e._scrollTop=t,e.scrolling||(e.scrolling=!0,e.eachSubGrid((function(e){return e.suspendResizeMonitor=!0}))),e.rowManager.updateRenderedRows(t),e.trigger("scroll",{scrollTop:t}))}));e.scrollInitialized=!0,e.scrollable.on({scroll:n,scrollend:function(){e.scrolling=!1,e.eachSubGrid((function(e){return e.suspendResizeMonitor=!1}))}}),e.callEachSubGrid("initScroll")}}},{key:"scrollRowIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lg,n=this,r=t.block||"nearest",i=n.rowManager;if(e=n.store.getById(e)){if(-1===n.store.indexOf(e))return sg;var o=n.scrollable,a=n.getRecordCoords(e),s=In.from(o.element);if(a.virtual){var l=a.block;if(o.scrollIntoView(a,{block:"center"}),i.scrollTargetRecordId=e,i.updateRenderedRows(o.y,!0),a=n.getRecordCoords(e),i.lastScrollTop=o.y,a.virtual)return sg;var c="nearest"!==r?t:{block:l};if(t.animate){o.suspendEvents(),"end"===r||"nearest"===r&&"end"===l?o.y-=s.bottom-a.bottom:("start"===r||"nearest"===r&&"start"===l)&&(o.y+=a.y-s.y),i.updateRenderedRows(o.y,!1,!0),"end"===l?o.y-=i.appendRowBuffer*i.rowHeight-1:o.y+=i.prependRowBuffer*i.rowHeight-1;var u=o.scrollIntoView(n.getRecordCoords(e),Object.assign({},t,c));return u.then((function(){return o.resumeEvents()}))}return n.scrollRowIntoView(e,Object.assign({},t,c))}var d=t.column;if(d){if("string"==typeof d&&(d=n.columns.getById(d)||n.columns.get(d)),d){o=n.getSubGridFromColumn(d).scrollable;var f=In.from(i.getRowFor(e).getCell(d.id));a.x=f.x,a.width=f.width}}else t.x=!1;return o.scrollIntoView(a,t)}}},{key:"scrollColumnIntoView",value:function(e,t){return e=e instanceof Hu?e:this.columns.get(e)||this.columns.getById(e)||this.columns.getAt(e),this.getSubGridFromColumn(e).scrollColumnIntoView(e,t)}},{key:"scrollCellIntoView",value:function(e,t){return this.scrollRowIntoView(e.id,Object.assign({column:e.columnId},"boolean"==typeof t?{animate:t}:t))}},{key:"scrollToBottom",value:function(e){return this.scrollRowIntoView(this.store.last,e)}},{key:"scrollToTop",value:function(e){return this.scrollable.scrollBy(0,-this.scrollable.y,e)}},{key:"storeScroll",value:function(){var e=this.storedScrollState={scrollTop:this.scrollable.y,scrollLeft:{}};return this.eachSubGrid((function(t){e.scrollLeft[t.region]=t.scrollable.x})),e}},{key:"restoreScroll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.storedScrollState,t=this;t.eachSubGrid((function(t){t.scrollable.x=e.scrollLeft[t.region]})),t.scrollable.y=e.scrollTop}},{key:"measureRowHeight",value:function(){var e=this,t=on.createElement({tag:"div",className:"b-grid "+(e.features.stripe?"b-stripe":""),style:"position: absolute; visibility: hidden",html:'<div class="b-grid-subgrid"><div class="b-grid-row"></div></div>',parent:document.getElementById(e.appendTo)||document.body}),n=t.firstElementChild.firstElementChild,r=parseInt(on.getStyleValue(n,"height")),i=parseInt(on.getStyleValue(n,"border-top-width")),o=parseInt(on.getStyleValue(n,"border-bottom-width"));null!=e.rowHeight&&e.rowHeight!==e._rowHeightFromStyle||(e.rowHeight=!isNaN(r)&&r?r:e.defaultRowHeight,e._rowHeightFromStyle=e.rowHeight),e._rowBorderHeight=i+o,e._isRowMeasured=!0,t.remove()}},{key:"onThemeChange",value:function(e){var t=e.theme;this.measureRowHeight(),this.trigger("theme",{theme:t})}},{key:"refreshRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.element.classList.add("b-notransition"),e?this.rowManager.returnToTop():this.rowManager.refresh(),this.element.classList.remove("b-notransition")}},{key:"refreshColumn",value:function(e){var t=e.field;this.rowManager.forEach((function(e){var n=e.getCell(t);e.renderCell(n)}))}},{key:"refreshVirtualScrollbars",value:function(){var e=this,t=e.headerContainer,n=e.footerContainer,r=e.virtualScrollers,i=e.scrollable,o=Re.isEdge||Re.isIE11?Math.abs(i.scrollHeight-i.clientHeight)>1:i.scrollHeight>i.clientHeight,a=o?"add":"remove";Object.values(e.subGrids).some((function(e){return e.overflowingHorizontally}))?r.classList.remove("b-hide-display"):r.classList.add("b-hide-display"),t.classList[a]("b-grid-vertical-overflow"),n.classList[a]("b-grid-vertical-overflow"),r.classList[a]("b-grid-vertical-overflow"),e.onHeightChange(),on.scrollBarWidth&&(t.style.marginRight=n.style.paddingRight=o?"".concat(on.scrollBarWidth-1,"px"):0)}},{key:"onContentChange",value:function(){var e=this,t=e.rowManager;e.isVisible?(t.estimateTotalHeight(),e.paintListener=null,e.refreshTotalHeight(e.contentHeight),e.callEachSubGrid("refreshFakeScroll"),e.onHeightChange()):e.paintListener||(e.paintListener=e.on({paint:"onContentChange",once:!0,thisObj:e}))}},{key:"onHeightChange",value:function(){var e=this;e._bodyRectangle=In.client(e.bodyContainer),e._bodyHeight=e.autoHeight?e.contentHeight:e.bodyContainer.offsetHeight}},{key:"renderHeader",value:function(e,t){}},{key:"renderFooter",value:function(e,t){}},{key:"suspendRefresh",value:function(){this.refreshSuspended++}},{key:"resumeRefresh",value:function(e){this.refreshSuspended&&!--this.refreshSuspended&&e&&this.refreshRows()}},{key:"renderRows",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=e&&n.storeScroll();n.refreshSuspended||(n.trigger("beforeRenderRows"),n.renderingRows=!0,n.element.classList.add("b-grid-refreshing"),t&&(n.scrollable.y=n._scrollTop=0),n.rowManager.reinitialize(t),n.trigger("renderRows"),n.renderingRows=!1,n.onContentChange(),e&&n.restoreScroll(r),n.element.classList.remove("b-grid-refreshing"))}},{key:"renderContents",value:function(){var e=this,t=e.element,n=e.headerContainer,r=e.footerContainer,i=e.rowManager;if(e.emptyCache(),e.isPainted){e._headerHeight=null,e.callEachSubGrid("refreshHeader",n),e.callEachSubGrid("refreshFooter",r),e.renderHeader(n,t),e.renderFooter(r,t),e.fixSizes();var o=i.removeAllRows();i.calculateRowCount(!1,!0,!0),i.rowCount&&(i.setPosition(o),e.renderRows())}}},{key:"onPaint",value:function(){var e=this,t=e.rowManager,n=e.store,r=e.element,i=e.headerContainer,o=e.bodyContainer,a=e.footerContainer;if(!e.isPainted){var s,l=0;e.columns.on({change:function(){return s=!0},single:!0}),e._bodyRectangle=In.client(e.bodyContainer);var c=e.bodyContainer.offsetHeight;e.updateResponsive(e.width,0),s&&(e.callEachSubGrid("refreshHeader",i),e.callEachSubGrid("refreshFooter",a)),e.renderHeader(i,r),e.renderFooter(a,r),e.autoHeight?(e._bodyHeight=t.initWithHeight(r.offsetHeight-i.offsetHeight-a.offsetHeight,!0),o.style.height=e.bodyHeight+"px"):(e._bodyHeight=c,t.initWithHeight(e._bodyHeight,!0)),e.eachSubGrid((function(e){e.header.maxDepth>l&&(l=e.header.maxDepth)})),i.dataset.maxDepth=l,e.fixSizes(),!n.count&&n.isLoading||e.renderRows(!1,!1),e.initScroll(),e.initInternalEvents()}}},{key:"render",value:function(){var e=this;e.requireSize=Boolean(e.owner),se()(J()(n.prototype),"render",this).apply(this,arguments),e.autoHeight||!e.headerContainer.offsetHeight||e.bodyContainer.offsetHeight||console.warn("Grid element not sized correctly, please check your CSS styles and review how you size the widget")}},{key:"maskBody",value:function(e){var t=this;if(t.bodyContainer){t.unmaskBody();var n=(t.activeMask=Qr.mask(e,t.element)).maskElement;return n.style.marginTop="".concat(t.bodyContainer.offsetTop,"px"),n.style.height="".concat(t.virtualScrollers.offsetTop+t.virtualScrollers.offsetHeight-t.bodyContainer.offsetTop,"px"),t.activeMask}}},{key:"unmaskBody",value:function(){var e=this;e.loadmaskHideTimer&&e.clearTimeout(e.loadmaskHideTimer),e.loadmaskHideTimer=null,e.activeMask&&e.activeMask.destroy(),e.activeMask=null}},{key:"toggleEmptyText",value:function(){this.bodyContainer&&on.toggleClasses(this.bodyContainer,"b-grid-empty",!(this.rowManager.rowCount>0||this.store.isLoading||this.store.isCommitting))}},{key:"contentElement",get:function(){return this.verticalScroller}},{key:"overflowElement",get:function(){return this.bodyContainer}},{key:"focusElement",get:function(){return this.bodyContainer}},{key:"columns",set:function(e){var t,n,r=this;r._columnStore?e?r._columnStore.data=e:r._columnStore.destroy():(e instanceof zu?(e.grid||(e.grid=r),r._columnStore=e):Array.isArray(e)?r._columnStore=new zu({grid:r,data:e}):e&&(r._columnStore=new zu(Object.assign({grid:r},e))),r._columnStore.on("change",r.onColumnsChanged,r),r._columnStore.on((t=r.onColumnsResized,n=r,{update:function(e){var r=e.store,i=e.record,o=e.changes,a=!0;return("width"in o||"minWidth"in o||"flex"in o)&&(a=t.call(n,{store:r,record:i,changes:o})),a}})),Re.isTouchDevice&&(r.touch=!0,r._columnStore.forEach((function(e){var t=e.touchConfig;t&&e.applyState(t)}))))},get:function(){return this._columnStore}},{key:"rowManager",get:function(){var e=this;return e._isRowMeasured||e.measureRowHeight(),e._rowManager||(e._rowManager=new uh({grid:e,rowHeight:e.rowHeight,rowScrollMode:e.rowScrollMode||"move",autoHeight:e.autoHeight,fixedRowHeight:e.fixedRowHeight,listeners:{changetotalheight:e.onRowManagerChangeTotalHeight,requestscrollchange:e.onRowManagerRequestScrollChange,thisObj:e}}))}},{key:"store",get:function(){return this._store},set:function(e){var t=this,n=t.rowManager,r=t.initialConfig.features;if(e!==t._store)if(t.detachListeners("store"),e){if(e instanceof ga);else{var i={};t.data&&(i.data=t.data),r&&r.tree&&(i.tree=!0),e.modelClass||(i.modelClass=function(e){$()(n,e);var t=og(n);function n(){return D()(this,n),t.apply(this,arguments)}return n}(gd)),e=new(e.readUrl?ka:ga)(Object.assign(i,e))}t._store=e,t.bindStore(e),t.isPainted&&n.reinitialize()}else t.destroyStore&&t._store.destroy(),t._store=null}},{key:"data",get:function(){return this._store?this._store.records:this._data},set:function(e){this._store?this._store.data=e:this._data=e}},{key:"emptyText",get:function(){return this._emptyText},set:function(e){this._emptyText=e,this.eachSubGrid((function(t){return t.emptyText=e}))}},{key:"bodyHeight",get:function(){return this._bodyHeight}},{key:"headerHeight",get:function(){var e=this;return e.isPainted&&!e._headerHeight&&(e._headerHeight=e.headerContainer.offsetHeight),e._headerHeight}},{key:"autoHeight",get:function(){return this._autoHeight},set:function(e){mt.assertBoolean(e,"autoHeight"),this._autoHeight=e}},{key:"columnLines",get:function(){return this._columnLines},set:function(e){mt.assertBoolean(e,"columnLines"),on.toggleClasses(this.element,"b-no-column-lines",!e),this._columnLines=e}},{key:"readOnly",set:function(e){var t=this;t._readOnly=e,t.isPainted&&(t.trigger("readOnly",{readOnly:e}),e?t.element.classList.add("b-readonly"):t.element.classList.remove("b-readonly"))},get:function(){return this._readOnly}},{key:"scrolling",set:function(e){this._scrolling=e},get:function(){return this._scrolling}},{key:"contentHeight",get:function(){var e=this.rowManager;return Math.max(e.totalHeight,e.bottomRow?e.bottomRow.bottom:0)}}],[{key:"getLKey",value:function(){return"eb889f4f-9370-11ea-a249-d094663d5c88"}},{key:"$name",get:function(){return"GridBase"}},{key:"defaultConfig",get:function(){return{rowHeight:null,fixedRowHeight:null,defaultRowHeight:45,emptyText:"L{noRows}",fullRowRefresh:!0,readOnly:null,hideHeaders:null,showRemoveRowInContextMenu:!0,autoHeight:null,store:{},data:null,columns:[],defaultRegion:"normal",destroyStore:null,enableTextSelection:null,loadMask:"L{loadMask}",syncMask:"L{syncMask}",columnLines:!0,fillLastColumn:!0,resizeToFitIncludesHeader:!0,animateRemovingRows:!Re.isIE11,disableGridRowModelWarning:null,loadMaskErrorIcon:"b-icon b-icon-warning",headerClass:wh,testPerformance:!1,positionMode:"translate",rowScrollMode:"move",monitorResize:!0,features:!0,subGridConfigs:{normal:{flex:1}},scrollable:{overflowY:!0},scrollerClass:vh,showDirty:null,loadMaskHideTimeout:3e3,transitionDurationTimeout:500,refreshSuspended:0,transitionDuration:500,contextMenuTriggerEvent:"contextmenu",localizableProperties:["emptyText","loadMask","syncMask"],localeClass:"Grid"}}},{key:"properties",get:function(){return{_selectedRecords:[],_verticalScrollHeight:0,virtualScrollHeight:0,_scrollTop:null}}}]),n}(Fo(yi).mixes(vo,yo,(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Sh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"initInternalEvents",value:function(){for(var e=Object.keys(Ch),t=e.length,n={element:this.element,thisObj:this},r=0;r<t;r++)n[e[r]]="handleEvent";Kn.on(n)}},{key:"getEventData",value:function(e){var t=on.up(e.target,".b-grid-cell");if(t){var n=Ms.get(t),r=n.id,i=n.columnId,o=this.store.getById(r);return o?{cellElement:t,cellData:n,columnId:i,id:r,record:o,cellSelector:{id:r,columnId:i}}:null}}},{key:"handleEvent",value:function(e){this.disabled||(this.event=e,Ch[e.type]&&this[Ch[e.type]](e))}},{key:"onElementTouchStart",value:function(e){var t=this;on.isTouchEvent=!0,1===e.touches.length&&(t.longPressTimeout=setTimeout((function(){t.onElementLongPress(e),e.preventDefault(),t.longPressPerformed=!0}),t.longPressTime))}},{key:"onElementTouchMove",value:function(e){this.longPressTimeout&&(clearTimeout(this.longPressTimeout),this.longPressTimeout=null)}},{key:"onElementTouchEnd",value:function(e){var t=this;t.longPressPerformed&&(e.cancelable&&e.preventDefault(),t.longPressPerformed=!1),t.longPressTimeout&&(clearTimeout(t.longPressTimeout),t.longPressTimeout=null)}},{key:"onElementLongPress",value:function(e){}},{key:"triggerCellMouseEvent",value:function(e,t){var n=this.getEventData(t);if(n){var r=this.columns.getById(n.columnId);this.trigger("cell"+L.capitalizeFirstLetter(e),{grid:this,record:n.record,column:r,cellSelector:n.cellSelector,cellElement:n.cellElement,target:t.target,event:t})}}},{key:"onElementMouseDown",value:function(e){var t=this.getEventData(e);this.skipFocusSelection=!0,this.triggerCellMouseEvent("mousedown",e),t&&!e.defaultPrevented&&this.onFocusGesture(t,e)}},{key:"onElementMouseMove",value:function(e){this.mouseMoveEvent=e}},{key:"onElementMouseUp",value:function(e){}},{key:"onHandleElementClick",value:function(e){!1!==this.trigger("beforeElementClick",{event:e})&&this.onElementClick(e)}},{key:"onElementClick",value:function(e){var t=this.getEventData(e);t&&(this.triggerCellMouseEvent("click",e),Ms.get(t.cellElement).row.removeCls("b-hover"))}},{key:"onFocusGesture",value:function(e,t){e&&this.focusCell(e.cellSelector,{scroll:!1,doSelect:!0,event:t})}},{key:"onElementDblClick",value:function(e){var t=e.target;if(this.triggerCellMouseEvent("dblClick",e),t.classList.contains("b-grid-header-resize-handle")){var n=on.up(t,".b-grid-header");this.columns.getById(n.dataset.columnId).resizeToFitContent()}}},{key:"onElementMouseOver",value:function(e){if(!this.scrolling){var t=on.up(e.target,".b-grid-cell");if(t){var n=Ms.get(t).row;!n||"number"==typeof e.buttons&&0!==e.buttons||(this.hoveredRow=n),this.triggerCellMouseEvent("mouseOver",e)}this.trigger("mouseOver",{event:e})}}},{key:"onElementMouseOut",value:function(e){(this.hoveredRow=null,this.scrolling)||(on.up(e.target,".b-grid-cell")&&this.triggerCellMouseEvent("mouseOut",e),this.trigger("mouseOut",{event:e}))}},{key:"onElementKeyDown",value:function(e){var t=this;if(!e.handled)if(e.target.matches(".b-grid-header.b-depth-0"))t.handleHeaderKeyDown(e);else if(e.target===t.focusElement||Re.isIE11&&e.currentTarget===t.focusElement)t.handleViewKeyDown(e);else if("Escape"===e.key&&t.isActionableLocation){var n=mt.clone(t.focusedCell);n.element=null,t.focusCell(n),on.focusWithoutScrolling(t.element)}}},{key:"handleViewKeyDown",value:function(e){switch(e.key){case"ArrowLeft":return e.preventDefault(),this.navigateLeft(e);case"ArrowRight":return e.preventDefault(),this.navigateRight(e);case"ArrowUp":return e.preventDefault(),this.navigateUp(e);case"ArrowDown":return e.preventDefault(),this.navigateDown(e)}}},{key:"handleHeaderKeyDown",value:function(e){var t=this,n=t.columns.getById(e.target.dataset.columnId);switch(n.onKeyDown&&n.onKeyDown(e),e.key){case"ArrowLeft":var r=t.columns.getAdjacentVisibleLeafColumn(n,!1);if(r)t.getHeaderElement(r.id).focus();break;case"ArrowRight":var i=t.columns.getAdjacentVisibleLeafColumn(n,!0);if(i)t.getHeaderElement(i.id).focus();break;case"Enter":t.getHeaderElement(n.id).click()}}},{key:"onElementKeyPress",value:function(e){}},{key:"onElementKeyUp",value:function(e){}},{key:"onElementContextMenu",value:function(e){var t=this.getEventData(e);t&&(this.triggerCellMouseEvent("contextMenu",e),on.isTouchEvent&&this.onFocusGesture(t,e))}},{key:"onInternalResize",value:function(e,t,n,i,o){var a=this;a._devicePixelRatio&&a._devicePixelRatio!==window.devicePixelRatio&&on.resetScrollBarWidth(),a._devicePixelRatio=window.devicePixelRatio,a._bodyRectangle=In.client(a.bodyContainer),se()(J()(r.prototype),"onInternalResize",this).apply(this,arguments),n!==o&&(a._bodyHeight=a.bodyContainer.offsetHeight,a.isPainted&&a.rowManager.initWithHeight(a._bodyHeight)),a.refreshVirtualScrollbars(),t!==i&&a.setTimeout((function(){a.isDestroyed||a.updateResponsive(t,i)}),0)}},{key:"hoveredRow",set:function(e){var t=this;t._hoveredRow&&!t._hoveredRow.isDestroyed&&(t._hoveredRow.removeCls("b-hover"),t._hoveredRow=null),e&&!t.scrolling&&(t._hoveredRow=e,e.addCls("b-hover"))}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{longPressTime:400}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Rh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"createFeatureInitializer",value:function(e,t,n,r){var i=[this],o=n.prototype.construct;return xh[re()(r)]&&(i[1]=r),{configurable:!0,get:function(){return delete e[t],n.prototype.construct=function(){e[t]=this;for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];o.apply(this,i),n.prototype.construct=o},Ee()(n,i)}}}},{key:"hasFeature",value:function(e){return!(!this.features||!this.features[e])}},{key:"features",set:function(e){var t,n,r,i=bd.getInstanceDefaultFeatures(this);e=this._features=mt.assign({},e),i&&Object.entries(i).forEach((function(t){var n=te()(t,2),r=n[0];n[1];r in e||(e[r]=!0)}));for(var o=bd.getInstanceFeatures(this),a=0,s=Object.keys(e);a<s.length;a++)if(t=s[a],n=e[t]){if(L.lowercaseFirstLetter(t)!==t)throw new Error(this.L("invalidFeatureNameFormat",t));if(!(r=o[t]))throw new Error(this.L("featureNotFound",t));Reflect.defineProperty(e,t,this.createFeatureInitializer(e,t,r,n))}},get:function(){return this._features}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Eh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onGridElementFocus",value:function(e){var t=this,n={doSelect:!1,event:e};if(t._focusedCell)t.focusCell(t._focusedCell,n);else{var r=t.element.contains(e.relatedTarget)?null:t.lastFocusedCell;if(r){var i=t.getCell(r);if(!i||!on.isVisible(i)||!t.store.getById(r.id))return void t.revertFocus();t.returningFocus=!0,t.focusCell(r,n),t.returningFocus=!1}else if(!t.scrolling&&!t.skipFocusSelection&&t.store.first){var o=t.mouseMoveEvent,a=t.rowManager,s=t._bodyRectangle,l=o?Math.min(Math.max(o.clientY,s.y),s.bottom):s.center.y,c=a.getRowAt(l)||a.rows[Math.floor(a.rowCount/2)],u=o&&t.getEventData(o)||{id:c.id,columnId:t.columns.visibleColumns[0].id};t.getCell(u)&&t.focusCell(u,n)}}t.skipFocusSelection=!1}},{key:"onFocusOut",value:function(e){se()(J()(r.prototype),"onFocusOut",this).call(this,e),this.clearFocus()}},{key:"isFocused",value:function(e){return Boolean(this._focusedCell)&&this.isLocationEqual(e,this._focusedCell)}},{key:"focusCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dh;e=this.normalizeCellContext(e===Object?Object.assign({},e):e);var n=this,r=!1!==t.doSelect,i=t,o=i.event,a=i.scroll,s=n.lastFocusedCell=n._focusedCell,l=n.isLocationEqual(e,s),c=s&&n.getCell(s),u=n.getSubGridFromColumn(e.columnId),d=n.getCell(e);if(o&&"mousedown"===o.type)for(var f=o.target;f!==d;f=f.parentElement)if(on.isFocusable(f))return void(e.element=f);if(l)return o&&n.onCellNavigate&&n.onCellNavigate(n,null,n._focusedCell,o,r),e;c&&c.classList.remove("b-focused");var h=d||n.getCell({row:n.rowManager.topIndex,columnId:e.columnId}),g=In.from(u.element),v=In.from(n.bodyContainer),p=In.from(h).moveTo(null,g.y);return!1===a?t=Object.assign({},t,Th):(t=Object.assign({},t,a),p.width>g.width||p.height>v.height?t.x=t.y=!1:t.column=e.columnId,n.scrollRowIntoView(e.id,t)),(d=n.getCell(e))&&(e.element=d,d.classList.add("b-focused")),n._focusedCell=e,n.onCellNavigate&&n.onCellNavigate(n,s,n._focusedCell,o,r),n.trigger("navigate",{lastFocusedCell:s,focusedCell:n._focusedCell,event:o}),e}},{key:"isLocationEqual",value:function(e,t){return e&&t&&e.id===t.id&&e.columnId===t.columnId&&(!e.element||!t.element||e.element===t.element)}},{key:"blurCell",value:function(e){var t=this.getCell(e);t&&t.classList.remove("b-focused")}},{key:"clearFocus",value:function(){var e=this;e._focusedCell&&(e.lastFocusedCell=e._focusedCell,e.blurCell(e._focusedCell),e._focusedCell=null)}},{key:"internalNextPrevCell",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=this,r=n._focusedCell;return r?n.focusCell({id:r.id,columnId:n.columns.getAdjacentVisibleLeafColumn(r.columnId,e,!0).id},{doSelect:!0,event:t}):null}},{key:"navigateRight",value:function(e){return this.internalNextPrevCell(!0,e)}},{key:"navigateLeft",value:function(e){return this.internalNextPrevCell(!1,e)}},{key:"internalNextPrevRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this,i=r._focusedCell;if(!i)return!1;var o=r.store["get".concat(e?"Next":"Prev")](i.id,!1,t);return!!o&&r.focusCell({id:o.id,columnId:i.columnId,scroll:{x:!1}},{doSelect:!0,event:n})}},{key:"navigateDown",value:function(e){return this.internalNextPrevRow(!0,!1,e)}},{key:"navigateUp",value:function(e){return this.internalNextPrevRow(!1,!1,e)}},{key:"focusedCell",get:function(){var e=this._focusedCell;if(e&&this.getCell(e))return e;this.clearFocus()},set:function(e){this.focusCell(e,{doSelect:!1})}},{key:"isActionableLocation",get:function(){var e=this._focusedCell;return Boolean(e&&e.element&&this.getCell(e).contains(e.element))}},{key:"focusedRecord",get:function(){if(this._focusedCell)return this.store.getById(this._focusedCell.id)}},{key:"cellCSSSelector",get:function(){var e=this._focusedCell,t=e&&this.getRowById(e.id);return e&&t?"[data-index=".concat(t.index,"] [data-column-id=").concat(e.columnId,"]"):""}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Mh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getClosestBiggerLevel",value:function(e){var t=this,n=Object.keys(t.responsiveLevels),r=null,i=99995,o=null;return n.forEach((function(n){var a=t.responsiveLevels[n];if(["number","string"].includes(re()(a))||(a=a.levelWidth),"*"===a)o=n;else if(e<a){var s=a-e;s<i&&(i=s,r=n)}})),r||o}},{key:"updateResponsive",value:function(e,t){var n=this,r=n.getClosestBiggerLevel(t),i=n.getClosestBiggerLevel(e);if(r!==i){var o=n.responsiveLevels[i];["number","string"].includes(re()(o))||n.applyState(o),n.columns.forEach((function(e){var t=e.responsiveLevels;t&&(t[i]?e.applyState(t[i]):t["*"]&&e.applyState(t["*"]))})),n.element.classList.remove("b-responsive-"+r),n.element.classList.add("b-responsive-"+i),n.trigger("responsive",{level:i,width:e,oldLevel:r,oldWidth:t})}}},{key:"responsiveLevel",get:function(){return this.getClosestBiggerLevel(this.width)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{responsiveLevels:Object.freeze({small:400,medium:600,large:"*"})}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Fh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"afterConfigure",value:function(){var e=this;if(e.selectionMode.checkbox){var t=zu.getColumnClass("check");if(!t)throw new Error("CheckColumn must be imported for checkbox selection mode to work");var n=e.checkboxColumn=new t({id:"".concat(e.id,"-selection-column"),width:"4em",minWidth:"4em",field:null,cellCls:"b-checkbox-selection",region:Object.keys(e.subGridConfigs).sort()[0],showCheckAll:e.selectionMode.showCheckAll},e.columns);n.meta.depth=0,n._grid=e;var i=n.renderer;n.renderer=function(t){t.value=e.isSelected(t.record),i.call(n,t)},n.on({toggle:"onCheckChange",toggleAll:"onCheckAllChange",thisObj:e});var o=e.columns.indexOf(e.columns.findRecord("type","rownumber"))+1;e.columns.insert(o,n)}se()(J()(r.prototype),"afterConfigure",this).call(this),e.store.on("idChange",e.onRecordIdChange,e)}},{key:"onRecordIdChange",value:function(e){var t=e.record,n=e.oldValue,r=(e.value,this.selectedRecordCollection);r.get(n)===t&&r.rebuildIndices()}},{key:"onSelectedRecordCollectionChange",value:function(e){e.source,e.action;var t=e.added,n=void 0===t?[]:t,r=e.removed,i=this;i._selectedCell&&!i.isSelectable(i._selectedCell)&&i.deselectCell(i._selectedCell),n=n.filter((function(e){return i.isSelectable(e)})),i.triggerChangeEvent({mode:"row",action:n.length?"select":"deselect",selection:i.selectedRecords,selected:n,deselected:r},i.silent)}},{key:"onCheckChange",value:function(e){var t=e.source,n=e.checked,r=e.record;n?(this.selectRow({record:r,column:t,addToSelection:!1!==this.selectionMode.multiSelect,scrollIntoView:!1}),t.headerCheckbox&&this.selectedRecords.length===this.store.count-(this.store.groupRecords?this.store.groupRecords.length:0)&&(t.suspendEvents(),t.headerCheckbox.checked=!0,t.resumeEvents())):(this.deselectRow(r),t.headerCheckbox&&(t.suspendEvents(),t.headerCheckbox.checked=!1,t.resumeEvents()))}},{key:"onCheckAllChange",value:function(e){this[e.checked?"selectAll":"deselectAll"]()}},{key:"onElementKeyDown",value:function(e){var t=this.focusedCell,n=this.checkboxColumn;if(se()(J()(r.prototype),"onElementKeyDown",this).call(this,e),t&&" "===e.key&&n&&this.columns.getById(t.columnId)===n){var i=this.getCell(t).widget;i&&i.toggle()}}},{key:"spliceSelectedRecords",value:function(e,t,n){this._selectedRecordCollection.splice(e,t,n)}},{key:"isSelected",value:function(e){return e instanceof Io&&(e=e.id),Oh[re()(e)]?this.selectedRecordCollection.includes(e):this._selectedCell&&this._selectedCell.id==e.id&&this._selectedCell.columnId===e.columnId}},{key:"isSelectable",value:function(e){if(!e)return!1;var t=this.store.getById(e.id||e);return t&&!(t.meta&&t.meta.specialRow)}},{key:"selectRow",value:function(e){var t=e.record,n=e.column,r=void 0===n?this.columns.bottomColumns[0]:n,i=e.scrollIntoView,o=void 0===i||i,a=e.addToSelection,s=void 0!==a&&a;if("object"!==re()(arguments[0])){var l=arguments;t=l[0],o=!(l.length>1)||l[1],s=l[2]||!1}var c=this,u=c.store.getById(t);t?c.selectCell({id:u.id,column:r},o,s):c.deselectAll()}},{key:"selectCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=i.selectedRecordCollection,a=i.selectionMode,s=i.normalizeCellContext(e),l=s.record||i.store.getById(s.id);if(i.isSelectable(l)){if(t&&i.scrollRowIntoView(s.id,{column:s.columnId}),a.row&&(r&&(i.silent=(i.silent||0)+1),n?o.add(l):o.splice(0,o.count,l),r&&i.silent--,1===i.selectedRecordCollection.count&&(i.startCell=s,i.lastRange=null)),a.cell&&(s.columnId||s.column)&&!i.isSelected(s)){var c=i._selectedCell?[i._selectedCell]:[];i._selectedCell=s,i.triggerChangeEvent({mode:"cell",action:"select",selected:[s],deselected:c,selection:[s]},r)}return s}this.deselectAll()}},{key:"selectAll",value:function(){var e,t=this;t.store.isFiltered?(e=t.selectedRecordCollection).add.apply(e,Z()(t.store.records.filter((function(e){return!e.meta.specialRow})))):t.selectedRecords=t.store.records.filter((function(e){return!e.meta.specialRow}))}},{key:"deselectAll",value:function(){var e,t=this;t.store.isFiltered?(e=t.selectedRecordCollection).remove.apply(e,Z()(t.store.records.filter((function(e){return!e.meta.specialRow})))):t.selectedRecordCollection.clear();t._selectedCell&&t.deselectCell(t._selectedCell)}},{key:"deselectRow",value:function(e){var t=e instanceof Io?e:this.store.getById(e);t&&this.selectedRecordCollection.remove(t)}},{key:"deselectCell",value:function(e){var t=this,n=t.normalizeCellContext(e),r=t.selectionMode,i=n.record||t.store.getById(n.id),o=t._selectedCell;return r.row&&t.selectedRecordCollection.remove(i),r.cell&&n.columnId&&o&&o.id===n.id&&o.columnId===n.columnId&&(t._selectedCell=null,t.triggerChangeEvent({mode:"cell",action:"deselect",selected:[],deselected:[n],selection:[]})),n}},{key:"selectRange",value:function(e,t){var n=this.store,r=this.selectedRecordCollection,i=n.indexOf(e),o=n.indexOf(t),a=Math.min(i,o),s=Math.max(i,o);if(-1===a||-1===s)throw new Error("Record not found in selectRange");r.splice(0,r.count,n.getRange(a,s+1,!1))}},{key:"onStoreRemove",value:function(e){se()(J()(r.prototype),"onStoreRemove",this)&&se()(J()(r.prototype),"onStoreRemove",this).call(this,e),this.selectedRecordCollection.remove(e.records)}},{key:"onStoreDataChange",value:function(e){var t=e.action,n=e.source;if(se()(J()(r.prototype),"onStoreDataChange",this)&&se()(J()(r.prototype),"onStoreDataChange",this).apply(this,arguments),_h[t]){var i=this.selectedRecordCollection,o=[];i.forEach((function(e){n.includes(e)?i.splice(i.indexOf(e),1,n.getById(e.id)):o.push(e)})),i.remove(o)}}},{key:"onStoreRemoveAll",value:function(){se()(J()(r.prototype),"onStoreRemoveAll",this)&&se()(J()(r.prototype),"onStoreRemoveAll",this).call(this),this.deselectAll()}},{key:"handleMouseMultiSelect",value:function(e,t){var n=this,r=e.id;(t.metaKey||t.ctrlKey)&&n.isSelected(r)?n.deselectRow(r):n.selectionMode.multiSelect&&(t.shiftKey&&n.startCell?function(e,t){var r=n.store,i=n.selectedRecordCollection,o=r.indexOf(e),a=r.indexOf(t),s=Math.min(o,a),l=Math.max(o,a);if(-1===s||-1===l)throw new Error("Record not found in selectRange");var c=r.getRange(s,l+1,!1).filter((function(e){return n.isSelectable(e)}));i.splice(0,n.lastRange||0,c),n.lastRange=c}(n.startCell.id,r):(t.ctrlKey||t.metaKey)&&n.selectRow({record:r,scrollIntoView:!1,addToSelection:!0}))}},{key:"onCellNavigate",value:function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(e.columns.getById(n.columnId)!==e.checkboxColumn&&!e.selectionMode.rowCheckboxSelection&&!(!i||e.returningFocus||r&&r.target.closest(".b-tree-expander"))){var o=t&&n.id===t.id,a=r&&"mousedown"===r.type,s=a&&r.ctrlKey;!r||r.button&&2!==r.button||!r.shiftKey&&!s?e.selectCell(n,!1,o&&(!r||r.shiftKey||r.ctrlKey)||r&&(s||2===r.button&&e.isSelected(n.id))):e.handleMouseMultiSelect(n,r),e.startCell&&!s||(e.startCell=n,e.lastRange=null)}}},{key:"triggerChangeEvent",value:function(e,t){var n,r,i,o,a=this,s=e.mode,l=e.selected,c=e.deselected;if("row"===s){for(n=0,r=l.length;n<r;n++)(i=a.getRowFor(l[n]))&&(i.addCls("b-selected"),!a.checkboxColumn||a.checkboxColumn.hidden||l[n].meta.specialRow||(i.getCell(a.checkboxColumn.id).widget.checked=!0));for(n=0,r=c.length;n<r;n++)(i=a.getRowFor(c[n]))&&(i.removeCls("b-selected"),!a.checkboxColumn||a.checkboxColumn.hidden||c[n].meta.specialRow||(i.getCell(a.checkboxColumn.id).widget.checked=!1))}else if("cell"===s){for(n=0,r=l.length;n<r;n++)(o=a.getCell(l[n]))&&o.classList.add("b-selected");for(n=0,r=c.length;n<r;n++)(o=a.getCell(c[n]))&&o.classList.remove("b-selected")}t||a.trigger("selectionChange",e)}},{key:"selectedRecordCollection",set:function(e){e instanceof Sr||(e=new Sr(e)),this._selectedRecordCollection=e,e.on({change:"onSelectedRecordCollectionChange",thisObj:this})},get:function(){return this._selectedRecordCollection}},{key:"selectedCell",get:function(){return this._selectedCell},set:function(e){this.selectCell(e)}},{key:"selectionMode",set:function(e){e&&e.rowCheckboxSelection&&(e.row=e.checkbox=!0,e.cell=!1),this._selectionMode=e},get:function(){return this._selectionMode}},{key:"selectedRecord",get:function(){return this.selectedRecordCollection.last||null},set:function(e){this.selectRow({record:e})}},{key:"selectedRecords",get:function(){return this.selectedRecordCollection.values},set:function(e){var t=this.selectedRecordCollection,n=this.store,r=[];if(e){var i,o=Ah(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;(a=n.getById(a))&&r.push(a)}}catch(e){o.e(e)}finally{o.f()}}t.splice(0,t.count,r)}},{key:"selectedCellCSSSelector",get:function(){var e=this._selectedCell,t=e&&this.getRowById(e.id);return e&&t?"[data-index=".concat(t.dataIndex,"] [data-column-id=").concat(e.columnId,"]"):""}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{selectionMode:{row:!0,cell:!0,rowCheckboxSelection:!1,multiSelect:!0,checkbox:!1,showCheckAll:!1},selectedRecordCollection:{}}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ph()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getState",value:function(){var e=this,t=e.element.style.cssText,n={rowHeight:e.rowHeight,readOnly:e.readOnly};if(t&&(n.style=t),e.selectedCell){var r=e.selectedCell,i=r.id,o=r.columnId;n.selectedCell={id:i,columnId:o}}return n.selectedRecords=e.selectedRecords.map((function(e){return e.id})),n.columns=e.columns.map((function(e){return e.getState()})),n.store=e.store.state,n.scroll=e.storeScroll(),n.width={},n.collapsed={},e.eachSubGrid((function(e){null==e.flex&&(n.width[e.region]=e.width),n.collapsed[e.region]=e.collapsed})),n}},{key:"applyState",value:function(e){var t=this;if("readOnly"in e&&(t.readOnly=e.readOnly),"rowHeight"in e&&(t.rowHeight=e.rowHeight),"style"in e&&(t.style=e.style),"selectedCell"in e&&(t.selectedCell=e.selectedCell),"store"in e&&(t.store.state=e.store),"selectedRecords"in e&&(t.selectedRecords=e.selectedRecords),"columns"in e){var n=!1,r=!1;t.columns.suspendEvents(),t.eachSubGrid(Lh),e.columns.forEach((function(e,i){var o=t.columns.getById(e.id);if(o){var a=o.generation;o.applyState(e),n=n||o.generation!==a,o.stateSortIndex=i,o.allIndex!==i&&(r=n=!0)}})),n&&t.eachSubGrid(jh),r&&(t.eachSubGrid((function(e){e.columns.records.sort(Bh),e.columns.allRecords.sort(Bh)})),t.columns.sort({fn:Bh,ascending:!0})),t.isPainted&&n&&t.renderContents(),t.columns.resumeEvents(),t.eachSubGrid(Hh)}"width"in e&&t.eachSubGrid((function(t){t.region in e.width&&(t.width=e.width[t.region])})),"collapsed"in e&&t.eachSubGrid((function(t){t.collapsed=e.collapsed[t.region]})),"scroll"in e&&t.restoreScroll(e.scroll)}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Qh()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"initSubGrids",value:function(){var e,t,n,r,i=this,o=i._regions,a=new Set,s=!0,l=Kh(i.columns.records);try{for(l.s();!(r=l.n()).done;){var c=r.value;c.region&&!i.subGridConfigs[c.region]&&(i.subGridConfigs[c.region]={}),a.add(c.region)}}catch(e){l.e(e)}finally{l.f()}o&&o.forEach((function(e){return i.subGrids[e].destroy()})),i.subGrids={},i._regions=Array.from(a),i._regions.sort(),i.subGridConfigs.normal&&0===Object.keys(i.subGridConfigs.normal).length&&(i.subGridConfigs.normal=ug.defaultConfig.subGridConfigs.normal);var u,d=Kh(i._regions);try{var f=function(){var r=u.value;n=i.columns.makeChained((function(e){return e.region===r}),["region"]),t=mt.assign({parent:i,grid:i,store:i.store,rowManager:i.rowManager,region:r,headerClass:i.subGridConfigs[r].headerClass||i.headerClass,columns:n,hideHeaders:i.hideHeaders},i.subGridConfigs[r]),e=!1,t.flex||t.width||(t.width=n.totalFixedWidth,e=!0),i.subGrids[r]=new Xh(t),i.subGrids[r].hasCalculatedWidth=e,s&&(i.subGrids[r].isFirstRegion=!0,s=!1)};for(d.s();!(u=d.n()).done;)f()}catch(e){d.e(e)}finally{d.f()}}},{key:"doDestroy",value:function(){this.eachSubGrid((function(e){return e.destroy()})),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"eachSubGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;n.regions.forEach((function(r,i){var o=n.subGrids[r];e.call(t||o,o,i++)}))}},{key:"eachWidget",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;n.regions.forEach((function(r){var i=n.subGrids[r];!1!==e(i)&&t&&i.eachWidget&&i.eachWidget(e,t)}))}},{key:"callEachSubGrid",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=this,o=null;return i.regions.forEach((function(t,r){var a=i.subGrids[t];if(a[e]){var s=a[e].apply(a,n);0===r&&(o=s)}})),o}},{key:"getLastRegions",value:function(){var e=this.regions.slice(-2);return 2===e.length?e:[e[0],e[0]]}},{key:"getNextRegion",value:function(e){var t=this.regions;return t[t.indexOf(e)+1]||t[t.length-2]}},{key:"getPreviousRegion",value:function(e){return this.regions[this.regions.indexOf(e)-1]}},{key:"getSubGrid",value:function(e){return this.subGrids[e]}},{key:"getSubGridFromColumn",value:function(e){return e=e instanceof Hu?e:this.columns.get(e)||this.columns.getById(e),this.getSubGrid(e.region)}},{key:"resolveSplitter",value:function(e){var t=this.getLastRegions(),n=e instanceof Xh?e.region:e;return t[1]===n&&(n=t[0]),this.subGrids[n].splitterElement}},{key:"items",get:function(){var e=this;return this.regions.map((function(t){return e.subGrids[t]}))}},{key:"regions",get:function(){return this._regions||this.initSubGrids(),this._regions}},{key:"widgetClass",get:function(){}}]),r}(e||G)})));function dg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ug.localeClass="Grid",ug._$name="GridBase",ye.register("gridbase",ug);var fg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(dg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"$name",get:function(){return"Grid"}}]),r}(ug);function hg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}fg._$name="Grid",ye.register("grid",fg),j.setVersion("grid","3.1.1");var gg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(hg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"store",set:function(e){if(e&&!e.tree){if(e instanceof ga)throw new Error("TreeGrid requires a Store configured with tree : true");e.tree=!0}ei()(J()(r.prototype),"store",e,this,!0)},get:function(){return se()(J()(r.prototype),"store",this)}}],[{key:"$name",get:function(){return"TreeGrid"}}]),r}(fg);function vg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}gg._$name="TreeGrid",ye.register("treegrid",gg);var pg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(vg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return r}(_e());pg._$name="SchedulerCommon";n(269);function yg(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return mg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mg(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function mg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var kg=function(e,t,n){return e.store&&(e=e.store),t.store&&(t=t.store),(e=e[n]||0)<(t=t[n]||0)?-1:e>t?1:0},wg=function(e,t){return kg(e,t,"loadPriority")},Sg=function(e,t){return kg(e,t,"syncPriority")},Cg=function(){};function Rg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var xg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Rg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.stores&&(e.crudStores=e.stores,delete e.stores),se()(J()(r.prototype),"construct",this).call(this,e)}},{key:"commit",value:function(){this.commitCrudStores()}},{key:"reject",value:function(){this.rejectCrudStores()}},{key:"addStore",value:function(){return this.addCrudStore.apply(this,arguments)}},{key:"removeStore",value:function(){return this.removeCrudStore.apply(this,arguments)}},{key:"getStore",value:function(){return this.getCrudStore.apply(this,arguments)}},{key:"hasChanges",value:function(){return this.crudStoreHasChanges.apply(this,arguments)}},{key:"loadData",value:function(){return this.loadCrudManagerData.apply(this,arguments)}},{key:"revision",get:function(){return this.crudRevision},set:function(e){this.crudRevision=e}},{key:"stores",set:function(e){e!==this.crudStores&&(this.crudStores=e)},get:function(){return this.crudStores}},{key:"isLoading",get:function(){return this.isCrudManagerLoading}}],[{key:"defaultConfig",get:function(){return Object.assign({},this.crudManagerDefaultConfig,{overrideCrudStoreLoad:!0,stores:null})}}]),r}(function(e){return function(e){$()(d,e);var t,n,r,i,o,a,s,l,c,u=(t=d,function(){var e,n=J()(t);if(bg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function d(){return D()(this,d),u.apply(this,arguments)}return M()(d,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._requestId=0,this.activeRequests={},this.crudStoresIndex={},se()(J()(d.prototype),"construct",this).call(this,e)}},{key:"afterConstruct",value:function(){var e=this;se()(J()(d.prototype),"afterConstruct",this).call(this),this.autoLoad&&this.load().catch((function(t){if(!e.isValidResponse(t.rawResponse,t.response))throw t}))}},{key:"getStoreDescriptor",value:function(e){return e?e instanceof ga?this.crudStores.find((function(t){return t.store===e})):"object"===re()(e)?this.crudStoresIndex[e.storeId]:this.crudStoresIndex[e]||this.getStoreDescriptor(ga.getStore(e)):null}},{key:"fillStoreDescriptor",value:function(e){var t=e.store,n=t.storeIdProperty,r=void 0===n?this.storeIdProperty:n,i=t.modelClass;return e.storeId||(e.storeId=t[r]),e.idField||(e.idField=i.idField),e.phantomIdField||(e.phantomIdField=i.phantomIdField),e.phantomParentIdField||(e.phantomParentIdField=i.phantomParentIdField),"writeAllFields"in e||(e.writeAllFields=t.writeAllFields),e}},{key:"updateCrudStoreIndex",value:function(){var e=this.crudStoresIndex={};this.crudStores.forEach((function(t){return t.storeId&&(e[t.storeId]=t)}))}},{key:"getCrudStore",value:function(e){var t=this.getStoreDescriptor(e);return t&&t.store}},{key:"forEachCrudStore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;e&&this.crudStores.every((function(n){return!1!==e.call(t,n.store,n.storeId,n)}))}},{key:"internalAddCrudStore",value:function(e){var t,n=this;return e instanceof ga?t={store:e}:"object"===re()(e)?(e.stores&&(Array.isArray(e.stores)||(e.stores=[e.stores]),e.stores.forEach((function(t,n){var r=t;"string"==typeof t&&(r={storeId:t}),r.masterStoreInfo=e,e.stores[n]=r}))),t=e):t={store:ga.getStore(e)},n.fillStoreDescriptor(t),(e=t.store).setCrudManager?e.setCrudManager(n):e.crudManager=n,e.pageSize=null,n.overrideCrudStoreLoad&&e.load&&(e.load=e.commit=function(){}),n.bindCrudStoreListeners(e),t}},{key:"addCrudStore",value:function(e,t,n){var r;if(e&&(Array.isArray(e)||(e=[e]),e.length)){var i=this,o=e.map(i.internalAddCrudStore,i);if(void 0===t){var a;(a=i.crudStores).push.apply(a,Z()(o))}else{var s,l=t;n&&((n instanceof ga||"object"!==re()(n))&&(n=i.getStoreDescriptor(n)),l+=i.crudStores.indexOf(n)),(s=i.crudStores).splice.apply(s,[l,0].concat(Z()(o)))}(r=i.orderedCrudStores).push.apply(r,Z()(o)),i.updateCrudStoreIndex()}}},{key:"addPrioritizedStore",value:function(e){this.hasCrudStore(e)||this.addCrudStore(e,ue.findInsertionIndex(e,this.crudStores,wg)),this.hasApplySequenceStore(e)||this.addStoreToApplySequence(e,ue.findInsertionIndex(e,this.syncApplySequence,Sg))}},{key:"hasCrudStore",value:function(e){return this.crudStores.some((function(t){return t===e||t.store===e||t.storeId===e}))}},{key:"removeCrudStore",value:function(e){for(var t=this,n=t.crudStores,r=0,i=n.length;r<i;r++){var o=n[r];if(o===e||o.store===e||o.storeId===e){t.unbindCrudStoreListeners(o.store),delete t.crudStoresIndex[o.storeId],n.splice(r,1),t.syncApplySequence&&t.removeStoreFromApplySequence(e);break}}}},{key:"bindCrudStoreListeners",value:function(e){e.on({name:"store",change:"onCrudStoreChange",thisObj:this})}},{key:"unbindCrudStoreListeners",value:function(){this.detachListeners("store")}},{key:"addStoreToApplySequence",value:function(e,t,n){if(e){Array.isArray(e)||(e=[e]);var r=this,i=e.reduce((function(e,t){var n=r.getStoreDescriptor(t);return n&&e.push(n),e}),[]);if(void 0===t){var o;(o=r.syncApplySequence).push.apply(o,Z()(i))}else{var a,s=t;n&&((n instanceof ga||"object"!==re()(n))&&(n=r.getStoreDescriptor(n)),s+=r.syncApplySequence.indexOf(n)),(a=r.syncApplySequence).splice.apply(a,[s,0].concat(Z()(i)))}var l=r.syncApplySequence.map((function(e){return e.storeId}));r.orderedCrudStores=Z()(r.syncApplySequence),r.crudStores.forEach((function(e){l.includes(e.storeId)||r.orderedCrudStores.push(e)}))}}},{key:"removeStoreFromApplySequence",value:function(e){var t=this.syncApplySequence.findIndex((function(t){return t===e||t.store===e||t.storeId===e}));t>-1&&(this.syncApplySequence.splice(t,1),this.orderedCrudStores.splice(t,1))}},{key:"hasApplySequenceStore",value:function(e){return this.syncApplySequence.some((function(t){return t===e||t.store===e||t.storeId===e}))}},{key:"onCrudStoreChange",value:function(){var e=this;e.crudIgnoreUpdates||(e.crudStoreHasChanges()?(e.trigger("hasChanges"),e.autoSync&&(e.autoSyncTimerId||(e.autoSyncTimerId=e.setTimeout((function(){e.autoSyncTimerId=null,e.sync().catch((function(t){if(!e.isValidResponse(t.rawResponse,t.response))throw t}))}),e.autoSyncTimeout)))):e.trigger("noChanges"))}},{key:"internalOnResponse",value:(c=ta()(Zo.a.mark((function e(t,n,r,i){var o,a;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this).activeRequests[t]=null,(a=n?o.decode(n):null)&&a.success){e.next=7;break}return o.trigger("requestFail",{requestType:t,response:a,responseText:n,responseOptions:r}),o.trigger(t+"Fail",{response:a,responseOptions:r,responseText:n,options:i}),e.abrupt("return",a);case 7:if(!1===o.trigger("beforeResponseApply",{requestType:t,response:a})||!1===o.trigger("before"+L.capitalizeFirstLetter(t)+"Apply",{response:a,options:i})){e.next=14;break}return o.crudRevision=a.revision,e.next=11,o.applyResponse(t,a,i);case 11:o.trigger("requestDone",{requestType:t,response:a,responseOptions:r}),o.trigger(t,{response:a,responseOptions:r,options:i}),"load"!==t&&o.crudStoreHasChanges()||o.trigger("noChanges");case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return c.apply(this,arguments)})},{key:"internalOnLoad",value:(l=ta()(Zo.a.mark((function e(t,n,r){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.crudLoaded=!0,e.abrupt("return",this.internalOnResponse("load",t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"internalOnSync",value:(s=ta()(Zo.a.mark((function e(t,n,r){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.internalOnResponse("sync",t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"suspendChangesTracking",value:function(){this.crudIgnoreUpdates++}},{key:"resumeChangesTracking",value:function(e){this.crudIgnoreUpdates&&!--this.crudIgnoreUpdates&&e&&this.onCrudStoreChange()}},{key:"crudStoreHasChanges",value:function(e){if(e){var t=this.getCrudStore(e);return t&&this.isCrudStoreDirty(t)}return this.crudStores.some(this.isCrudStoreDirty)}},{key:"isCrudStoreDirty",value:function(e){return null!=e.store.changes}},{key:"emitCrudStoreEvents",value:function(e,t){var n,r={action:"read"+t},i=yg(this.crudStores);try{for(i.s();!(n=i.n()).done;){var o=n.value;e.includes(o.storeId)&&o.store.trigger(t,r)}}catch(e){i.e(e)}finally{i.f()}}},{key:"getLoadPackage",value:function(e){var t={type:"load",requestId:this.requestId},n=this.crudStores,r=Object.assign({},e);return t.stores=n.map((function(e){var t=r&&r[e.storeId],n=e.pageSize||e.store&&e.store.pageSize;if(t||n){var i=Object.assign({storeId:e.storeId,page:1,pageSize:n},t);return e.currentPage=i.page,t&&delete r[e.storeId],i}return e.storeId})),Object.assign(t,r),t}},{key:"loadCrudStore",value:function(e,t,n){var r=t&&t.rows;n&&n.append||t.append?e.add(r):e.data=r,e.trigger("load",{source:e,data:r})}},{key:"loadDataToCrudStore",value:function(e,t,n){var r,i=this,o=e.store,a=e.stores,s=e.idField||"id",l=o.tree,c=t&&t.rows;(o.__loading=!0,c)&&(a&&(r=i.getSubStoresData(c,a,s,l)),i.loadCrudStore(o,t,n,e),r&&r.forEach((function(e){i.loadDataToCrudStore(Object.assign({store:o.getById(e.id).get(e.storeDesc.storeId)},e.storeDesc),e.data)})));o.__loading=!1}},{key:"loadCrudManagerData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.suspendChangesTracking(),this.crudStores.forEach((function(r){var i=r.storeId,o=e[i];o&&t.loadDataToCrudStore(r,o,n[i])})),this.resumeChangesTracking()}},{key:"load",value:function(e){var t=this,n=t.getLoadPackage(e);return new Promise((function(r,i){!1!==t.trigger("beforeLoad",{pack:n})?(t.activeRequests.load&&(t.cancelRequest(t.activeRequests.load.desc),t.trigger("loadCanceled",{pack:n})),t.activeRequests.load={options:e,pack:n,resolve:r,reject:i,id:n.requestId,desc:t.sendRequest({data:t.encode(n),type:"load",success:t.onLoadSuccess,failure:t.onLoadFailure,thisObj:t})},t.emitCrudStoreEvents(n.stores,"loadStart"),t.trigger("loadStart",{pack:n})):(t.trigger("loadCanceled",{pack:n}),t.processPromise(i,null,{action:"load",cancelled:!0}))}))}},{key:"onLoadSuccess",value:(a=ta()(Zo.a.mark((function e(t,n){var r,i,o,a;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",i=this.activeRequests.load,o=i.options,e.next=4,t.text().then((function(e){return r=e})).catch(Cg);case 4:return e.next=6,this.internalOnLoad(r,n,o);case 6:a=e.sent,this.emitCrudStoreEvents(i.pack.stores,"afterRequest"),a&&a.success?i.resolve({response:a,rawResponse:t,responseText:r,options:o}):this.processPromise(i.reject,i.resolve,{action:"load",cancelled:!1,response:a,rawResponse:t,responseText:r,options:o});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"onLoadFailure",value:(o=ta()(Zo.a.mark((function e(t){var n,r,i,o,a,s,l=arguments;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:{},r=this.activeRequests.load,i=r.options,o=Boolean(n.signal&&n.signal.aborted)){e.next=11;break}return a="",e.next=6,t.text().then((function(e){return a=e})).catch(Cg);case 6:return e.next=8,this.internalOnLoad(a,n,i);case 8:s=e.sent,this.emitCrudStoreEvents(r.pack.stores,"afterRequest"),this.processPromise(r.reject,null,{action:"load",cancelled:o,response:s,rawResponse:t,responseText:a,options:i});case 11:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getSubStoresData",value:function(e,t,n,r){var i=this;if(e){var o=[];return r?e.forEach((function(e){a(e,t);var r=i.getSubStoresData(e.children,t,n,!0);r&&o.push.apply(o,Z()(r))})):e.forEach((function(e){return a(e,t)})),o}function a(e,t){t.forEach((function(t){var r=t.storeId;e[r]&&(o.push({id:e[n],storeDesc:t,data:e[r]}),delete e[r])}))}}},{key:"prepareAdded",value:function(e,t){var n=this,r=t.store,i=t.stores,o=r.isTree,a=t.phantomIdField||this.phantomIdField,s=t.phantomParentIdField||this.phantomParentIdField;return e.filter((function(e){return e.isValid})).map((function(e){var t=e.constructor,r=Object.assign(e.persistableData,oe()({},a,e.id));if(o){var l=e.parent;l&&!l.isRoot&&l.isPhantom&&(r[s]=l.id)}return n.resetIdsBeforeSync&&mt.deletePath(r,t.getFieldDataSource(t.idField)),i&&n.processSubStores(e,r,i),r}))}},{key:"prepareUpdated",value:function(e,t){var n=this,r=t.store,i=t.stores,o=r.isTree,a=t.writeAllFields||!1!==t.writeAllFields&&this.writeAllFields,s=t.phantomParentIdField||this.phantomParentIdField;if(t.store.tree){var l=t.store.rootNode;e=e.filter((function(e){return e!==l}))}return e.filter((function(e){return e.isValid})).reduce((function(e,t){var r;if(r=a?t.persistableData:t.modificationData,o){var l=t.parent;l&&!l.isRoot&&l.isPhantom&&(r[s]=l.id)}return i&&n.processSubStores(t,r,i),mt.isEmpty(r)||e.push(r),e}),[])}},{key:"prepareRemoved",value:function(e){return e.map((function(e){var t=e.constructor;return mt.setPath({},t.getFieldDataSource(t.idField),e.id)}))}},{key:"processSubStores",value:function(e,t,n){var r=this;n.forEach((function(n){var i=n.storeId,o=e.get(i);if(o){var a=r.getCrudStoreChanges(Object.assign({store:o},n));a?t[i]=Object.assign(a,{$store:!0}):delete t[i]}else delete t[i]}))}},{key:"getCrudStoreChanges",value:function(e){var t,n=e.store,r=n.added.values,i=n.modified.values,o=n.removed.values;return r.length&&(r=this.prepareAdded(r,e)),i.length&&(i=this.prepareUpdated(i,e)),o.length&&(o=this.prepareRemoved(o)),(r.length||i.length||o.length)&&(t={},r.length&&(t.added=r),i.length&&(t.updated=i),o.length&&(t.removed=o)),t}},{key:"getChangeSetPackage",value:function(){var e=this,t={type:"sync",requestId:this.requestId,revision:this.crudRevision},n=0;return this.crudStores.forEach((function(r){var i=e.getCrudStoreChanges(r);i&&(n++,t[r.storeId]=i)})),n?t:null}},{key:"applyChangesToRecord",value:function(e,t,n){var r,i=this,o=e.constructor,a=o.fieldDataSourceMap,s=o.prototype,l={},c=e.data,u=oe()({},i.phantomIdField,!0);for(var d in n&&n.forEach((function(n){var r=n.storeId;if(Object.prototype.hasOwnProperty.call(t,r)){u[r]=!0;var o=e.get(r);o?i.applyChangesToStore(Object.assign({store:o},n),t[r]):console.log("Can't find store for the response sub-package")}})),t)if(Object.prototype.hasOwnProperty.call(t,d)&&!u[d]){var f=a[d],h=f?f.name:d,g=o.processField(h,t[d]),v=d in s?e[h]:mt.getPath(c,d);mt.isEqual(v,g)||(r=!0,l[h]=g)}if(r){for(var p in i.suspendChangesTracking(),l)e[p]=l[p];i.resumeChangesTracking()}e.clearChanges(!0,!1)}},{key:"applyRemovals",value:function(e,t,n){var r=this,i=e.removed,o=e.modelClass,a=n.findByIdFn,s=n.removeRecordFn,l=o.getFieldDataSource(o.idField),c=0;return t.forEach((function(e){var t=e[l],n=!1;if(i.includes(t)&&(i.remove(t),n=!0,c++),!n){var o=a(t);o?(r.suspendChangesTracking(),s(o),i.remove(o),c++,r.resumeChangesTracking()):console.log("Can't find record to remove from the response package")}})),c}},{key:"getApplyChangesToStoreHelpers",value:function(e){return e.tree?{findByPhantomFn:function(t){return e.getById(t)},findByIdFn:function(t){return e.getById(t)},addRecordFn:function(t){return(t.parentId&&e.getById(t.parentId)||e.rootNode).appendChild(t)},removeRecordFn:function(e){return e.remove()}}:{findByPhantomFn:function(t){return e.getById(t)},findByIdFn:function(t){return e.getById(t)},addRecordFn:function(t){return e.add(t)[0]},removeRecordFn:function(t){return e.remove(t)}}}},{key:"applyChangesToStore",value:function(e,t){var n=this,r=e.phantomIdField||n.phantomIdField,i=e.store,o=i.modelClass,a=o.getFieldDataSource(o.idField),s=n.getApplyChangesToStoreHelpers(i),l=s.findByPhantomFn,c=s.findByIdFn,u=s.addRecordFn,d=s.removeRecordFn,f=t.rows,h=t.removed;if(f){var g=e.stores;f.forEach((function(e){var t=e[r],o=mt.getPath(e,a),s=null;null!=t?s=l(t):null!=o&&(s=c(o)),s?n.applyChangesToRecord(s,e,g,i):(n.suspendChangesTracking(),s=u(e),n.resumeChangesTracking(),s.clearChanges())}))}h&&n.applyRemovals(i,h,{findByIdFn:c,removeRecordFn:d})&&i.trigger("dataChanged",{source:i})}},{key:"applySyncResponse",value:function(e){var t=this.orderedCrudStores;this.applyingSyncResponse=!0;var n,r=yg(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=e[i.storeId];o&&this.applyChangesToStore(i,o)}}catch(e){r.e(e)}finally{r.f()}this.applyingSyncResponse=!1}},{key:"applyLoadResponse",value:function(e,t){this.applyingLoadResponse=!0,this.loadCrudManagerData(e,t),this.applyingLoadResponse=!1}},{key:"applyResponse",value:(i=ta()(Zo.a.mark((function e(t,n,r){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.trackResponseType&&(t=n.type||t),e.t0=t,e.next="load"===e.t0?4:"sync"===e.t0?6:8;break;case 4:return this.applyLoadResponse(n,r),e.abrupt("break",8);case 6:return this.applySyncResponse(n),e.abrupt("break",8);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"sync",value:function(){var e=this,t=this;return t.activeRequests.sync?(t.trigger("syncDelayed"),t.activeSyncPromise=t.activeSyncPromise.then((function(){return t.sync()}),(function(){return t.sync()}))):t.activeSyncPromise=new Promise((function(n,r){var i=t.getChangeSetPackage();i?!1!==t.trigger("beforeSync",{pack:i})?(t.trigger("syncStart",{pack:i}),t.activeRequests.sync={pack:i,resolve:n,reject:r,id:i.requestId,desc:t.sendRequest({data:t.encode(i),type:"sync",success:t.onSyncSuccess,failure:t.onSyncFailure,thisObj:t})}):(t.trigger("syncCanceled",{pack:i}),e.processPromise(r,null,{action:"sync",cancelled:!0})):n(null)}))}},{key:"onSyncSuccess",value:(r=ta()(Zo.a.mark((function e(t,n){var r,i,o;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.next=3,t.text().then((function(e){return r=e})).catch(Cg);case 3:return i=this.activeRequests.sync,e.next=6,this.internalOnSync(r,n);case 6:(o=e.sent)&&o.success?i.resolve({response:o,rawResponse:t,responseText:r,request:i}):this.processPromise(i.reject,i.resolve,{action:"sync",cancelled:!1,response:o,rawResponse:t,responseText:r,request:i});case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"onSyncFailure",value:(n=ta()(Zo.a.mark((function e(t){var n,r,i,o,a,s=arguments;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:{},r="",i=null,o=this.activeRequests.sync,a=Boolean(n.signal&&n.signal.aborted)){e.next=9;break}return e.next=6,t.text().then((function(e){return r=e})).catch(Cg);case 6:return e.next=8,this.internalOnSync(r,n);case 8:i=e.sent;case 9:a||this.processPromise(o.reject,null,{action:"sync",cancelled:a,response:i,rawResponse:t,responseText:r,request:o});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"commitCrudStores",value:function(){this.crudStores.forEach((function(e){return e.store.commit()}))}},{key:"rejectCrudStores",value:function(){this.orderedCrudStores.forEach((function(e){return e.store.clearChanges()}))}},{key:"doDestroy",value:function(){var e=this;for(e.activeRequests.load&&e.cancelRequest(e.activeRequests.load.desc),e.activeRequests.sync&&e.cancelRequest(e.activeRequests.sync.desc);e.crudStores.length>0;)e.removeCrudStore(e.crudStores[0]);clearTimeout(e.autoSyncTimerId),e.destroyed=!0,se()(J()(d.prototype),"doDestroy",this)&&se()(J()(d.prototype),"doDestroy",this).call(this)}},{key:"isValidResponse",value:function(e,t){return e&&(e.ok&&t||[500,404].includes(e.status))}},{key:"processPromise",value:function(e,t,n){var r=n.cancelled,i=n.action,o=n.rawResponse,a=n.response;if(t&&this.isValidResponse(o,a))t(n);else{var s="".concat(L.capitalizeFirstLetter(i)," ").concat(r?"canceled":"failed"),l=new Error(s);Object.assign(l,n),e(l)}}},{key:"isCrudManager",get:function(){return!0}},{key:"crudStores",set:function(e){this._crudStores=[],this.addCrudStore(e);var t,n=yg(this._crudStores);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.loadPriority=r.syncPriority=0}}catch(e){n.e(e)}finally{n.f()}},get:function(){return this._crudStores}},{key:"orderedCrudStores",get:function(){return this._orderedCrudStores},set:function(e){return this._orderedCrudStores=e}},{key:"syncApplySequence",set:function(e){this._syncApplySequence=[],this.addStoreToApplySequence(e)},get:function(){return this._syncApplySequence}},{key:"isCrudManagerLoading",get:function(){return Boolean(this.activeRequests.load||this.applyingLoadResponse)}},{key:"isLoadingOrSyncing",get:function(){return Boolean(this.activeRequests.load||this.activeRequests.sync)}},{key:"requestId",get:function(){return Number.parseInt("".concat(Date.now()).concat(this._requestId++))}}],[{key:"defaultConfig",get:function(){return{crudRevision:null,crudStores:[],storeIdProperty:"storeId",crudFilterParam:"filter",transport:{},trackResponseType:!1,phantomIdField:"$PhantomId",phantomParentIdField:"$PhantomParentId",autoLoad:!1,autoSyncTimeout:100,autoSync:!1,resetIdsBeforeSync:!0,syncApplySequence:[],orderedCrudStores:[],writeAllFields:!1,crudIgnoreUpdates:0,crudLoaded:!1,createMissingRecords:!1,autoSyncTimerId:null,applyingLoadResponse:!1,applyingSyncResponse:!1,callOnFunctions:!0}}}]),d}(or(e))}(pe(G)));function Eg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}xg._$name="AbstractCrudManager";var Dg=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Eg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"cancelRequest",value:function(e){e.abort()}},{key:"sendRequest",value:function(e){var t=this,n=e.data,i=t.transport[e.type]||{},o=i.paramName,a=Object.assign({},i.params),s=i.method||r.defaultMethod[e.type],l=Object.assign({url:i.url,method:s,params:a},i.requestConfig);if(o?(l.params=l.params||{},l.params[o]=n):l.jsonData=n,!i.url)throw new Error("Trying to request without URL specified");t.trigger("beforeSend",{params:a,type:e.type,requestConfig:l,config:e}),l.jsonData&&(l.headers=l.headers||{},l.headers["Content-Type"]=l.headers["Content-Type"]||"application/json");var c=Object.assign({method:s,headers:l.headers,queryParams:a,body:"HEAD"===s||"GET"===s?void 0:l.jsonData},l.fetchOptions),u=Ae.fetch(l.url,c);return u.catch((function(e){c.signal&&!c.signal.aborted&&console.warn(e)})).then((function(n){n&&n.ok?e.success&&e.success.call(e.thisObj||t,n,c):e.failure&&e.failure.call(e.thisObj||t,n,c)})),u}}],[{key:"defaultMethod",get:function(){return{load:"GET",sync:"POST"}}}]),r}(e||G)};function Tg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Mg=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Tg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"afterConstruct",value:function(){var e=this;e.crudManager&&e.loadMask&&e.crudManager.isCrudManagerLoading&&e.maskBody(e.loadMask)}},{key:"bindCrudManager",value:function(e){this.detachListeners("crudManager"),e&&e.on({name:"crudManager",loadStart:"onCrudManagerLoadStart",load:"onCrudManagerLoad",loadCanceled:"onCrudManagerLoadCanceled",syncStart:"onCrudManagerSyncStart",sync:"onCrudManagerSync",syncCanceled:"onCrudManagerSyncCanceled",requestFail:"onCrudManagerRequestFail",thisObj:this})}},{key:"onCrudManagerLoadStart",value:function(){this.loadMask&&this.maskBody(this.loadMask),this.toggleEmptyText()}},{key:"onCrudManagerSyncStart",value:function(){this.syncMask&&this.maskBody(this.syncMask)}},{key:"onCrudManagerRequestFinalize",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=this;r.activeMask&&(e?(r.unmaskBody(),r.toggleEmptyText()):(r.activeMask.icon=r.loadMaskErrorIcon,r.activeMask.text='<div class="b-grid-load-failure">\n                <div class="b-grid-load-fail">'.concat(r.L("".concat(t,"FailedMessage")),"</div>\n                ").concat(n&&n.message?'<div class="b-grid-load-fail">'.concat(r.L("serverResponseLabel")," ").concat(n.message,"</div>"):"","\n            </div>"),r.loadmaskHideTimer=r.setTimeout((function(){r.onCrudManagerRequestFinalize()}),r.loadMaskHideTimeout)))}},{key:"onCrudManagerLoadCanceled",value:function(){this.onCrudManagerRequestFinalize()}},{key:"onCrudManagerSyncCanceled",value:function(){this.onCrudManagerRequestFinalize()}},{key:"onCrudManagerLoad",value:function(){this.onCrudManagerRequestFinalize()}},{key:"onCrudManagerSync",value:function(){this.onCrudManagerRequestFinalize()}},{key:"onCrudManagerRequestFail",value:function(e){var t=e.requestType,n=e.response;this.onCrudManagerRequestFinalize(!1,t,n)}},{key:"crudManager",get:function(){return this._crudManager},set:function(e){var t=this;e&&e.isCrudManager?t._crudManager=e:e&&t.crudManagerClass?e=new t.crudManagerClass(Object.assign({scheduler:t},e)):t._crudManager=null,t.bindCrudManager(t._crudManager)}}],[{key:"$name",get:function(){return"CrudManagerView"}},{key:"defaultConfig",get:function(){return{crudManagerClass:null,crudManager:null}}}]),r}(e)};function Ag(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ig=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ag()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"encode",value:function(e){return L.safeJsonStringify(e)}},{key:"decode",value:function(e){return L.safeJsonParse(e)}}]),r}(e||G)};function Fg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Og=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Fg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"getNthDayInPeriod",value:function(e,t,n,r){var i,o,a;if(r){r>0?(o=1,a=e):(o=-1,a=t);var s=n-a.getDay();o*s<0&&(r+=o),((i=new Date(a.getTime()+6048e5*(r-o)+864e5*s))<e||i>t)&&(i=null)}return i}},{key:"buildDate",value:function(e,t,n){var r=new Date(e,t,n);if(r.getFullYear()==e&&r.getMonth()==t&&r.getDate()==n)return r}},{key:"isValidPosition",value:function(e){return Boolean(e)}},{key:"forEachDateAtPositions",value:function(e,t,n,r){for(var i=e.length,o={},a=0;a<t.length;a++){var s=t[a];if(this.isValidPosition(s)){var l=s>0?e[s-1]:e[i+s];if(l&&!o[l.getTime()]&&(o[l.getTime()]=!0,!1===n.call(r,l)))return!1}}}},{key:"frequency",get:function(){return"NONE"}},{key:"MAX_OCCURRENCES_COUNT",get:function(){return 1e6}}]),r}(G);function _g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Og._$name="AbstractRecurrenceIterator";var Pg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(_g()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getResource",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.resourceStore;return e&&e.getById(this.resourceId)}},{key:"fullCopy",value:function(){throw new Error("Not implemented")}},{key:"eventResourceKey",get:function(){return"".concat(this.event?this.eventId:this.data.eventId||this.internalId,"-").concat(this.resource?this.resourceId:this.data.resourceId||this.internalId)}},{key:"assignmentStore",get:function(){return this.stores&&this.stores[0]}},{key:"eventStore",get:function(){var e=this.assignmentStore;return e&&e.eventStore}},{key:"resourceStore",get:function(){var e=this.eventStore;return e&&e.resourceStore}},{key:"eventName",get:function(){return this.event&&this.event.name}},{key:"resourceName",get:function(){return this.resource&&this.resource.name}},{key:"isAssignment",get:function(){return!0}},{key:"isPersistable",get:function(){var e,t=this.event,n=this.resource,r=this.stores,i=this.unjoinedStores,o=r[0];return e=o?this.isValid&&(o.crudManager||!t.hasGeneratedId&&!n.hasGeneratedId):i[0],Boolean(e)}},{key:"isValid",get:function(){return null!=this.resource&&null!=this.event}},{key:"eventResourceCompositeKey",get:function(){return r.makeAssignmentEventResourceCompositeKey(this.eventId,this.resourceId)}}],[{key:"makeAssignmentEventResourceCompositeKey",value:function(e,t){return"event(".concat(e,")-resource(").concat(t,")")}},{key:"fields",get:function(){return[{name:"resourceId"},{name:"eventId"}]}},{key:"relationConfig",get:function(){return[{relationName:"resource",fieldName:"resourceId",store:"resourceStore",collectionName:"assignments"},{relationName:"event",fieldName:"eventId",store:"eventStore",collectionName:"assignments"}]}}]),r}(Io);function Lg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Pg.exposeProperties(),Pg._$name="AssignmentModel";var Hg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Lg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"add",value:function(e){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var n=e[t];if(n instanceof Io||(e[t]=n=this.createRecord(n)),-1!==this.storage.findIndex("eventResourceKey",n.eventResourceKey,!0))throw new Error("Duplicate assignment Event: ".concat(n.eventId," to resource: ").concat(n.resourceId))}return se()(J()(r.prototype),"add",this).call(this,e)}},{key:"doDestroy",value:function(){this.eventStoreDetacher&&this.eventStoreDetacher(),this.resourceStoreDetacher&&this.resourceStoreDetacher(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"attachToEventStore",value:function(e){var t=this;t.eventStoreDetacher&&t.eventStoreDetacher(),e&&(t.eventStoreDetacher=e.on({remove:t.onEventRemove,resourcestorechange:t.onEventStoreResourceStoreChange,thisObj:t,prio:200})),t.isConfiguring||t.initRelations(!0),t.attachToResourceStore(e&&e.resourceStore)}},{key:"attachToResourceStore",value:function(e){var t=this;t.resourceStore=e,t.resourceStoreDetacher&&t.resourceStoreDetacher(),e&&(t.resourceStoreDetacher=e.on({remove:t.onResourceRemove,removeAll:t.onResourceRemoveAll,thisObj:t,prio:200}),t.isConfiguring||t.initRelations(!0))}},{key:"onEventStoreResourceStoreChange",value:function(e){var t=e.newResourceStore;this.attachToResourceStore(t)}},{key:"onEventRemove",value:function(e){var t=e.records,n=e.isMove,r=e.isCollapse;if(!n&&!r){var i=[];t.forEach((function(e){e.traverse((function(e){i.push.apply(i,Z()(e.assignments))}))})),this.isRemovingEvent=!0,i.length&&this.remove(i),this.isRemovingEvent=!1}}},{key:"onResourceRemove",value:function(e){var t=e.records,n=e.isMove,r=e.isCollapse;if(!n&&!r){var i=[];t.forEach((function(e){e.traverse((function(e){i.push.apply(i,Z()(e.assignments))}))})),i.length&&this.remove(i)}}},{key:"onResourceRemoveAll",value:function(){this.removeAll()}},{key:"mapAssignmentsForEvent",value:function(e,t,n){var r=Boolean(t),i=Boolean(n),o=Io.asId(e),a=this.relationCache.event&&this.relationCache.event[o];return a?(t=t||function(e){return e},n=n||function(){return!0},r||i?a.reduce((function(e,r){var i=t(r);return n(i)&&e.push(i),e}),[]):a):[]}},{key:"mapAssignmentsForResource",value:function(e,t,n){var r=Boolean(t),i=Boolean(n),o=Io.asId(e),a=this.relationCache.resource&&this.relationCache.resource[o];return a?(t=t||function(e){return e},n=n||function(){return!0},r||i?a.reduce((function(e,r){var i=t(r);return n(i)&&e.push(i),e}),[]):a):[]}},{key:"getAssignmentsForEvent",value:function(e){return e.assignments}},{key:"removeAssignmentsForEvent",value:function(e){return this.remove(e.assignments)}},{key:"getAssignmentsForResource",value:function(e){return this.mapAssignmentsForResource(e)}},{key:"removeAssignmentsForResource",value:function(e){this.remove(this.getAssignmentsForResource(e))}},{key:"getResourcesForEvent",value:function(e){return this.mapAssignmentsForEvent(e,(function(e){return e.resource}),(function(e){return Boolean(e)}))}},{key:"getEventsForResource",value:function(e){return this.mapAssignmentsForResource(e,(function(e){return e.event}),(function(e){return!!e}))}},{key:"assignEventToResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=i.autoCommit;t=Array.isArray(t)?t:[t];var a=[];return i.autoCommit=!1,r&&e.resources&&e.resources.forEach((function(n){t.includes(n)||i.unassignEventFromResource(e,n)})),t.forEach((function(t){if(!i.isEventAssignedToResource(e,t)){var r=new i.modelClass({eventId:Io.asId(e),resourceId:Io.asId(t)});r=n(r),a.push(r)}})),a=i.add(a),i.autoCommit=o,a}},{key:"unassignEventFromResource",value:function(e,t){var n=[];if(!t)return this.removeAssignmentsForEvent(e);Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++)this.isEventAssignedToResource(e,t[r])&&n.push(this.getAssignmentForEventAndResource(e,t[r]));return this.remove(n)}},{key:"isEventAssignedToResource",value:function(e,t){var n=this.getResourcesForEvent(e),r=Io.asId(t);return n.some((function(e){return e.id==r}))}},{key:"getAssignmentForEventAndResource",value:function(e,t){return e=this.eventStore.getById(e),t=this.resourceStore.getById(t),this.records.find((function(n){return n.event==e&&n.resource==t}))}},{key:"storage",set:function(e){ei()(J()(r.prototype),"storage",e,this,!0),this.storage.addIndex("eventResourceKey")},get:function(){return se()(J()(r.prototype),"storage",this)}},{key:"eventStore",get:function(){return this._eventStore},set:function(e){var t=this,n=t._eventStore;t._eventStore=e||null,t.attachToEventStore(t._eventStore),(n||e)&&n!==e&&t.trigger("eventStoreChange",{newEventStore:e,oldEventStore:n})}}],[{key:"defaultConfig",get:function(){return{loadPriority:300,syncPriority:300,modelClass:Pg}}}]),r}(ka);function jg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Hg._$name="AssignmentStore";var Bg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(jg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"clearDate",value:function(){this.set("date",null)}},{key:"getAvailability",value:function(e){var t=this;if(e)return t.get("availability");if(t.availabilityCache)return t.availabilityCache;var n=t.get("availability").map((function(e){return"string"==typeof e?t.parseInterval(e):e}));return t.verifyAvailability(n),t.availabilityCache=n}},{key:"verifyAvailability",value:function(e){var t=this;e.sort((function(e,t){return e.startTime-t.startTime})),e.forEach((function(n,r){if(n.startTime>n.endTime)throw new Error("Start time ".concat(ft.format(n.startTime,"HH:mm")," is greater than end time ").concat(ft.format(n.endTime,"HH:mm")));if(r>0&&e[r-1].endTime>n.startTime)throw new Error("Availability intervals should not intersect: [".concat(t.stringifyInterval(e[r-1]),"] and [").concat(t.stringifyInterval(n),"]"))}))}},{key:"stringifyInterval",value:function(e){var t=e.startTime,n=e.endTime;return ft.format(t,"HH:mm")+"-"+ft.format(n,"HH:mm")}},{key:"stringifyIntervals",value:function(e){var t=this;return e.map((function(e){return"string"==typeof e?e:t.stringifyInterval(e)}))}},{key:"parseInterval",value:function(e){var t=/(\d\d):(\d\d)-(\d\d):(\d\d)/.exec(e);if(!t)throw new Error("Invalid format for availability string: ".concat(String,". It should have exact format: hh:mm-hh:mm"));return{startTime:new Date(0,0,0,t[1],t[2]),endTime:new Date(0,0,0,t[3],t[4])}}},{key:"addAvailabilityInterval",value:function(e,t){var n;n=e instanceof Date?{startTime:e,endTime:t}:this.parseInterval(e+(t?"-"+t:""));var r=this.getAvailability().concat(n);this.verifyAvailability(r),this.setAvailability(r)}},{key:"removeAvailabilityInterval",value:function(e){var t=this.getAvailability();t.splice(e,1),this.setAvailability(t)}},{key:"getAvailabilityIntervalsFor",value:function(e){var t=(e="number"==typeof e?new Date(e):e).getFullYear(),n=e.getMonth(),r=e.getDate();return this.getAvailability().map((function(e){var i=e.endTime.getDate();return{startDate:new Date(t,n,r,e.startTime.getHours(),e.startTime.getMinutes()),endDate:new Date(t,n,r+(1==i?1:0),e.endTime.getHours(),e.endTime.getMinutes())}}))}},{key:"getAvailabilityStartFor",value:function(e){var t=this.getAvailabilityIntervalsFor(e);return t.length?t[0].startDate:null}},{key:"getAvailabilityEndFor",value:function(e){var t=this.getAvailabilityIntervalsFor(e);return t.length?t[t.length-1].endDate:null}},{key:"date",set:function(e){e&&(e=ft.startOf(e,"day")),this.set("date",e)},get:function(){return this.get("date")}},{key:"availability",get:function(){return this.get("availability")},set:function(e){this.availabilityCache=null,this.set("availability",this.stringifyIntervals(e)),this.getAvailability()}},{key:"totalHours",get:function(){return this.getTotalMS()/1e3/60/60}},{key:"totalMS",get:function(){return this.getAvailability().reduce((function(e,t){return e+(t.endTime-t.startTime)}),0)}}],[{key:"fields",get:function(){return[{name:"date",type:"date",format:"YYYY-MM-DD",persist:!0},{name:"weekday",type:"int"},{name:"overrideStartDate",type:"date",dateFormat:"YYYY-MM-DD"},{name:"overrideEndDate",type:"date",dateFormat:"YYYY-MM-DD"},{name:"type",defaultValue:"DAY"},{name:"isWorkingDay",type:"boolean",defaultValue:!1},{name:"cls"},{name:"name"},{name:"availability",persist:!0}]}}]),r}(Io);function Ng(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Bg._$name="CalendarDayModel";var zg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ng()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"afterConstruct",value:function(){se()(J()(r.prototype),"afterConstruct",this).call(this),this.normalize()}},{key:"normalize",value:function(){var e=this,t=e.startDate,n=e.endDate,r=e.duration,i=e.durationUnit,o=null!=r;t&&n&&!o?e.setData("duration",ft.diff(t,n,i,!0)):t&&!n&&o?e.setData("endDate",ft.add(t,r,i)):!t&&n&&o&&e.setData("startDate",ft.add(n,-r,i)),this.clearCachedValues()}},{key:"setDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationUnit,n={duration:e=parseFloat(e),durationUnit:t};this.startDate?n.endDate=ft.add(this.startDate,e,t):this.endDate&&(n.startDate=ft.add(this.endDate,-e,t)),this.set(n)}},{key:"setStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r={startDate:e};if(e){var i;if(t)i=null!=n.duration;else if(n.endDate){if(r.duration=ft.diff(e,n.endDate,n.durationUnit,!0),r.duration<0)throw new Error("Negative duration")}else i=null!=this.duration;i&&(r.endDate=ft.add(e,n.duration,n.durationUnit))}else r.duration=null;n.set(r)}},{key:"setEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r={endDate:e};if(e){var i;if(!0===t)i=null!=n.duration;else if(n.startDate){if(r.duration=ft.diff(n.startDate,e,n.durationUnit,!0),r.duration<0)throw new Error("Negative duration")}else i=null!=this.duration;i&&(r.startDate=ft.add(e,-n.duration,n.durationUnit))}n.set(r)}},{key:"setStartEndDate",value:function(e,t){this.set({startDate:e,endDate:t})}},{key:"clearCachedValues",value:function(){this._startDateMS=null,this._endDateMS=null,this._isMilestone=null}},{key:"inSetNormalize",value:function(e){if("string"!=typeof e)return"duration"in(e=Object.assign({},e))?(e.startDate&&!e.endDate&&(e.endDate=ft.add(e.startDate,e.duration,e.durationUnit||this.durationUnit,!0,!0)),!e.startDate&&e.endDate&&(e.startDate=ft.add(e.endDate,-e.duration,e.durationUnit||this.durationUnit,!0,!0))):e.startDate&&e.endDate&&(e.duration=ft.diff(e.startDate,e.endDate,e.durationUnit||this.durationUnit,!0)),e}},{key:"inSet",value:function(e,t,n,i){return this.clearCachedValues(),e=this.inSetNormalize(e)||e,se()(J()(r.prototype),"inSet",this).call(this,e,t,n,i)}},{key:"forEachDate",value:function(e,t){return this.dates.forEach(e.bind(t))}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationUnit;if("string"==typeof e){var n=e;e=t,t=n}this.setStartDate(ft.add(this.startDate,e,t,!0),!0)}},{key:"fullCopy",value:function(){return this.copy.apply(this,arguments)}},{key:"intersects",value:function(e){return this.intersectsRange(e.startDate,e.endDate)}},{key:"intersectsRange",value:function(e,t){var n=this.startDate,r=this.endDate;return n&&r&&ft.intersectSpans(n,r,e,t)}},{key:"split",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=this,n=this.copy(),r=t.firstStore,i=r&&r.assignmentStore,o=t.duration*e,a=t.duration-o;if(e<=0||e>=1)throw new Error("Split point must be > 0 and < 1");return t.duration=o,n.startDate=t.endDate,n.duration=a,r&&r.add(n),i&&i.add(t.assignments.map((function(e){var t=Object.assign({},e.data,{eventId:n.id});return delete t.id,t}))),n}},{key:"cls",get:function(){return this._cls||(this._cls=new bt(se()(J()(r.prototype),"get",this).call(this,"cls"))),this._cls},set:function(e){var t=this;t._cls?t._cls.value=e:t._cls=new bt(e),t.set("cls",t._cls.value)}},{key:"startDate",get:function(){return this.get("startDate")},set:function(e){this.setStartDate(e)}},{key:"endDate",get:function(){return this.get("endDate")},set:function(e){this.setEndDate(e)}},{key:"duration",get:function(){return this.get("duration")},set:function(e){this.setDuration(e,this.durationUnit)}},{key:"durationUnit",get:function(){return this.get("durationUnit")}},{key:"fullDuration",get:function(){return new As({unit:this.durationUnit,magnitude:this.duration})},set:function(e){"string"==typeof e&&(e=ft.parseDuration(e,!0,this.durationUnit)),this.setDuration(e.magnitude,e.unit)}},{key:"dates",get:function(){for(var e=[],t=ft.startOf(this.startDate,"day"),n=this.endDate,r=t;r<n;r=ft.add(r,1,"day"))e.push(r);return e}},{key:"durationMS",get:function(){return this.endDate&&this.startDate?this.endDateMS-this.startDateMS:ft.asMilliseconds(this.duration||0,this.durationUnit)}},{key:"endDateMS",get:function(){var e=this;return null==e._endDateMS&&(e._endDateMS=e.endDate&&e.endDate.getTime()),e._endDateMS}},{key:"startDateMS",get:function(){var e=this;return null==e._startDateMS&&(e._startDateMS=e.startDate&&e.startDate.getTime()),e._startDateMS}},{key:"isMilestone",get:function(){return null==this._isMilestone&&(this._isMilestone=0===this.durationMS),this._isMilestone}},{key:"isScheduled",get:function(){return Boolean(this.startDate&&this.endDate&&this.hasValidDates)}},{key:"isValid",get:function(){var e=!0;if(e){var t=this.startDate,n=this.endDate;e=!t||!n||n-t>=0}return e}},{key:"hasValidDates",get:function(){var e=this.startDateMS,t=this.endDateMS;return!e||!t||t-e>=0}},{key:"wbsCode",get:function(){return this.indexPath.join(".")}}],[{key:"fields",get:function(){return[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number",allowNull:!0},{name:"durationUnit",type:"string",defaultValue:"d"},{name:"fullDuration",persist:!1},{name:"cls",defaultValue:""},"iconCls",{name:"style",type:"object"},{name:"name",type:"string"}]}}]),r}(Io);function Vg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zg._$name="TimeSpan";var Wg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Vg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).call(this,e),t.unitsInMs={MILLI:1,SECOND:1e3,MINUTE:6e4,HOUR:36e5,DAY:60*t.hoursPerDay*60*1e3,WEEK:t.daysPerWeek*t.hoursPerDay*60*60*1e3,MONTH:t.daysPerMonth*t.hoursPerDay*60*60*1e3,QUARTER:3*t.daysPerMonth*24*60*60*1e3,YEAR:12*t.daysPerMonth*24*60*60*1e3},t.defaultWeekAvailability=t.getDefaultWeekAvailability(),t.on({change:t.clearCache,thisObj:t}),t.clearCache()}},{key:"getDefaultWeekAvailability",value:function(){for(var e=this.defaultAvailability,t=this.weekendFirstDay,n=this.weekendSecondDay,r=[],i=0;i<7;i++)r.push(this.weekendsAreWorkdays||i!=t&&i!=n?new this.modelClass({type:"WEEKDAY",weekday:i,availability:e&&e.slice()||[],isWorkingDay:!0}):new this.modelClass({type:"WEEKDAY",weekday:i,availability:[]}));return r}},{key:"removeAll",value:function(){r.allCalendars.forEach((function(e){e.storeId=null,e.destroy()}))}},{key:"intersectsWithCurrentWeeks",value:function(e,t){var n=!1;return this.forEachNonStandardWeek((function(r){var i=r.startDate,o=r.endDate;if(i<=e&&e<o||i<t&&t<=o)return n=!0,!1})),n}},{key:"clearCache",value:function(){var e=this;if(!(e.suspendCacheUpdate>0)){e.holidaysCache={},e.availabilityIntervalsCache={};var t=e.daysIndex={},n=e.weekAvailability=[],r=e.nonStandardWeeksStartDates=[],i=e.nonStandardWeeksByStartDate={};e.forEach((function(e){var o,a,s=e.id,l=/^(\d)-(\d\d\d\d\/\d\d\/\d\d)-(\d\d\d\d\/\d\d\/\d\d)$/.exec(s),c=/^WEEKDAY:(\d+)$/.exec(s),u=e.type,d=e.weekday;if("WEEKDAYOVERRIDE"==u||l){if("WEEKDAYOVERRIDE"==u&&(o=e.overrideStartDate,a=e.overrideEndDate),l&&(o=ft.parse(l[2],"YYYY/MM/DD"),a=ft.parse(l[3],"YYYY/MM/DD"),d=l[1]),o&&a&&null!=d){var f=o-0;i[f]||(i[f]={startDate:new Date(o),endDate:new Date(a),name:e.getName(),weekAvailability:[],mainDay:null},r.push(f)),d>=0?i[f].weekAvailability[d]=e:i[f].mainDay=e}}else if("WEEKDAY"==u||c){if(c&&(d=c[1]),null!=d){if(d<0||d>6)throw new Error("Incorrect week day index");n[d]=e}}else{var h=e.date;h&&(t[h-0]=e)}})),r.sort((function(e,t){return e-t})),e.trigger("calendarChange")}}},{key:"addNonStandardWeek",value:function(e,t,n,r){if(e=ft.clearTime(e),t=ft.clearTime(t),this.intersectsWithCurrentWeeks(e,t))throw new Error("Can not add intersecting week");var i=this.modelClass,o=[];n.forEach((function(n,a){if(n instanceof Bg)n.type="WEEKDAYOVERRIDE",n.overrideStartDate=e,n.overrideEndDate=t,n.weekday=a,n.name=r||"Week override",o.push(n);else if(Array.isArray(n)){var s=new i;s.type="WEEKDAYOVERRIDE",s.overrideStartDate=e,s.overrideEndDate=t,s.weekday=a,s.name=r||"Week override",s.setAvailability(n),o.push(s)}}));var a=new i;a.type="WEEKDAYOVERRIDE",a.overrideStartDate=e,a.overrideEndDate=t,a.weekday=-1,a.name=r||"Week override",o.push(a),this.add(o)}},{key:"getNonStandardWeekByStartDate",value:function(e){return this.nonStandardWeeksByStartDate[ft.clearTime(e)-0]||null}},{key:"removeNonStandardWeek",value:function(e){e=ft.clearTime(e)-0;var t=this.getNonStandardWeekByStartDate(e);t&&this.remove(ue.clean(t.weekAvailability).concat(t.mainDay))}},{key:"getNonStandardWeekByDate",value:function(e){e=ft.clearTime(e)-0;for(var t=this.nonStandardWeeksStartDates,n=this.nonStandardWeeksByStartDate,r=0;r<t.length;r++){var i=n[t[r]];if(i.startDate>e)break;if(i.startDate<=e&&e<=i.endDate)return i}return null}},{key:"setWeekendsAreWorkDays",value:function(e){var t=this;e!==t.weekendsAreWorkdays&&(t.weekendsAreWorkdays=e,t.defaultWeekAvailability=t.getDefaultWeekAvailability(),t.clearCache())}},{key:"areWeekendsWorkDays",value:function(){return this.weekendsAreWorkdays}},{key:"forEachNonStandardWeek",value:function(e,t){for(var n=this.nonStandardWeeksStartDates,r=this.nonStandardWeeksByStartDate,i=0;i<n.length;i++)if(!1===e.call(t||this,r[n[i]]))return!1}},{key:"getCalendarDay",value:function(e){return e="number"==typeof e?new Date(e):e,this.getOverrideDay(e)||this.getWeekDay(e.getDay(),e)||this.getDefaultCalendarDay(e.getDay())}},{key:"getOverrideDay",value:function(e){return this.getOwnCalendarDay(e)||this.parent&&this.parent.getOverrideDay(e)||null}},{key:"getOwnCalendarDay",value:function(e){return e="number"==typeof e?new Date(e):e,this.daysIndex[ft.clearTime(e)-0]}},{key:"getWeekDay",value:function(e,t){if(t){var n=this.getNonStandardWeekByDate(t);if(n&&n.weekAvailability[e])return n.weekAvailability[e]}return this.weekAvailability[e]||this.parent&&this.parent.getWeekDay(e,t)||null}},{key:"isHoliday",value:function(e){var t=e-0,n=this.holidaysCache;if(null!=n[t])return n[t];e="number"==typeof e?new Date(e):e;var r=this.getCalendarDay(e);if(!r)throw new Error("Can't find day for "+e);return n[t]=!r.isWorkingDay}},{key:"getDefaultCalendarDay",value:function(e){return this.hasOwnProperty("defaultAvailability")||this.hasOwnProperty("weekendsAreWorkdays")||!this.parent?this.defaultWeekAvailability[e]:this.parent.getDefaultCalendarDay(e)}},{key:"isWorkingDay",value:function(e){return!this.isHoliday(e)}},{key:"isWeekend",value:function(e){var t=e.getDay();return t===this.weekendFirstDay||t===this.weekendSecondDay}},{key:"convertMSDurationToUnit",value:function(e,t){return e/this.unitsInMs[ft.getUnitByName(t)]}},{key:"convertDurationToMs",value:function(e,t){return e*this.unitsInMs[ft.getUnitByName(t)]}},{key:"forEachAvailabilityInterval",value:function(e,t,n){n=n||this;var r=e.startDate,i=e.endDate,o=!1!==e.isForward;if(o?!r:!i)throw new Error("At least `startDate` or `endDate` is required, depending from the `isForward` option");var a=new Date(o?r:i),s=ft;o?i||(i=s.add(r,e.availabilitySearchLimit||this.availabilitySearchLimit||1825,"day")):r||(r=s.add(i,-(e.availabilitySearchLimit||this.availabilitySearchLimit||1825),"day"));for(var l=!1;o?a<i:a>r;){for(var c=this.getAvailabilityIntervalsFor(a-(o?0:1),!!o&&l),u=o?0:c.length-1;o?u<c.length:u>=0;o?u++:u--){var d=c[u],f=d.startDate,h=d.endDate;if(!(f>=i||h<=r)){var g=f<r?r:f,v=h>i?i:h;if(!1===t.call(n,g,v))return!1}}a=o?s.getStartOfNextDay(a,!1,l):s.getEndOfPreviousDay(a,l),l=!0}}},{key:"calculateDuration",value:function(e,t,n){var r=0;return this.forEachAvailabilityInterval({startDate:e,endDate:t},(function(e,t){var n=e.getTimezoneOffset()-t.getTimezoneOffset();r+=t-e+60*n*1e3})),this.convertMSDurationToUnit(r,n)}},{key:"getHolidaysRanges",value:function(e,t,n){if(e>t)throw new Error("startDate can't be bigger than endDate");e=ft.clearTime(e),t=ft.clearTime(t);var r,i,o=[];for(i=e;i<t;i=ft.getNext(i,"day",1))if(this.isHoliday(i)||this.weekendsAreWorkdays&&n&&this.isWeekend(i)){var a=this.getCalendarDay(i),s=a&&a.cls||this.defaultNonWorkingTimeCssCls,l=ft.getNext(i,"day",1);r?r.cls.isEqual(s)?r.endDate=l:(o.push(r),r=new zg({startDate:i,endDate:l,cls:s})):r=new zg({startDate:i,endDate:l,cls:s})}else r&&(o.push(r),r=null);return r&&o.push(r),o}},{key:"calculateEndDate",value:function(e,t,n){if(!t)return new Date(e);var r,i=ft,o=0===(t=this.convertDurationToMs(t,n))&&i.clearTime(e,!0)-e==0?i.add(e,-1,"day"):e;return this.forEachAvailabilityInterval({startDate:o},(function(e,n){var i=n-e,o=e.getTimezoneOffset()-n.getTimezoneOffset();if(i>=t)return r=new Date(e-0+t),!1;t-=i+60*o*1e3})),r}},{key:"skipNonWorkingTime",value:function(e,t){var n=!1;if(this.forEachAvailabilityInterval(t?{startDate:e}:{endDate:e,isForward:!1},(function(r,i){return e=t?r:i,n=!0,!1})),!n)throw new Error("skipNonWorkingTime: Cannot skip non-working time, please ensure that this calendar has any working period of time specified");return new Date(e)}},{key:"calculateStartDate",value:function(e,t,n){return t?(t=this.convertDurationToMs(t,n),this.forEachAvailabilityInterval({endDate:e,isForward:!1},(function(e,n){var i=n-e;if(i>=t)return r=new Date(n-t),!1;t-=i})),r):new Date(e);var r}},{key:"skipWorkingTime",value:function(e,t,n){return t>=0?this.calculateEndDate(e,t,n):this.calculateStartDate(e,-t,n)}},{key:"isChildOf",value:function(e){for(var t=this,n=!1;t&&!n;)n=t===e,t=t.parent;return n}},{key:"getParentableCalendars",value:function(){var e=this;return r.getAllCalendars().reduce((function(t,n){return n===e||n.isChildOf(e)||t.push({id:n.calendarId,name:n.name||n.calendarId}),t}),[])}},{key:"getAvailabilityIntervalsFor",value:function(e,t){return e=t?e.valueOf():e instanceof Date?new Date(e.getFullYear(),e.getMonth(),e.getDate()).valueOf():ft.clearTime(new Date(e)).valueOf(),this.availabilityIntervalsCache[e]=this.availabilityIntervalsCache[e]||this.getCalendarDay(e).getAvailabilityIntervalsFor(e)}},{key:"onParentDestroy",value:function(){this.parent=null}},{key:"isAvailabilityIntersected",value:function(e,t,n){for(var r,i,o,a,s=0;s<7;s++)if(r=this.getWeekDay(s)||this.getDefaultCalendarDay(s),o=e.getWeekDay(s)||e.getDefaultCalendarDay(s),r&&o){i=r.getAvailability(),a=o.getAvailability();for(var l=0,c=i.length;l<c;l++)for(var u=0,d=a.length;u<d;u++)if(a[u].startTime<i[l].endTime&&a[u].endTime>i[l].startTime)return!0}var f=!1;return this.forEachNonStandardWeek((function(e){return!(e.startDate>=n)&&(t<e.endDate?(f=!0,!1):void 0)})),f}},{key:"calendarId",get:function(){return this._calendarId},set:function(e){var t=this;t._calendarId=e,t.storeId=null!=e?"GNT_CALENDAR:"+e:null,t.params=Object.assign(t.params||{},{calendarId:e})}},{key:"parent",set:function(e){var t=this,n=r.getCalendar(e);if(e&&!n)throw new Error("Invalid parent specified for the calendar");if(t.parent!=n){var i={calendarchange:t.clearCache,destroy:t.onParentDestroy,thisObj:t},o=t.parent;o&&o.un(i),t._parent=n,n&&n.on(i),t.params=Object.assign(t.params||{},{parentId:n?n.calendarId:null}),t.clearCache(),t.trigger("parentChange",{newParent:n,oldParent:o})}},get:function(){return this._parent}}],[{key:"getCalendar",value:function(e){return e instanceof r?e:ga.getStore(e)}},{key:"defaultConfig",get:function(){return{modelClass:Bg,daysPerMonth:30,daysPerWeek:7,hoursPerDay:24,unitsInMs:null,defaultNonWorkingTimeCssCls:"b-nonworkingtime",weekendsAreWorkdays:!1,weekendFirstDay:6,weekendSecondDay:0,holidaysCache:null,availabilityIntervalsCache:null,daysIndex:null,weekAvailability:null,defaultWeekAvailability:null,nonStandardWeeksByStartDate:null,nonStandardWeeksStartDates:null,calendarId:null,parent:null,defaultAvailability:["00:00-24:00"],name:null,suspendCacheUpdate:0,availabilitySearchLimit:1825}}},{key:"allCalendars",get:function(){return(ga.stores||[]).filter((function(e){return e instanceof r}))}}]),r}(ka);function Ug(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Wg._$name="Calendar";function Gg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Yg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Gg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventStore;return e&&e.getEventsForResource(this)||[]}},{key:"isAbove",value:function(e){var t,n,r,i,o,a=this,s=a.resourceStore;if(a===e)return!1;if(s.tree){for(t=a,n=[];t;)n.push(t),t=t.parentNode;for(t=e,r=[];t;)r.push(t),t=t.parentNode;for(i=0;i<n.length-1&&i<r.length-1&&n[i]==r[i];)++i;return o=n[i],a=n[i+1],e=r[i+1],o.indexOf(a)<o.indexOf(e)}return s.indexOf(a)<s.indexOf(e)}},{key:"unassignAll",value:function(e){var t=this;this.events&&this.events.slice().forEach((function(n){return n.unassign(t,e)}))}},{key:"resourceStore",get:function(){return this.stores&&this.stores[0]}},{key:"eventStore",get:function(){var e=this.resourceStore;return e&&e.eventStore||this.parentNode&&this.parentNode.eventStore}},{key:"assignmentStore",get:function(){var e=this.eventStore;return e&&e.assignmentStore}},{key:"events",get:function(){return this.eventStore&&this.eventStore.getEventsForResource(this)}},{key:"isPersistable",get:function(){var e=this.parentNode;return!e||!e.phantom||e.isRoot&&e.isRoot()}}],[{key:"fields",get:function(){return[{name:"name",type:"string",persist:!0},"eventColor","eventStyle","imageUrl","image"]}}]),r}(gd);function $g(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return qg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qg(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function qg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Yg.exposeProperties(),Yg._$name="ResourceModel";var Kg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Xg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){if(se()(J()(r.prototype),"construct",this).call(this,e),this.modelClass!==Yg&&!(this.modelClass.prototype instanceof Yg))throw new Error("Model for ResourceStore must subclass ResourceModel")}},{key:"remove",value:function(e){var t,n=$g(e=Array.isArray(e)?e:[e]);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.getById(i).unassignAll(!0)}}catch(e){n.e(e)}finally{n.f()}se()(J()(r.prototype),"remove",this).call(this,e)}},{key:"removeAll",value:function(){this.traverse((function(e){return e.unassignAll(!0)})),se()(J()(r.prototype),"removeAll",this).call(this)}}],[{key:"defaultConfig",get:function(){return{loadPriority:200,syncPriority:100,modelClass:Yg,storeId:"resources",autoTree:!0}}}]),r}(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ug()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getScheduledEventsInTimeSpan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.eventStore;return this.reduce((function(r,i){r.concat(n.getEventsForResource(i).reduce((function(n,r){r.intersectsRange(e,t)&&n.push(r)})))}))}},{key:"eventStore",get:function(){return this._eventStore},set:function(e){var t=this;if(t._eventStore!==e){var n=t._eventStore;t._eventStore=e||null,e&&!e.resourceStore&&(e.resourceStore=t),t.trigger("eventStoreChange",{newEventStore:e,oldEventStore:n})}}}]),r}(e||G)}(ka));function Jg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Kg._$name="ResourceStore";var Qg=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Jg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onEventStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onResourceStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onAssignmentStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onDependencyStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"removeNonPersistableRecordsToCreate",value:function(e){var t,n,r=e.added||[];for(n=r.length-1;n>=0;--n)(t=r[n]).isPersistable||r.splice(r.indexOf(t),1);0===r.length&&(e.added.length=0)}},{key:"shallContinueSync",value:function(e){return Boolean(e.added&&e.added.length>0||e.modified&&e.modified.length>0||e.removed&&e.removed.length>0)}},{key:"eventStore",set:function(e){var t=this;t.eventStoreDetacher&&t.eventStoreDetacher(),t._eventStore=e,e&&e.autoCommit&&(t.eventStoreDetacher=e.on({beforecommit:t.onEventStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._eventStore}},{key:"resourceStore",set:function(e){var t=this;t.resourceStoreDetacher&&t.resourceStoreDetacher(),t._resourceStore=e,e&&e.autoCommit&&(t.resourceStoreDetacher=e.on({beforecommit:t.onResourceStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._resourceStore}},{key:"assignmentStore",set:function(e){var t=this;t.assignmentStoreDetacher&&t.assignmentStoreDetacher(),t._assignmentStore=e,e&&e.autoSync&&(t.assignmentStoreDetacher=e.on({beforecommit:t.onAssignmentStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._assignmentStore}},{key:"dependencyStore",set:function(e){var t=this;t.dependencyStoreDetacher&&t.dependencyStoreDetacher(),t._dependencyStore=e,e&&e.autoSync&&(t.dependencyStoreDetacher=e.on({beforecommit:t.onDependencyStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._dependencyStore}}]),r}(G);function Zg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Qg._$name="ModelPersistencyManager";function ev(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var tv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ev()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"cancel",value:function(){var e=this.delayedCalls;if(e){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=n.length?n:Object.keys(e),o=i.length-1;o>=0;o--){var a=i[o],s=e[a];s&&s.timer&&(this.clearTimeout(s.timer),s.timer=null)}}}},{key:"invoke",value:function(e){var t=e.id,n=e.scope,r=e.beforeFn,i=L.capitalizeFirstLetter(t);this.trigger("delayed".concat(i,"Start"),e),r&&r.call(n,e);for(var o,a=e.afterFn,s=e.fn,l=e.entries,c=[];o=l.shift();)c.push(s.call.apply(s,[n,e].concat(Z()(o))));return a&&a.call(n,e),this.trigger("delayed".concat(i,"End"),e),e.delete(),c}},{key:"execute",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(n,r){var i=e;i.delayedCalls=i.delayedCalls||{};var o=t.id,a=t.args,s=t.timeout;i.delayedCalls[o]||(i.delayedCalls[o]=Object.assign({delete:function(){return delete i.delayedCalls[o]},entries:[],scope:e,id:o},t),delete i.delayedCalls[o].args);var l=i.delayedCalls[o];i.cancel(o),l.entries.push(a||[]),l.timer=i.setTimeout((function(){l.results=i.invoke(l),n(l)}),s||i.delayedCallTimeout)}))}},{key:"delayedCallTimeout",get:function(){return isNaN(this._delayedCallTimeout)?100:this._delayedCallTimeout},set:function(e){this._delayedCallTimeout=e}}]),r}(or(pe()));function nv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}tv._$name="DelayedCallsManager";var rv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(nv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"forEachDate",value:function(e){var t=e.recurrence,n=e.fn,r=e.scope,i=void 0===r?this:r,o=t.timeSpan,a=t.endDate,s=t.interval,l=o.startDate,c=e.startDate||l,u=e.endDate||a,d=t.count,f=0;a&&u&&u>a&&(u=a),l>c&&(c=l);var h=c-l,g=864e5*s,v=Math.floor(h/g);u||d||(d=this.MAX_OCCURRENCES_COUNT);for(var p=ft.add(l,v,"day");(!u||p<=u)&&(f++,!(p>=c&&(u&&p>u||!1===n.call(i,p,f)||d&&f>=d)));)p=ft.add(p,s,"day")}},{key:"frequency",get:function(){return"DAILY"}}]),r}(Og);function iv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}rv._$name="DailyRecurrenceIterator";var ov=/^([+-]?[0-9])?(SU|MO|TU|WE|TH|FR|SA)$/,av=["SU","MO","TU","WE","TH","FR","SA"],sv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(iv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"decodeDay",value:function(e){var t,n;return(t=ov.exec(e))&&(n=[av.indexOf(t[2])],t[1]&&(t[1]=parseInt(t[1],10),n.push(t[1]))),n}},{key:"encodeDay",value:function(e){var t;if(Array.isArray(e)){var n=e,r=te()(n,2);e=r[0],t=r[1]}return(t?t.toString():"")+av[e]}},{key:"decode",value:function(e){var t,n=[];if(e)for(var r=0;r<e.length;r++)(t=this.decodeDay(e[r]))&&n.push(t);return n}},{key:"encode",value:function(e){var t,n=[];if(e)for(var r=0;r<e.length;r++)(t=this.encodeDay(e[r]))&&n.push(t);return n}}]),r}(G);function lv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}sv._$name="RecurrenceDayRuleEncoder";var cv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(lv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"forEachDate",value:function(e){var t,n,r=e.fn,i=e.recurrence,o=e.scope,a=void 0===o?this:o,s=i.timeSpan,l=i.interval,c=i.days,u=i.endDate,d=s.startDate,f=0,h=e.startDate||d,g=e.endDate||u,v=i.count,p=sv.decode(c);for(u&&g&&g>u&&(g=u),p&&p.length?p.sort((function(e,t){return e[0]-t[0]})):p=[[d.getDay()]],d>h&&(h=d),t=ft.getNext(v?d:h,"week",0,0),g||v||(v=this.MAX_OCCURRENCES_COUNT);!g||t<=g;){for(var y=0;y<p.length;y++)if((n=ft.copyTimeValues(ft.add(t,p[y][0],"day"),d))>=d&&(f++,n>=h&&(g&&n>g||!1===r.call(a,n,f)||v&&f>=v)))return;t=ft.getNext(t,"week",l,0)}}},{key:"frequency",get:function(){return"WEEKLY"}}]),r}(Og);function uv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}cv._$name="WeeklyRecurrenceIterator";var dv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(uv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"getNthDayOfMonth",value:function(e,t){var n=ft.daysInMonth(e),r=null;return t&&Math.abs(t)<=n&&(r=new Date(e.getFullYear(),e.getMonth(),t<0?n+t+1:t)),r}},{key:"isValidPosition",value:function(e){return e&&Math.abs(e)>0&&Math.abs(e)<=31}},{key:"forEachDate",value:function(e){var t,n,r,i,o,a,s=this,l=e.fn,c=e.recurrence,u=e.scope,d=void 0===u?s:u,f=c.timeSpan,h=c.interval,g=c.days,v=c.endDate,p=c.count,y=c.positions,m=f.startDate,b=sv.decode(g),k=y&&y.length,w={},S=e.startDate||m,C=e.endDate||v,R=c.monthDays,x=0;for(v&&C&&C>v&&(C=v),m>S&&(S=m),n=ft.startOf(p?m:S,"month"),r=new Date(ft.getNext(n,"month",1)-1),R&&R.length||b&&b.length||(R=[m.getDate()]),b&&b.length&&b.forEach((function(e){e[1]&&((t=t||{})[e[0]]=e[1])}));(!C||C>=n)&&(!p||x<p);){if(i=[],b&&b.length){if(b.forEach((function(e){var t=e[0],l=1,c=53;for(e[1]&&(l=c=e[1]),a=l;a<=c;a++)(o=s.getNthDayInPeriod(n,r,t,a))&&(o=ft.copyTimeValues(o,m),w[o.getTime()]||(w[o.getTime()]=!0,i.push(o)))})),i.sort((function(e,t){return e-t})),!k)for(a=0;a<i.length;a++)if((o=i[a])>=m&&(x++,o>=S&&(C&&o>C||!1===l.call(d,o,x)||p&&x>=p)))return!1}else{var E=[];for(a=0;a<R.length;a++)(o=s.getNthDayOfMonth(n,R[a]))&&!w[o.getTime()]&&(w[o.getTime()]=!0,E.push(o));for(E.sort((function(e,t){return e-t})),a=0;a<E.length;a++)if(o=ft.copyTimeValues(E[a],m),k)i.push(o);else if(o>=m&&(x++,o>=S&&(C&&o>C||!1===l.call(d,o,x)||p&&x>=p)))return}k&&i.length&&s.forEachDateAtPositions(i,y,(function(e){if(e>=m&&(x++,e>=S&&(!C||e<=C)&&(!1===l.call(d,e,x)||p&&x>=p)))return!1})),n=ft.getNext(n,"month",h),r=new Date(ft.getNext(n,"month",1)-1)}}},{key:"frequency",get:function(){return"MONTHLY"}}]),r}(Og);function fv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}dv._$name="MonthlyRecurrenceIterator";var hv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(fv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"forEachDate",value:function(e){var t,n,r,i,o,a,s=this,l=e.fn,c=e.recurrence,u=e.scope,d=void 0===u?s:u,f=c.timeSpan,h=c.interval,g=c.days,v=c.count,p=c.positions,y=c.endDate,m=f.startDate,b=sv.decode(g),k=p&&p.length,w={},S=e.startDate||m,C=e.endDate||y,R=c.months,x=0;for(y&&C&&C>y&&(C=y),m>S&&(S=m),i=ft.startOf(v?m:S,"year"),o=new Date(ft.getNext(i,"year",1)-1),R&&R.sort((function(e,t){return e-t})),R&&R.length||b&&b.length||(R=[m.getMonth()+1]),b&&b.length&&b.forEach((function(e){e[1]&&((a=a||{})[e[0]]=e[1])}));(!C||C>=i)&&(!v||x<v);){if(r=[],b&&b.length){if(b.forEach((function(e){var a=e[0],l=1,c=53;for(e[1]&&(l=c=e[1]),t=l;t<=c;t++)(n=s.getNthDayInPeriod(i,o,a,t))&&(n=ft.copyTimeValues(n,m),w[n.getTime()]||(w[n.getTime()]=!0,r.push(n)))})),r.sort((function(e,t){return e-t})),!k)for(t=0;t<r.length;t++)if((n=r[t])>=m&&(x++,n>=S&&(C&&n>C||!1===l.call(d,n,x)||v&&x>=v)))return}else for(t=0;t<R.length;t++)if((n=s.buildDate(i.getFullYear(),R[t]-1,m.getDate()))&&(n=ft.copyTimeValues(n,m),!w[n.getTime()]))if(w[n.getTime()]=!0,k)r.push(n);else if(n>=m&&(x++,n>=S&&(C&&n>C||!1===l.call(d,n,x)||v&&x>=v)))return;k&&r.length&&s.forEachDateAtPositions(r,p,(function(e){if(e>=m&&(x++,e>=S&&(!C||e<=C)&&(!1===l.call(d,e,x)||v&&x>=v)))return!1})),i=ft.getNext(i,"year",h),o=new Date(ft.getNext(i,"year",1)-1)}}},{key:"frequency",get:function(){return"YEARLY"}}]),r}(Og);function gv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}hv._$name="YearlyRecurrenceIterator";var vv=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(gv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"setupRecurringTimeSpans",value:function(){var e=this;e.recurrenceIterators=e.recurrenceIterators||[],e.addRecurrenceIterators(rv,cv,dv,hv),e.relayEvents(e.delayedCallsManager,["delayedRegenerateOccurrencesStart","delayedRegenerateOccurrencesEnd","delayedGenerateOccurrencesStart","delayedGenerateOccurrencesEnd"]),e.delayedCallsManager.on({delayedRegenerateOccurrencesEnd:e.onDelayedRegenerateOccurrencesFinish,delayedGenerateOccurrencesEnd:e.onDelayedGenerateOccurrencesFinish,thisObj:e})}},{key:"doDestroy",value:function(){this.delayedCallsManager.destroy()}},{key:"addRecurrenceIterators",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){return e.recurrenceIterators[t.frequency]=t}))}},{key:"getRecurrenceIteratorForTimeSpan",value:function(e){return this.recurrenceIterators[e.recurrence.frequency]}},{key:"buildOccurrencesForTimeSpan",value:function(e,t,n,r){var i=[];if(e.isRecurring&&e.startDate){var o=e.recurrence,a=this.getRecurrenceIteratorForTimeSpan(e),s=e.exceptionDates?e.exceptionDates.reduce((function(e,t){return e[t.getTime()]=!0,e}),{}):{};a.forEachDate({recurrence:o,startDate:t,endDate:n,fn:function(t){s[t.getTime()]||r&&e.getOccurrenceByStartDate(t)||i.push(e.buildOccurrence(t))}})}return i}},{key:"mergeDelayedCallEntries",value:function(e){for(var t,n,r,i,o,a=e.entries,s={},l=0;l<a.length;l++){var c=o=a[l],u=te()(c,3);r=u[0],t=u[1],n=u[2];for(var d=0;d<r.length;d++){var f=s[(i=r[d]).id];f?(f[1]>t&&(f[1]=t),f[2]<n&&(f[2]=n)):s[i.id]=[[i]].concat(Z()(o.slice(1)))}}a=Object.values(s);for(var h={},g=0;g<a.length;g++){var v=o=a[g],p=te()(v,3);i=p[0],t=p[1],n=p[2];var y=(t?t.getTime():"")+"-"+(n?n.getTime():"");h[y]?h[y][0]=h[y][0].concat(i):h[y]=o}e.entries=Object.values(h)}},{key:"regenerateOccurrencesForTimeSpansBuffered",value:function(e,t,n){var r=this;return Array.isArray(e)||(e=[e]),(e=e.filter((function(e){return e.isRecurring}))).length?new Promise(function(){var i=ta()(Zo.a.mark((function i(o,a){var s;return Zo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.delayedCallsManager.execute({id:"regenerateOccurrences",beforeFn:r.mergeDelayedCallEntries,args:[e,t,n],fn:function(e,t,n,i){var o=e.toRemove=e.toRemove||[];o.push.apply(o,Z()(r.getOccurrencesForTimeSpans(t))),e.added=r.generateOccurrencesForTimeSpans(t,n,i,!1)},afterFn:function(e){var t=e.toRemove;t.length&&(e.removed=r.remove(t))}});case 2:s=i.sent,o({added:s.added,removed:s.removed});case 4:case"end":return i.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}()):Promise.resolve()}},{key:"generateOccurrencesForTimeSpansBuffered",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this;return Array.isArray(e)||(e=[e]),(e=e.filter((function(e){return e.isRecurring}))).length?new Promise(function(){var o=ta()(Zo.a.mark((function o(a){var s;return Zo.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,i.delayedCallsManager.execute({id:"generateOccurrences",beforeFn:i.mergeDelayedCallEntries,args:[e,t,n,r],fn:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.added=i.generateOccurrencesForTimeSpans.apply(i,n)}});case 2:s=o.sent,a({added:s.added});case 4:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()):Promise.resolve()}},{key:"generateOccurrencesForTimeSpans",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=[];if(e){var o=this,a=[];if(Array.isArray(e)||(e=[e]),e.length){for(var s=0;s<e.length;s++){var l=e[s],c=void 0,u=void 0,d=void 0;(a=o.buildOccurrencesForTimeSpan(l,t,n,r))&&(t<=(d=l.startDate)&&(u=a.shift())&&(c=u.startDate)-d&&(l.setStartEndDate(c,u.endDate),l.recurrence.sanitize()),i.push.apply(i,Z()(a)))}i.length&&o.add(i)}}return i}},{key:"generateOccurrencesForAll",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.getRecurringTimeSpans(),o=[];return i.length&&(r.trigger("generateOccurrencesAllStart",{timeSpans:i,startDate:e,endDate:t,preserveExisting:n}),o=r.generateOccurrencesForTimeSpans(i,e,t,n),r.trigger("generateOccurrencesAllEnd",{timeSpans:i,startDate:e,endDate:t,preserveExisting:n})),o}},{key:"getRecurringTimeSpans",value:function(){return this.query((function(e){return e.supportsRecurring&&e.isRecurring}))}},{key:"getOccurrencesForTimeSpans",value:function(e){var t=this,n=[];if(Array.isArray(e)||(e=[e]),e.length)for(var r=function(r){var i=e[r].id;n.push.apply(n,Z()(t.query((function(e){return e.supportsRecurring&&e.recurringTimeSpanId==i}))))},i=0;i<e.length;i++)r(i);return n}},{key:"getOccurrencesForAll",value:function(){return this.query((function(e){return e.supportsRecurring&&e.isOccurrence}))}},{key:"removeOccurrencesForTimeSpans",value:function(e){return this.remove(this.getOccurrencesForTimeSpans(e))}},{key:"removeOccurrencesForAll",value:function(){return this.remove(this.getOccurrencesForAll())}},{key:"onDelayedRegenerateOccurrencesFinish",value:function(){this.trigger("occurrencesReady")}},{key:"onDelayedGenerateOccurrencesFinish",value:function(){this.trigger("occurrencesReady")}},{key:"supportsRecurringTimeSpans",get:function(){return!0}},{key:"delayedCallTimeout",get:function(){return isNaN(this._delayedCallTimeout)?100:this._delayedCallTimeout},set:function(e){this._delayedCallTimeout=e}},{key:"delayedCallsManager",get:function(){return this._delayedCallsManager=this._delayedCallsManager||new tv({delayedCallTimeout:this.delayedCallTimeout}),this._delayedCallsManager}}],[{key:"$name",get:function(){return"RecurringTimeSpansMixin"}}]),r}(e||G)};function pv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var yv=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(pv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"setupRecurringEvents",value:function(){return this.setupRecurringTimeSpans.apply(this,arguments)}},{key:"generateOccurrencesForEvents",value:function(){return this.generateOccurrencesForTimeSpans.apply(this,arguments)}},{key:"generateOccurrencesForEventsBuffered",value:function(){return this.generateOccurrencesForTimeSpansBuffered.apply(this,arguments)}},{key:"regenerateOccurrencesForEvents",value:function(){return this.regenerateOccurrencesForTimeSpans.apply(this,arguments)}},{key:"regenerateOccurrencesForEventsBuffered",value:function(){return this.regenerateOccurrencesForTimeSpansBuffered.apply(this,arguments)}},{key:"getRecurringEvents",value:function(){return this.getRecurringTimeSpans()}},{key:"getOccurrencesForEvents",value:function(e){return this.getOccurrencesForTimeSpans(e)}},{key:"removeOccurrencesForEvents",value:function(e){return this.removeOccurrencesForTimeSpans(e)}},{key:"isEventPersistable",value:function(e){return se()(J()(r.prototype),"isEventPersistable",this).call(this,e)&&(!e.supportsRecurring||!e.isOccurrence)}},{key:"supportsRecurringEvents",get:function(){return!0}}],[{key:"$name",get:function(){return"RecurringEventsMixin"}}]),r}(vv(e||G))};function mv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function bv(e){return e?"string"==typeof e&&(e=e.split(",").map((function(e){return parseInt(e,10)}))):e=null,e}function kv(e){return e?"string"==typeof e&&(e=e.split(",")):e=null,e}function wv(e,t){return String(e)===String(t)}function Sv(e){return this.defaultValue&&void 0===e?this.defaultValue:this.allowNull&&null==e?null:(e=parseInt(e),isNaN(e)&&(e=void 0),e)}var Cv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(mv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=e.rule,i=e.timeSpan;t._suspendedTimeSpanNotifying=0,delete e.timeSpan,delete e.rule,se()(J()(r.prototype),"construct",this).apply(this,arguments),n&&(t.suspendTimeSpanNotifying(),t.rule=n,t.resumeTimeSpanNotifying()),t.timeSpan=i}},{key:"sanitize",value:function(){var e=this,t=e.timeSpan,n=t&&t.startDate;switch(e.beginBatch(),e.isSanitizing=!0,e.frequency){case"DAILY":e.positions=null,e.days=null,e.monthDays=null,e.months=null;break;case"WEEKLY":e.positions=null,e.monthDays=null,e.months=null;var r=e.days;n&&r&&1==r.length&&r[0]==sv.encodeDay(n.getDay())&&(e.days=null);break;case"MONTHLY":e.monthDays&&e.monthDays.length&&(e.positions=null,e.days=null),e.months=null;var i=e.monthDays;n&&i&&1==i.length&&i[0]==n.getDate()&&(e.monthDays=null);break;case"YEARLY":e.monthDays=null;var o=e.months;n&&o&&1==o.length&&o[0]==n.getMonth()+1&&(e.months=null)}e.isSanitizing=!1,e.endBatch()}},{key:"copy",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=(e=se()(J()(r.prototype),"copy",this)).call.apply(e,[this].concat(n));return o.dateFormat=this.dateFormat,o.timeSpan=this.timeSpan,o}},{key:"afterChange",value:function(e,t,n){var i=se()(J()(r.prototype),"afterChange",this).call(this,e,t,n);this.isSanitizing||this.sanitize();var o=this.timeSpan;return o&&!this.isTimeSpanNotifyingSuspended&&o.onRecurrenceChanged(),i}},{key:"suspendTimeSpanNotifying",value:function(){this._suspendedTimeSpanNotifying++}},{key:"resumeTimeSpanNotifying",value:function(){this._suspendedTimeSpanNotifying&&this._suspendedTimeSpanNotifying--}},{key:"isRecurrenceModel",get:function(){return!0}},{key:"dateFormat",get:function(){return this._dateFormat||"YYYYMMDDTHHmmss"},set:function(e){this._dateFormat=e}},{key:"timeSpan",get:function(){return this._timeSpan},set:function(e){this._timeSpan=e}},{key:"rule",get:function(){var e=this,t=[];return e.frequency&&(t.push("FREQ=".concat(e.frequency)),e.interval>1&&t.push("INTERVAL=".concat(e.interval)),e.days&&e.days.length&&t.push("BYDAY="+e.days.join(",")),e.monthDays&&e.monthDays.length&&t.push("BYMONTHDAY="+e.monthDays.join(",")),e.months&&e.months.length&&t.push("BYMONTH="+e.months.join(",")),e.count&&t.push("COUNT=".concat(e.count)),e.endDate&&t.push("UNTIL="+ft.format(e.endDate,e.dateFormat)),e.positions&&e.positions.length&&t.push("BYSETPOS="+e.positions.join(","))),t.join(";")},set:function(e){var t=this;if(t.beginBatch(),e){for(var n=e.split(";"),r=0,i=n.length;r<i;r++){var o=n[r].split("="),a=o[1];switch(o[0]){case"FREQ":t.frequency=a;break;case"INTERVAL":t.interval=a;break;case"COUNT":t.count=a,t.until=null;break;case"UNTIL":t.endDate=a?ft.parse(a,t.dateFormat):null,t.count=null;break;case"BYDAY":t.days=a;break;case"BYMONTHDAY":t.monthDays=a;break;case"BYMONTH":t.months=a;break;case"BYSETPOS":t.positions=a}}t.sanitize()}else t.set({frequency:null,interval:null,count:null,endDate:null,days:null,monthDays:null,months:null,positions:null});t.endBatch()}},{key:"count",get:function(){return this.get("count")},set:function(e){e&&(this.endDate=null),this.set("count",e)}},{key:"endDate",get:function(){return this.get("endDate")},set:function(e){e&&(this.count=null),this.set("endDate",e)}},{key:"isTimeSpanNotifyingSuspended",get:function(){return Boolean(this._suspendedTimeSpanNotifying)}}],[{key:"fields",get:function(){return[{name:"frequency",defaultValue:"DAILY"},{name:"interval",defaultValue:1,convert:Sv},{name:"endDate",type:"date"},{name:"count",allowNull:!0,convert:Sv},{name:"days",convert:kv,isEqual:wv},{name:"monthDays",convert:bv,isEqual:wv},{name:"months",convert:bv,isEqual:wv},{name:"positions",convert:bv,isEqual:wv}]}}]),r}(Io);function Rv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Cv._$name="RecurrenceModel";function xv(e){if(e){var t=this.dateFormat;e=(e="string"==typeof e?e.split(","):e).map((function(e){return"string"==typeof e&&(e=ft.parse(e,t)),e}))}return e}var Ev=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Rv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"setRecurrence",value:function(e,t,n){var r,i;e&&(e.isRecurrenceModel?r=e:"string"==typeof e?((r=new this.recurrenceModel).frequency=e,t&&(r.interval=t),n&&(n instanceof Date?r.endDate=n:r.count=n)):r=new this.recurrenceModel(e),r.timeSpan=this,i=r.rule),this.recurrence=r,this.recurrenceRule=i}},{key:"getOccurrenceByStartDate",value:function(e){var t,n;if(e){n=this.occurrences;for(var r=0;r<n.length;r++)if(n[r].startDate-e==0){t=n[r];break}}return t}},{key:"removeOccurrences",value:function(){var e=this.stores[0];return e&&e.removeOccurrencesForTimeSpans&&e.removeOccurrencesForTimeSpans(this)}},{key:"onRecurrenceChanged",value:function(){this.recurrenceRule=this.recurrence&&this.recurrence.rule||null}},{key:"buildOccurrence",value:function(e){var t=this.copy(null);return t.beginBatch(),t.setStartDate(e),t.recurringTimeSpanId=this.id,t.endBatch(),t}},{key:"afterChange",value:function(e,t,n){var i;"recurrenceRule"in t&&(this._recurrence=null);for(var o=arguments.length,a=new Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];return(i=se()(J()(r.prototype),"afterChange",this)).call.apply(i,[this,e,t,n].concat(a))}},{key:"addExceptionDate",value:function(e){var t=this.exceptionDates||[];e&&(this.exceptionDates=t.concat(e))}},{key:"beforeStartDateChange",value:function(){this._startDateValue=this.startDate}},{key:"afterStartDateChange",value:function(){this._startDateValue-this.startDate&&this.exceptionDates&&(this.exceptionDates=null)}},{key:"supportsRecurring",get:function(){return!0}},{key:"recurrenceModel",get:function(){return this._recurrenceModel||Cv},set:function(e){this._recurrenceModel=e}},{key:"recurrence",get:function(){var e=this,t=e.recurrenceRule;return!e._recurrence&&t&&(e._recurrence=new e.recurrenceModel({rule:t,timeSpan:e})),e._recurrence},set:function(e){var t,n=this;if(n.isOccurrence){var r=n.recurringTimeSpan;t=r&&r.recurrence,n.recurringTimeSpanId=null}e&&t&&(t.endDate=new Date(n.startDate-1)),n._recurrence=e,e?(e.timeSpan=n,n.recurrenceRule=e.rule):n.recurrenceRule=null}},{key:"isRecurring",get:function(){return this.recurrence&&!this.isOccurrence}},{key:"isOccurrence",get:function(){return Boolean(this.recurringTimeSpanId)}},{key:"recurringTimeSpan",get:function(){var e=this.recurringTimeSpanId,t=this.stores[0];return e&&t&&t.getById(e)}},{key:"occurrences",get:function(){var e=this.stores[0];return e&&e.getOccurrencesForTimeSpans&&e.getOccurrencesForTimeSpans(this)}}],[{key:"fields",get:function(){return[{name:"recurringTimeSpanId"},{name:"recurrenceRule"},{name:"exceptionDates",convert:xv}]}}]),r}(e||zg)};function Dv(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Tv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tv(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Tv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Av=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Mv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"forEachResource",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=Dv(this.resources);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!1===e.call(n,i))return}}catch(e){r.e(e)}finally{r.f()}}},{key:"getResource",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.resourceId,t=this,n=t.eventStore,r=n&&n.resourceStore;if(n&&e){var i=n.getResourcesForEvent(t);if(1==i.length)return i[0];if(i.length>1)throw new Error("Event::getResource() is not applicable for events with multiple assignments, please use Event::resources instead.");return null}if(r)return r?r.getById(e):null}},{key:"assign",value:function(e){var t=this.eventStore;e=Io.asId(e),t?t.assignEventToResource(this,e):this.resourceId=e}},{key:"unassign",value:function(e,t){var n=this,r=n.eventStore;e=Io.asId(e),n.meta.removingResource=t,r?r.unassignEventFromResource(n,e):n.resourceId==e&&(n.resourceId=null),n.meta.removingResource=null}},{key:"reassign",value:function(e,t){var n=this.eventStore;e=Io.asId(e),t=Io.asId(t),n?n.reassignEventFromResourceToResource(this,e,t):this.resourceId=t}},{key:"isAssignedTo",value:function(e){var t=this.eventStore;return e=Io.asId(e),t?t.isEventAssignedToResource(this,e):this.resourceId==e}},{key:"eventStore",get:function(){var e=this;return e._eventStore||(e._eventStore=e.stores&&e.stores.find((function(e){return e.isEventStore}))),e._eventStore}},{key:"resourceStore",get:function(){var e=this.eventStore;return e&&e.resourceStore}},{key:"assignmentStore",get:function(){var e=this.eventStore;return e&&e.assignmentStore}},{key:"resources",get:function(){return this.eventStore&&this.eventStore.getResourcesForEvent(this)||[]}},{key:"isEvent",get:function(){return!0}},{key:"isDraggable",get:function(){return this.draggable}},{key:"isResizable",get:function(){return!this.isMilestone&&this.resizable}},{key:"isPersistable",get:function(){var e=this.eventStore;return e&&e.isEventPersistable(this)}},{key:"recurringEvent",get:function(){return this.recurringTimeSpan}}],[{key:"fields",get:function(){return[{name:"resourceId"},{name:"draggable",type:"boolean",persist:!1,defaultValue:!0},{name:"resizable",persist:!1,defaultValue:!0},"eventStyle","eventColor","milestoneWidth"]}},{key:"relationConfig",get:function(){return[{relationName:"resource",fieldName:"resourceId",store:"resourceStore",collectionName:"events"}]}}]),r}(Ev());function Iv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Av.exposeProperties(),Av._$name="EventModel";var Fv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Iv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){if(se()(J()(r.prototype),"construct",this).call(this,e,!0),this.setupRecurringEvents(),this.modelClass!==Av&&!(this.modelClass.prototype instanceof Av))throw new Error("The model for the EventStore must subclass EventModel")}},{key:"append",value:function(e){this.add(e)}}],[{key:"defaultConfig",get:function(){return{loadPriority:100,syncPriority:200,modelClass:Av,storeId:"events"}}}]),r}(yv(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Zg()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e),Object.assign(this,{isEventStore:!0,autoTree:!0,modelPersistencyManager:this.createModelPersistencyManager()})}},{key:"createModelPersistencyManager",value:function(){return new Qg({eventStore:this,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore,dependencyStore:this.dependencyStore})}},{key:"getEventsInTimeSpan",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=[];return this.forEachScheduledEvent((function(o,a,s){(n&&ft.intersectSpans(a,s,e,t)||!n&&a-e>=0&&t-s>=0)&&(!r||o.resources.length>0)&&i.push(o)})),i}},{key:"getEventsByStartDate",value:function(e){var t=[];return this.forEachScheduledEvent((function(n,r,i){ft.isEqual(r,e,"day")&&t.push(n)})),t}},{key:"forEachScheduledEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.forEach((function(n){var r=n.startDate,i=n.endDate;if(r&&i)return e.call(t,n,r,i)}))}},{key:"getTotalTimeSpan",value:function(){var e=new Date(9999,0,1),t=new Date(0);return this.forEach((function(n){n.startDate&&(e=ft.min(n.startDate,e)),n.endDate&&(t=ft.max(n.endDate,t))})),e=e<new Date(9999,0,1)?e:null,t=t>new Date(0)?t:null,this.lastTotalTimeSpan={startDate:e||null,endDate:t||e||null}}},{key:"isEventPersistable",value:function(e){var t=!0;if(!this.assignmentStore){var n=e.stores[0],r=n&&n.crudManager;t=!n||(r||!e.resource||!e.resource.hasGeneratedId)}return t}},{key:"isDateRangeAvailable",value:function(e,t,n,r){if(n instanceof Pg){var i=n.event,o=i.resources,a=new Set(r.events);return o.forEach((function(e){e.events.forEach((function(e){return a.add(e)}))})),a.delete(i),!Array.from(a).some((function(n){return ft.intersectSpans(e,t,n.startDate,n.endDate)}))}return!this.getEventsForResource(r).some((function(r){return!(n===r||!ft.intersectSpans(e,t,r.startDate,r.endDate))}))}},{key:"filterEventsForResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;return e.getEvents(this).filter(t.bind(n))}},{key:"getResourcesForEvent",value:function(e){return this.assignmentStore?this.assignmentStore.getResourcesForEvent(e):(e=this.getById(e)).resource&&!e.resource.placeHolder?[e.resource]:[]}},{key:"getEventsForResource",value:function(e){if(this.assignmentStore)return this.assignmentStore.getEventsForResource(e);e=Io.asId(e);var t=this.relationCache.resource&&this.relationCache.resource[e];return t?t.slice():[]}},{key:"getAssignmentsForEvent",value:function(e){return this.assignmentStore&&this.assignmentStore.getAssignmentsForEvent(e)||[]}},{key:"getAssignmentsForResource",value:function(e){return this.assignmentStore&&this.assignmentStore.getAssignmentsForResource(e)||[]}},{key:"assignEventToResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.assignmentStore?this.assignmentStore.assignEventToResource(e,t,void 0,n):(e=this.getById(e),Array.isArray(t)&&(t=t[0]),e&&(e.resourceId=Io.asId(t)))}},{key:"unassignEventFromResource",value:function(e,t){this.assignmentStore?this.assignmentStore.unassignEventFromResource(e,t):(e=this.getById(e),t=Io.asId(t),e&&e.resourceId==t&&(e.resourceId=null))}},{key:"reassignEventFromResourceToResource",value:function(e,t,n){var r=this.assignmentStore,i=Io.asId(n),o=Io.asId(t);if(r){var a=r.getAssignmentForEventAndResource(e,t);a?a.resourceId=i:r.assignEventToResource(e,n)}else(e=this.getById(e)).resourceId==o&&(e.resourceId=i)}},{key:"isEventAssignedToResource",value:function(e,t){return this.assignmentStore?this.assignmentStore.isEventAssignedToResource(e,t):(e=this.getById(e),t=Io.asId(t),e&&e.resourceId==t||!1)}},{key:"removeAssignmentsForEvent",value:function(e){this.assignmentStore?this.assignmentStore.removeAssignmentsForEvent(e):(e=this.getById(e))&&(e.resourceId=null)}},{key:"removeAssignmentsForResource",value:function(e){var t=this.assignmentStore,n=this.resourceStore;t?t.removeAssignmentsForResource(e):n?e=n.getById(e):(e=Io.asId(e),this.forEach((function(t){return t.resourceId==e&&(t.resourceId=null)})))}},{key:"resourceStore",get:function(){return this._resourceStore},set:function(e){var t=this,n=t._resourceStore;n&&(n.eventStore=null,t.modelPersistencyManager&&(t.modelPersistencyManager.resourceStore=null)),t._resourceStore=e||null,e&&(t.modelPersistencyManager&&(t.modelPersistencyManager.resourceStore=t._resourceStore),e.eventStore=t),t.isConfiguring||t.initRelations(!0),(n||e)&&n!==e&&t.trigger("resourceStoreChange",{newResourceStore:e,oldResourceStore:n})}},{key:"assignmentStore",get:function(){return this._assignmentStore},set:function(e){var t=this,n=t._assignmentStore;n&&(n.eventStore=null,t.modelPersistencyManager&&(t.modelPersistencyManager.assignmentStore=null)),t._assignmentStore=e||null,e&&(t.modelPersistencyManager&&(t.modelPersistencyManager.assignmentStore=t._assignmentStore),e.eventStore=t),t.isConfiguring||t.initRelations(!0),(n||e)&&n!==e&&t.trigger("assignmentStoreChange",{newAssignmentStore:e,oldAssignmentStore:n})}},{key:"dependencyStore",get:function(){return this._dependencyStore},set:function(e){var t=this,n=t._dependencyStore;n&&(n.eventStore=null,t.modelPersistencyManager&&(t.modelPersistencyManager.dependencyStore=null)),t._dependencyStore=e||null,t._dependencyStore&&(t.modelPersistencyManager&&(t.modelPersistencyManager.dependencyStore=t._dependencyStore),t._dependencyStore.eventStore=t),(n||e)&&n!==e&&t.trigger("dependencyStoreChange",{newDependencyStore:e,oldDependencyStore:n})}}]),r}(e||G)}(ka)));function Ov(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Fv._$name="EventStore";var _v=["SS","SF","FS","FF"],Pv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ov()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).apply(this,arguments),e&&(e.from&&e.from instanceof zg&&(this.setSourceEvent(e.from),delete e.from),e.to&&e.to instanceof zg&&(this.setTargetEvent(e.to),delete e.to))}},{key:"getHardType",value:function(){return this.get("type")}},{key:"setHardType",value:function(e){var t;return e!==this.getHardType()&&(t=this.set({type:e,fromSide:null,toSide:null})),t}},{key:"setLag",value:function(e,t){1!==arguments.length?(e=parseFloat(e),this.set({lag:e,lagUnit:t})):"number"==typeof e?this.lag=e:(e=ft.parseDuration(e),this.set({lag:e.magnitude,lagUnit:e.unit}))}},{key:"getLag",value:function(){return this.lag?"".concat(this.lag<0?"-":"+").concat(Math.abs(this.lag)).concat(ft.getShortNameOfUnit(this.lagUnit)):""}},{key:"getSourceEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventStore;return!e&&this.unjoinedStores.length&&(e=this.leftProjectEventStore),e&&e.getById(this.from)}},{key:"getTargetEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventStore;return!e&&this.unjoinedStores.length&&(e=this.leftProjectEventStore),e&&e.getById(this.to)}},{key:"getDateRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.sourceEvent,n=this.targetEvent;if(t&&n&&t.isScheduled&&n.isScheduled){var i,o,a=r.Type;switch(this.type){case a.StartToStart:i=t.startDate,o=n.startDate;break;case a.StartToEnd:i=t.startDate,o=n.endDate;break;case a.EndToEnd:i=t.endDate,o=n.endDate;break;case a.EndToStart:i=t.endDate,o=n.startDate}return{start:e?i:ft.min(i,o),end:e?o:ft.max(i,o)}}return null}},{key:"highlight",value:function(e){var t=this.highlighted?this.highlighted.split(" "):[];t.includes(e)||(this.highlighted=t.concat(e).join(" "))}},{key:"unhighlight",value:function(e){var t=this.highlighted;if(t){var n=t.split(" "),r=n.findIndex((function(t){return t===e}));r>=0&&(n.splice(r,1),this.highlighted=n.join(" "))}}},{key:"isHighlightedWith",value:function(e){var t=this.highlighted;return t&&t.split(" ").includes(e)}},{key:"getConnectorString",value:function(e){var t=_v[this.type];if(e)return t;if(this.type===r.Type.EndToStart)return"";var n=Fe.locale;if(n){var i=n.Scheduler&&n.Scheduler[t];if(i)return i}return t}},{key:"toString",value:function(){return"".concat(this.from).concat(this.getConnectorString()).concat(this.getLag())}},{key:"isValid",value:function(e){var t=this.from,n=this.to;return"number"==typeof this.type&&t&&""!==t&&null!=n&&""!==n&&t!==n}},{key:"eventStore",get:function(){var e=this.stores,t=this.unjoinedStores;return e[0]&&e[0].eventStore||t[0]&&t[0].eventStore}},{key:"hardType",get:function(){return this.getHardType()},set:function(e){this.setHardType(e)}},{key:"lag",get:function(){return this.get("lag")},set:function(e){"number"==typeof e?this.set({lag:e}):this.setLag(e)}},{key:"fullLag",get:function(){return{unit:this.lagUnit,magnitude:this.lag}},set:function(e){"string"==typeof e?this.setLag(e):this.setLag(e.magnitude,e.unit)}},{key:"sourceEvent",set:function(e){this.from=e.id}},{key:"targetEvent",set:function(e){this.to=e.id}},{key:"isPersistable",get:function(){var e,t=this.stores,n=this.unjoinedStores,r=t[0];if(r){var i=this.getSourceEvent(),o=this.getTargetEvent(),a=r.crudManager;e=i&&(a||!i.hasGeneratedId)&&o&&(a||!o.hasGeneratedId)}else e=Boolean(n[0]);return e}}],[{key:"Type",get:function(){return{StartToStart:0,StartToEnd:1,EndToStart:2,EndToEnd:3}}},{key:"fields",get:function(){return[{name:"from"},{name:"to"},{name:"type",type:"int",defaultValue:2},{name:"cls",defaultValue:""},{name:"bidirectional",type:"boolean"},{name:"fromSide",type:"string"},{name:"toSide",type:"string"},{name:"lag",type:"number",allowNull:!0,defaultValue:0},{name:"lagUnit",type:"string",defaultValue:"d"}]}},{key:"relationConfig",get:function(){return[{relationName:"sourceEvent",fieldName:"from",store:"eventStore",collectionName:"successors"},{relationName:"targetEvent",fieldName:"to",store:"eventStore",collectionName:"predecessors"}]}}]),r}(Io);function Lv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Pv.exposeProperties(),Pv._$name="DependencyBaseModel";var Hv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Lv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getTypeFromSides",value:function(e,t,n){var r=Pv.Type,i=n?"right":"left",o=n?"left":"right";return e===i?t===i?r.StartToStart:r.StartToEnd:t===o?r.EndToEnd:r.EndToStart}}]),r}(Pv);function jv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Hv.exposeProperties(),Hv._$name="DependencyModel";var Bv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(jv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"doDestroy",value:function(){this.eventStoreDetacher&&this.eventStoreDetacher(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"attachToEventStore",value:function(e){var t=this;t.eventStoreDetacher&&t.eventStoreDetacher(),t.eventStoreDetacher=e.on({remove:t.onEventRemove,thisObj:t,detachable:!0})}},{key:"onEventRemove",value:function(e){var t=this,n=e.records,r=e.isMove,i=void 0!==r&&r,o=e.isCollapse;i||void 0!==o&&o||n.forEach((function(e){e.traverse((function(e){return t.removeEventDependencies(e,!1)}))}))}},{key:"reduceEventDependencies",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0;return o=o||function(e){return r.getEventDependencies(e)},(e=Array.isArray(e)?e:[e]).reduce((function(e,n){n.children&&!i?n.traverse((function(n){e=o(n).reduce(t,e)})):e=o(n).reduce(t,e)}),n),n}},{key:"reduceEventPredecessors",value:function(e,t,n,r){return this.reduceEventDependencies(e,t,n,r,(function(e){}))}},{key:"reduceEventSuccessors",value:function(e,t,n,r){return this.reduceEventDependencies(e,t,n,r,(function(e){}))}},{key:"mapEventDependencies",value:function(e,t,n,r,i){return this.reduceEventDependencies(e,(function(e,t){return n(t)&&e.push(t),e}),[],r,i)}},{key:"mapEventPredecessors",value:function(e,t,n,r){return this.reduceEventPredecessors(e,(function(e,t){return n(t)&&e.push(t),e}),[],r)}},{key:"mapEventSuccessors",value:function(e,t,n,r){return this.reduceEventSuccessors(e,(function(e,t){return n(t)&&e.push(t),e}),[],r)}},{key:"getEventDependencies",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return[].concat(e.predecessors||[],e.successors||[])}},{key:"getEventPredecessors",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.predecessors}},{key:"getEventSuccessors",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.successors}},{key:"getUnique",value:function(e){return Z()(new Set(e))}},{key:"removeEventDependencies",value:function(e,t){var n=this.getEventDependencies(e,t);n.length&&this.remove(this.getUnique(n))}},{key:"removeEventPredecessors",value:function(e,t){var n=this.getEventPredecessors(e,t);n.length&&this.remove(this.getUnique(n))}},{key:"removeEventSuccessors",value:function(e,t){var n=this.getEventSuccessors(e,t);n.length&&this.remove(this.getUnique(n))}},{key:"getBySourceTargetId",value:function(e){return this.records.find((function(t){return e==r.makeDependencySourceTargetCompositeKey(t.from,t.to)}))}},{key:"getDependencyForSourceAndTargetEvents",value:function(e,t){return e=Io.asId(e),t=Io.asId(t),this.getBySourceTargetId(r.makeDependencySourceTargetCompositeKey(e,t))}},{key:"getEventsLinkingDependency",value:function(e,t){return this.getDependencyForSourceAndTargetEvents(e,t)||this.getDependencyForSourceAndTargetEvents(t,e)}},{key:"isValidDependency",value:function(e,t,n){return 1===arguments.length&&(n=e.type,t=e.to,e=e.from),null!=e&&null!=t&&e!==t}},{key:"isValidDependencyToCreate",value:function(e,t,n){return this.isValidDependency(e,t,n)}},{key:"getHighlightedDependencies",value:function(e){return this.records.reduce((function(t,n){return n.isHighlightedWith(e)&&t.push(n),t}),[])}},{key:"getTimeSpanDependencies",value:function(e){return this.getEventDependencies(e)}},{key:"eventStore",get:function(){return this._eventStore},set:function(e){var t=this,n=t._eventStore;t._eventStore=e,e&&(t.attachToEventStore(e),t.isConfiguring||t.initRelations(!0)),(n||e)&&n!==e&&t.trigger("eventStoreChange",{newEventStore:e,oldEventStore:n})}}],[{key:"makeDependencySourceTargetCompositeKey",value:function(e,t){return"source(".concat(e,")-target(").concat(t,")")}},{key:"defaultConfig",get:function(){return{loadPriority:400,syncPriority:400,modelClass:Hv,storeId:"dependencies"}}}]),r}(ka);function Nv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Bv._$name="DependencyStore";var zv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Nv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.scheduler&&(this.scheduler=e.scheduler,this.scheduler._crudManager=this),se()(J()(r.prototype),"construct",this).call(this,e)}},{key:"afterConstruct",value:function(){var e=this,t=e.scheduler;if(t){(t.isVertical||t.isHorizontal&&!t.store)&&(t.resourceStore=e.resourceStore,t.eventStore=e.eventStore);var n=t.features,i=n.dependencies,o=n.timeRanges,a=n.resourceTimeRanges;i&&(e.dependencyStore=i.dependencyStore),o&&(e.addCrudStore(o.store),e._timeRangesStore=o.store),a&&(e.addCrudStore(a.store),e._resourceTimeRangesStore=a.store)}se()(J()(r.prototype),"afterConstruct",this).call(this)}},{key:"addFeaturedStore",value:function(e){this.addPrioritizedStore(e)}},{key:"setFeaturedStore",value:function(e,t,n){var r=this,i=r[e];return t=ga.getStore(t,t&&t.storeClass||n),i&&r.removeStore(i),r[e]=t&&{store:t}||null,r.addFeaturedStore(r[e]),r[e]}},{key:"timeRangesStore",get:function(){return this._timeRangesStore}},{key:"resourceStore",get:function(){return this._resourceStore&&this._resourceStore.store},set:function(e){var t=this;t.setFeaturedStore("_resourceStore",e,t.resourceStoreClass),t.eventStore.resourceStore=t._resourceStore&&t._resourceStore.store}},{key:"eventStore",get:function(){return this._eventStore&&this._eventStore.store},set:function(e){var t=this;if(t.setFeaturedStore("_eventStore",e,t.eventStoreClass),e=t._eventStore&&t._eventStore.store,t.isConfiguring&&e&&!1!==t.addRelatedStores){var n=r.getEventStoreInfo(e,t.initialConfig),i=n.assignmentStore,o=n.resourceStore,a=n.dependencyStore;i&&(t.assignmentStore=i),o&&(t.resourceStore=o),a&&(t.dependencyStore=a)}}},{key:"assignmentStore",get:function(){return this._assignmentStore&&this._assignmentStore.store},set:function(e){this.setFeaturedStore("_assignmentStore",e,this.assignmentStoreClass)}},{key:"dependencyStore",get:function(){return this._dependencyStore&&this._dependencyStore.store},set:function(e){this.setFeaturedStore("_dependencyStore",e,this.dependencyStoreClass)}}],[{key:"getEventStoreInfo",value:function(e,t){e instanceof Fv||(e="string"==typeof e?ga.getStore(e):e.store);var n={},r=t.assignmentStore,i=t.resourceStore,o=t.dependencyStore;return!r&&(n.assignmentStore=e.assignmentStore),!i&&(n.resourceStore=e.resourceStore),!o&&(n.dependencyStore=e.dependencyStore),n}},{key:"defaultConfig",get:function(){return{resourceStoreClass:Kg,eventStoreClass:Fv,assignmentStoreClass:Hg,dependencyStoreClass:Bv,resourceStore:{},eventStore:{},assignmentStore:null,dependencyStore:null,addRelatedStores:!0}}}]),r}(Ig(Dg(xg)));function Vv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zv._$name="CrudManager";var Wv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Vv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"getLegend",value:function(e,t){var n,r=this,i=e.timeSpan,o=e.interval,a=e.days,s=e.monthDays,l=e.months,c=e.positions,u=t||i.startDate,d={interval:o};switch(e.frequency){case"DAILY":return 1==o?r.L("Daily"):r.L("Every {0} days",d);case"WEEKLY":return a&&a.length?d.days=r.getDaysLegend(a):u&&(d.days=ft.getDayName(u.getDay())),r.L(1==o?"Weekly on {1}":"Every {0} weeks on {1}",d);case"MONTHLY":return a&&a.length&&c&&c.length?d.days=r.getDaysLegend(a,c):s&&s.length?(s.sort((function(e,t){return e-t})),d.days=r.arrayToText(s)):u&&(d.days=u.getDate()),r.L(1==o?"Monthly on {1}":"Every {0} months on {1}",d);case"YEARLY":return a&&a.length&&c&&c.length?d.days=r.getDaysLegend(a,c):d.days=u.getDate(),l&&l.length?(l.sort((function(e,t){return e-t})),n=l.length>2?function(e){return ft.getMonthShortName(e-1)}:function(e){return ft.getMonthName(e-1)},d.months=r.arrayToText(l,n)):d.months=ft.getMonthName(u.getMonth()),r.L(1==o?"Yearly on {1} of {2}":"Every {0} years on {1} of {2}",d)}}},{key:"getDaysLegend",value:function(e,t){var n,r=this,i={position:""};if(t&&t.length&&(i.position=r.arrayToText(t,(function(e){return r.L("position".concat(e))}))),e.length)switch(e.sort((function(e,t){return sv.decodeDay(e)[0]-sv.decodeDay(t)[0]})),e.join(",")){case r.allDaysValue:i.days=r.L("day");break;case r.workingDaysValue:i.days=r.L("weekday");break;case r.nonWorkingDaysValue:i.days=r.L("weekend day");break;default:n=e.length>2?function(e){return ft.getDayShortName(sv.decodeDay(e)[0])}:function(e){return ft.getDayName(sv.decodeDay(e)[0])},i.days=r.arrayToText(e,n)}return r.L("daysFormat",i)}},{key:"arrayToText",value:function(e,t){return t&&(e=e.map(t)),e.join(", ").replace(/,(?=[^,]*$)/,this.L(" and "))}},{key:"$name",get:function(){return"RecurrenceLegend"}},{key:"allDaysValue",get:function(){return"SU,MO,TU,WE,TH,FR,SA"}},{key:"workingDaysValue",get:function(){return"MO,TU,WE,TH,FR"}},{key:"nonWorkingDaysValue",get:function(){return"SU,SA"}}]),r}(_e());function Uv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Wv._$name="RecurrenceLegend";var Gv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Uv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"isResourceTimeRange",get:function(){return!0}},{key:"resources",get:function(){return[this.resource]}}],[{key:"fields",get:function(){return["resourceId","timeRangeColor"]}},{key:"relationConfig",get:function(){return[{relationName:"resource",fieldName:"resourceId",store:"resourceStore",collectionName:"timeRanges",nullFieldOnRemove:!0}]}}]),r}(zg);function Yv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Gv._$name="ResourceTimeRangeModel";var $v=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Yv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getResourcesForEvent",value:function(e){return[e.resource]}},{key:"resourceStore",set:function(e){this._resourceStore=e,this.isConfiguring||this.initRelations(!0)},get:function(){return this._resourceStore}}],[{key:"defaultConfig",get:function(){return{loadPriority:500,syncPriority:500,resourceStore:null,modelClass:Gv,storeId:"resourceTimeRanges"}}}]),r}(ka);function qv(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Xv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xv(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Xv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}$v._$name="ResourceTimeRangeStore";var Jv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Kv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).apply(this,arguments),this.normalizeUnits()}},{key:"generateId",value:function(e){var t=this,n=t.headers,r=[],i=Object.getPrototypeOf(t.data).id;if(!i){for(var o=n.length-1;o>=0;o--)r.push(o?n[o].unit:L.capitalizeFirstLetter(n[o].unit));i=r.join("And")}return e.includes(i)&&(i+="-".concat(t.tickWidth,"by").concat(t.tickHeight||t.tickWidth),e.includes(i)&&(i+="-".concat(t.bottomHeader.increment),e.includes(i)&&(i=we.generateId("".concat(i,"-"))))),i}},{key:"normalizeUnits",value:function(){for(var e=this,t=e.timeResolution,n=e.headers,r=0,i=n.length;r<i;r++){var o=n[r];o.unit=ft.normalizeUnit(o.unit),o.splitUnit&&(o.splitUnit=ft.normalizeUnit(o.splitUnit)),"increment"in o||(n[r]=Object.assign({increment:1},o))}t&&(t.unit=ft.normalizeUnit(t.unit)),e.shiftUnit&&(e.shiftUnit=ft.normalizeUnit(e.shiftUnit))}},{key:"set",value:function(){}},{key:"inSet",value:function(){}},{key:"columnLinesFor",get:function(){return"columnLinesFor"in this.data?this.data.columnLinesFor:this.headers.length-1}},{key:"tickSize",get:function(){return this._tickSize||this.tickWidth}},{key:"tickWidth",get:function(){return"tickWidth"in this.data?this.data.tickWidth:50}},{key:"tickHeight",get:function(){return"tickHeight"in this.data?this.data.tickHeight:50}},{key:"headerConfig",get:function(){if(this.data.headerConfig)return this.data.headerConfig;var e={},t=this.headers;switch(t.length){case 1:e.middle=t[0];break;case 2:0===this.mainHeaderLevel?(e.middle=t[0],e.bottom=t[1]):(e.top=t[0],e.middle=t[1]);break;case 3:e.top=t[0],e.middle=t[1],e.bottom=t[2];break;default:throw new Error("headerConfig object not supported for >3 header levels")}return e}},{key:"mainHeaderLevel",set:function(e){this.data.mainHeaderLevel=e},get:function(){return"mainHeaderLevel"in this.data?this.data.mainHeaderLevel:3===this.data.headers.length?1:this.headers.length-1}},{key:"mainHeader",get:function(){return this.headers[this.mainHeaderLevel]}},{key:"bottomHeader",get:function(){return this.headers[this.headers.length-1]}},{key:"leafUnit",get:function(){return this.bottomHeader.unit}},{key:"mainUnit",get:function(){return this.mainHeader}},{key:"msPerPixel",get:function(){var e=this.bottomHeader;return Math.round(ft.asMilliseconds(e.increment||1,e.unit)/this.tickWidth)}},{key:"isValid",get:function(){var e,t=this,n=!0,r=qv(t.headers);try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n&&Boolean(ft.normalizeUnit(i.unit))}}catch(e){r.e(e)}finally{r.f()}return t.timeResolution&&(n=n&&ft.normalizeUnit(t.timeResolution.unit)),t.shiftUnit&&(n=n&&ft.normalizeUnit(t.shiftUnit)),n}}],[{key:"processData",value:function(e){var t;e.headerConfig&&(j.deprecate("Scheduler","4.0.0","ViewPreset headerConfig config replaced by headers config. See https://www.bryntum.com/docs/scheduler/#guides/upgrades/3.0.md"),e=mt.assign({},e),this.normalizeHeaderConfig(e));for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return(t=se()(J()(r),"processData",this)).call.apply(t,[this,e].concat(i))}},{key:"normalizeHeaderConfig",value:function(e){var t=e.headerConfig,n=e.columnLinesFor,r=e.mainHeaderLevel,i=e.headers=[];if(t.top&&("top"==n&&(e.columnLinesFor=0),"top"==r&&(e.mainHeaderLevel=0),i[0]=t.top),!t.middle)throw new Error("ViewPreset.headerConfig must be configured with a middle");"middle"==n&&(e.columnLinesFor=i.length),"middle"==r&&(e.mainHeaderLevel=i.length),i.push(t.middle),t.bottom&&(e.mainHeaderLevel=i.length-1,null==n?e.columnLinesFor=i.length-1:"bottom"==n&&(e.columnLinesFor=i.length),null==r&&(e.mainHeaderLevel=i.length-1),"bottom"==r&&(e.mainHeaderLevel=i.length),i.push(t.bottom))}},{key:"fields",get:function(){return[{name:"name",type:"string"},{name:"rowHeight",defaultValue:24},{name:"tickWidth",defaultValue:50},{name:"tickHeight",defaultValue:50},{name:"displayDateFormat",defaultValue:"HH:mm"},{name:"shiftUnit",defaultValue:"hour"},{name:"shiftIncrement",defaultValue:1},{name:"defaultSpan",defaultValue:12},"timeResolution","headers","mainHeaderLevel","columnLinesFor"]}}]),r}(Io);function Qv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Jv._$name="ViewPreset";var Zv=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Qv()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"createRecord",value:function(e){if(e.preset&&!e.base&&(j.deprecate("Scheduler","4.0.0","ViewPreset preset config replaced by base config. See https://www.bryntum.com/docs/scheduler/#guides/upgrades/3.0.md"),e.base=e.preset),e.base){var t=this.getById(e.base)||tp.getById(e.base);e=Object.setPrototypeOf(e,t.data)}return se()(J()(r.prototype),"createRecord",this).apply(this,arguments)}},{key:"updateLocalization",value:function(){var e=this;se()(J()(r.prototype),"updateLocalization",this).call(this),this.forEach((function(t){var n=e.L(t.id);n&&(n.displayDateFormat&&(t.displayDateFormat=n.displayDateFormat),n.middleDateFormat&&t.headerConfig.middle&&(t.headerConfig.middle.dateFormat=n.middleDateFormat),n.topDateFormat&&t.headerConfig.top&&(t.headerConfig.top.dateFormat=n.topDateFormat),n.bottomDateFormat&&t.headerConfig.bottom&&(t.headerConfig.bottom.dateFormat=n.bottomDateFormat))}))}},{key:"storage",set:function(e){var t=this;ei()(J()(r.prototype),"storage",e,this,!0),this.storage.addSorter((function(e,n){var r=e.bottomHeader,i=n.bottomHeader;return(n.msPerPixel-e.msPerPixel||dt[r.unit]-dt[i.unit]||r.increment-i.increment)*t.zoomOrder}))},get:function(){return se()(J()(r.prototype),"storage",this)}}],[{key:"defaultConfig",get:function(){return{useRawData:!0,modelClass:Jv,zoomOrder:1}}}]),r}(_e(ga));function ep(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Zv._$name="PresetStore";var tp=new(function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ep()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getById",value:function(e){return se()(J()(r.prototype),"getById",this).call(this,e)||this.basePresets[e]}},{key:"registerPreset",value:function(e,t){var n=this.createRecord(Object.assign({id:e},t)),r=this.find((function(e){return e.equals(n)}));if(r)return r;if(!n.isValid)throw new Error("Invalid preset, please check your configuration");return this.add(n),n}},{key:"getPreset",value:function(e){return"number"==typeof e&&(e=this.getAt(e)),"string"==typeof e?e=this.getById(e):e instanceof Jv||(e=this.createRecord(e)),e}},{key:"normalizePreset",value:function(e){if(!(e instanceof Jv))if("string"==typeof e){if(!(e=this.getPreset(e)))throw new Error("You must define a valid view preset. See PresetManager for reference")}else if("object"===re()(e)){if(e.base){var t=this.getById(e.base);if(!t)throw new Error("ViewPreset base '".concat(e.base,"' does not exist"));e=mt.merge(mt.clone(t.data),e)}e.id?e=this.createRecord(e):(e=this.createRecord(mt.assign({},e))).id=e.generateId(e)}return e}},{key:"deletePreset",value:function(e){"string"==typeof e?e=this.getById(e):"number"==typeof e&&(e=this.getAt(e)),e&&(this.remove(e),delete this.basePresets[e.id])}},{key:"basePresets",set:function(e){var t=this._basePresets={};for(var n in e)e[n].id=n,t[n]=this.createRecord(e[n])},get:function(){return this._basePresets}},{key:"defaultPresets",set:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i="string"==typeof r,o=i?r:r.preset,a=void 0;if(i)a=this.basePresets[o];else{var s=Object.setPrototypeOf(mt.clone(this.basePresets[o].data),{id:o}),l=s.timeResolution,c=s.headers[s.headers.length-1];s.id=void 0,"width"in r&&(s.tickWidth=r.width),"height"in r&&(s.tickHeight=r.height),"increment"in r&&(c.increment=r.increment),"resolution"in r&&(l.increment=r.resolution),"resolutionUnit"in r&&(l.unit=ft.getUnitByName(r.resolutionUnit)),a=this.createRecord(s)}this.add(a)}}}],[{key:"defaultConfig",get:function(){return{preventSubClassingModel:!0,basePresets:{secondAndMinute:{name:"Seconds",tickWidth:30,tickHeight:40,displayDateFormat:"ll LTS",shiftIncrement:10,shiftUnit:"minute",defaultSpan:24,timeResolution:{unit:"second",increment:5},headers:[{unit:"minute",dateFormat:"llll"},{unit:"second",increment:10,dateFormat:"ss"}]},minuteAndHour:{name:"Minutes",tickWidth:60,tickHeight:60,displayDateFormat:"ll LT",shiftIncrement:1,shiftUnit:"hour",defaultSpan:24,timeResolution:{unit:"minute",increment:30},headers:[{unit:"hour",dateFormat:"ddd MM/DD, hA"},{unit:"minute",increment:30,dateFormat:"mm"}]},hourAndDay:{name:"Hours",tickWidth:70,tickHeight:40,displayDateFormat:"ll LT",shiftIncrement:1,shiftUnit:"day",defaultSpan:24,timeResolution:{unit:"minute",increment:30},headers:[{unit:"day",dateFormat:"ddd DD/MM"},{unit:"hour",dateFormat:"LT"}]},day:{name:"Hours 2",displayDateFormat:"LT",shiftIncrement:1,shiftUnit:"day",defaultSpan:1,timeResolution:{unit:"minute",increment:30},mainHeaderLevel:0,headers:[{unit:"day",dateFormat:"ddd DD/MM",splitUnit:"day"},{unit:"hour",renderer:function(e){return'\n                                    <div class="b-sch-calendarcolumn-ct"><span class="b-sch-calendarcolumn-hours">'.concat(ft.format(e,"HH"),'</span>\n                                    <span class="b-sch-calendarcolumn-minutes">').concat(ft.format(e,"mm"),"</span></div>\n                                ")}}]},week:{name:"Week/hours",displayDateFormat:"LT",shiftIncrement:1,shiftUnit:"week",defaultSpan:24,timeResolution:{unit:"minute",increment:30},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"D d",splitUnit:"day"},{unit:"hour",dateFormat:"LT",renderer:function(e){return'\n                                    <div class="sch-calendarcolumn-ct">\n                                    <span class="sch-calendarcolumn-hours">'.concat(ft.format(e,"HH"),'</span>\n                                    <span class="sch-calendarcolumn-minutes">').concat(ft.format(e,"mm"),"</span>\n                                    </div>\n                                ")}}]},dayAndWeek:{name:"Days 2",tickWidth:100,tickHeight:80,displayDateFormat:"ll LT",shiftUnit:"day",shiftIncrement:1,defaultSpan:5,timeResolution:{unit:"hour",increment:1},headers:[{unit:"week",renderer:function(e){return ft.getShortNameOfUnit("week")+"."+ft.format(e,"WW MMM YYYY")}},{unit:"day",dateFormat:"dd DD"}]},weekAndDay:{name:"Days",tickWidth:100,tickHeight:80,displayDateFormat:"ll hh:mm A",shiftUnit:"week",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"day",increment:1},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"YYYY MMMM DD"},{unit:"day",increment:1,dateFormat:"DD MMM"}]},weekAndMonth:{name:"Weeks",tickWidth:100,tickHeight:105,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:5,defaultSpan:6,timeResolution:{unit:"day",increment:1},headers:[{unit:"month",dateFormat:"MMM YYYY"},{unit:"week",dateFormat:"DD MMM"}]},weekAndDayLetter:{name:"Weeks 2",tickWidth:20,tickHeight:50,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:1,defaultSpan:10,timeResolution:{unit:"day",increment:1},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"ddd DD MMM YYYY",verticalColumnWidth:115},{unit:"day",dateFormat:"d1",verticalColumnWidth:25}]},weekDateAndMonth:{name:"Weeks 3",tickWidth:30,tickHeight:40,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:1,defaultSpan:10,timeResolution:{unit:"day",increment:1},headers:[{unit:"month",dateFormat:"YYYY MMMM"},{unit:"week",dateFormat:"DD"}]},monthAndYear:{name:"Months",tickWidth:110,tickHeight:110,displayDateFormat:"ll",shiftIncrement:3,shiftUnit:"month",defaultSpan:12,timeResolution:{unit:"day",increment:1},headers:[{unit:"year",dateFormat:"YYYY"},{unit:"month",dateFormat:"MMM YYYY"}]},year:{name:"Years",tickWidth:100,tickHeight:100,resourceColumnWidth:100,displayDateFormat:"ll",shiftUnit:"year",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"month",increment:1},headers:[{unit:"year",dateFormat:"YYYY"},{unit:"quarter",renderer:function(e,t,n){return ft.getShortNameOfUnit("quarter").toUpperCase()+(Math.floor(e.getMonth()/3)+1)}}]},manyYears:{name:"Years 2",tickWidth:40,tickHeight:50,displayDateFormat:"ll",shiftUnit:"year",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"year",increment:1},mainHeaderLevel:0,headers:[{unit:"year",dateFormat:"YYYY",increment:5},{unit:"year",dateFormat:"YY",increment:1}]}},defaultPresets:["manyYears",{width:80,increment:1,resolution:1,preset:"manyYears",resolutionUnit:"YEAR"},"year",{width:30,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},{width:50,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},{width:200,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},"monthAndYear","weekDateAndMonth","weekAndMonth","weekAndDayLetter","weekAndDay",{width:54,increment:1,resolution:1,preset:"weekAndDay",resolutionUnit:"HOUR"},"hourAndDay",{width:64,increment:6,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},{width:100,increment:6,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},{width:64,increment:2,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},"minuteAndHour",{width:30,increment:15,resolution:5,preset:"minuteAndHour"},{width:130,increment:15,resolution:5,preset:"minuteAndHour"},{width:60,increment:5,resolution:5,preset:"minuteAndHour"},{width:100,increment:5,resolution:5,preset:"minuteAndHour"},"secondAndMinute",{width:60,increment:10,resolution:5,preset:"secondAndMinute"},{width:130,increment:5,resolution:5,preset:"secondAndMinute"}],listeners:{locale:"updateLocalization"}}}}]),r}(Zv));function np(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var rp=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(np()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;if(t.generateTicksValidatorFn=function(){return!0},se()(J()(r.prototype),"construct",this).call(this,e),t.originalContinuous=t.continuous,t.on({change:function(e){"filter"!==e.action&&t.trigger("reconfigure",{supressRefresh:!1})},refresh:function(){return t.trigger("reconfigure",{supressRefresh:!1})},endreconfigure:function(e){return t.trigger("reconfigure",e)}}),t.startDate)t.internalOnReconfigure(),t.trigger("reconfigure");else if(t.viewPreset){var n=t.getAdjustedDates(new Date);t.startDate=n.startDate,t.endDate=n.endDate}}},{key:"reconfigure",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.getAdjustedDates(e.startDate,e.endDate);if(!1!==r.trigger("beforeReconfigure",{startDate:i.startDate,endDate:i.endDate,config:e})){if(r.trigger("beginReconfigure"),r._configuredStartDate=e.startDate,r._configuredEndDate=e.endDate,Object.assign(r,e),!1===r.internalOnReconfigure(n))return!1;r.trigger("endReconfigure",{suppressRefresh:t,config:e})}}},{key:"internalOnReconfigure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.isConfigured=!0;var n=t.getAdjustedDates(t.startDate,t.endDate,!0),r=t.getAdjustedDates(t.startDate,t.endDate),i=r.startDate,o=r.endDate;if(i>=o)throw new Error("Invalid start/end dates. Start date must less than end date. Start date: ".concat(i,". End date: ").concat(o,"."));var a=t.unit,s=t.increment||1,l=t.generateTicks(i,o,a,s);t.suspendEvents(),t.data=l;var c=t.count;if(0===c){if(e)return t.resumeEvents(),!1;throw new Error("Invalid time axis configuration or filter, please check your input data.")}t.startDate=t.first.startDate,t.resumeEvents();var u=t.last.endDate;t.isContinuous?(t.adjustedStart=n.startDate,t.adjustedEnd=ft.getNext(c>1?l[c-1].startDate:n.startDate,a,s,t.weekStartDay)):(t.adjustedStart=t.startDate,t.adjustedEnd=u);do{t.visibleTickStart=(t.startDate-t.adjustedStart)/(ft.asMilliseconds(a)*s),t.autoAdjust&&(t.visibleTickStart=Math.floor(t.visibleTickStart)),t.visibleTickStart>=1&&(t.adjustedStart=ft.getNext(t.adjustedStart,a,s,t.weekStartDay))}while(t.visibleTickStart>=1);do{t.visibleTickEnd=c-(t.adjustedEnd-u)/(ft.asMilliseconds(a)*s),c-t.visibleTickEnd>=1&&(t.adjustedEnd=ft.getNext(t.adjustedEnd,a,-1,t.weekStartDay))}while(c-t.visibleTickEnd>=1);t.updateTickCache(!0)}},{key:"setTimeSpan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.getAdjustedDates(e,t),o=i.startDate,a=i.endDate;if(r.startDate-o!=0||r.endDate-a!=0)return r.reconfigure({startDate:o,endDate:a},!1,n)}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shiftUnit,n=this,r=n.startDate,i=n.endDate;n.isFiltered&&(r=n.allRecords[0].startDate,i=n.allRecords[n.allCount-1].endDate);var o=0;do{r=ft.add(r,e,t),i=ft.add(i,e,t)}while(o++<100&&!1===n.setTimeSpan(r,i,!0))}},{key:"shiftNext",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shiftIncrement;this.shift(e)}},{key:"shiftPrevious",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shiftIncrement;this.shift(-e)}},{key:"filterBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=this;n.filters.clear(),se()(J()(r.prototype),"filterBy",this).call(this,(function(n,r){return e.call(t,n.data,r)})),0===n.count&&(n.trigger("invalidFilter"),n.clearFilters())}},{key:"triggerFilterEvent",value:function(e){e.filters.count?this.continuous=!1:this.continuous=this.originalContinuous,this.updateTickCache(),se()(J()(r.prototype),"triggerFilterEvent",this).call(this,e)}},{key:"getAdjustedDates",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return e=e||r.startDate,t=t||ft.add(e,r.defaultSpan,r.mainUnit),r.autoAdjust||n?{startDate:r.floorDate(e,!1,r.autoAdjust?r.mainUnit:r.unit,1),endDate:r.ceilDate(t,!1,r.autoAdjust?r.mainUnit:r.unit,1)}:{startDate:e,endDate:t}}},{key:"floorDate",value:function(e,t,n,r){var i=this,o=(t=!1!==t)?ft.clone(i.startDate):null,a=r||i.resolutionIncrement,s=n||(t?i.resolutionUnit:i.mainUnit),l=function(e,t){return Math.floor(e/t)*t};if(t){var c=l(ft.diff(o,e,s),a);return ft.add(o,c,s)}var u=ft.clone(e);if("week"===s){var d=u.getDay()||7,f=i.weekStartDay||7;(u=ft.add(ft.startOf(u,"day"),d>=f?f-d:-(7-f+d),"day")).getDay()!==f&&23===u.getHours()&&(u=ft.add(u,1,"hour"))}else{u=ft.startOf(u,s);var h=["day","year"].includes(s)?1:0,g="day"===s?"date":s,v=l(ft.get(u,g)-h,a)+h;u=ft.set(u,g,v)}return u}},{key:"roundDate",value:function(e,t){var n=this,r=ft.clone(e),i=n.resolutionIncrement||1;switch(t=ft.clone(t||n.startDate),n.resolutionUnit){case"week":ft.startOf(r,"day");var o,a=r.getDay()-n.weekStartDay;return a<0&&(a=7+a),o=1===Math.round(a/7)?7-a:-a,ft.add(r,o,"day");case"month":var s=ft.diff(t,r,"month")+ft.as("month",r.getDay()/ft.daysInMonth(r)),l=Math.round(s/i)*i;return ft.add(t,l,"month");case"quarter":return ft.startOf(r,"month"),ft.add(r,"month",3-r.getMonth()%3);default:var c=ft.as(n.resolutionUnit,ft.diff(t,r)),u=ft.as(n.resolutionUnit,t.getTimezoneOffset()-r.getTimezoneOffset(),"minute"),d=Math.round((c+u)/i)*i;return ft.add(t,d-u,n.resolutionUnit)}}},{key:"ceilDate",value:function(e,t,n,r){t=!1!==t,r=r||(t?this.resolutionIncrement:1);var i=ft.clone(e),o=!1,a=n||(t?this.resolutionUnit:this.mainUnit);switch(a){case"minute":o=!ft.isStartOf(i,"minute");break;case"hour":o=!ft.isStartOf(i,"hour");break;case"day":case"date":o=!ft.isStartOf(i,"day");break;case"week":o=(i=ft.startOf(i,"day")).getDay()!==this.weekStartDay||!ft.isEqual(i,e);break;case"month":o=1!==(i=ft.startOf(i,"day")).getDate()||!ft.isEqual(i,e);break;case"quarter":o=(i=ft.startOf(i,"day")).getMonth()%3!=0||1!==i.getDate()||!ft.isEqual(i,e);break;case"year":o=0!==(i=ft.startOf(i,"day")).getMonth()||1!==i.getDate()||!ft.isEqual(i,e)}return o?ft.getNext(i,a,r,this.weekStartDay):i}},{key:"processExclusion",value:function(e,t,n){var r=this.include;return!!r&&Object.entries(r).some((function(r){var i=te()(r,2),o=i[0],a=i[1];if(!a)return!1;var s=a.from,l=a.to;if(ft.compareUnits("day",n)>=0&&ft.getLargerUnit(o)===n&&(s&&ft.set(e,o,s),l)){var c,u=n;"day"===n&&(u="date"),ft.set(t,(c={},oe()(c,u,ft.get(t,u)-1),oe()(c,o,l),c))}if(ft.compareUnits(o,n)>=0){var d="day"===o?e.getDay():ft.get(e,o);if(s&&d<s||l&&d>=l)return!0}}))}},{key:"initExclusion",value:function(){Object.entries(this.include).forEach((function(e){var t=te()(e,2),n=t[0],r=t[1];if(r){var i=r.from,o=r.to;r.lengthFactor=ft.getUnitToBaseUnitRatio(n,ft.getLargerUnit(n))/(o-i),r.lengthFactorExcl=ft.getUnitToBaseUnitRatio(n,ft.getLargerUnit(n))/(o-i-1),r.center=i+i/(r.lengthFactor-1)}}))}},{key:"generateTicks",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.unit,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.increment,s=this,l=[],c=Boolean(s.include),u=0,d=s.getAdjustedDates(e,t),f=d.startDate,h=d.endDate;for(s.tickCache={},c&&s.initExclusion();f<h;){if(n=ft.getNext(f,o,a,s.weekStartDay),!s.autoAdjust&&n>h&&(n=h),"hour"===o&&a>1&&l.length>0&&0===u){var g=l[l.length-1];0!==(u=(g.startDate.getHours()+a)%24-g.endDate.getHours())&&(n=ft.add(n,u,"hour"))}i=!1,c?(r=new Date(n.getTime()),i=s.processExclusion(f,n,o)):r=n,s.generateTicksValidatorFn(f)&&!i&&(l.push({id:l.length+1,startDate:f,endDate:n}),s.tickCache[f.getTime()]=l.length-1),f=r}return l}},{key:"getTickFromDate",value:function(e){var t,n,r,i,o=this.records,a=0,s=o.length-1;if(!o.length||e<o[0].startDate||e>o[s].endDate)return-1;if(this.isContinuous){for(;a<s;)e>o[t=a+s+1>>1].endDate?a=t+1:e<o[t].startDate?s=t-1:a=t;return r=(n=o[a]).startDate,i=n.endDate,e>r&&(a+=(e-r)/(i-r)),Math.min(Math.max(a,this.visibleTickStart),this.visibleTickEnd)}for(var l=0;l<=s;l++)if(e<=(i=o[l].endDate))return n=l+(e>(r=o[l].startDate)?(e-r)/(i-r):0)}},{key:"getDateFromTick",value:function(e,t){var n=this;if(e===n.visibleTickEnd)return n.endDate;var r=Math.floor(e),i=e-r,o=n.getAt(r);if(!o)return null;var a=0===r?n.adjustedStart:o.startDate,s=r===n.count-1&&n.isContinuous?n.adjustedEnd:o.endDate,l=ft.add(a,i*(s-a),"millisecond");return t&&(l=n[t+"Date"](l)),l}},{key:"updateTickCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.count?(t._start=t.first.startDate,t._end=t.last.endDate,t._startMS=t.startDate.getTime(),t._endMS=t.endDate.getTime()):t._start=t._end=t._startMs=t._endMS=null,e||(t.tickCache={},t.forEach((function(e,n){return t.tickCache[e.startDate.getTime()]=n})))}},{key:"dateInAxis",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.startDate,i=n.endDate;if(n.isContinuous)return t?ft.betweenLesserEqual(e,r,i):ft.betweenLesser(e,r,i);for(var o,a,s,l=n.getCount(),c=0;c<l;c++)if(o=(s=n.getAt(c)).startDate,a=s.endDate,t&&e<=a||!t&&e<a)return e>=o;return!1}},{key:"timeSpanInAxis",value:function(e,t){var n=this;return t&&t.getTime()!==e.getTime()?n.isContinuous?ft.intersectSpans(e,t,n.startDate,n.endDate):e<n.startDate&&t>n.endDate||n.getTickFromDate(e)!==n.getTickFromDate(t):this.dateInAxis(e,!0)}},{key:"isTimeSpanInAxis",value:function(e){var t=this,n=e.startDateMS,r=e.endDateMS;return!(!n||!r)&&(r===n?this.dateInAxis(e.startDate,!0):t.isContinuous?r>t.startMS&&n<t.endMS:n<t.startMS&&r>t.endMS||t.getTickFromDate(e.startDate)!==t.getTickFromDate(e.endDate))}},{key:"forEachAuxInterval",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this,o=this.endDate,a=this.startDate,s=0;if(a>o)throw new Error("Invalid time axis configuration");for(;a<o;)t=ft.min(ft.getNext(a,e,n,this.weekStartDay),o),r.call(i,a,t,s),a=t,s++}},{key:"isTimeAxis",get:function(){return!0}},{key:"viewPreset",get:function(){return this._viewPreset},set:function(e){if(!((e=tp.getPreset(e))instanceof Jv))throw new Error("TimeAxis must be configured with the ViewPreset instance that the Scheduler is using");this._viewPreset=e,Object.assign(this,{unit:e.bottomHeader.unit,increment:e.bottomHeader.increment||1,resolutionUnit:e.timeResolution.unit,resolutionIncrement:e.timeResolution.increment,mainUnit:e.mainHeader.unit,shiftUnit:e.shiftUnit,shiftIncrement:e.shiftIncrement||1,defaultSpan:e.defaultSpan||1,presetName:e.id,headers:e.headers})}},{key:"weekStartDay",set:function(e){this._weekStartDay=e},get:function(){return null==this._weekStartDay?ft.weekStartDay:this._weekStartDay}},{key:"resolution",get:function(){return{unit:this.resolutionUnit,increment:this.resolutionIncrement}},set:function(e){this.resolutionUnit=e.unit,this.resolutionIncrement=e.increment}},{key:"resolutionUnit",get:function(){return this._resolutionUnit},set:function(e){this._resolutionUnit=e}},{key:"resolutionIncrement",get:function(){return this._resolutionIncrement},set:function(e){this._resolutionIncrement=e||1}},{key:"mainUnit",set:function(e){this._mainUnit=e},get:function(){return this._mainUnit}},{key:"shiftUnit",set:function(e){this._shiftUnit=e},get:function(){return this._shiftUnit||this._mainUnit}},{key:"shiftIncrement",set:function(e){this._shiftIncrement=e},get:function(){return this._shiftIncrement||1}},{key:"unit",set:function(e){this._unit=e},get:function(){return this._unit}},{key:"increment",set:function(e){this._increment=e},get:function(){return this._increment}},{key:"defaultSpan",get:function(){return this._defaultSpan},set:function(e){this._defaultSpan=e}},{key:"isContinuous",get:function(){return!1!==this.continuous&&!this.filtered}},{key:"startDate",get:function(){return this._start||(this.first?new Date(this.first.startDate):null)},set:function(e){this._start=ft.parse(e)}},{key:"endDate",get:function(){return this._end||(this.last?new Date(this.last.endDate):null)},set:function(e){e&&(this._end=ft.parse(e))}},{key:"startMS",get:function(){return this._startMS}},{key:"endMS",get:function(){return this._endMS}},{key:"include",get:function(){return this._include},set:function(e){var t=this;t._include=e,t.continuous=!e,t.isConfiguring||(t.startDate=t._configuredStartDate,t.endDate=t._configuredEndDate,t.internalOnReconfigure(),t.trigger("includeChange"))}},{key:"visibleTickTimeSpan",get:function(){return this.isContinuous?this.visibleTickEnd-this.visibleTickStart:this.count}},{key:"ticks",get:function(){return this.records}}],[{key:"defaultConfig",get:function(){return{modelClass:zg,continuous:!0,originalContinuous:null,include:null,autoAdjust:!0,unit:null,increment:null,resolutionUnit:null,resolutionIncrement:null,weekStartDay:null,mainUnit:null,shiftUnit:null,shiftIncrement:1,adjustedStart:null,adjustedEnd:null,visibleTickStart:null,visibleTickEnd:null,defaultSpan:1,tickCache:{},viewPreset:null}}}]),r}(ga);function ip(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}rp._$name="TimeAxis";var op=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ip()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){e.useBackgroundCanvas=!0,se()(J()(r.prototype),"construct",this).call(this,e,t),this.timeAxisViewModel=e.timeAxisViewModel,e.on({theme:"onThemeChange",thisObj:this})}},{key:"doDestroy",value:function(){this.timeAxisViewModelDetatcher&&this.timeAxisViewModelDetatcher(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.isConfiguring||(e?(on.removeEachSelector(this.client.backgroundCanvas,".b-column-line-major"),this.client.backgroundCanvas.style.backgroundImage="none"):this.drawLines()),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"getColorsFromCSS",value:function(){var e=this;if(!e.GotColors){var t=on.createElement({style:"position: absolute; visibility: hidden",html:'<div class="b-column-line"></div><div class="b-column-line-major"></div>',parent:document.body}),n=on.getStyleValue(t.firstElementChild,"border-left-color"),r=on.getStyleValue(t.lastElementChild,"border-left-color"),i=on.getStyleValue(t.firstElementChild,"border-left-style"),o=on.getStyleValue(t.lastElementChild,"border-left-style");n&&(e.tickColor=n),r&&(e.majorTickColor=r),i&&(e.tickStyle=i),o&&(e.majorTickStyle=o),t.remove(),e.GotColors=!0}}},{key:"onThemeChange",value:function(){this.GotColors=!1,this.render()}},{key:"render",value:function(){this.getColorsFromCSS(),this.drawLines()}},{key:"drawLines",value:function(){if(this.client.timeAxis.startDate){var e=this,t=e.client,n=t.timeAxis,r=n.startDate,i=t.timeAxisViewModel,o=i.tickSize,a=t.backgroundCanvas,s=document.createElement("canvas"),l=s.getContext("2d"),c=i.columnLinesFor,u=i.headers[c],d=i.headers,f=d[d.indexOf(u)-1]||d[0],h=d[d.length-1],g=n.floorDate(r,!1,f.unit,"year"===f.unit?1:f.increment||1),v=ft.getNext(g,f.unit,f.increment||1,n.weekStartDay),p=Math.round(ft.getDurationInUnit(g,v,h.unit))/(h.increment||1),y=Math.round(ft.getDurationInUnit(g,v,u.unit))/(u.increment||1),m=p/y;if(t.isHorizontal){if(r){var b=d.length>1&&ft.doesUnitsAlign(f.unit,u.unit),k=b?g:n.floorDate(r,!1,u.unit,u.increment),w=n.isContinuous?ft.getDurationInUnit(k,r,h.unit,!0)/n.increment*o:0;on.removeEachSelector(a,".b-column-line-major");var S=!1,C=!0;u!==f&&b&&"day"===h.unit&&-1!==ft.compareUnits(f.unit,"month")&&(C=!1,n.forEachAuxInterval(f.unit,f.increment,(function(e,t){on.append(a,{tag:"div",className:"b-column-line-major",style:"left:".concat(i.getPositionFromDate(t)-1,"px;")})}))),s.width=Math.min(2*p*o,32767),s.height=20,l.translate(-.5,-.5),l.lineWidth=2;for(var R=0;R<y;R++){var x=(S=0===R&&(f!==u&&b&&C&&n.isContinuous))&&e.majorTickStyle||!S&&e.tickStyle;if("solid"!==x)switch(x){case"dashed":l.setLineDash([6,4]);break;case"dotted":l.setLineDash([2,3])}l.beginPath(),l.strokeStyle=S?e.majorTickColor:e.tickColor,l.moveTo(R*m*o*2+10-1,0),l.lineTo(R*m*o*2+10-1,22),l.stroke()}a.style.backgroundImage="url(".concat(s.toDataURL(),")"),a.style.backgroundSize="".concat(s.width/2,"px"),a.style.backgroundPositionX="".concat(-(5+w),"px")}}else{if(s.width=2*t.timeAxisColumn.resourceColumns.columnWidth,s.height=2,l.translate(-.5,-.5),l.lineWidth=2,r){if(on.removeEachSelector(a,".b-column-line-major"),u!==f&&n.forEachAuxInterval(f.unit,f.increment,(function(e,t){on.append(a,{tag:"div",className:"b-column-line-major",style:"top:".concat(i.getPositionFromDate(t)-1,"px;")})})),"solid"!==e.tickStyle)switch(e.tickStyle){case"dashed":l.setLineDash([6,4]);break;case"dotted":l.setLineDash([2,3])}var E=m*o*2;s.height=E,l.beginPath(),l.strokeStyle=e.tickColor,l.lineWidth=2,l.moveTo(0,E-1),l.lineTo(s.width+2,E-1),l.stroke()}l.beginPath(),l.strokeStyle=e.tickColor,l.moveTo(s.width-1,0),l.lineTo(s.width-1,s.height+2),l.stroke(),a.style.backgroundImage="url(".concat(s.toDataURL(),")"),a.style.backgroundSize="".concat(s.width/2,"px"),a.style.backgroundPositionX="0"}}}},{key:"updateCanvasSize",value:function(){this.disabled||this.drawLines()}}],[{key:"$name",get:function(){return"ColumnLines"}},{key:"properties",get:function(){return{tickColor:"#e6e6e6",majorTickColor:"#999",tickStyle:"solid",majorTickStyle:"solid"}}},{key:"pluginConfig",get:function(){return{after:["render","updateCanvasSize"]}}}]),r}(ho);op._$name="ColumnLines",bd.registerFeature(op,!0,["Scheduler","Gantt"]);n(271);function ap(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function sp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var lp=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(sp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"findPath",value:function(e,t){var n,r,i,o,a,s,l,c,u,d,f,h,g,v,p,y,m,b,k,w,S,C,R,x,E,D,T,M,A,I,F,O=this;for(t&&!Array.isArray(t)&&(t=[t]),F=0;e&&!I;)for(r=(n=Object.assign(O.config,e)).startBox,i=n.endBox,o=n.startShift,a=n.endShift,s=n.startSide,l=n.endSide,c=n.startArrowSize,u=n.endArrowSize,d=n.startArrowMargin,f=n.endArrowMargin,h=n.horizontalMargin,g=n.verticalMargin,v=n.hasOwnProperty("startHorizontalMargin")?n.startHorizontalMargin:h,p=n.hasOwnProperty("startVerticalMargin")?n.startVerticalMargin:g,y=n.hasOwnProperty("endHorizontalMargin")?n.endHorizontalMargin:h,m=n.hasOwnProperty("endVerticalMargin")?n.endVerticalMargin:g,b=n.hasOwnProperty("otherHorizontalMargin")?n.otherHorizontalMargin:h,k=n.hasOwnProperty("otherVerticalMargin")?n.otherVerticalMargin:g,w=n.otherBoxes,s=O.normalizeSide(s),l=O.normalizeSide(l),S=O.getConnectionCoordinatesFromBoxSideShift(r,s,o),C=O.getConnectionCoordinatesFromBoxSideShift(i,l,a),T=O.calcGridBaseBoxFromBoxAndDrawParams(r,s,c,d,v,p),M=O.calcGridBaseBoxFromBoxAndDrawParams(i,l,u,f,y,m),w=w&&w.map((function(e){return O.calcGridBaseBoxFromBoxAndDrawParams(e,!1,0,0,b,k)})),R=O.getConnectionCoordinatesFromBoxSideShift(T,s,o),x=O.getConnectionCoordinatesFromBoxSideShift(M,l,a),A=O.buildPathGrid(T,M,R,x,s,l,w),E=O.convertDecartPointToGridPoint(A,R),D=O.convertDecartPointToGridPoint(A,x),I=O.findPathOnGrid(A,E,D,s,l),e=!1;!I&&!e&&t&&F<t.length;F++)e=t[F](n);return I&&(I=O.prependPathWithArrowStaffSegment(I,S,c,s),I=O.appendPathWithArrowStaffSegment(I,C,u,l),I=O.optimizePath(I)),I}},{key:"getConnectionCoordinatesFromBoxSideShift",value:function(e,t,n){var r;switch(t){case"left":r={x:e.start,y:(e.top+e.bottom)/2+n};break;case"right":r={x:e.end,y:(e.top+e.bottom)/2+n};break;case"top":r={x:(e.start+e.end)/2+n,y:e.top};break;case"bottom":r={x:(e.start+e.end)/2+n,y:e.bottom}}return r}},{key:"calcGridBaseBoxFromBoxAndDrawParams",value:function(e,t,n,r,i,o){var a;switch(t){case"left":a={start:e.start-Math.max(n+r,i),end:e.end+i,top:e.top-o,bottom:e.bottom+o};break;case"right":a={start:e.start-i,end:e.end+Math.max(n+r,i),top:e.top-o,bottom:e.bottom+o};break;case"top":a={start:e.start-i,end:e.end+i,top:e.top-Math.max(n+r,o),bottom:e.bottom+o};break;case"bottom":a={start:e.start-i,end:e.end+i,top:e.top-o,bottom:e.bottom+Math.max(n+r,o)};break;default:a={start:e.start-i,end:e.end+i,top:e.top-o,bottom:e.bottom+o}}return a}},{key:"buildPathGrid",value:function(e,t,n,r,i,o,a){var s,l,c,u,d,f,h,g,v,p,y,m,b,k={},w=[];for(s=[e.start,"left"===i||"right"===i?(e.start+e.end)/2:n.x,e.end,t.start,"left"===o||"right"===o?(t.start+t.end)/2:r.x,t.end],l=[e.top,"top"===i||"bottom"===i?(e.top+e.bottom)/2:n.y,e.bottom,t.top,"top"===o||"bottom"===o?(t.top+t.bottom)/2:r.y,t.bottom],a&&a.forEach((function(e){s.push(e.start,(e.start+e.end)/2,e.end),l.push(e.top,(e.top+e.bottom)/2,e.bottom)})),s=Z()(new Set(s.sort((function(e,t){return e-t})))),f=0,g=(l=Z()(new Set(l.sort((function(e,t){return e-t}))))).length;f<g;++f)for(k[f]=k[f]||{},c=l[f],d=0,h=s.length;d<h;++d){if(m=((u=s[d])<=e.start||u>=e.end||c<=e.top||c>=e.bottom)&&(u<=t.start||u>=t.end||c<=t.top||c>=t.bottom),a)for(v=0,p=a.length;m&&v<p;++v)m=u<=(y=a[v]).start||u>=y.end||c<=y.top||c>=y.bottom||u===n.x&&c===n.y||u===r.x&&c===r.y;b={distance:Math.pow(2,53)-1,permitted:m,x:u,y:c,ix:d,iy:f},k[f][d]=b,w.push(b)}return{width:s.length,height:l.length,xs:s,ys:l,points:k,linearPoints:w}}},{key:"convertDecartPointToGridPoint",value:function(e,t){var n=e.xs.indexOf(t.x),r=e.ys.indexOf(t.y);return e.points[r][n]}},{key:"findPathOnGrid",value:function(e,t,n,r,i){var o=!1;return t.permitted&&n.permitted&&(e=this.waveForward(e,t,0),o=this.collectPath(e,n,i)),o}},{key:"getGridPointNeighbors",value:function(e,t,n){var r,i=t.ix,o=t.iy,a=[];return o<e.height-1&&(r=e.points[o+1][i],(!n||n(r))&&a.push(r)),o>0&&(r=e.points[o-1][i],(!n||n(r))&&a.push(r)),i<e.width-1&&(r=e.points[o][i+1],(!n||n(r))&&a.push(r)),i>0&&(r=e.points[o][i-1],(!n||n(r))&&a.push(r)),a}},{key:"waveForward",value:function(e,t,n){var r=this;return aa.preWalkUnordered([t,n],(function(t){var n=te()(t,2),i=n[0],o=n[1];return r.getGridPointNeighbors(e,i,(function(e){return e.permitted&&e.distance>o+1})).map((function(e){return[e,o+1]}))}),(function(e){var t=te()(e,2),n=t[0],r=t[1];return n.distance=r})),e}},{key:"collectPath",value:function(e,t,n){for(var r,i,o,a,s=!0,l=[];s&&t.distance;)if(s=(r=this.getGridPointNeighbors(e,t,(function(e){return e.permitted&&e.distance==t.distance-1}))).length>0){switch(i=(r=r.sort((function(e,r){var i,o;i=e.ix-t.ix,o=e.iy-t.iy;var a=("left"===n||"right"===n)&&0===o||("top"===n||"bottom"===n)&&0===i?-1:1;i=r.ix-t.ix,o=r.iy-t.iy;var s=("left"===n||"right"===n)&&0===o||("top"===n||"bottom"===n)&&0===i?-1:1;return a>s?1:a<s?-1:a===s?e.y>r.y?-1:1:void 0})))[0],l.push({x1:i.x,y1:i.y,x2:t.x,y2:t.y}),o=i.ix-t.ix,a=i.iy-t.iy,!0){case!a&&o>0:n="left";break;case!a&&o<0:n="right";break;case!o&&a>0:n="top";break;case!o&&a<0:n="bottom"}t=i}return s&&l.reverse()||!1}},{key:"prependPathWithArrowStaffSegment",value:function(e,t,n,r){var i,o;if(e.length>0){switch(i={x2:(o=e[0]).x1,y2:o.y1},r){case"left":i.x1=t.x-n,i.y1=o.y1;break;case"right":i.x1=t.x+n,i.y1=o.y1;break;case"top":i.x1=o.x1,i.y1=t.y-n;break;case"bottom":i.x1=o.x1,i.y1=t.y+n}e.unshift(i)}return e}},{key:"appendPathWithArrowStaffSegment",value:function(e,t,n,r){var i,o;if(e.length>0){switch(i={x1:(o=e[e.length-1]).x2,y1:o.y2},r){case"left":i.x2=t.x-n,i.y2=o.y2;break;case"right":i.x2=t.x+n,i.y2=o.y2;break;case"top":i.x2=o.x2,i.y2=t.y-n;break;case"bottom":i.x2=o.x2,i.y2=t.y+n}e.push(i)}return e}},{key:"optimizePath",value:function(e){var t,n,r=[];if(e.length>0)for(t=e.shift(),r.push(t);e.length>0;)n=e.shift(),t.x1==n.x1&&t.y1==n.y1&&t.x2==n.x2&&t.y2==n.y2?t=n:t.y1-t.y2==0&&n.y1-n.y2==0?t.x2=n.x2:t.x1-t.x2==0&&n.x1-n.x2==0?t.y2=n.y2:(r.push(n),t=n);return r}},{key:"normalizeSide",value:function(e){return r.sideToSide[e]||e}}],[{key:"defaultConfig",get:function(){return{startSide:"right",startArrowSize:0,startArrowMargin:12,startShift:0,endSide:"left",endArrowSize:0,endArrowMargin:12,endShift:0,verticalMargin:2,horizontalMargin:5,otherBoxes:null}}},{key:"sideToSide",get:function(){return{l:"left",r:"right",t:"top",b:"bottom"}}}]),r}(G);lp._$name="RectangularPathFinder";n(273),n(231);function cp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var up=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(cp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"startConfigure",value:function(e){this.configDataLayer(this.client,e),se()(J()(r.prototype),"startConfigure",this).call(this,e)}},{key:"doDestroy",value:function(){var e=this;return(this.dataLayerStores||[]).forEach((function(t){"columns"===t&&(t="columnStore"),e[t]=null})),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"configDataLayer",value:function(e,t){var n=this;return(t.dataLayerStores||[]).reduce((function(t,r){if("columnStore"===r||"columns"===r)r="columnStore",t.columnStore=t.columnStore||t.columns||n.obtainColumnStore(e,t);else{var i="obtain".concat(L.capitalizeFirstLetter(r)),o=n[i];t[r]=t[r]||o&&o.call(n,e,t)}return Reflect.has(n,r)||!Object.isExtensible(n)||Object.isSealed(n)||Object.isFrozen(n)||Object.defineProperty(n,r,{get:function(){return this["_".concat(r)]},set:function(e){this.setDataLayerStore(r,e)}}),t}),t)}},{key:"attachToDataLayer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(this.dataLayerStores||[]).forEach((function(n){"columns"===n&&(n="columnStore");var r="obtain".concat(L.capitalizeFirstLetter(n)),i=e[r];e[n]&&!t||!i||(e[n]=i.call(e,e.client))}))}},{key:"setDataLayerStore",value:function(e,t){var n="_".concat(e),r="_".concat(e,"Detacher"),i="on".concat(L.capitalizeFirstLetter(e),"Change"),o="get".concat(L.capitalizeFirstLetter(e),"ListenersConfig");if(this[n]!==t&&(this[r]&&(this[r](),this[r]=null),this[i]&&this[i](t,this[n]),this[n]=t,t&&this[o])){var a=this[o]();a&&(this[r]=t.on(Object.assign({thisObj:this,detachable:!0},a)))}}},{key:"obtainStore",value:function(e,t){return e.store}},{key:"obtainColumnStore",value:function(e,t){return e.columns}}],[{key:"defaultConfig",get:function(){return{dataLayerStores:["store"]}}}]),r}(e||G)};function dp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var fp=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(dp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"obtainResourceStore",value:function(e,t){return e.store}},{key:"obtainDependencyStore",value:function(e,t){return e.dependencyStore}},{key:"obtainAssignmentStore",value:function(e,t){return e.assignmentStore}},{key:"obtainEventStore",value:function(e,t){return e.eventStore}}],[{key:"defaultConfig",get:function(){return{dataLayerStores:["resourceStore","dependencyStore","assignmentStore","eventStore"]}}}]),r}(up(e||G))};function hp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var gp=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(hp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"addEventToResource",value:function(e){var t=e.event,n=e.resource,r=e.eventStore,i=e.assignmentStore;t=r.add(t)[0];var o=this.addAssignment({event:t,resource:n,assignmentStore:i}).assignment;return{event:t,assignment:o!==t?o:null}}},{key:"getEventDependencies",value:function(e){var t=e.event;return e.dependencyStore.getEventDependencies(t)}},{key:"getEventAssignments",value:function(e){var t=e.event;e.assignmentStore;return t.assignments||[]}},{key:"getEventResource",value:function(e){var t=e.event;e.resourceStore;return t.resource}},{key:"isEventAssignedToResource",value:function(e){var t=this,n=e.event,r=e.resource,i=e.resourceStore,o=e.assignmentStore;return o?this.getEventAssignments({event:n,assignmentStore:o}).some((function(e){return t.isAssignmentForResource({assignment:e,resource:r,resourceStore:i})})):n.resource===r}},{key:"assignEventToResource",value:function(e){var t,n=e.event,r=e.resource,i=e.assignmentStore;return i?t=i.add({eventId:n.id,resourceId:r.id})[0]:n.resourceId=r.id,t||n}}]),r}(e||G)};function vp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var pp=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(vp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"isAssignmentEventAssigned",value:function(e){return!!e.assignment.event}},{key:"isAssignmentResourceAssigned",value:function(e){return!!e.assignment.resource}},{key:"isAssignmentAssigned",value:function(e){var t=e.assignment;return!!t.event&&!!t.resource}},{key:"isAssignmentForResource",value:function(e){var t=e.assignment,n=e.resource;e.resourceStore;return t.resource===n}},{key:"getAssignmentResource",value:function(e){var t=e.assignment;e.resourceStore;return t.resource}},{key:"getAssignmentEvent",value:function(e){var t=e.assignment;e.eventStore;return t.event}},{key:"getAssignmentDependencies",value:function(e){var t=e.assignment,n=e.dependencyStore,r=t.event;return r?this.getEventDependencies({event:r,dependencyStore:n}):[]}},{key:"addAssignment",value:function(e){var t=e.event,n=e.resource,r=e.assignmentStore,i=e.assignmentConfig;return{assignment:r.add(Object.assign({},i,{eventId:t.id,resourceId:n.id}))[0]}}}]),r}(e||G)};function yp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var mp=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(yp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getDependencySourceEvent",value:function(e){var t=e.dependency;e.eventStore;return t.sourceEvent}},{key:"getDependencyTargetEvent",value:function(e){var t=e.dependency;e.eventStore;return t.targetEvent}},{key:"getDependencySourceAssignments",value:function(e){var t=e.dependency,n=e.assignmentStore,r=t.sourceEvent;return r?this.getEventAssignments({event:r,assignmentStore:n}):[]}},{key:"getDependencyTargetAssignments",value:function(e){var t=e.dependency,n=e.assignmentStore,r=t.targetEvent;return r?this.getEventAssignments({event:r,assignmentStore:n}):[]}},{key:"getDependencyAssignments",value:function(e){var t=e.dependency,n=e.assignmentStore;[].concat(this.getDependencySourceAssignments({dependency:t,assignmentStore:n}),this.getDependencyTargetAssignments({dependency:t,assignmentStore:n}))}},{key:"getDependencyAssignmentsAsFromToArray",value:function(e){var t=e.dependency,n=e.assignmentStore,r=this.getDependencySourceAssignments({dependency:t,assignmentStore:n}),i=this.getDependencyTargetAssignments({dependency:t,assignmentStore:n});return r.reduce((function(e,t){return i.reduce((function(e,n){return e.push({from:t,to:n}),e}),e)}),[])}},{key:"isDependencySourceAssignment",value:function(e){var t=e.dependency,n=e.assignment;return t.from===n.eventId}},{key:"isDependnecyTargetAssignment",value:function(e){var t=e.dependency,n=e.assignment;return t.to===n.eventId}},{key:"isValidDependency",value:function(e){var t=e.sourceEvent,n=e.targetEvent,r=e.type;return e.dependencyStore.isValidDependency(t.id,n.id,r)}},{key:"isValidDependencyToCreate",value:function(e){var t=e.sourceEvent,n=e.targetEvent,r=e.type;return e.dependencyStore.isValidDependencyToCreate(t.id,n.id,r)}},{key:"createDependency",value:function(e){var t=e.sourceEvent,n=e.targetEvent,r=e.type,i=e.fromSide,o=e.toSide;return e.dependencyStore.add({from:t.id,to:n.id,type:r,fromSide:i,toSide:o})[0]}}]),r}(e||G)};function bp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var kp=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(bp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return r}(e||G)};function wp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Sp=function(e){var t,n=[pp,mp,gp,kp],r=(t=Fo(G)).mixes.apply(t,n);return function(e){$()(i,e);var t,n=(t=i,function(){var e,n=J()(t);if(wp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function i(){return D()(this,i),n.apply(this,arguments)}return M()(i,[{key:"dataApi",get:function(){return this._dataApi||(this._dataApi=new r({host:this.dataApiHost||this})),this._dataApi}}]),i}(e||G)};function Cp(){var e=Ti()(['\n             <table class="b-sch-dependency-tooltip">\n                <tr>\n                    <td>',": </td>\n                    <td>",'</td>\n                    <td>\n                        <div class="b-sch-box b-','"></div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>',": </td>\n                    <td>",'</td>\n                    <td><div class="b-sch-box b-','"></div></td>\n                </tr>\n            </table>\n        ']);return Cp=function(){return e},e}function Rp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var xp=["left","left","right","right"],Ep=["left","right","left","right"],Dp=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Rp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;if(e.isVertical)throw new Error("Dependencies feature is not supported in vertical mode");n.doScheduleDraw=n.createOnFrame("draw",[],n,!0),se()(J()(r.prototype),"construct",this).call(this,e,t),n.pathFinder=new lp(n.pathFinderConfig),delete n.pathFinderConfig,n.lineDefAdjusters=n.createLineDefAdjusters()}},{key:"doDestroy",value:function(){this.tooltip&&this.tooltip.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.updateCreateListeners(),this.client.isPainted&&this.draw(),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"exposeSchedulerDependenciesProperty",value:function(){var e=this;e.dependenciesPropertyExposed&&delete e.client.dependencies,Object.defineProperty(e.client,"dependencies",{configurable:!0,get:function(){return e.dependencyStore.records},set:function(t){return e.dependencyStore.data=t}}),e.dependenciesPropertyExposed=!0}},{key:"getResourceStoreListenersConfig",value:function(){return{refresh:this.onRowStoreRefresh}}},{key:"obtainDependencyStore",value:function(e,t){var n=t&&t.store||se()(J()(r.prototype),"obtainDependencyStore",this).call(this,e,t);return!0!==n&&n||(n=new this.storeClass),n}},{key:"getDependencyStoreListenersConfig",value:function(){return{change:this.onDependencyChange}}},{key:"onDependencyStoreChange",value:function(e,t){var n=this,r=n.client;n.resetGridCache(),n.resetBoundsCache(),r.dependencyStore=e,e&&(!n.dependenciesPropertyExposed&&r.dependencies&&(e.data=r.dependencies,delete r.dependencies),n.dependencies&&(e.data=n.dependencies,delete n.dependencies),e.metaMapId=r.id,e.eventStore=r.eventStore,n.exposeSchedulerDependenciesProperty())}},{key:"getAssignmentStoreListenersConfig",value:function(){return{change:this.onAssignmentChange,refresh:this.onAssignmentRefresh}}},{key:"getEventStoreListenersConfig",value:function(){return{change:this.onEventChange}}},{key:"createMarkers",value:function(){var e=this,t=e.client.svgCanvas,n=e.endMarker=e.initMarkerElement("arrowEnd","8","M0,0 L0,6 L9,3 z");if(Re.isEdge||Re.isIE11){var r=e.startMarker=e.initMarkerElement("arrowStart","1","M0,3 L9,6 L9,0 z");t.appendChild(r)}else n.setAttribute("orient","auto-start-reverse");t.appendChild(n)}},{key:"initMarkerElement",value:function(e,t,n){return on.createElement({id:e,tag:"marker",ns:"http://www.w3.org/2000/svg",markerHeight:9,markerWidth:9,refX:t,refY:3,viewBox:"0 0 9 6",orient:"auto",markerUnits:"userSpaceOnUse",children:[{tag:"path",ns:"http://www.w3.org/2000/svg",d:n}]})}},{key:"createLineDefAdjusters",value:function(){var e=this.client;return[function(t){var n=!1;return(t.startArrowMargin>e.barMargin||t.endArrowMargin>e.barMargin)&&(t.startArrowMargin=t.endArrowMargin=e.barMargin,n=!0),n?t:n},function(e){var t=!1;return(e.startArrowMargin>0||e.endArrowMargin>0)&&(e.startArrowMargin=e.endArrowMargin=0,t=!0),t?e:t}]}},{key:"getElementForDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n='[depId="'.concat(e.id,'"]');return t&&(n+='[fromId="'.concat(t.from.id,'"][toId="').concat(t.to.id,'"]')),this.client.svgCanvas.querySelector(n)}},{key:"getDependencyForElement",value:function(e){var t="string"==typeof e?e:e.getAttribute("depId");return this.dependencyStore.getById(t)}},{key:"onToggleNode",value:function(){this.dependencyGridCache=null,this.scheduleDraw(!0)}},{key:"onViewportResize",value:function(){this.scheduleDraw(!0)}},{key:"onTranslateRow",value:function(e){var t=e.row;t.lastTop>=0&&t.top!==t.lastTop&&this.scheduleDraw(!0)}},{key:"onChangeTotalHeight",value:function(){this.scheduleDraw(!0)}},{key:"onHorizontalScroll",value:function(e){var t=e.subGrid;this.isDrawn&&t===this.client.timeAxisSubGrid&&this.scheduleDraw(!1)}},{key:"onVerticalScroll",value:function(){this.isDrawn&&this.scheduleDraw(!1)}},{key:"onRowsRefresh",value:function(){this.scheduleDraw(!0)}},{key:"onRowsRerender",value:function(){this.scheduleDraw(!0)}},{key:"onRowStoreRefresh",value:function(e){switch(e.action){case"sort":case"filter":case"batch":this.dependencyGridCache=null,this.scheduleDraw(!0)}}},{key:"onDependencyChange",value:function(e){var t=e.action,n=e.record,r=e.records,i=this;if(i.client.isPainted&&!i.disabled){switch(t){case"dataset":i.dependencyGridCache={};case"add":var o=i._dependencyGridCache;return r.forEach((function(e){o&&i.addToGridCache(e)})),o||i._thisIsAUsedExpression(i.dependencyGridCache),void i.scheduleDraw();case"update":return i.scheduleRefreshDependency(n);case"remove":return r.forEach((function(e){i.releaseDependency(e,!0),i.removeFromCache(e)})),void i.client.trigger("dependenciesDrawn");case"removeall":case"filter":i.dependencyGridCache=null}i.scheduleDraw(!0)}}},{key:"onEventChange",value:function(e){var t=this,n=e.action,r=e.record;switch(n){case"filter":this.scheduleDraw(!0);break;case"update":if(r.isEvent){var i=[r];r.resources.forEach((function(e){return i.push.apply(i,Z()(e.events))})),new Set(i).forEach((function(e){return t.drawForTimeSpan(e,!0)}))}else this.drawForTimeSpan(r,!0);break;case"removeall":this.resetGridCache(),this.scheduleDraw(!0)}}},{key:"onAssignmentRefresh",value:function(e){"dataset"===e.action&&(this.resetGridCache(),this.scheduleDraw(!0))}},{key:"onAssignmentChange",value:function(e){var t=this,n=e.action,r=e.record,i=e.records,o=this;r&&(i=[r]),"add"!==n&&"remove"!==n&&"update"!==n||i.forEach((function(e){t.dataApi.getAssignmentDependencies({assignment:e,dependencyStore:t.dependencyStore}).forEach((function(i){if("add"===n)o.scheduleRefreshDependency(i);else if("remove"===n){(t.dataApi.isDependencySourceAssignment({dependency:i,assignment:e})?t.dataApi.getDependencyTargetAssignments({dependency:i,assignmentStore:t.assignmentStore}).map((function(t){return{from:e,to:t}})):t.dataApi.getDependencySourceAssignments({dependency:i,assignmentStore:t.assignmentStore}).map((function(t){return{from:t,to:e}}))).forEach((function(e){o.releaseDependency(i,e),o.removeFromCache(i,e)}))}else"update"===n&&t.dataApi.getDependencyAssignmentsAsFromToArray({dependency:i,assignmentStore:t.assignmentStore}).filter((function(e){return e.from===r||e.to===r})).forEach((function(e){t.scheduleRefreshDependency(i,e)}))}))}))}},{key:"onElementClick",value:function(e){if(e.target.matches("."+this.baseCls)){var t=Ms.get(e.target).dependency,n="click"===e.type?"Click":"DblClick";this.client.trigger("dependency".concat(n),{dependency:t,event:e})}}},{key:"onElementDblClick",value:function(e){return this.onElementClick(e)}},{key:"onElementMouseOver",value:function(e){var t=this;if(e.target.matches("."+t.baseCls)){var n=Ms.get(e.target).dependency;t.client.trigger("dependencyMouseOver",{dependency:n,event:e}),t.overCls&&t.highlight(n,t.overCls)}}},{key:"onElementMouseOut",value:function(e){if(e.target.matches("."+this.baseCls)){var t=Ms.get(e.target).dependency;this.client.trigger("dependencyMouseOut",{dependency:t,event:e}),this.overCls&&!t.meta.removed&&this.unhighlight(t)}}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.overCls,n=this.getElementForDependency(e);n&&n.classList.add(t),e.highlight(t)}},{key:"unhighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.overCls,n=this.getElementForDependency(e);n&&n.classList.remove(t),e.unhighlight(t)}},{key:"highlightEventDependencies",value:function(e){var t=this;e.allDependencies.forEach((function(e){return t.highlight(e)}))}},{key:"unhighlightEventDependencies",value:function(e){var t=this;e.allDependencies.forEach((function(e){return t.unhighlight(e)}))}},{key:"isDependencyVisible",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this,o=i.dataApi,a=i.resourceStore,s=i.eventStore,l=o.getDependencySourceEvent({dependency:e}),c=o.getDependencyTargetEvent({dependency:e});if(!l||!c)return!1;if(r){if(t=o.getAssignmentResource({assignment:r.from,resourceStore:a}),n=o.getAssignmentResource({assignment:r.to,resourceStore:a}),s.isFiltered&&(-1===s.indexOf(l)||-1===s.indexOf(c)))return!1}else t=o.getEventResource({event:l,resourceStore:a}),n=o.getEventResource({event:c,resourceStore:a});return l instanceof Io&&t instanceof Yg&&n instanceof Yg&&!t.instanceMeta(a).hidden&&!n.instanceMeta(a).hidden}},{key:"getBox",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.getTimeSpanRecordFromDependency(e,t);return n=r?this.dataApi.getAssignmentResource({assignment:r[t?"from":"to"],resourceStore:this.resourceStore}):this.dataApi.getEventResource({event:i,resourceStore:this.resoureStore}),this.client.getResourceEventBox(i,n,!0)}},{key:"getRowRecordFromDependency",value:function(e,t,n){return n?this.dataApi.getAssignmentResource({assignment:n[t?"from":"to"],resourceStore:this.resourceStore}):this.dataApi.getEventResource({event:this.getTimeSpanRecordFromDependency(e,t),resourceStore:this.resourceStore})}},{key:"getTimeSpanRecordFromDependency",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e["".concat(t?"source":"target","Event")]}},{key:"getMetaId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?"".concat(this.client.id,"-ass").concat(e.from.id,"-ass").concat(e.to.id):this.client.id}},{key:"getDependencyBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=n.client,i=e.getDateRange();if(!r.rowManager.rowCount||!n.isDependencyVisible(e,t))return null;if(!i||!ft.intersectSpans(i.start,i.end,r.startDate,r.endDate))return null;var o=n.getMetaId(t),a=e.instanceMeta(o),s=n.getBox(e,!0,t),l=n.getBox(e,!1,t);if(!s||!l)return null;if(n._resetBoundsCache||!a.bounds||!a.bounds.layout){var c=n.getTimeSpanRecordFromDependency(e,!0),u=n.getTimeSpanRecordFromDependency(e,!1),d=s instanceof In?s:new In(s.start,s.top,s.end-s.start,s.bottom-s.top),f=l instanceof In?l:new In(l.start,l.top,l.end-l.start,l.bottom-l.top),h=In.union(d,f);r.isGantt||[[c,d,s],[u,f,l]].map((function(e){var t=te()(e,3),n=t[0],i=t[1],o=t[2];if("default"===r.milestoneLayoutMode&&n.isMilestone){!r.milestoneWidth&&o.eventEl&&n.iconCls&&(r.milestoneWidth=o.eventEl.firstElementChild.offsetWidth);var a=r.milestoneWidth||i.height;i.left-=a/2,i.right+=a/2}})),a.bounds={bounds:h,startRectangle:d,endRectangle:f,layout:s.layout&&l.layout}}return e.instanceMeta(o).bounds}},{key:"getIteratableDependencyAssignments",value:function(e){return this.assignmentStore?this.dataApi.getDependencyAssignmentsAsFromToArray({dependency:e,assignmentStore:this.assignmentStore}):[null]}},{key:"addToGridCache",value:function(e){var t=this,n=t.dependencyGridCache,r=t.cacheGridSize,i=t.rowStore;t.getIteratableDependencyAssignments(e).forEach((function(o){var a=t.getDependencyBounds(e,o);a&&function(){var s,l,c,u,d=t.getMetaId(o),f=e.instanceMeta(d).gridCache=[],h=i.indexOf(t.getRowRecordFromDependency(e,!0,o)),g=i.indexOf(t.getRowRecordFromDependency(e,!1,o)),v=Math.min(h,g),p=Math.max(h,g),y=a.bounds,m=Math.floor(Math.max(y.x,0)/r.x),b=Math.floor(y.right/r.x),k=Math.floor(v/r.index),w=Math.floor(p/r.index);for(c=m;c<=b;c++)for(s=n[c]||(n[c]={}),u=k;u<=w;u++)(l=s[u]||(s[u]=[])).find((function(t){return t.dependency.id===e.id&&t.assignmentData===o&&t.metaId===d}))||l.push({dependency:e,assignmentData:o,metaId:d}),f.push([c,u])}()}))}},{key:"removeFromCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;(t?[t]:this.getIteratableDependencyAssignments(e)).forEach((function(t){var r=n.getMetaId(t),i=e.instanceMeta(r);i.gridCache&&n._dependencyGridCache&&i.gridCache.forEach((function(r){var i=te()(r,2),o=i[0],a=i[1];if(n._dependencyGridCache.hasOwnProperty(o)&&n._dependencyGridCache[o].hasOwnProperty(a)){var s=n._dependencyGridCache[o][a],l=s.findIndex((function(n){return n.dependency===e&&(n.assignmentData===t||n.assignmentData.from===t.from&&n.assignmentData.to===t.to)}));l>-1&&s.splice(l,1)}})),i.bounds=null,i.gridCache=null}))}},{key:"resetBoundsCache",value:function(){this._resetBoundsCache=!0}},{key:"resetGridCache",value:function(){this.dependencyGridCache=null}},{key:"prepareLineDef",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=this,r=n.getTimeSpanRecordFromDependency(e,!0),i=n.getTimeSpanRecordFromDependency(e,!1),o=e.type,a=e.fromSide,s=e.toSide;if(!a)switch(!0){case o===Hv.Type.StartToEnd:case o===Hv.Type.StartToStart:a=n.getConnectorStartSide(r);break;case o===Hv.Type.EndToStart:case o===Hv.Type.EndToEnd:a=n.getConnectorEndSide(r);break;default:throw new Error("Invalid dependency type: "+o)}if(!s)switch(!0){case o===Hv.Type.StartToEnd:s=n.getConnectorEndSide(i);break;case o===Hv.Type.StartToStart:case o===Hv.Type.EndToStart:s=n.getConnectorStartSide(i);break;case o===Hv.Type.EndToEnd:s=n.getConnectorEndSide(i);break;default:throw new Error("Invalid dependency type: "+o)}var l=t.startRectangle,c=t.endRectangle;return{startBox:{start:l.x,end:l.right,top:l.y,bottom:l.bottom},endBox:{start:c.x,end:c.right,top:c.y,bottom:c.bottom},startSide:a,endSide:s}}},{key:"drawLine",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=this.client,s=this.getMetaId(i),l=t.instanceMeta(s).lineElement;(l&&o||(l=document.createElementNS("http://www.w3.org/2000/svg","polyline"),o&&(t.instanceMeta(s).lineElement=l),l.setAttribute("depId",t.id),i&&(l.setAttribute("fromId",i.from.id),l.setAttribute("toId",i.to.id)),e.appendChild(l)),l.classList.length&&l.classList.remove.apply(l.classList,l.getAttribute("class").split(" ")),l.classList.add(this.baseCls),t.cls&&l.classList.add(t.cls),t.bidirectional&&l.classList.add("b-sch-bidirectional-line"),t.highlighted)&&(r=l.classList).add.apply(r,Z()(t.highlighted.split(" ")));if(Re.isIE11){var c=t.getDateRange(!0),u=a.startDate;c.start<u&&l.classList.add("b-no-start-marker"),c.end<u&&l.classList.add("b-no-end-marker")}return l.setAttribute("points",n?n.map((function(e,t){return t!==n.length-1?"".concat(e.x1,",").concat(e.y1):"".concat(e.x1,",").concat(e.y1," ").concat(e.x2,",").concat(e.y2)})).join(" "):""),Ms.set(l,{dependency:t}),l}},{key:"refreshDependency",value:function(e){var t=this,n=t.getIteratableDependencyAssignments(e);t.releaseDependency(e,null!==n[0]),t.removeFromCache(e),t.addToGridCache(e),n.forEach((function(n){return t.drawDependency(e,null,n)}))}},{key:"refreshDependencyAssignment",value:function(e,t){this.releaseDependency(e,t),this.removeFromCache(e,t),this.addToGridCache(e),this.drawDependency(e,null,t)}},{key:"scheduleRefreshDependency",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.dependenciesToRefresh;n?r.has(e)?!0!==r.get(e)&&r.get(e).add(n):r.set(e,new Set([n])):r.set(e,!0),1===r.size&&this.requestAnimationFrame((function(){t.refreshDependencyOnFrame()}))}},{key:"refreshDependencyOnFrame",value:function(){var e=this,t=e.dependenciesToRefresh;e.client.isPainted&&(t.forEach((function(t,n){if(!0===t){var r=e.getIteratableDependencyAssignments(n);e.releaseDependency(n,null!==r[0]),e.removeFromCache(n)}else t.forEach((function(t){e.releaseDependency(n,t),e.removeFromCache(n,t)}))})),t.forEach((function(t,n){e.addToGridCache(n)})),t.forEach((function(t,n){!0===t&&(t=e.getIteratableDependencyAssignments(n)),t.forEach((function(t){e.drawDependency(n,null,t)}))})),t.clear(),e.client.trigger("dependenciesDrawn",{partial:!0}))}},{key:"drawDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.client.svgCanvas,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=this,a=o.drawnDependencies,s=o.oldDrawnDependencies,l=t||o.getDependencyBounds(e,n),c=function(t){return t.dependency===e&&(t.assignmentData===n||t.assignmentData&&t.assignmentData.from===n.from&&t.assignmentData.to===n.to)};if(!o.disabled&&l){var u=o.prepareLineDef(e,l),d=o.pathFinder.findPath(u,o.lineDefAdjusters);o.drawLine(r,e,d,n,i),i&&!a.some(c)&&a.push({dependency:e,assignmentData:n})}var f=s&&s.findIndex(c);f>=0&&s.splice(f,1)}},{key:"drawForTimeSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;n.client.isAnimating?n.client.on({transitionend:function(){n.drawForTimeSpan(e,!0)},once:!0}):n.dependencyStore.getTimeSpanDependencies(e).forEach((function(e){t?n.scheduleRefreshDependency(e):n.refreshDependency(e)}))}},{key:"drawForEvent",value:function(e){this.drawForTimeSpan(e)}},{key:"updateDependenciesForTimeSpan",value:function(e,t){var n,r=this,i=this,o=e.isAssignment?e.event:e,a=i.dependencyStore.getTimeSpanDependencies(o),s=i.getMetaId(),l=i.client,c=In.from(t,l.timeAxisSubGridElement);a.forEach((function(t){r.getIteratableDependencyAssignments(t).forEach((function(r){var a,l,u,d=c.clone();r&&r.from!==e&&r.to!==e||i.isDependencyVisible(t,r)&&(i.getTimeSpanRecordFromDependency(t,!0)===o?(a=d,(n=t.instanceMeta(s).bounds)?l=n.endRectangle:(u=i.getBox(t,!1,r))&&(l=new In(u.start,u.top,u.end-u.start,u.bottom-u.top))):((n=t.instanceMeta(s).bounds)?a=n.startRectangle:(u=i.getBox(t,!0,r))&&(a=new In(u.start,u.top,u.end-u.start,u.bottom-u.top)),l=d),a&&l&&i.drawDependency(t,{startRectangle:a,endRectangle:l},r))}))}))}},{key:"scheduleDraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.disabled||(e&&t.resetBoundsCache(),t.client.isAnimating?t.clientTransitionRemover||(t.clientTransitionRemover=t.client.on({transitionend:function(){t.clientTransitionRemover(),t.clientTransitionRemover=null,t.draw()},once:!0})):t.doScheduleDraw())}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.client;if((t.oldDrawnDependencies||t.dependencyStore.count)&&n.isPainted)if(n.isAnimating)n.on({transitionend:function(){t.scheduleDraw(!0)},once:!0});else{var r=n.timeAxisSubGrid.viewRectangle;if(e&&t.resetBoundsCache(),r.width&&r.height){if(t.oldDrawnDependencies=t.drawnDependencies,t.drawnDependencies=[],r.inflate(t.bufferSize),!t.disabled&&t.rowStore.count&&n.rowManager.rowCount){var i,o,a,s={},l=t.dependencyGridCache,c=t.cacheGridSize,u=Math.floor(Math.max(r.left,0)/c.x),d=Math.floor(r.right/c.x),f=Math.floor(n.rowManager.topRow.dataIndex/c.index),h=Math.floor(n.rowManager.bottomRow.dataIndex/c.index),g=[];for(i=u;i<=d;i++)for(o=f;o<=h;o++){var v=l[i],p=v&&v[o];for(a=0;p&&a<p.length;a++){var y=p[a],m=y.dependency,b=y.assignmentData,k=y.metaId,w=m.id+"-"+k;if(!s[w]){var S=t.getDependencyBounds(m,b);(S&&S.bounds.intersect(r,!0,!0)||n.ignoreViewBox)&&g.push([m,S,b]),s[w]=!0}}}g.forEach((function(e){var n=te()(e,3),r=n[0],i=n[1],o=n[2];t.drawDependency(r,i,o)}))}t._resetBoundsCache=!1,t.oldDrawnDependencies.forEach((function(e){return t.releaseDependency(e.dependency,e.assignmentData)})),n.trigger("dependenciesDrawn"),this.isDrawn=!0}}}},{key:"releaseDependency",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!0===n)Object.keys(e.meta.map||{}).filter((function(e){return e.startsWith(t.client.id)})).forEach((function(t){var n=e.meta.map[t];n.lineElement&&(n.lineElement.remove(),n.lineElement=null)}));else{var r=this.getMetaId(n),i=e.instanceMeta(r).lineElement;i&&(e.instanceMeta(r).lineElement=null,i.remove())}}},{key:"render",value:function(){var e=this,t=e.client;e.showTooltip&&(e.tooltip=e.createTooltip()),t.timeAxis.on({endreconfigure:e.resetGridCache,thisObj:e}),t.rowManager.on({refresh:e.onRowsRefresh,changetotalheight:e.onChangeTotalHeight,thisObj:e}),t.on({horizontalscroll:e.onHorizontalScroll,svgcanvascreated:e.createMarkers,togglenode:e.onToggleNode,scroll:e.onVerticalScroll,timelineviewportresize:e.onViewportResize,thisObj:e}),e.highlightDependenciesOnEventHover&&(t.on(t.scheduledEventName+"MouseEnter",(function(t){return e.highlightEventDependencies(t.eventRecord||t.taskRecord)})),t.on(t.scheduledEventName+"MouseLeave",(function(t){return e.unhighlightEventDependencies(t.eventRecord||t.taskRecord)}))),e.draw()}},{key:"renderContents",value:function(){this.draw()}},{key:"getConnectorStartSide",value:function(e){return this.client.currentOrientation.getConnectorStartSide(e)}},{key:"getConnectorEndSide",value:function(e){return this.client.currentOrientation.getConnectorEndSide(e)}},{key:"createTooltip",value:function(){var e=this,t=e.client;return new Ui(Object.assign({align:"b-t",id:"".concat(t.id,"-dependency-tip"),forSelector:".b-timelinebase:not(.b-eventeditor-editing):not(.b-resizing-event):not(.b-dragcreating):not(.b-dragging-event):not(.b-creating-dependency) .".concat(e.baseCls),clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],forElement:t.timeAxisSubGridElement,showOnHover:!0,hoverDelay:0,hideDelay:0,anchorToTarget:!1,trackMouse:!1,getHtml:e.getHoverTipHtml.bind(e)},e.tooltip||{}))}},{key:"getHoverTipHtml",value:function(e){var t=e.activeTarget,n=this,r=n.getDependencyForElement(t),i=n.dataApi.getDependencySourceEvent({dependency:r,eventStore:this.eventStore}),o=n.dataApi.getDependencyTargetEvent({dependency:r,eventStore:this.eventStore});return Ii.tpl(Cp(),n.L("from"),i.name,xp[r.type],n.L("to"),o.name,Ep[r.type])}},{key:"rowStore",get:function(){return this.resourceStore}},{key:"scheduler",get:function(){return this.client}},{key:"dependencyGridCache",get:function(){var e=this;return e._dependencyGridCache||(e._dependencyGridCache={},e.dependencyStore.forEach((function(t){return e.addToGridCache(t)}))),e._dependencyGridCache},set:function(e){this._dependencyGridCache=e}}],[{key:"$name",get:function(){return"Dependencies"}},{key:"defaultConfig",get:function(){return{pathFinderConfig:null,overCls:"b-sch-dependency-over",baseCls:"b-sch-dependency",store:null,dependencies:null,highlightDependenciesOnEventHover:!1,showTooltip:!0,tooltip:null,bufferSize:50,cacheGridSize:{x:500,index:25},drawnDependencies:[],drawnLines:[],dependenciesToRefresh:new Map,storeClass:Bv}}},{key:"pluginConfig",get:function(){return{chain:["render","renderContents","onElementClick","onElementDblClick","onElementMouseOver","onElementMouseOut"],assign:["getElementForDependency","getDependencyForElement"]}}}]),r}(Fo(ho).mixes((function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ap()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,t);var n=this;n.view=e,n.eventName=e.scheduledEventName,n.view.on("readOnly",(function(){return n.updateCreateListeners()})),n.updateCreateListeners()}},{key:"doDestroy",value:function(){var e=this;e.detachListeners("view"),e.creationData=null,e.mouseDetacher&&e.mouseDetacher(),e.creationTooltip&&e.creationTooltip.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"updateCreateListeners",value:function(){var e,t=this;t.view&&(t.detachListeners("view"),t.isCreateAllowed&&t.view.on((e={name:"view"},oe()(e,"".concat(t.eventName,"mouseenter"),"onTimeSpanMouseEnter"),oe()(e,"".concat(t.eventName,"mouseleave"),"onTimeSpanMouseLeave"),oe()(e,"thisObj",t),e)))}},{key:"onTimeSpanMouseEnter",value:function(e){var t=e["".concat(this.eventName,"Record")],n=e["".concat(this.eventName,"Element")];this.showTerminals(t,on.down(n,e.source.eventInnerSelector))}},{key:"onTimeSpanMouseLeave",value:function(e){var t=e["".concat(this.eventName,"Element")];this.creationData&&on.isDescendant(t,this.creationData.sourceTerminal.parentElement)||this.hideTerminals(t)}},{key:"onTerminalMouseOut",value:function(e){var t=this,n=on.up(e.target,t.view.eventSelector);on.isDescendant(n,t.showingTerminalsFor)||t.creationData&&n===t.creationData.sourceTerminal.parentElement||(t.hideTerminals(n),t.view.unhover(e))}},{key:"onTerminalMouseDown",value:function(e){var t=this;if(0===e.button&&!t.creationData){var n=t.view,r=n.timeAxisSubGridElement,i=e.target,o=i.parentElement.closest(n.eventSelector),a=In.from(n.element,document.body);e.preventDefault(),e.stopPropagation(),t.creationData={source:n.resolveTimeSpanRecord(o),sourceTerminal:i,startPoint:In.from(i,r).center,startX:e.pageX-a.x+n.scrollLeft,startY:e.pageY-a.y+n.scrollTop,valid:!1},n.resolveResourceRecord&&(t.creationData.sourceResource=n.resolveResourceRecord(o)),t.mouseDetacher=Kn.on({mouseup:{element:document.body,handler:"onMouseUp"},mousemove:{element:r,handler:"onMouseMove"},thisObj:t})}}},{key:"onMouseMove",value:function(e){var t=this,n=t.view,r=t.creationData,i=In.from(n.element,document.body),o=e.pageX-i.x+n.scrollLeft-r.startX,a=e.pageY-i.y+n.scrollTop-r.startY,s=Math.round(Math.sqrt(o*o+a*a))-3,l=Math.atan2(a,o),c=t.connector;if(!c){if(!1===this.onRequestDragCreate())return;c=t.connector}c.style.width="".concat(s,"px"),c.style.transform="rotate(".concat(l,"rad)"),t.lastMouseMoveEvent=e}},{key:"onRequestDragCreate",value:function(){var e=this,t=e.view,n=e.creationData;if(!1===t.trigger("beforeDependencyCreateDrag",{data:n}))return e.abort(),!1;t.element.classList.add("b-creating-dependency"),e.connector=e.createConnector(n.startPoint.x,n.startPoint.y),t.trigger("dependencyCreateDragStart",{data:n}),e.showCreationTooltip&&(e.creationTooltip=e.creationTooltip||e.createDragTooltip(),e.creationTooltip.disabled=!1,e.creationTooltip.show()),t.scrollManager.startMonitoring({element:t.timeAxisSubGridElement,callback:function(){return e.lastMouseMoveEvent&&e.onMouseMove(e.lastMouseMoveEvent)},thisObj:e})}},{key:"onOverTargetTerminal",value:function(e){var t=this,n=e.target,r=t.view,i=t.creationData,o=t.connector;if(!(i.valid instanceof Promise))if(n!==i.sourceTerminal){if(n!==i.targetTerminal){i.targetTerminal=n,i.target=r.resolveTimeSpanRecord(n),r.resolveResourceRecord&&(i.targetResource=r.resolveResourceRecord(n));var a,s=i.sourceTerminal.dataset.side,l=i.targetTerminal.dataset.side,c=function(e){t.isDestroyed||(i.valid=e,n.classList.add(e?"b-valid":"b-invalid"),o.classList.add(e?"b-valid":"b-invalid"),r.trigger("dependencyValidationComplete",{data:i}))};switch(!0){case"left"===s&&"left"===l:a=Pv.Type.StartToStart;break;case"left"===s&&"right"===l:a=Pv.Type.StartToEnd;break;case"right"===s&&"left"===l:a=Pv.Type.EndToStart;break;case"right"===s&&"right"===l:a=Pv.Type.EndToEnd}r.trigger("dependencyValidationStart",{data:i}),i.valid=t.dataApi.isValidDependencyToCreate({type:a,sourceEvent:i.source,targetEvent:i.target,dependencyStore:t.dependencyStore}),i.valid instanceof Promise?i.valid.then(c):c(i.valid)}}else o.classList.remove("b-valid"),o.classList.remove("b-invalid")}},{key:"onMouseUp",value:function(e){var t=this,n=t.creationData,r=e.target;t.abort();var i=function(){var r=ta()(Zo.a.mark((function r(){var i;return Zo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.targetTerminal=e.target,!((i=t.createDependency(n))instanceof Promise)){r.next=5;break}return r.next=5,i;case 5:t.view.trigger("dependencyCreateDrop",{data:n});case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),o=function(e){t.view.trigger("afterDependencyCreateDrop",{data:e})};n.valid&&r.matches(".".concat(t.terminalCls))?n.valid instanceof Promise?n.valid.then((function(e){n.valid=e,e?i().then((function(){return o(n)})):o(n)})):i().then((function(){return o(n)})):(n.valid=!1,o(n))}},{key:"abort",value:function(){var e=this,t=e.view,n=e.creationData;if(n){var r=n.source,i=n.sourceResource,o=n.target,a=n.targetResource;if(r){var s=t.getElementFromEventRecord(r,i);s&&e.hideTerminals(s)}if(o){var l=t.getElementFromEventRecord(o,a);l&&e.hideTerminals(l)}}e.creationTooltip&&(e.creationTooltip.disabled=!0),e.creationData=e.lastMouseMoveEvent=null,e.mouseDetacher&&e.mouseDetacher(),e.removeConnector()}},{key:"createConnector",value:function(e,t){var n=this.view;return this.connector=on.createElement({parent:n.timeAxisSubGridElement,className:"".concat(this.baseCls,"-connector"),style:"left:".concat(e,"px;top:").concat(t,"px")}),n.element.classList.add("b-creating-dependency"),this.connector}},{key:"createDragTooltip",value:function(){var e=this,t=e.view;return e.creationTooltip=new Ui(Object.assign({id:"".concat(t.id,"-dependency-drag-tip"),cls:"b-sch-dependency-creation-tooltip",loadingMsg:"",autoShow:!0,anchorToTarget:!1,forSelector:".b-sch-terminal",forElement:t.timeAxisSubGridElement,trackMouse:!0,constrainTo:null,getHtml:function(t){var n=t.tip,r=t.event;if(e.creationData)return r&&e.onOverTargetTerminal(r),e.generateTooltipContent(n,e.creationData)},header:{dock:"right"},listeners:{pointerout:function(t){var n=t.source,r=e.creationData;return r.target=r.targetTerminal=null,r.valid=!1,n.html=n.getHtml({tip:n}),!1},beforeShow:function(e){var t=e.source;t.html=t.getHtml({tip:t})}}},e.creationTooltip||{}))}},{key:"removeConnector",value:function(e){var t=this,n=t.connector,r=t.view;n&&(n.classList.add("b-removing"),n.style.width="0",t.setTimeout((function(){n.remove(),t.connector=null,e&&e.call(t)}),200)),r.element.classList.remove("b-creating-dependency"),t.creationTooltip&&t.creationTooltip.hide(),r.scrollManager.stopMonitoring(r.timeAxisSubGridElement)}},{key:"showTerminals",value:function(e,t){var n=this;if(n.isCreateAllowed){var r=n.terminalCls,i="".concat(r,"s-visible");(t=on.down(t,n.view.eventInnerSelector)).classList.contains(i)||this.view.element.classList.contains("b-resizing-event")||n.view.readOnly||(n.terminalSides.forEach((function(e){var i=on.createElement({parent:t,className:"".concat(r," ").concat(r,"-").concat(e),dataset:{side:e,feature:!0}});i.detacher=Kn.on({element:i,mouseout:"onTerminalMouseOut",mousedown:{handler:"onTerminalMouseDown",capture:!0},thisObj:n})})),t.classList.add(i),e.cls.add(i),n.showingTerminalsFor=t)}}},{key:"hideTerminals",value:function(e){var t=this,n=t.client.getTimeSpanMouseEventParams(e)["".concat(this.eventName,"Record")],r="".concat(t.terminalCls,"s-visible");on.forEachSelector(e,".".concat(t.terminalCls),(function(e){e.detacher&&e.detacher(),e.remove()})),on.down(e,t.view.eventInnerSelector).classList.remove(r),n.cls.remove(r),t.showingTerminalsFor=null}},{key:"createDependency",value:function(e){var t=e.source,n=e.target,r=e.sourceTerminal.dataset.side,i=e.targetTerminal.dataset.side,o=("left"===r?0:2)+("right"===i?1:0);return this.dataApi.createDependency({sourceEvent:t,targetEvent:n,dependencyStore:this.dependencyStore,type:o,fromSide:r,toSide:i})}},{key:"generateTooltipContent",value:function(e,t){var n,r,i=this,o=t.valid;return Object.assign(t,{fromText:t.source.name,toText:t.target?t.target.name:"",fromSide:t.sourceTerminal.dataset.side,toSide:t.targetTerminal?t.targetTerminal.dataset.side:""}),o instanceof Promise?(e.element.classList.remove("b-invalid"),e.element.classList.add("b-checking"),n="checking",r=i.L("Checking"),new Promise((function(n){return o.then((function(r){t.valid=r,e.isDestroyed||n(i.generateTooltipContent(e,t))}))}))):(!0===o?(e.element.classList.remove("b-invalid"),e.element.classList.remove("b-checking"),n="valid",r=i.L("valid")):(e.element.classList.remove("b-checking"),e.element.classList.add("b-invalid"),n="invalid",r=i.L("invalid")),e.titleElement.innerHTML='<i class="b-icon b-icon-'.concat(n,'"></i>').concat(r),'<table class="b-sch-dependency-creation-tooltip">\n                        <tr><td>'.concat(i.L("from"),": </td><td>").concat(t.fromText,'</td><td><div class="b-sch-box b-').concat(t.fromSide,'"></div></td></tr>\n                        <tr><td>').concat(i.L("to"),": </td><td>").concat(t.toText,'</td><td><div class="b-sch-box b-').concat(t.toSide,'"></div></td></tr>\n                    </table>'))}},{key:"allowCreate",set:function(e){this._allowCreate=e,this.updateCreateListeners()},get:function(){return this._allowCreate}},{key:"isCreateAllowed",get:function(){return this.allowCreate&&!this.view.readOnly&&!this.disabled}}],[{key:"defaultConfig",get:function(){return{showCreationTooltip:!0,creationTooltip:null,terminalCls:"b-sch-terminal",terminalSides:["left","top","right","bottom"],allowCreate:!0}}}]),r}(e||G)}),fp,or,Sp));function Tp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Dp._$name="Dependencies",bd.registerFeature(Dp,!1,"Scheduler"),document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))&&function(e){if("Element"in e){var t=e.Element.prototype,n=Object,r=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},i=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},o=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(""===t)throw new o("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(t))throw new o("INVALID_CHARACTER_ERR","The token must not contain space characters.");return i.call(e,t)},s=function(e){for(var t=r.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],i=0,o=n.length;i<o;i++)this.push(n[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},l=s.prototype=[],c=function(){return new s(this)};if(o.prototype=Error.prototype,l.item=function(e){return this[e]||null},l.contains=function(e){return~a(this,e+"")},l.add=function(){var e,t=arguments,n=0,r=t.length,i=!1;do{e=t[n]+"",~a(this,e)||(this.push(e),i=!0)}while(++n<r);i&&this._updateClassName()},l.remove=function(){var e,t,n=arguments,r=0,i=n.length,o=!1;do{for(e=n[r]+"",t=a(this,e);~t;)this.splice(t,1),o=!0,t=a(this,e)}while(++r<i);o&&this._updateClassName()},l.toggle=function(e,t){var n=this.contains(e),r=n?!0!==t&&"remove":!1!==t&&"add";return r&&this[r](e),!0===t||!1===t?t:!n},l.replace=function(e,t){var n=a(e+"");~n&&(this.splice(n,1,t),this._updateClassName())},l.toString=function(){return this.join(" ")},n.defineProperty){var u={get:c,enumerable:!0,configurable:!0};try{n.defineProperty(t,"classList",u)}catch(e){void 0!==e.number&&-2146823252!==e.number||(u.enumerable=!1,n.defineProperty(t,"classList",u))}}else n.prototype.__defineGetter__&&t.__defineGetter__("classList",c)}}(window),function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){for(var n=0,r=arguments.length;n<r;n++)e=arguments[n],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:n.call(this,e)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(e,t){var n=this.toString().split(" "),r=n.indexOf(e+"");~r&&(n=n.slice(r),this.remove.apply(this,n),this.add(t),this.add.apply(this,n.slice(1)))}),e=null}();var Mp=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Tp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"processWidgetConfig",value:function(e){var t=this.dependencyEditFeature;return!("lagField"===e.ref&&!t.showLagField)&&(!("deleteButton"===e.ref&&!t.showDeleteButton)&&(Object.assign(e,{}),se()(J()(r.prototype),"processWidgetConfig",this).call(this,e)))}},{key:"afterShow",value:function(){var e,t=this.widgetMap.deleteButton;t&&(t.hidden=!this.record.isPartOfStore());for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(e=se()(J()(r.prototype),"afterShow",this)).call.apply(e,[this].concat(i))}},{key:"onInternalKeyDown",value:function(e){this.trigger("keyDown",{event:e}),se()(J()(r.prototype),"onInternalKeyDown",this).call(this,e)}}],[{key:"$name",get:function(){return"DependencyEditor"}},{key:"defaultConfig",get:function(){return{items:[],draggable:{handleSelector:":not(button,.b-field-inner)"},axisLock:"flexible"}}}]),r}(Ei);function Ap(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Mp._$name="DependencyEditor";var Ip=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ap()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n,i=this;if(e.dependencyEdit=i,i.dependencyStore=e.dependencyStore,se()(J()(r.prototype),"construct",this).call(this,e,t),!e.features.dependencies)throw new Error("Dependencies feature required when using DependencyEdit");i.clientListenersDetacher=e.on((n={},oe()(n,i.triggerEvent,i.onActivateEditor),oe()(n,"thisObj",i),n))}},{key:"doDestroy",value:function(){this.clientListenersDetacher(),this.editor&&this.editor.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onBeforeSave",value:function(e){}},{key:"onAfterSave",value:function(e){}},{key:"updateRecord",value:function(e){var t=this.values;if(e.beginBatch(),e.set(t),this.lagField){var n=this.lagField.value;e.setLag(n.magnitude,n.unit)}this.typeField&&"type"in t&&e.set({fromSide:null,toSide:null}),e.endBatch()}},{key:"onPopupKeyDown",value:function(e){var t=e.event;"Enter"===t.key&&this.saveAndCloseOnEnter&&"input"===t.target.tagName.toLowerCase()&&(t.preventDefault(),this.onSaveClick())}},{key:"onSaveClick",value:function(){this.save()&&this.editor.hide()}},{key:"onDeleteClick",value:function(){this.deleteDependency(),this.editor.hide()}},{key:"onCancelClick",value:function(){this.editor.hide()}},{key:"internalShowEditor",value:function(e){var t=this,n=t.client,r=t.lastPointerDownCoordinate;if(!1!==n.trigger("beforeDependencyEdit",{dependencyEdit:t,dependencyRecord:e})){var i=t.getEditor(e);if(t.loadRecord(e),n.trigger("beforeDependencyEditShow",{dependencyEdit:t,dependencyRecord:e,editor:i}),!r){var o=In.from(t.client.element).center;r=[o.x-i.width/2,o.y-i.height/2]}i.showByPoint(r)}}},{key:"editDependency",value:function(e){this.client.readOnly||this.internalShowEditor(e)}},{key:"getEditor",value:function(){var e=this,t=e.editor;return t||(0===(t=e.editor=new Mp(mt.assign({dependencyEditFeature:e,autoShow:!1,anchor:!0,scrollAction:"realign",clippedBy:[e.client.timeAxisSubGridElement,e.client.bodyContainer],constrainTo:window,autoClose:e.autoClose,cls:e.cls,listeners:{keydown:e.onPopupKeyDown,thisObj:e}},e.editorConfig))).items.length&&console.warn("Editor configured without any `items`"),t.eachWidget((function(t){var n=t.ref||t.id;n&&!e[n]&&(e[n]=t)})),e.saveButton&&e.saveButton.on("click",e.onSaveClick,e),e.deleteButton&&e.deleteButton.on("click",e.onDeleteClick,e),e.cancelButton&&e.cancelButton.on("click",e.onCancelClick,e),e.editor)}},{key:"loadRecord",value:function(e){var t=this;t.fromNameField.value=e.sourceEvent.name,t.toNameField.value=e.targetEvent.name,t.lagField&&(t.lagField.unit=e.lagUnit),t.editor.record=t.dependencyRecord=e}},{key:"save",value:function(){var e=this,t=e.client,n=e.dependencyRecord;if(n&&e.isValid){var r=e.dependencyStore,i=e.values;if(!1!==t.trigger("beforeDependencySave",{dependencyRecord:n,values:i})){if(e.onBeforeSave(n),e.updateRecord(n),r&&!n.stores.length){if(!1===t.trigger("beforeDependencyAdd",{dependencyRecord:n,dependencyEdit:e}))return;r.add(n)}t.project&&t.project.propagate(),t.trigger("afterDependencySave",{dependencyRecord:n}),e.onAfterSave(n)}return n}}},{key:"deleteDependency",value:function(){var e=this;return!1!==e.client.trigger("beforeDependencyDelete",{dependencyRecord:e.dependencyRecord})&&(e.editor.containsFocus&&e.editor.revertFocus(),e.client.dependencyStore.remove(e.dependencyRecord),e.client.project&&e.client.project.propagate(),!0)}},{key:"onActivateEditor",value:function(e){var t=e.dependency,n=e.event;this.disabled||(this.lastPointerDownCoordinate=[n.clientX,n.clientY],this.editDependency(t))}},{key:"editorConfig",get:function(){return this._editorConfig},set:function(e){var t=this.getDefaultConfiguration().editorConfig;(e=mt.assign({},t,e)).items=e.items||[],this._editorConfig=e}},{key:"isValid",get:function(){return Object.values(this.editor.widgetMap).every((function(e){return!(e.name&&!e.hidden)||!1!==e.isValid}))}},{key:"values",get:function(){var e={};return this.editor.eachWidget((function(t){t.name&&!t.hidden&&(e[t.name]=t.value)}),!0),e}}],[{key:"$name",get:function(){return"DependencyEdit"}},{key:"defaultConfig",get:function(){var e=this;return{autoClose:!0,saveAndCloseOnEnter:!0,showDeleteButton:!0,triggerEvent:"dependencydblclick",showLagField:!1,dependencyRecord:null,editorConfig:{title:"L{Edit dependency}",localeClass:this,closable:!0,items:[{type:"display",localeClass:this,label:"L{From}",editable:!1,ref:"fromNameField"},{type:"display",localeClass:this,label:"L{To}",ref:"toNameField"},{type:"combo",localeClass:this,label:"L{Type}",name:"type",ref:"typeField",editable:!1,valueField:"id",displayField:"name",items:Object.keys(Hv.Type).map((function(t){return{id:Hv.Type[t],name:e.L(t)}}))},{type:"duration",localeClass:this,label:"L{Lag}",name:"lag",ref:"lagField",allowNegative:!0}],bbar:[{type:"widget",cls:"b-label-filler"},{color:"b-green",localeClass:this,text:"L{Save}",ref:"saveButton"},{color:"b-gray",localeClass:this,text:"L{Delete}",ref:"deleteButton"},{color:"b-gray",localeClass:this,text:"L{Cancel}",ref:"cancelButton"}]}}}}]),r}(ho);function Fp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ip._$name="DependencyEdit",bd.registerFeature(Ip,!1);var Op=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Fp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"doDestroy",value:function(){this.menu&&this.menu.destroy()}},{key:"onElementContextMenu",value:function(e){"contextmenu"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onElementClick",value:function(e){"click"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onElementDblClick",value:function(e){"dblclick"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onEventSpaceKey",value:function(e){var t=In.from(e.target).center,n=new MouseEvent("contextmenu",Object.assign({clientX:t.x,clientY:t.y},e));Object.defineProperty(n,"target",{get:function(){return e.target}}),this.showEventContextMenu(n)}},{key:"showEventContextMenu",value:function(e){var t=this.client,n=e.target,r=on.up(n,t.eventSelector)||n;if(r){var i=this.resolveRecord(r);i&&(e.preventDefault(),this.showContextMenuFor(i,{targetElement:r,event:e}))}}},{key:"showContextMenuFor",value:function(e,t){}},{key:"beforeContextMenuShow",value:function(){}},{key:"showContextMenu",value:function(e){if(!this.disabled){var t=this,n=e.event,r=e.menuType.toLowerCase(),i=L.lowercaseFirstLetter(r),o="get".concat(L.capitalizeFirstLetter(r),"MenuItems"),a=t.client,s=t.processItems,l=t.defaultItems,c=t.namedItems,u=n?[n.clientX+1,n.clientY+1]:In.from(e.targetElement).center,d=e.items=mt.isEmpty(t.items)?mt.clone(l):mt.merge(mt.clone(l),t.items);e.namedItems=c,e.selection=a.selectedRecords;var f=a.getColumnFromElement(e.targetElement),h=[];if(f){a.getCellMenuItems(f,e.taskRecord,h);var g=h.reduce((function(e,t){return e[t.name]=t,e}),{});d=e.items=mt.copyPropertiesIf(d,g,Object.keys(g))}!function e(t,n){for(var r in t){var i=t[r];if(i){r in n&&(i=t[r]="object"===re()(i)?mt.merge(mt.clone(n[r]),i):n[r]);var o=i.menu;o&&e("items"in o?o.items:o,n)}}}(d,c),a[o]&&a[o](e,d),s&&!1===s(e)||mt.isEmpty(e.items)||!1!==t.beforeContextMenuShow(e)&&!1!==a.trigger("".concat(i,"ContextMenuBeforeShow"),e)&&(t.menu=Ce.showContextMenu(u,{owner:a,scrollAction:"hide",clippedBy:[a.timeAxisSubGridElement,a.bodyContainer],constrainTo:window,items:d,onDestroy:function(){t.menu=null},onBeforeItem:function(t){Object.assign(t,e)},onItem:function(e){return a.trigger("".concat(i,"ContextMenuItem"),e)},listeners:{show:function(t){var n=t.source;e.menu=n,a.trigger("".concat(i,"ContextMenuShow"),e)}}}))}}},{key:"hideContextMenu",value:function(e){this.menu&&this.menu.hide(e)}},{key:"defaultItems",set:function(e){this._defaultItems=e},get:function(){var e=mt.clone(this._defaultItems);if(this.client.readOnly)for(var t in e)e[t]=!1;return e}},{key:"triggerEvent",get:function(){return this._triggerEvent||this.client.contextMenuTriggerEvent},set:function(e){this._triggerEvent=e}}],[{key:"defaultConfig",get:function(){return{defaultItems:null,items:null,processItems:null,triggerEvent:null}}},{key:"pluginConfig",get:function(){return{assign:["showEventContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onEventSpaceKey"]}}}]),r}(ho);function _p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Op._$name="TimeSpanRecordContextMenuBase";var Pp=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(_p()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"resolveRecord",value:function(e){return this.client.resolveEventRecord(e)}},{key:"showContextMenuFor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.targetElement,r=t.event,i=this,o=i.client;(n||(n=o.getElementsFromEventRecord(e)[0]))&&i.showContextMenu({menuType:"event",eventElement:n,targetElement:n,eventRecord:e,resourceRecord:o.resolveResourceRecord(n),assignmentRecord:o.resolveAssignmentRecord(n),event:r})}},{key:"defaultItems",set:function(e){this._defaultItems=e},get:function(){var e=se()(J()(r.prototype),"defaultItems",this);return this.client.assignmentStore||(e.unassignEvent=!1),e}},{key:"namedItems",get:function(){var e=this.client;return this._namedItems||(this._namedItems={deleteEvent:{text:e.L("Delete event"),icon:"b-icon b-icon-trash",weight:-160,onItem:function(t){var n=t.menu,r=t.eventRecord,i=n.focusInEvent&&n.focusInEvent.relatedTarget;i&&(i.focus(),e.navigator.activeItem=i),e.removeRecords([r])}},unassignEvent:{text:e.L("Unassign event"),icon:"b-icon b-icon-unassign",weight:-150,name:"unassignEvent",onItem:function(t){var n=t.menu,r=t.eventRecord,i=t.resourceRecord,o=n.focusInEvent&&n.focusInEvent.relatedTarget;o&&(o.focus(),e.navigator.activeItem=o),r.unassign(i)}}}),this._namedItems}}],[{key:"$name",get:function(){return"EventContextMenu"}},{key:"defaultConfig",get:function(){return{items:null,processItems:null,defaultItems:{deleteEvent:!0,unassignEvent:!0}}}}]),r}(Op);function Lp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Pp.featureClass="",Pp._$name="EventContextMenu",bd.registerFeature(Pp,!0,"Scheduler");var Hp=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Lp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e)}},{key:"generateContent",value:function(e){var t=e.date,n=this.template(e),r=this.div;return r.innerHTML=n,this.updateDateIndicator(r,t),r.innerHTML}},{key:"updateDateIndicator",value:function(e,t){var n=e.querySelector(".b-sch-hour-indicator"),r=e.querySelector(".b-sch-minute-indicator");t&&n&&r&&("hour"===this.mode?(n.style.transform="rotate(".concat(t.getHours()%12*30,"deg)"),r.style.transform="rotate(".concat(6*t.getMinutes(),"deg)")):(n.style.transform="none",r.style.transform="none"))}},{key:"mode",get:function(){var e=ft.compareUnits(this.scheduler.timeAxisViewModel.timeResolution.unit,"day")<0,t=ft.formatContainsHourInfo(this.scheduler.displayDateFormat);return e&&t?"hour":"day"}},{key:"template",set:function(e){this._template=e},get:function(){return this._template}}],[{key:"defaultConfig",get:function(){return{minuteHeight:8,minuteTop:2,hourHeight:8,hourTop:2,handLeft:10,div:document.createElement("div"),scheduler:null,template:function(e){return'<div class="b-sch-clockwrap b-sch-clock-'.concat(this.mode," ").concat(e.cls||"",'">\n                    <div class="b-sch-clock">\n                        <div class="b-sch-hour-indicator">').concat(ft.format(e.date,"MMM"),'</div>\n                        <div class="b-sch-minute-indicator">').concat(ft.format(e.date,"D"),'</div>\n                        <div class="b-sch-clock-dot"></div>\n                    </div>\n                    <span class="b-sch-clock-text">').concat(e.text,"</span>\n                </div>")}}}}]),r}(G);function jp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Hp._$name="ClockTemplate";var Bp=function(e){$()(i,e);var t,n,r=(t=i,function(){var e,n=J()(t);if(jp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function i(){return D()(this,i),r.apply(this,arguments)}return M()(i,[{key:"render",value:function(){var e,t=this,n=t.client;t.drag&&t.drag.destroy(),t.drag=new Tc(Object.assign((e={name:t.constructor.name,mode:"translateXY"},oe()(e,this.client.isHorizontal?"lockY":"lockX",t.constrainDragToResource),oe()(e,this.client.isHorizontal?"lockX":"lockY",t.constrainDragToTimeSlot),oe()(e,"minX",!0),oe()(e,"maxX",!0),oe()(e,"constrain",!1),oe()(e,"cloneTarget",!t.constrainDragToTimeline),oe()(e,"dragWithin",t.constrainDragToTimeline?null:document.body),oe()(e,"hideOriginalElement",!0),oe()(e,"outerElement",n.timeAxisSubGridElement),oe()(e,"targetSelector",n.eventSelector),oe()(e,"isElementDraggable",(function(e,r){return!n.readOnly&&t.isElementDraggable(e,r)})),oe()(e,"scrollManager",t.constrainDragToTimeline?n.scrollManager:null),oe()(e,"transitionDuration",n.transitionDuration),oe()(e,"listeners",{beforedragstart:"onBeforeDragStart",dragstart:"onDragStart",drag:"onDrag",drop:"onDrop",abort:"onDragAbort",reset:"onDragReset",thisObj:t}),e),t.dragHelperConfig)),n.rowManager.on({changeTotalHeight:"updateYConstraint",thisObj:t}),t.showTooltip&&(t.clockTemplate=new Hp({scheduler:n}))}},{key:"doDestroy",value:function(){var e=this;e.drag&&e.drag.destroy(),e.clockTemplate&&e.clockTemplate.destroy(),e.tip&&e.tip.destroy(),se()(J()(i.prototype),"doDestroy",this).call(this)}},{key:"onBeforeDragStart",value:function(e){var t=e.context,n=(e.event,this.client),r=n.scheduledEventName,i=n.resolveEventRecord(t.element);if(this.disabled||!i||!i.isDraggable)return!1;t.pointerStartDate=n.getDateFromXY([t.startClientX,t.startPageY],null,!1);var o=!1!==n.trigger("before".concat(r,"Drag"),{eventRecord:i,context:this.dragData});return!1!==o&&this.updateYConstraint(i),o}},{key:"onDragStart",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.client,a=o.scheduledEventName;i.currentOverClient=o,i.scrollClients={},i.onMouseOverNewTimeline(o);var s=i.dragData=i.getDragData(n,r);if(i.showTooltip){var l=s.context.dragProxy?s.context.dragProxy.firstChild:n.element;i.tip?i.tip.showBy(l):(i.tip=new Ui({id:"".concat(o.id,"-event-drag-tip"),align:"b-t",autoShow:!0,updateContentOnMouseMove:!0,clippedBy:i.constrainDragToTimeline?[o.timeAxisSubGridElement,o.bodyContainer]:null,forElement:l,getHtml:i.getTipHtml.bind(i),style:"pointer-events:none",cls:i.tooltipCls}),i.tip.on("innerhtmlupdate",i.updateDateIndicator,i))}o.trigger("".concat(a,"DragStart"),(t={},oe()(t,"".concat(a,"Records"),s.draggedRecords),oe()(t,"context",s),t))}},{key:"updateDateIndicator",value:function(){var e=this.dragData,t=e.startDate,n=e.endDate,r=this.tip,i=r.element.querySelector(".b-sch-tooltip-enddate");this.clockTemplate.updateDateIndicator(r.element,t),i&&this.clockTemplate.updateDateIndicator(i,n)}},{key:"onDrag",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.dragData,a=o.startDate;if(i.constrainToTimeline)t=i.client;else{var s=r.target;if(/^touch/.test(r.type)){var l=In.from(o.context.element,null,!0).center;s=on.elementFromPoint(l.x,l.y)}t=we.fromElement(s,"timelinebase")}var c=i.client.features.dependencies,u=n.newX,d=n.newY;if(t){if(t!==i.currentOverClient&&i.onMouseOverNewTimeline(t),i.updateDragContext(n,r),i.constrainDragToTimeline&&(i.showExactDropPosition||i.client.timeAxisViewModel.snap)){var f=t.getDateFromCoordinate(i.getCoordinate(o.draggedRecords[0],n.element,[u,d]))-o.sourceDate,h=new Date(o.origStart-0+f),g=t.timeAxisViewModel.getDistanceBetweenDates(h,o.startDate);o.startDate>=t.timeAxis.startDate&&null!=g&&on.addTranslateX(n.element,g)}i.triggerEventDrag(o,a);var v=i.checkDragValidity(o,r);v&&"boolean"!=typeof v&&(n.message=v.message||"",v=v.valid),n.valid=!1!==v,i.showTooltip&&i.tip.realign(),c&&c.updateDependenciesForTimeSpan(o.draggedRecords[0],o.context.element.querySelector(t.eventInnerSelector))}else c&&c.updateDependenciesForTimeSpan(o.draggedRecords[0],o.context.element)}},{key:"onMouseOverNewTimeline",value:function(e){var t=this.scrollClients;(this.currentOverClient.element.classList.remove("b-dragging-"+this.currentOverClient.scheduledEventName),e.element.classList.add("b-dragging-"+e.scheduledEventName),e.id in t)||(e.scrollManager.startMonitoring({element:e.timeAxisSubGridElement}),t[e.id]=e);this.currentOverClient=e}},{key:"onDrop",value:function(e){var t=e.context,n=e.event,r=this,i=r.currentOverClient,o=r.dragData;if(!t.valid)return r.onInvalidDrop({context:t,event:n});var a=!1;r.updateDragContext(t,n),r.tip&&r.tip.hide(),t.valid&&o.startDate&&o.endDate&&(o.finalize=function(){r.finalize.apply(r,arguments),t.finalize.apply(t,arguments)},i.trigger("before".concat(i.capitalizedEventName,"DropFinalize"),{context:o,event:n}),t.async=o.async,!t.async&&r.isValidDrop(o)&&(a=o.startDate-o.origStart!=0||o.newResource!==o.resourceRecord)),t.async||r.finalize(o.valid&&t.valid&&a)}},{key:"onDragAbort",value:function(e){var t,n=e.context,r=this,i=r.dragData,o=r.client,a=i.draggedRecords;o.currentOrientation.onDragAbort(n),r.dragData.record.instanceMeta(o).retainElement=!1,r.tip&&r.tip.hide(),o.trigger("".concat(o.capitalizedEventName,"DragAbort"),(t={},oe()(t,"".concat(o.scheduledEventName,"Records"),a),oe()(t,"context",i),t))}},{key:"onInvalidDrop",value:function(){var e=this;e.dragData.draggedRecords.forEach((function(t){return e.resumeElementRedrawing(t)})),e.tip&&e.tip.hide()}},{key:"onDragReset",value:function(e){var t=e.source,n=this;for(var r in n.scrollClients||{})n.scrollClients[r].scrollManager.stopMonitoring(n.scrollClients[r].timeAxisSubGridElement);t.context&&t.context.started&&n.dragData.eventBarEls[0].classList.remove("b-drag-main");if(n.scrollClients=null,n.currentOverClient&&n.currentOverClient.element.classList.remove("b-dragging-"+n.currentOverClient.scheduledEventName),n.dragData&&!n.dragData.context.valid){var i=n.currentOverClient.features.dependencies;i&&i.scheduleDraw(!0)}}},{key:"onInternalInvalidDrop",value:function(){var e,t=this,n=t.currentOverClient;t.tip&&t.tip.hide(),t.drag.abort(),n.trigger("after".concat(n.capitalizedEventName,"Drop"),(e={},oe()(e,n.scheduledEventName+"Records",t.dragData.draggedRecords),oe()(e,"valid",!1),oe()(e,"context",t.dragData),e))}},{key:"finalize",value:(n=ta()(Zo.a.mark((function e(t){var n,r,i,o,a,s,l;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).currentOverClient,i=n.dragData,o=i.context,(a=i.draggedRecords).forEach((function(e,t){n.resumeElementRedrawing(e),i.eventBarEls[t].classList.remove(n.drag.draggingCls)})),!t){e.next=11;break}if(!((s=n.updateRecords(i))instanceof Promise)){e.next=8;break}return o.async=!0,e.next=8,s;case 8:i.valid?(n.drag.reset(),r.trigger("after".concat(r.capitalizedEventName,"Drop"),(l={},oe()(l,"".concat(r.scheduledEventName,"Records"),a),oe()(l,"valid",!0),oe()(l,"context",i),l))):n.onInternalInvalidDrop(),e.next=12;break;case 11:n.onInternalInvalidDrop();case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateDragContext",value:function(e,t){var n=this,r=n.drag,i=n.dragData,o=n.currentOverClient,a=o.isHorizontal,s=e.element,l=In.from(s,o.timeAxisSubGridElement),c=i.draggedRecords[0],u=c.isAssignment?c.event:c,d=n.constrainDragToTimeSlot||(a?r.lockX:r.lockY);if(i.browserEvent=t,d)i.timeDiff=0;else{if(o.timeAxis.isContinuous){var f=i.dateConstraints,h=o.timeAxisSubGrid.scrollable,g=h.viewport,v=o.isHorizontal?e.clientX-g.x+h.x:e.clientY-g.y+h.y,p=o.timeAxisViewModel.getDateFromPosition(v,null,!0),y=i.timeDiff=p-e.pointerStartDate;i.startDate=n.adjustStartDate(i.origStart,y),f&&(i.startDate=ft.constrain(i.startDate,f.start,new Date(f.end-u.durationMS))),i.endDate=new Date(i.startDate-0+i.duration)}else{var m=n.resolveStartEndDates(l);i.startDate=m.startDate,i.endDate=m.endDate}i.timeDiff=i.startDate-i.origStart}if(Object.assign(i,n.getProductDragContext(i)),i.valid)if(i.endDate<=o.timeAxis.startDate||i.startDate>=o.timeAxis.endDate)i.context.valid=!1,i.context.message=n.L("noDropOutsideTimeline");else{var b=!t||n.checkDragValidity(i,t);b&&"boolean"!=typeof b?(i.context.valid=!1!==b.valid,i.context.message=b.message):(i.context.valid=!1!==b,i.context.message="")}else i.context.valid=!1}},{key:"suspendElementRedrawing",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.instanceMeta(this.client).retainElement=t}},{key:"resumeElementRedrawing",value:function(e){this.suspendElementRedrawing(e,!1)}},{key:"getDragData",value:function(e,t){var n=this,r=n.client,i=n.setupProductDragData(e),o=i.record,a=i.dateConstraints,s=i.eventBarEls,l=i.draggedRecords,c=o.startDate,u=o.endDate,d=r.timeAxis,f=c<d.startDate,h=u>d.endDate,g=n.getCoordinate(o,e.element,[e.elementStartX,e.elementStartY]),v=n.getCoordinate(o,e.element,[e.startClientX,e.startClientY]);l.forEach((function(e){return n.suspendElementRedrawing(e)})),n.drag.startEvent.ctrlKey&&n.client.selectEvent(l[0],!0);var p={context:e,dateConstraints:a,eventBarEls:s,record:o,draggedRecords:l,sourceDate:f?c:r.getDateFromCoordinate(g),screenSourceDate:r.getDateFromCoordinate(v,null,!1),origStart:c,origEnd:u,startDate:c,endDate:u,timeDiff:0,startsOutsideView:f,endsOutsideView:h,duration:u-c,browserEvent:t};if(s.forEach((function(e,t){e.classList.add(n.drag.draggingCls),e.classList.remove("b-sch-event-hover"),e.classList.remove("b-active"),e.classList.remove("b-first-render")})),s.length>1)if(e.relatedElements=s.slice(1),e.relatedElStartPos=[],e.relatedElDragFromPos=[],n.unifiedDrag){n.client.isAnimating=!0,Kn.on({element:s[1],transitionend:function(e){n.client.isAnimating=!1},once:!0}),s[0].classList.add("b-drag-main");var y=on.getTranslateXY(e.element),m=te()(y,2),b=m[0],k=m[1];e.relatedElements.forEach((function(t,n){e.relatedElStartPos[n]=on.getTranslateXY(t),b+=10,k+=10,on.setTranslateXY(t,b,k),e.relatedElDragFromPos[n]=[b,k]}))}else e.relatedElements.forEach((function(t,n){e.relatedElStartPos[n]=e.relatedElDragFromPos[n]=on.getTranslateXY(t)}));return p}},{key:"getRelatedRecords",value:function(e){return[]}},{key:"setupConstraints",value:function(e,t,n,r){var i=!this.showExactDropPosition&&n>1?n:0;r?this.setXConstraint(e.left,e.right-t.width,i):this.setXConstraint(!0,!0,i),this.setYConstraint(e.top,e.bottom-t.height,0)}},{key:"updateYConstraint",value:function(e){var t=this,n=t.client,r=t.drag.context,i=n.timeAxisViewModel.snapPixelAmount;if(r&&!t.drag.lockY){var o;if(!t.constrainDragToTimeline)return void t.setYConstraint(null,null,i);o=n.getScheduleRegion(null,e),t.setYConstraint(o.top,o.bottom-r.element.offsetHeight,i)}else t.setYConstraint(null,null,i)}},{key:"setXConstraint",value:function(e,t,n){var r=this.drag;r.leftConstraint=e,r.rightConstraint=t,r.minX=e,r.maxX=t}},{key:"setYConstraint",value:function(e,t,n){var r=this.drag;r.topConstraint=e,r.bottomConstraint=t,r.minY=e,r.maxY=t}},{key:"adjustStartDate",value:function(e,t){return this.client.timeAxis.roundDate(new Date(e-0+t),!!this.client.snapRelativeToEventStartDate&&e)}},{key:"resolveStartEndDates",value:function(e){var t=this.client.getStartEndDatesFromRectangle(e,"round",this.dragData.duration);return{startDate:t.start,endDate:t.end}}},{key:"getTipHtml",value:function(){var e,t=this,n=t.dragData,r=n.startDate,i=n.endDate,o=n.draggedRecords,a=t.client.getFormattedDate(r),s=t.client.getFormattedEndDate(i,r),l=t.dragData.context,c=l.valid,u=l.message;return t.dragTipTemplate((e={valid:c,startDate:r,endDate:i,startText:a,endText:s,message:u||""},oe()(e,t.client.scheduledEventName+"Record",o[0]),oe()(e,"dragData",t.dragData),oe()(e,"startClockHtml",t.clockTemplate.template({date:r,text:a,cls:"b-sch-tooltip-startdate"})),oe()(e,"endClockHtml",o[0].isMilestone?"":t.clockTemplate.template({date:i,text:s,cls:"b-sch-tooltip-enddate"})),e))}},{key:"isValidDrop",value:function(e){throw new Error("Implement in subclass")}},{key:"checkDragValidity",value:function(e){throw new Error("Implement in subclass")}},{key:"updateRecords",value:function(e){throw new Error("Implement in subclass")}},{key:"isElementDraggable",value:function(e,t){throw new Error("Implement in subclass")}},{key:"getCoordinate",value:function(e,t,n){throw new Error("Implement in subclass")}},{key:"setupProductDragData",value:function(e){throw new Error("Implement in subclass")}},{key:"getProductDragContext",value:function(e){throw new Error("Implement in subclass")}},{key:"constrainDragToTimeSlot",set:function(e){var t=this.client.isHorizontal?"lockX":"lockY";this._constrainDragToTimeSlot=e,this.drag&&(this.drag[t]=e)},get:function(){return this._constrainDragToTimeSlot}},{key:"constrainDragToResource",set:function(e){var t=this.client.isHorizontal?"lockY":"lockX";this._constrainDragToResource=e,this.drag&&(this.drag[t]=e)},get:function(){return this._constrainDragToResource}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e}}],[{key:"defaultConfig",get:function(){return{dragTipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")},constrainDragToResource:!0,showTooltip:!0,showExactDropPosition:!1,constrainDragToTimeline:!0,store:null,dragHelperConfig:null,tooltipCls:null}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),i}(ho);function Np(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Bp._$name="DragBase";var zp=[null],Vp=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Np()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"isElementDraggable",value:function(e,t){var n=this.scheduler,r=on.up(e,n.eventSelector),i=n.features.eventResize;if(!r||this.disabled)return!1;if(e.matches('[class$="-handle"]'))return!1;var o=n.resolveEventRecord(r);return!(i&&!o.isMilestone&&i.resize.overAnyHandle(t,r))}},{key:"triggerEventDrag",value:function(e,t){e.startDate-t==0&&e.newResource===e.resourceRecord||this.scheduler.trigger("eventDrag",{eventRecords:e.draggedRecords,startDate:e.startDate,endDate:e.endDate,newResource:e.newResource,context:e})}},{key:"onDragStart",value:function(e){var t=e.context,n=e.event,i=this.client.features.eventContextMenu;se()(J()(r.prototype),"onDragStart",this).call(this,{context:t,event:n}),i&&i.hideContextMenu(!1)}},{key:"isValidDrop",value:function(e){var t=e.newResource,n=e.resourceRecord,r=e.draggedRecords[0];return!t.meta.specialRow&&(n===t||(r instanceof Pg?(r=this.dataApi.getAssignmentEvent({assignment:r,eventStore:this.eventStore}),!this.dataApi.isAssignmentForResource({assignment:r,resource:t,resourceStore:this.resourceStore})):!this.dataApi.isEventAssignedToResource({event:r,resource:t,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore})))}},{key:"checkDragValidity",value:function(e,t){var n=this,r=this.currentOverClient,i=n.dragData.context.valid;return i&&(i=r.allowOverlap||r.isDateRangeAvailable(e.startDate,e.endDate,e.draggedRecords[0],e.newResource)?n.validatorFn.call(n.validatorFnThisObj||n,e,t):{valid:!1,message:n.L("eventOverlapsExisting")}),i}},{key:"updateRecords",value:function(e){var t,n=this.scheduler,r=this.currentOverClient,i=n.assignmentStore,o=n.eventStore,a=e.draggedRecords;if(o!==r.eventStore&&(o.remove(a),r.eventStore.add(a)),i){if(r!==n)throw new Error("Assignments cannot be dragged cross-scheduler");t=this.updateRecordsMultipleAssignmentMode(n,r,e,!1)}else t=this.updateRecordsSingleAssignmentMode(n,r,e,!1);return r.trigger("eventDrop",{eventRecords:a,isCopy:!1,event:e.browserEvent,targetEventRecord:e.targetEventRecord,targetResourceRecord:e.newResource,context:e}),t}},{key:"updateRecordsSingleAssignmentMode",value:function(e,t,n,r){var i,o=this,a=e!==t,s="vertical"===t.mode,l=e.eventStore,c=e.resourceStore,u=n.draggedRecords,d=n.timeDiff,f=n.resourceRecord,h=n.newResource,g=o.unifiedDrag||a&&u.length>1,v=[],p=o.constrainDragToResource?0:c.indexOf(f)-c.indexOf(h),y=o.adjustStartDate(u[0].startDate,d);if(s&&u.forEach((function(t,r){var i=n.eventBarEls[r];delete t.instanceMeta(e).hasTemporaryDragElement,i.dataset.transient&&i.remove()})),u.forEach((function(f,m){var b=n.eventBarEls[m],k=f.generation,w=a?zp:f.resources;b.querySelector(e.eventInnerSelector).classList.add(e.committingCls),r?(f=f.fullCopy(null),v.push(f)):l!==t.eventStore&&(l.remove(u),t.eventStore.add(u),f.instanceMeta(t).fromDragProxy=!0),f.beginBatch();var S=g?y:o.adjustStartDate(f.startDate,d);(0!==p||g||a)&&w.length&&w.forEach((function(e){var r=h;if(!g&&!a){var i=c.indexOf(e)-p;i<0?i=0:i>=c.getCount()&&(i=c.getCount()-1),r=c.getAt(i)}if(e?f.reassign(e,r):f.assign(r),!s){var o=t.rowManager.getRowFor(r)&&t.isInTimeAxis(f)?t.getEventRenderId(f,r):null;if(o)if(a){var l=In.from(n.context.element,t.foregroundCanvas,!0),u=n.context.element.cloneNode(!0);on.setTranslateXY(u,l.x,l.y),u.classList.remove("b-first-render"),u.classList.remove("b-active"),u.classList.remove("b-drag-proxy"),u.classList.remove("b-dragging"),t.currentOrientation.cacheTimeSpanElement(f,r,u)}else t.currentOrientation.releaseTimeSpanDiv(b,!0),t.currentOrientation.updateElementId(b,o);else b.remove()}})),f.setStartDate(S,!0,l.skipWeekendsDuringDragDrop),f.endBatch(),f.generation!==k&&(i=!0)})),v.length){var m=l.count;l.add(v),l.count!==m&&(i=!0)}i||(n.valid=!1)}},{key:"updateRecordsMultipleAssignmentMode",value:function(e,t,n,r){var i,o=this,a=e!==t,s=e.eventStore,l=n.draggedRecords,c=n.timeDiff,u=n.resourceRecord,d=n.newResource,f={};l.forEach((function(l,h){var g=l.event,v=n.eventBarEls[h],p=g.generation,y=e.getEventRenderId(l.event,d);f[g.id]||(f[g.id]=!0,"vertical"===t.mode?v.dataset.transient&&(v.retainElement=!1):y&&(a?t.currentOrientation.cacheTimeSpanElement(g,v):t.currentOrientation.updateElementId(v,y)),g.setStartDate(o.adjustStartDate(g.startDate,c),!0,s.skipWeekendsDuringDragDrop),u!==d&&(r?g.assign(d):g.isAssignedTo(d)?g.unassign(l.resource):g.reassign(l.resource,d)),i=i||l.resource!==u||g.generation!==p)})),i||(n.valid=!1)}},{key:"getProductDragContext",value:function(e){var t,n=this.scheduler.resolveEventRecord(e.browserEvent.target);return t=this.constrainDragToResource?e.resourceRecord:this.constrainDragToTimeline?this.resolveResource()||e.newResource||e.resourceRecord:this.resolveResource(),{valid:Boolean(t),newResource:t,targetEventRecord:n}}},{key:"setupProductDragData",value:function(e){var t=this,n=t.scheduler,r=e.grabbed,i=n.resolveEventRecord(r),o=n.resolveResourceRecord(r),a=n.resolveAssignmentRecord(r),s=In.from(r),l=[a||i],c=[];if(t.constrainDragToResource&&!o)throw new Error("Resource could not be resolved for event: "+i.id);var u=n.getDateConstraints(t.constrainDragToResource?o:null,i);return t.constrainDragToTimeline&&t.setupConstraints(n.getScheduleRegion(t.constrainDragToResource?o:null,i),s,n.timeAxisViewModel.snapPixelAmount,Boolean(u)),n.multiEventSelect&&(n.isEventSelected(l[0])||t.drag.startEvent.ctrlKey)&&l.push.apply(l,t.getRelatedRecords(a||i)),l.forEach((function(e){var t;(t=e instanceof Pg?n.getElementFromEventRecord(e.event,e.resource):n.getElementFromEventRecord(e,e.resource))||(t=(t=n.currentOrientation.addTemporaryDragElement(e)).innerElement),c.push(t)})),c.forEach((function(e,t){return c[t]=e.parentNode})),{record:i,dateConstraints:u,eventBarEls:c,draggedRecords:l}}},{key:"getDragData",value:function(e,t){return Object.assign(se()(J()(r.prototype),"getDragData",this).call(this,e,t),{resourceRecord:this.scheduler.resolveResourceRecord(e.grabbed)})}},{key:"getRelatedRecords",value:function(e){return this.scheduler.selectedEvents.filter((function(t){return t!==e&&t.isDraggable}))}},{key:"getCoordinate",value:function(e,t,n){var r=this.currentOverClient;if(r.isHorizontal){var i=n[0];if("default"!==r.milestoneLayoutMode&&e.isMilestone)switch(r.milestoneAlign){case"center":i+=t.offsetWidth/2;break;case"end":i+=t.offsetWidth}return i}var o=n[1];if("default"!==r.milestoneLayoutMode&&e.isMilestone)switch(r.milestoneAlign){case"center":o+=t.offsetHeight/2;break;case"end":o+=t.offsetHeight}return o}},{key:"resolveResource",value:function(){var e=this.currentOverClient,t=e.isHorizontal,n=this.dragData.context,r=n.dragProxy||n.element,i=In.from(r,null,!0),o=e.isVertical||this.unifiedDrag?n.clientY:i.center.y,a=In.from(r,this.currentOverClient.timeAxisSubGridElement,!0).center,s=a.x,l=a.y;if(t){var c=e.rowManager.getRowAt(o);return c&&e.resourceStore.getAt(c.dataIndex)}return e.resolveResourceRecord(e.timeAxisSubGridElement.querySelector(".b-sch-timeaxis-cell"),[s,l])}},{key:"adjustStartDate",value:function(e,t){var n=this.currentOverClient;return n.timeAxis.roundDate(new Date(e-0+t),!!n.snapRelativeToEventStartDate&&e)}},{key:"resolveStartEndDates",value:function(e){var t=this.currentOverClient,n=this.dragData,r=t.getStartEndDatesFromRectangle(e,"round",n.duration),i=r.start,o=r.end;if(n.startsOutsideView)n.endsOutsideView||(i=ft.add(o,-n.duration,"ms"));else{if(i&&!t.timeAxis.dateInAxis(i,!1)){var a=t.timeAxis.getTickFromDate(i);a>=0&&(i=t.timeAxis.getDateFromTick(a))}o=ft.add(i,n.duration,"ms")}return{startDate:i,endDate:o}}},{key:"scheduler",get:function(){return this.client}},{key:"store",get:function(){return this.eventStore}}],[{key:"$name",get:function(){return"EventDrag"}},{key:"defaultConfig",get:function(){return{constrainDragToResource:!1,constrainDragToTimeSlot:!1,validatorFn:function(){},validatorFnThisObj:null,unifiedDrag:null}}}]),r}(Fo(Bp).mixes(fp,Sp));function Wp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Vp._$name="EventDrag",bd.registerFeature(Vp,!0,"Scheduler");var Up=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Wp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"doDestroy",value:function(){this.tip&&this.tip.destroy(),this.resize&&this.resize.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"addProxy",value:function(e){var t,n,r,i,o=this,a=o.client,s=a.barMargin,l=a.currentOrientation.getRowRegion(e.rowRecord);return a.isHorizontal?(r="currentX"in e?Math.min(e.startX,e.currentX+1):e.startX,i=l.y+s,t=e.width||o.dragTolerance,n=l.height-2*s):(r=l.x+s,i="currentY"in e?Math.min(e.startY,e.currentY+1):e.startY,t=l.width-2*s,n=e.height||o.dragTolerance),a.element.classList.add("b-dragcreating"),a.element.classList.add("b-dragcreating-proxy-sizing"),o.proxy=on.createElement({parent:a.foregroundCanvas,className:o.proxyCls,style:"transform:translate(".concat(r,"px, ").concat(i,"px);width:").concat(t,"px;height:").concat(n,"px"),retainElement:!0})}},{key:"removeProxy",value:function(){var e=this;e.proxy&&(e.proxy.remove(),e.resize.destroy(),e.proxy=e.resize=null,e.client.element.classList.remove("b-dragcreating"),e.client.element.classList.remove("b-dragcreating-proxy-sizing"),e.tip&&e.tip.hide())}},{key:"initResizer",value:function(e,t){var n,r=this;n=r.client.isHorizontal?t.currentX>t.startX?"right":"left":t.currentY>t.startY?"bottom":"top",r.resize&&r.resize.destroy(),r.resize=new jc({name:r.constructor.name,direction:r.client.isVertical?"vertical":"horizontal",isTouch:e.type.startsWith("touch"),grab:{element:r.proxy,edge:n,event:t.startEvent},allowEdgeSwitch:!0,outerElement:r.client.timeAxisSubGridElement,scrollManager:r.client.scrollManager,scroller:r.client.timeAxisSubGrid.scrollable,listeners:{resizing:r.onResizing,resize:r.onResize,cancel:r.onCancel,thisObj:r}}),r.resize.context.resource=t.resource}},{key:"initTooltip",value:function(){var e=this,t=e.client;e.showTooltip&&(e.tip?e.tip.showBy(e.getTooltipTarget()):(e.clockTemplate=new Hp({scheduler:t}),e.tip=new Ui({id:"".concat(t.id,"-drag-create-tip"),autoShow:!0,trackMouse:!1,updateContentOnMouseMove:!0,getHtml:e.getTipHtml.bind(e),align:t.isVertical?"t-b":"b100-t100",hideDelay:0,axisLock:!0}),e.tip.on("innerhtmlupdate",e.updateDateIndicator,e)))}},{key:"updateDateIndicator",value:function(){var e=this.createContext,t=e.startDate,n=e.endDate,r=this.tip,i=r.element.querySelector(".b-sch-tooltip-enddate");t&&n&&(this.clockTemplate.updateDateIndicator(r.element,t),i&&this.clockTemplate.updateDateIndicator(i,n))}},{key:"getTipHtml",value:function(){if(this.resize.context){var e,t,n=this,r=n.client,i=n.resize.context,o=i.edge,a=i.newX,s=i.newY,l=i.elementStartX,c=i.elementStartY,u=i.elementWidth,d=i.elementHeight,f=i.newWidth,h=i.newHeight,g=i.valid,v=i.message;if(r.isHorizontal){var p="left"===o?a:l,y=Math.min(Math.max(p+(f||u)-1,0),r.timeAxisViewModel.totalSize-1);e=r.getDateFromCoordinate(p,"round",!0),t=r.getDateFromCoordinate(y,"round",!0)}else{var m="top"===o?s:c,b=Math.min(Math.max(m+(h||d)-1,0),r.timeAxisViewModel.totalSize-1);e=r.getDateFromCoordinate(m,"round",!0),t=r.getDateFromCoordinate(b,"round",!0)}var k=ft.min(e,t),w=ft.max(e,t),S=k&&r.getFormattedDate(k),C=w&&t&&r.getFormattedEndDate(w,k);return n.tipTemplate({valid:g,startDate:k,endDate:w,startText:S,endText:C,message:v,startClockHtml:n.clockTemplate.template({date:k,text:S,cls:"b-sch-tooltip-startdate"}),endClockHtml:n.clockTemplate.template({date:r.getDisplayEndDate(w,k),text:C,cls:"b-sch-tooltip-enddate"})})}}},{key:"finalize",value:function(e){var t=this,n=function(){t.proxy.retainElement=!1,t.reset()},r=function(){t.client.trigger("afterDragCreate",{proxyElement:t.proxy}),n()};if(e){var i=t.finalizeDragCreate(t.createContext);i instanceof Promise?i.then(r,n):r()}else r()}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;if(0===e.button&&e.target.matches(".b-sch-timeaxis-cell")&&!t.disabled&&!n.readOnly){var r=n.isVertical?n.resolveResourceRecord(e):n.getRecordFromElement(e.target);if(r.meta.specialRow)return;if(t.preventMultiple&&!t.isRowEmpty(r))return;t.monitorMove=!0,t.createContext={startEvent:e,startScreenX:e.screenX,startScreenY:e.screenY,startX:e.offsetX,startY:e.offsetY,cellElement:e.target,rowRecord:r},t.mouseUpDetacher=Kn.on({element:document.body,mouseup:"onMouseUp",once:!0,thisObj:this})}}},{key:"onElementMouseMove",value:function(e){var t=this;if(t.monitorMove){var n=t.createContext,r=t.client,i=t.client.isVertical?n.startScreenY-e.screenY:n.startScreenX-e.screenX;if(Math.abs(i)>t.dragTolerance){var o=r.getDateFromDomEvent(e),a=In.from(r.timeAxisSubGridElement,null,!0);if(!1===t.handleBeforeDragCreate(o,e))return void(t.monitorMove=!1);n.currentX=Math.max(e.clientX-a.x+r.timeAxisSubGrid.scrollable.x,0),n.currentY=Math.max(e.clientY-a.y+r.timeAxisSubGrid.scrollable.y,0),t.addProxy(t.createContext),t.initResizer(e,t.createContext),t.initTooltip(),t.monitorMove=!1,r.trigger("dragCreateStart",{proxyElement:t.proxy})}}t.proxy&&t.showTooltip&&t.resize.context&&t.tip.alignTo(t.getTooltipTarget())}},{key:"getTooltipTarget",value:function(){var e=this,t=In.from(e.proxy,null,!0);return e.client.isVertical?("bottom"===e.resize.context.edge&&(t.y=t.bottom-1),t.height=e.tip.anchorSize[1]/2):("right"===e.resize.context.edge&&(t.x=t.right-1),t.width=e.tip.anchorSize[0]/2),{target:t}}},{key:"onMouseUp",value:function(){this.client.element.classList.remove("b-dragcreating-proxy-sizing"),this.monitorMove=!1}},{key:"onElementContextMenu",value:function(){if(this.proxy)return!1}},{key:"onResizing",value:function(e){var t=e.context,n=e.event,r=this,i=r.client,o="left"===t.edge?t.newX:t.elementStartX,a="top"===t.edge?t.newY:t.elementStartY,s=Math.min(o+Math.max((t.newWidth||t.elementWidth)-1,0),i.timeAxisViewModel.totalSize-1),l=Math.min(a+Math.max((t.newHeight||t.elementHeight)-1,0),i.timeAxisViewModel.totalSize-1),c=i.isVertical?a:o,u=i.isVertical?l:s,d=i.getDateFromCoordinate(c,"round",!0),f=i.getDateFromCoordinate(u,"round",!0),h=r.dateConstraints,g=ft.min(d,f),v=ft.max(d,f);h&&(v=ft.constrain(v,h.start,h.end),g=ft.constrain(g,h.start,h.end)),Object.assign(r.createContext,{startDate:g,endDate:v}),t.valid=r.checkValidity(r.createContext,n),t.message="",t.valid&&"boolean"!=typeof t.valid&&(t.message=t.valid.message,t.valid=t.valid.valid),t.valid=!1!==t.valid}},{key:"onResize",value:function(e){var t=e.context.valid,n=e.event,r=this,i=r.createContext,o=i.startDate,a=i.endDate;(!o||!a||a-o<=0)&&(t=!1),r.createContext=r.prepareCreateContextForFinalization(r.createContext,n,r.finalize.bind(r)),t&&r.client.trigger("beforeDragCreateFinalize",{context:r.createContext,event:n,proxyElement:r.proxy}),r.createContext&&(r.resize.context.async=r.createContext.async,r.createContext.async?r.resize.removeListeners():r.finalize(t))}},{key:"prepareCreateContextForFinalization",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.assign({},e,{async:r,event:t,finalize:n})}},{key:"onCancel",value:function(){this.cancel()}},{key:"cancel",value:function(){this.reset(),this.mouseUpDetacher&&this.mouseUpDetacher()}},{key:"reset",value:function(){this.removeProxy(),this.createContext=null,this.monitorMove=!1}},{key:"checkValidity",value:function(e,t){throw new Error("Implement in subclass")}},{key:"triggerDragCreateEnd",value:function(e,t){throw new Error("Implement in subclass")}},{key:"handleBeforeDragCreate",value:function(e,t){throw new Error("Implement in subclass")}},{key:"isRowEmpty",value:function(e){throw new Error("Implement in subclass")}},{key:"dragging",get:function(){return this.resize}}],[{key:"defaultConfig",get:function(){return{showTooltip:!0,dragTolerance:2,preventMultiple:!1,validatorFn:function(){},validatorFnThisObj:null,proxyCls:"b-sch-dragcreator-proxy",tipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")}}}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove"],before:["onElementContextMenu"]}}}]),r}(ho);function Gp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Up._$name="DragCreateBase";var Yp=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Gp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.scheduler=e,this.store=e.eventStore,se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"finalizeDragCreate",value:function(e){var t=new this.store.modelClass({startDate:e.startDate,endDate:e.endDate});this.proxy.dataset.eventId=t.id,this.scheduler.trigger("dragCreateEnd",{newEventRecord:t,resourceRecord:e.rowRecord,event:e.event,proxyElement:this.proxy})}},{key:"handleBeforeDragCreate",value:function(e,t){var n=this,r=n.scheduler.trigger("beforeDragCreate",{resourceRecord:n.createContext.rowRecord,date:e,event:t});if(r){var i=n.scheduler.features.scheduleTooltip;i&&i.hoverTip&&i.hoverTip.hide()}return n.dateConstraints=n.scheduler.getDateConstraints(n.createContext.rowRecord,e),r}},{key:"checkValidity",value:function(e,t){var n=this.client;return e.resourceRecord=e.rowRecord,(n.allowOverlap||n.isDateRangeAvailable(e.startDate,e.endDate,null,e.resourceRecord))&&this.validatorFn.call(this.validatorFnThisObj||this,e,t)}},{key:"isRowEmpty",value:function(e){var t=this.store.getEventsForResource(e);return!t||!t.length}}],[{key:"$name",get:function(){return"EventDragCreate"}},{key:"defaultConfig",get:function(){return{validatorFn:function(){}}}}]),r}(Up);function $p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Yp._$name="EventDragCreate",bd.registerFeature(Yp,!0,"Scheduler");var qp=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if($p()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){if(this.timeline=e,e.multiEventSelect=!0,e.features.eventDragCreate||e.features.pan)throw new Error("Cannot combine this feature with Pan or EventDragCreate features");this.targetSelector=[".b-timeline-subgrid .b-grid-cell",".b-timeline-subgrid"].join(","),se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;e.touches||0!==e.button||t.disabled||e.target.matches(t.targetSelector)&&(t.startX=e.clientX,t.startY=e.clientY,t.element=on.createElement({tag:"div",className:"b-dragselect-rect"},!0)[0],Nr.floatRoot.appendChild(t.element),n.element.classList.add("b-dragselecting"),t.eventRectangles=Array.from(n.element.querySelectorAll(n.eventSelector)).map((function(e){return{rectangle:In.from(e,!0),record:n.resolveEventRecord(e)}})),n.clearEventSelection(),t.subGridElementRect=In.from(n.timeAxisSubGrid.element,!0),n.navigator.disabled=!0)}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||Re.isSafari||Re.isIE11&&!e.isTrusted){if("number"==typeof t.startX){var n=Math.max(e.clientX,t.subGridElementRect.left),r=Math.max(e.clientY,t.subGridElementRect.top),i=Math.min(t.startX,n),o=Math.min(t.startY,r),a=Math.abs(t.startX-n),s=Math.abs(t.startY-r),l=new In(i,o,a,s).constrainTo(t.subGridElementRect);on.setTranslateXY(t.element,l.left,l.top),t.element.style.width=l.width+"px",t.element.style.height=l.height+"px",t.rectangle=l,t.updateSelection()}}else t.onElementMouseUp(e)}},{key:"onElementMouseUp",value:function(e){var t=this;"number"==typeof t.startX&&(t.element&&t.element.remove(),t.client.element.classList.remove("b-dragselecting"),t.startX=t.startY=null,t.setTimeout((function(){return t.client.navigator.disabled=!1}),100))}},{key:"updateSelection",value:function(){for(var e=this.eventRectangles,t=this.rectangle,n=0,r=e.length;n<r;n++){var i=e[n],o=t.intersect(i.rectangle,!0);o&&!i.selected?(i.selected=!0,this.client.selectEvent(i.record,!0)):!o&&i.selected&&(i.selected=!1,this.client.deselectEvent(i.record))}}}],[{key:"$name",get:function(){return"EventDragSelect"}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),r}(or(ho));function Xp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}qp._$name="EventDragSelect",bd.registerFeature(qp,!1,"Scheduler");var Kp=ft,Jp=function(e){if(1===e.length)return e[0].value;if(2===e.length){var t=e[0]instanceof as?e:e.reverse(),n=te()(t,2),r=n[0],i=n[1],o=Kp.parse(r.value);return o&&o.setHours(i.value.getHours(),i.value.getMinutes(),i.value.getSeconds(),i.value.getMilliseconds()),o}return null},Qp=function(e,t,n){if(e&&t){var r=Kp.add((i=n.startDateField.value,o=n.startTimeField.value,(a=new Date(i.getTime())).setHours(o.getHours(),o.getMinutes()),a),n.eventRecord.durationMS,"milliseconds");n.endDateField.value=r,n.endTimeField.value=Kp.clone(r)}var i,o,a},Zp=function(e){$()(a,e);var t,n,r,i,o=(t=a,function(){var e,n=J()(t);if(Xp()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function a(){return D()(this,a),o.apply(this,arguments)}return M()(a,[{key:"construct",value:function(e,t){var n,r=this;e.eventEdit=r,se()(J()(a.prototype),"construct",this).call(this,e,t),r.clientListenersDetacher=e.on((n={},oe()(n,r.triggerEvent,r.onActivateEditor),oe()(n,"dragcreateend",r.onDragCreateEnd),oe()(n,"thisObj",r),n))}},{key:"doDestroy",value:function(){this.clientListenersDetacher(),this.editor&&this.editor.destroy(),se()(J()(a.prototype),"doDestroy",this).call(this)}},{key:"insertExtraWidgetsIntoDefaultWidgets",value:function(e){if(this.extraItems&&this.extraItems.length){var t,n=e.items.findIndex((function(e){return"extraItems"===e.type}));n>-1&&(e.items.splice(n,1),t=e.items.splice(n));var r=this.extraItems.filter((function(e){return e.index>=0})),i=this.extraItems.filter((function(e){return!(e.index>=0)}));e.items=e.items.concat(i),r.sort((function(e,t){return e.index-t.index})),r.forEach((function(t){return e.items.splice(t.index,0,t)})),t&&t.length&&(e.items=e.items.concat(t))}}},{key:"onDatesChange",value:function(e){var t=this,n=e.source,r=e.value;switch(n.ref){case"startDateField":t.startTimeField&&Qp(r,t.startTimeField.value,t);break;case"startTimeField":t.startDateField&&Qp(t.startDateField.value,r,t)}t.endTimeField&&(Kp.isEqual(Kp.clearTime(t.startDateField.value),Kp.clearTime(t.endDateField.value))?t.endTimeField.min=t.startTimeField.value:t.endTimeField.min=null)}},{key:"save",value:(i=ta()(Zo.a.mark((function e(){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Implement in subclass");case 1:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"onBeforeSave",value:function(e){}},{key:"onAfterSave",value:function(e){}},{key:"updateRecord",value:function(e){var t=this.values;this.scheduler.assignmentStore&&delete t.resource,e.set(t)}},{key:"resetEditingContext",value:function(){var e=this;e.isEditing=!1,e.client.element.classList.remove("b-eventeditor-editing"),e.phantomEventElement&&e.phantomEventElement.remove(),e.phantomEventElement=null}},{key:"onPopupKeyDown",value:function(e){var t=e.event;"Enter"===t.key&&this.saveAndCloseOnEnter&&"input"===t.target.tagName.toLowerCase()&&(t.preventDefault(),"startDate"===t.target.name&&Qp(this.startDateField.value,this.startTimeField.value,this),this.onSaveClick())}},{key:"onSaveClick",value:(r=ta()(Zo.a.mark((function e(){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.save();case 2:e.sent&&this.editor.close();case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"onDeleteClick",value:(n=ta()(Zo.a.mark((function e(){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deleteEvent();case 2:e.sent&&(this.editor.autoClose&&!this.editor.containsFocus||this.editor.close());case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onCancelClick",value:function(){this.editor.close()}},{key:"editorConfig",get:function(){return this._editorConfig},set:function(e){var t=this.getDefaultConfiguration().editorConfig;(e=mt.assign({},t,e)).items=e.items||[],this.insertExtraWidgetsIntoDefaultWidgets(e),this._editorConfig=e}},{key:"extraWidgets",get:function(){return this._skipWarn||console.warn("`extraWidgets` was deprecated in 2.1, please change your code to use `extraItems`"),this._extraItems},set:function(e){console.warn("`extraWidgets` was deprecated in 2.1, please change your code to use `extraItems`"),this._extraItems=e}},{key:"extraItems",get:function(){var e=this;return e._skipWarn=!0,e._thisIsAUsedExpression(e.extraWidgets),e._skipWarn=!1,e._extraItems},set:function(e){this._extraItems=e}},{key:"isValid",get:function(){return Object.values(this.editor.widgetMap).every((function(e){return!(e.name&&!e.hidden)||!1!==e.isValid}))}},{key:"values",get:function(){var e=[],t=[],n={};return this.editor.eachWidget((function(r){var i=r.name;if(i&&!r.hidden)switch(i){case"startDate":e.push(r);break;case"endDate":t.push(r);break;case"resource":n[i]=r.record;break;default:n[i]=r.value}}),!0),n.startDate=Jp(e),n.endDate=Jp(t),n.duration=Kp.diff(n.startDate,n.endDate,this.editor.record.durationUnit,!0),n}}],[{key:"defaultConfig",get:function(){return{autoClose:!0,saveAndCloseOnEnter:!0,triggerEvent:null,showDeleteButton:!0,showNameField:!0,startTimeConfig:null,startDateConfig:null,endTimeConfig:null,endDateConfig:null,dateFormat:"L",timeFormat:"LT",editorConfig:null,extraItems:null,extraWidgets:null}}}]),a}(ho);function ey(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Zp._$name="EditBase";var ty=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ey()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"processWidgetConfig",value:function(e){var t=this.eventEditFeature;if("extraItems"===e.type)return!1;var n={};if("resourceField"===e.ref){if(!t.showResourceField)return!1;this.resourceStore=e.store=t.resourceStore.makeChained((function(e){return!e.meta.specialRow}),null,{excludeCollapsedRecords:!1}),e.multiSelect=Boolean(t.scheduler.assignmentStore),t.resourceFieldConfig&&(n=t.resourceFieldConfig)}return!("nameField"===e.ref&&!t.showNameField)&&(!("deleteButton"===e.ref&&!t.showDeleteButton)&&("startDate"!==e.name&&"endDate"!==e.name||"date"!==e.type||(n.format=t.dateFormat),"startDate"!==e.name&&"endDate"!==e.name||"time"!==e.type||(n.format=t.timeFormat),t.startDateConfig&&"startDate"===e.name&&"date"===e.type&&(n=t.startDateConfig),t.startTimeConfig&&"startDate"===e.name&&"time"===e.type&&(n=t.startTimeConfig),t.endDateConfig&&"endDate"===e.name&&"date"===e.type&&(n=t.endDateConfig),t.endTimeConfig&&"endDate"===e.name&&"time"===e.type&&(n=t.endTimeConfig),Object.assign(e,n),se()(J()(r.prototype),"processWidgetConfig",this).call(this,e)))}},{key:"show",value:function(){var e;this.resourceStore&&this.resourceStore.fillFromMaster();for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=se()(J()(r.prototype),"show",this)).call.apply(e,[this].concat(n))}},{key:"afterShow",value:function(){var e,t=this.widgetMap.deleteButton;t&&(t.hidden=this.readOnly||!this.record.stores.length);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(e=se()(J()(r.prototype),"afterShow",this)).call.apply(e,[this].concat(i))}},{key:"onInternalKeyDown",value:function(e){this.trigger("keyDown",{event:e}),se()(J()(r.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"readOnly",set:function(e){var t=this.widgetMap,n=t.deleteButton,r=t.saveButton,i=t.cancelButton;this._readOnly=e,this.element.classList[e?"add":"remove"]("b-readonly"),this.eachWidget((function(t){"_originalReadOnly"in t||(t._originalReadOnly=t._readOnly||!1),t.readOnly=e||t._originalReadOnly})),n&&(n.hidden=e),r&&(r.hidden=e),i&&(i.hidden=e)},get:function(){return this._readOnly}}],[{key:"$name",get:function(){return"EventEditor"}},{key:"defaultConfig",get:function(){return{items:[],draggable:{handleSelector:":not(button,.b-field-inner)"},axisLock:"flexible",scrollable:{overflowY:!0}}}}]),r}(Ei);function ny(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ty._$name="EventEditor";var ry=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ny()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(e=se()(J()(r.prototype),"construct",this)).call.apply(e,[this].concat(i));var a=t.widgetMap,s=a.changeMultipleButton,l=a.changeSingleButton,c=a.cancelButton;s&&s.on("click",t.onChangeMultipleButtonClick,t),l&&l.on("click",t.onChangeSingleButtonClick,t),c&&c.on("click",t.onCancelButtonClick,t),t.on("toolclick",t.onToolClick,t)}},{key:"onChangeMultipleButtonClick",value:function(){this.processMultipleRecords(),this.close()}},{key:"onChangeSingleButtonClick",value:function(){this.processSingleRecord(),this.close()}},{key:"onCancelButtonClick",value:function(){this.cancelFn&&this.cancelFn.call(this.thisObj),this.close()}},{key:"onToolClick",value:function(e){"close"===e.tool.handler&&this.cancelFn&&this.cancelFn.call(this.thisObj)}},{key:"confirm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return["actionType","eventRecord","title","html","changerFn","cancelFn","thisObj"].forEach((function(n){n in e&&(t[n]=e[n])})),t.updatePopupContent(),se()(J()(r.prototype),"show",this).call(this,e)}},{key:"updatePopupContent",value:function(){var e=this,t=e.widgetMap,n=t.changeMultipleButton,r=t.changeSingleButton,i=t.cancelButton,o=e.eventRecord,a=e.actionType,s=void 0===a?"update":a,l=o&&o.isRecurring;l?(n.text=e.L("Yes"),e.html=e.L("".concat(s,"-all-message"))):(n.text=e.L("".concat(s,"-further-btn-text")),e.html=e.L("".concat(s,"-further-message"))),r.text=e.L("".concat(s,"-only-this-btn-text")),i.text=e.L("Cancel"),l?r.hide():r.show(),e.width=e.L("width"),e.title=e.L("".concat(s,"-title"))}},{key:"processMultipleRecords",value:function(){var e=this.eventRecord,t=this.changerFn,n=this.thisObj,r=e.recurringEvent,i=new Date(e.startDate-1);e.beginBatch(),t.call(n,e),e.recurringTimeSpanId=null,e.endBatch(),r&&(r.recurrence.endDate=i)}},{key:"processSingleRecord",value:function(){var e=this.eventRecord,t=this.changerFn,n=this.thisObj,r=e.recurringEvent,i=e.startDate;e.beginBatch(),t.call(n),e.recurrence=null,e.endBatch(),r.addExceptionDate(i)}},{key:"updateLocalization",value:function(){this.updatePopupContent(),se()(J()(r.prototype),"updateLocalization",this).call(this)}}],[{key:"$name",get:function(){return"RecurrenceConfirmationPopup"}},{key:"defaultConfig",get:function(){return{localizableProperties:[],align:"b-t",autoShow:!1,autoClose:!1,centered:!0,scrollAction:"realign",constrainTo:window,draggable:!0,closable:!0,floating:!0,eventRecord:null,cls:"b-sch-recurrenceconfirmation",bbar:[{color:"b-green",localeClass:this,text:"L{Yes}",ref:"changeMultipleButton"},{color:"b-gray",localeClass:this,text:"L{update-only-this-btn-text}",ref:"changeSingleButton"},{color:"b-gray",localeClass:this,text:"L{Cancel}",ref:"cancelButton"}]}}}]),r}(Ei);function iy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ry._$name="RecurrenceConfirmationPopup",ye.register("recurrenceconfirmation",ry);var oy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(iy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildLocalizedItems",value:function(){return[{value:"DAILY",text:this.L("Daily")},{value:"WEEKLY",text:this.L("Weekly")},{value:"MONTHLY",text:this.L("Monthly")},{value:"YEARLY",text:this.L("Yearly")}]}}],[{key:"$name",get:function(){return"RecurrenceFrequencyCombo"}},{key:"defaultConfig",get:function(){return{editable:!1,displayField:"text",valueField:"value"}}}]),r}(Rf(Wa));function ay(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}oy._$name="RecurrenceFrequencyCombo",ye.register("recurrencefrequencycombo",oy);var sy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ay()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildLocalizedItems",value:function(){return[{value:"none",text:this.L("None")}].concat(Z()(se()(J()(r.prototype),"buildLocalizedItems",this).call(this)),[{value:this.customValue,text:this.L("Custom..."),cls:this.splitCls}])}},{key:"isCustomRecurrence",value:function(e){var t=e.interval,n=e.days,r=e.monthDays,i=e.months;return Boolean(t>1||n&&n.length||r&&r.length||i&&i.length)}},{key:"value",set:function(e){e=e||"none",ei()(J()(r.prototype),"value",e,this,!0)},get:function(){return se()(J()(r.prototype),"value",this)}},{key:"recurrence",set:function(e){this.value=e?this.isCustomRecurrence(e)?this.customValue:e.frequency:null}}],[{key:"$name",get:function(){return"RecurrenceCombo"}},{key:"defaultConfig",get:function(){return{customValue:"custom",placeholder:"None",splitCls:"b-recurrencecombo-split",items:!0,highlightExternalChange:!1}}}]),r}(oy);function ly(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}sy._$name="RecurrenceCombo",ye.register("recurrencecombo",sy);var cy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ly()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"updateLegend",value:function(){var e=this.recurrence;this.text=e?Wv.getLegend(e,this.eventStartDate):""}},{key:"onLocaleChange",value:function(){this.updateLegend()}},{key:"updateLocalization",value:function(){this.onLocaleChange(),se()(J()(r.prototype),"updateLocalization",this).call(this)}},{key:"recurrence",set:function(e){this._recurrence=e,this.updateLegend()},get:function(){return this._recurrence}},{key:"eventStartDate",set:function(e){this._eventStartDate=e,this.updateLegend()},get:function(){return this._eventStartDate}}],[{key:"$name",get:function(){return"RecurrenceLegendButton"}},{key:"defaultConfig",get:function(){return{localizableProperties:[],recurrence:null}}}]),r}(Ji);function uy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}cy._$name="RecurrenceLegendButton",ye.register("recurrencelegendbutton",cy);var dy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(uy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildLocalizedItems",value:function(){var e=this;return e._weekDays=null,e.weekDays.concat([{value:e.allDaysValue,text:e.L("day"),cls:e.splitCls},{value:e.workingDaysValue,text:e.L("weekday")},{value:e.nonWorkingDaysValue,text:e.L("weekend day")}])}},{key:"weekDays",get:function(){if(!this._weekDays){var e=ft.weekStartDay,t=ft.getDayNames().map((function(e,t){return{text:e,value:sv.encodeDay(t)}}));this._weekDays=t.slice(e).concat(t.slice(0,e))}return this._weekDays}},{key:"value",set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),e&&this.store.findRecord("value",e)||(e=this.defaultValue),ei()(J()(r.prototype),"value",e,this,!0)},get:function(){var e=se()(J()(r.prototype),"value",this);return e&&Array.isArray(e)&&(e=e.join(",")),e}}],[{key:"$name",get:function(){return"RecurrenceDaysCombo"}},{key:"defaultConfig",get:function(){return{allDaysValue:"SU,MO,TU,WE,TH,FR,SA",editable:!1,defaultValue:"SU,MO,TU,WE,TH,FR,SA",workingDaysValue:"MO,TU,WE,TH,FR",nonWorkingDaysValue:"SU,SA",splitCls:"b-recurrencedays-split",displayField:"text",valueField:"value"}}}]),r}(Rf(Wa));function fy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}dy._$name="RecurrenceDaysCombo",ye.register("recurrencedayscombo",dy);var hy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(fy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.columns=7,e.items=t.buildItems(),se()(J()(r.prototype),"construct",this).call(this,e)}},{key:"updateItemText",value:function(e){var t=sv.decodeDay(e.value)[0];e.text=ft.getDayName(t).substring(0,3)}},{key:"buildItems",value:function(){if(!this.__items){var e=ft.weekStartDay,t=ft.getDayNames().map((function(e,t){return{text:e.substring(0,3),value:sv.encodeDay(t)}}));this.__items=t.slice(e).concat(t.slice(0,e))}return this.__items}},{key:"onLocaleChange",value:function(){this.items.forEach(this.updateItemText,this)}},{key:"updateLocalization",value:function(){this.onLocaleChange(),se()(J()(r.prototype),"updateLocalization",this).call(this)}},{key:"value",set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),ei()(J()(r.prototype),"value",e,this,!0)},get:function(){var e=se()(J()(r.prototype),"value",this);return e&&Array.isArray(e)&&(e=e.join(",")),e}},{key:"widgetClassList",get:function(){var e=se()(J()(r.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceDaysButtonGroup"}},{key:"defaultConfig",get:function(){return{defaults:{cls:"b-raised",toggleable:!0}}}}]),r}(Zi);function gy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}hy._$name="RecurrenceDaysButtonGroup",ye.register("recurrencedaysbuttongroup",hy);var vy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(gy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.columns=7,e.items=t.buildItems(),se()(J()(r.prototype),"construct",this).call(this,e)}},{key:"buildItems",value:function(){for(var e=[],t=this.minValue;t<=this.maxValue;t++)e.push({text:t+"",value:t});return e}},{key:"minValue",get:function(){return 1}},{key:"maxValue",get:function(){return 31}},{key:"widgetClassList",get:function(){var e=se()(J()(r.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceMonthDaysButtonGroup"}},{key:"defaultConfig",get:function(){return{defaults:{toggleable:!0,cls:"b-raised"}}}}]),r}(Zi);function py(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}vy._$name="RecurrenceMonthDaysButtonGroup",ye.register("recurrencemonthdaysbuttongroup",vy);var yy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(py()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.columns=4,e.items=t.buildItems(),se()(J()(r.prototype),"construct",this).call(this,e)}},{key:"buildItems",value:function(){return ft.getMonthNames().map((function(e,t){return{text:e.substring(0,3),value:t+1}}))}},{key:"updateItemText",value:function(e){e.text=ft.getMonthName(e.value-1).substring(0,3)}},{key:"onLocaleChange",value:function(){this.items.forEach(this.updateItemText,this)}},{key:"updateLocalization",value:function(){this.onLocaleChange(),se()(J()(r.prototype),"updateLocalization",this).call(this)}},{key:"widgetClassList",get:function(){var e=se()(J()(r.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceMonthsButtonGroup"}},{key:"defaultConfig",get:function(){return{defaults:{toggleable:!0,cls:"b-raised"}}}}]),r}(Zi);function my(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}yy._$name="RecurrenceMonthsButtonGroup",ye.register("recurrencemonthsbuttongroup",yy);var by=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(my()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildLocalizedItems",value:function(){return[{value:"never",text:this.L("Never")},{value:"count",text:this.L("After")},{value:"date",text:this.L("On date")}]}},{key:"value",set:function(e){e=e||"never",ei()(J()(r.prototype),"value",e,this,!0)},get:function(){return se()(J()(r.prototype),"value",this)}},{key:"recurrence",get:function(){return this._recurrence},set:function(e){var t=null;e.endDate?t="date":e.count&&(t="count"),this._recurrence=e,this.value=t}}],[{key:"$name",get:function(){return"RecurrenceStopConditionCombo"}},{key:"defaultConfig",get:function(){return{editable:!1,placeholder:"Never",displayField:"text",valueField:"value"}}}]),r}(Rf(Wa));function ky(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}by._$name="RecurrenceStopConditionCombo",ye.register("recurrencestopconditioncombo",by);var wy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ky()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildLocalizedItems",value:function(){return this.buildDayNumbers().concat([{value:"-1",text:this.L("position-1"),cls:this.splitCls}])}},{key:"buildDayNumbers",value:function(){var e=this;return ue.populate(e.maxPosition,(function(t){return{value:t,text:e.L("position".concat(t))}}))}},{key:"value",set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),e&&this.store.findRecord("value",e)||(e=this.defaultValue),ei()(J()(r.prototype),"value",e,this,!0)},get:function(){var e=se()(J()(r.prototype),"value",this);return e?"".concat(e).split(",").map((function(e){return parseInt(e,10)})):[]}}],[{key:"$name",get:function(){return"RecurrencePositionsCombo"}},{key:"defaultConfig",get:function(){return{editable:!1,splitCls:"b-sch-recurrencepositions-split",displayField:"text",valueField:"value",defaultValue:1,maxPosition:5}}}]),r}(Rf(Wa));function Sy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}wy._$name="RecurrencePositionsCombo",ye.register("recurrencepositionscombo",wy);var Cy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Sy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onSaveClick",value:function(){var e=this;e.saveHandler?e.saveHandler.call(e.thisObj||e,e,e.record):(e.updateRecord(),e.close())}},{key:"onCancelClick",value:function(){var e=this;e.cancelHandler?e.cancelHandler.call(e.thisObj||e,e,e.record):e.close()}},{key:"updateRecord",value:function(e){var t=this.getValues((function(t){return t.name in e&&!t.disabled}));e.set(t)}},{key:"toggleStopFields",value:function(){var e=this.widgetMap,t=e.countField,n=e.endDateField;switch(this.widgetMap.stopRecurrenceField.value){case"count":t.show(),t.enable(),n.hide(),n.disable();break;case"date":t.hide(),t.disable(),n.show(),n.enable();break;default:t.hide(),n.hide(),t.disable(),n.disable()}}},{key:"onMonthDaysRadioFieldChange",value:function(e){var t=e.checked,n=this.widgetMap.monthDaysButtonField;n.disabled=!t||!this.isWidgetAvailableForFrequency(n)}},{key:"onPositionAndDayRadioFieldChange",value:function(e){var t=e.checked,n=this.widgetMap,r=n.daysCombo,i=n.positionsCombo;r.disabled=i.disabled=!t||!this.isWidgetAvailableForFrequency(r)}},{key:"onStopRecurrenceFieldChange",value:function(){this.toggleStopFields()}},{key:"isWidgetAvailableForFrequency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.widgetMap.frequencyField.value;return!e.forFrequency||e.forFrequency.indexOf(t)>-1}},{key:"onFrequencyFieldChange",value:function(e){var t=e.value,n=e.valid,r=this,i=r.queryAll((function(e){return"forFrequency"in e}));if(n&&t){for(var o=0;o<i.length;o++){var a=i[o];r.isWidgetAvailableForFrequency(a,t)?(a.show(),a.enable()):(a.hide(),a.disable())}r.widgetMap.intervalField.intervalUnit.innerHTML=r.L("".concat(t,"intervalUnit")),r.toggleFieldsState()}}},{key:"toggleFieldsState",value:function(){var e=this.widgetMap;this.onMonthDaysRadioFieldChange({checked:e.monthDaysRadioField.checked}),this.onPositionAndDayRadioFieldChange({checked:e.positionAndDayRadioField.checked}),this.onStopRecurrenceFieldChange()}},{key:"updateLocalization",value:function(){var e=this.widgetMap,t=e.countField,n=e.intervalField,i=e.frequencyField;t.countUnit.innerHTML=this.L("time(s)"),n.intervalUnit.innerHTML=this.L("".concat(i.value,"intervalUnit")),se()(J()(r.prototype),"updateLocalization",this).call(this)}},{key:"record",get:function(){return se()(J()(r.prototype),"record",this)},set:function(e){ei()(J()(r.prototype),"record",e,this,!0);var t=e.timeSpan,n=t&&t.startDate,i=this.widgetMap,o=i.daysButtonField,a=i.monthDaysButtonField,s=i.monthsButtonField,l=i.monthDaysRadioField,c=i.positionAndDayRadioField,u=i.stopRecurrenceField;n&&(e.days&&e.days.length||(o.value=[sv.encodeDay(n.getDay())]),e.monthDays&&e.monthDays.length||(a.value=n.getDate()),e.months&&e.months.length||(s.value=n.getMonth()+1)),e.days&&e.positions?(c.check(),this.isPainted||l.uncheck()):(l.check(),this.isPainted||c.uncheck()),u.recurrence=e}}],[{key:"$name",get:function(){return"RecurrenceEditor"}},{key:"defaultConfig",get:function(){return{draggable:!0,closable:!0,floating:!0,cls:"b-recurrenceeditor",title:"L{Repeat event}",autoClose:!0,width:400,items:{frequencyField:!0,daysButtonField:!0,monthDaysRadioField:!0,monthDaysButtonField:!0,monthsButtonField:!0,positionAndDayRadioField:!0,stopRecurrenceField:!0,countField:!0,endDateField:!0,intervalField:!0,positionsCombo:!0,daysCombo:!0},namedItems:{frequencyField:{type:"recurrencefrequencycombo",name:"frequency",localeClass:this,label:"L{Frequency}",weight:10,onChange:"up.onFrequencyFieldChange"},intervalField:{type:"numberfield",weight:15,name:"interval",localeClass:this,label:"L{Every}",labels:[{align:"end",reference:"intervalUnit",style:{width:"50em"}}],min:1,allowBlank:!1},daysButtonField:{type:"recurrencedaysbuttongroup",weight:20,name:"days",forFrequency:"WEEKLY"},monthDaysRadioField:{type:"checkbox",weight:30,toggleGroup:"radio",forFrequency:"MONTHLY",localeClass:this,label:"L{Each}",checked:!0,onChange:"up.onMonthDaysRadioFieldChange"},monthDaysButtonField:{type:"recurrencemonthdaysbuttongroup",weight:40,name:"monthDays",forFrequency:"MONTHLY"},monthsButtonField:{type:"recurrencemonthsbuttongroup",weight:50,name:"months",forFrequency:"YEARLY"},positionAndDayRadioField:{type:"checkbox",weight:60,toggleGroup:"radio",forFrequency:"MONTHLY|YEARLY",localeClass:this,label:"L{On the}",onChange:"up.onPositionAndDayRadioFieldChange"},positionsCombo:{type:"recurrencepositionscombo",weight:80,name:"positions",forFrequency:"MONTHLY|YEARLY"},daysCombo:{type:"recurrencedayscombo",weight:90,name:"days",forFrequency:"MONTHLY|YEARLY",flex:1},stopRecurrenceField:{type:"recurrencestopconditioncombo",weight:100,localeClass:this,label:"L{End repeat}",onChange:"up.onStopRecurrenceFieldChange"},countField:{type:"numberfield",weight:110,name:"count",min:2,localeClass:this,allowBlank:!1,disabled:!0,label:" ",labels:[{align:"end",reference:"countUnit",label:"L{time(s)}"}]},endDateField:{type:"datefield",weight:120,name:"endDate",hidden:!0,disabled:!0,label:" ",allowBlank:!1}},bbar:[{type:"widget",cls:"b-label-filler"},{type:"button",color:"b-green",ref:"saveButton",localeClass:this,text:"L{Save}",onClick:"up.onSaveClick"},{type:"button",color:"b-gray",ref:"cancelButton",localeClass:this,text:"L{Cancel}",onClick:"up.onCancelClick"}]}}}]),r}(Ei);function Ry(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Cy._$name="RecurrenceEditor",ye.register("recurrenceeditor",Cy);var xy=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ry()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"insertExtraWidgetsIntoDefaultWidgets",value:function(e){this.processEditorConfig(e),se()(J()(r.prototype),"insertExtraWidgetsIntoDefaultWidgets",this).call(this,e)}},{key:"processEditorConfig",value:function(e){var t=e.items,n=t.findIndex((function(e){return"extraItems"===e.type}));n<0?t.push.apply(t,Z()(this.recurringEventsItems)):t.splice.apply(t,[n,0].concat(Z()(this.recurringEventsItems)))}},{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,t),this.scheduler.on({beforeEventDelete:this.onRecurrableEventBeforeDelete,beforeEventSave:this.onRecurrableEventBeforeSave,thisObj:this})}},{key:"doDestroy",value:function(){this._recurrenceConfirmation&&this.recurrenceConfirmation.destroy(),this._recurrenceEditor&&this.recurrenceEditor.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onEditorConstructed",value:function(e){var t=this;e.on("hide",t.onRecurringEventEditorHide,t),t.editRecurrenceButton&&t.editRecurrenceButton.on("click",t.onEditRecurrenceClick,t),t.recurrenceCombo.on("change",t.onRecurrenceComboChange.bind(t))}},{key:"internalShowEditor",value:function(){this.toggleRecurringFieldsVisibility(this.isRecurringEnabled&&!1!==this.showRecurringUI)}},{key:"toggleRecurringFieldsVisibility",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?"show":"hide";this.editRecurrenceButton&&this.editRecurrenceButton[t](),this.recurrenceCombo&&this.recurrenceCombo[t]()}},{key:"onRecurringEventEditorHide",value:function(e){e.source;var t=this.recurrenceEditor,n=this.recurrenceConfirmation;t&&t.isVisible&&t.hide(),n&&n.isVisible&&n.hide()}},{key:"makeRecurrence",value:function(e){var t=this.eventRecord,n=t.copy(),r=t.recurrence;return(r=!e&&r?r.copy():new t.recurrenceModel({rule:e})).timeSpan=n,n.setStartDate(this.values.startDate),r.suspendTimeSpanNotifying(),r}},{key:"onRecurrableEventBeforeSave",value:function(e){var t=e.eventRecord,n=e.context;if(t.supportsRecurring&&(t.isRecurring||t.isOccurrence))return this.recurrenceConfirmation.confirm({actionType:"update",eventRecord:t,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),n.async=!0,!1}},{key:"showDisplayConfirmationOnEventDelete",value:function(e){return this.isEditing&&this.eventRecord===e&&e.supportsRecurring&&(e.isRecurring||e.isOccurrence)}},{key:"onRecurrableEventBeforeDelete",value:function(e){var t=e.eventRecords,n=e.context,r=te()(t,1)[0];if(this.showDisplayConfirmationOnEventDelete(r))return this.recurrenceConfirmation.confirm({actionType:"delete",eventRecord:r,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"showRecurrenceEditor",value:function(){var e=this,t=e.recurrenceEditor,n=e.eventRecord;t&&n&&n.supportsRecurring&&(e.recurrence||(e.recurrence=e.makeRecurrence()),e.recurrence.timeSpan.setStartDate(e.values.startDate),t.record=e.recurrence,t.showBy(e.recurrenceCombo.element))}},{key:"onEditRecurrenceClick",value:function(){this.showRecurrenceEditor()}},{key:"loadRecurrenceData",value:function(e){this.recurrence=e,this.updateRecurrenceFields(e)}},{key:"updateRecurrenceFields",value:function(e){var t=this;t.recurrenceCombo&&(t.recurrenceCombo.recurrence=e),t.editRecurrenceButton&&(t.editRecurrenceButton.recurrence=e,t.editRecurrenceButton.value=e?e.rule:null,e&&t.isRecurringEnabled&&!1!==t.showRecurringUI?t.editRecurrenceButton.show():t.editRecurrenceButton.hide())}},{key:"onRecurrenceComboChange",value:function(e){var t=e.source,n=e.value,r=e.userAction;n==t.customValue?r&&this.showRecurrenceEditor():this.loadRecurrenceData(n?this.makeRecurrence("FREQ=".concat(n)):null)}},{key:"recurrenceEditorSaveHandler",value:function(e,t){e.updateRecord(t),this.updateRecurrenceFields(t),e.close()}},{key:"onDatesChange",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=se()(J()(r.prototype),"onDatesChange",this)).call.apply(e,[this].concat(n));var o=this,a=o.editRecurrenceButton;if(!o.loadingRecord&&a){var s=o.values.startDate;s&&(a.eventStartDate=s)}}},{key:"internalLoadRecord",value:function(e,t){this.recurrenceCombo&&e&&e.supportsRecurring&&this.loadRecurrenceData(e.recurrence?this.makeRecurrence():null)}},{key:"isRecurringEnabled",get:function(){return Boolean(this.scheduler.features.recurringEvents&&!this.scheduler.features.recurringEvents.disabled)}},{key:"recurrenceConfirmation",set:function(e){this._recurrenceConfirmation=e},get:function(){var e=this._recurrenceConfirmation;return e&&e.$name||(e=Ce.createWidget(Object.assign({type:"recurrenceconfirmation",owner:this.getEditor()},e)),this._recurrenceConfirmation=e),e}},{key:"recurrenceEditor",set:function(e){this._recurrenceEditor=e},get:function(){var e=this,t=e._recurrenceEditor;return t&&t.$name||(t=Ce.createWidget(Object.assign({type:"recurrenceeditor",autoShow:!1,owner:e.getEditor(),scrollAction:"realign",clippedBy:[e.scheduler.timeAxisSubGridElement,e.scheduler.bodyContainer],constrainTo:window,anchor:!0,saveHandler:e.recurrenceEditorSaveHandler,thisObj:e},t)),e._recurrenceEditor=t),t}}],[{key:"$name",get:function(){return"RecurringEventEdit"}},{key:"defaultConfig",get:function(){return{recurringEventsItems:[{type:"recurrencecombo",label:"L{Repeat}",ref:"recurrenceCombo"},{type:"recurrencelegendbutton",ref:"editRecurrenceButton",name:"recurrenceRule",flex:"1"}],showRecurringUI:null}}}]),r}(e||G)};function Ey(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Dy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ey()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.scheduler=e,this.eventStore=e.eventStore,this.resourceStore=e.resourceStore,se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"getEditor",value:function(){var e=this,t=e.editor;return t||(0===(t=e.editor=new ty(e.getEditorConfig())).items.length&&console.warn("Event Editor configured without any `items`"),t.on({beforehide:e.resetEditingContext,keydown:e.onPopupKeyDown,thisObj:e}),Object.values(t.widgetMap).forEach((function(t){var n=t.ref||t.id;if(n&&!e[n])switch(e[n]=t,t.name){case"startDate":case"endDate":t.on("change",e.onDatesChange,e)}})),e.onEditorConstructed&&e.onEditorConstructed(t),e.eventTypeField&&e.eventTypeField.on("change",e.onEventTypeChange,e),e.saveButton&&e.saveButton.on("click",e.onSaveClick,e),e.deleteButton&&e.deleteButton.on("click",e.onDeleteClick,e),e.cancelButton&&e.cancelButton.on("click",e.onCancelClick,e),e.editor)}},{key:"getEditorConfig",value:function(){var e=this,t=e.autoClose,n=e.cls,r=e.readOnly;return mt.assign({eventEditFeature:e,align:"b-t",id:"".concat(e.scheduler.id,"-event-editor"),autoShow:!1,anchor:!0,scrollAction:"realign",clippedBy:[e.scheduler.timeAxisSubGridElement,e.scheduler.bodyContainer],constrainTo:window,autoClose:t,readOnly:r,cls:n},e.editorConfig)}},{key:"internalShowEditor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this,o=i.scheduler,a=n||on.down(o.getElementFromEventRecord(e,t),o.eventInnerSelector);if(a||!e.isPartOfStore(o.eventStore)){if(!1===o.trigger("beforeEventEdit",{eventEdit:i,eventRecord:e,resourceRecord:t,eventElement:a}))return o.element.classList.remove("b-eventeditor-editing"),i.phantomEventElement&&i.phantomEventElement.remove(),void(i.phantomEventElement=null);i.resourceRecord=t;var s=i.getEditor(e);se()(J()(r.prototype),"internalShowEditor",this)&&se()(J()(r.prototype),"internalShowEditor",this).call(this,e,t,n),i.typeField&&i.toggleEventType(e.get(i.typeField)),o.trigger("beforeEventEditShow",{eventEdit:i,eventRecord:e,resourceRecord:t,eventElement:a,editor:s}),i.isEditing=!0,i.loadRecord(e,t),a?(a.classList.add("b-editing"),s.showBy({target:a,anchor:!0})):s.showBy({target:o.element,anchor:!1,align:"c-c"});var l=o.timeAxisViewModel.timeResolution;"hour"!==l.unit&&"minute"!==l.unit||(i.startTimeField.step=i.endTimeField.step="".concat(l.increment).concat(l.unit))}}},{key:"editEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this,i=r.scheduler,o=i.eventStore.indexOf(e)<0;r.isEditing&&r.resetEditingContext(),i.readOnly||r.disabled||(i.element.classList.add("b-eventeditor-editing"),t||(e.resource?t=e.resource:e.resourceId&&(t=i.resourceStore.getById(e.resourceId))),o&&(this.phantomEventElement=n),n||o?r.internalShowEditor(e,t,n):i.scrollResourceEventIntoView(t,e,null,{animate:!0,edgeOffset:0,extendTimeAxis:!1}).then((function(){return r.internalShowEditor(e,t)}),(function(){return i.element.classList.remove("b-eventeditor-editing")})))}},{key:"loadRecord",value:function(e,t){this.loadingRecord=!0,this.internalLoadRecord(e,t),this.loadingRecord=!1}},{key:"internalLoadRecord",value:function(e,t){var n=this,i=n.client.eventStore;if(n.eventRecord=e,n.resourceRecord=t,n.editor.record=e,n.resourceField){var o=i.getResourcesForEvent(e);!i.storage.includes(e,!0)&&n.resourceRecord?n.resourceField.value=n.resourceRecord[n.resourceField.valueField]:n.scheduler.assignmentStore&&(n.resourceField.value=o.map((function(e){return e[n.resourceField.valueField]})))}se()(J()(r.prototype),"internalLoadRecord",this).call(this,e,t)}},{key:"toggleEventType",value:function(e){this.editor.element.dataset.eventType=e||"",this.editor.eachWidget((function(t){return t.dataset&&t.dataset.eventType&&(t.hidden=t.dataset.eventType!==e)}))}},{key:"finalizeEventSave",value:function(e,t,n,r){var i=this,o=i.scheduler,a=i.eventStore;if(i.onBeforeSave(e),e.beginBatch(),i.updateRecord(e),e.endBatch(),a&&!e.stores.length){if(!1===o.trigger("beforeEventAdd",{eventRecord:e,resourceRecords:t,resources:t}))return void n(!1);if(o.isInTimeAxis(e)){if(i.phantomEventElement){var s=o.generateTplData(e,t[0]);s&&(on.syncClassList(i.phantomEventElement,s.wrapperCls),on.createElement({tag:"div",parent:i.phantomEventElement,className:s.cls.toString()}),i.phantomEventElement.classList.add("b-sch-dragcreator-proxy"),i.phantomEventElement.id=s.id,i.phantomEventElement.dataset.syncId=e.id,o.isHorizontal&&o.currentOrientation.releaseTimeSpanDiv(i.phantomEventElement,!0),i.phantomEventElement=null,e.instanceMeta(o).fromDragProxy=!0)}}else i.phantomEventElement.remove();if(i.eventStore.add(e),i.eventStore.assignEventToResource(e,t),!i.eventStore.includes(e)){var l=o.element.querySelector(".b-sch-dragcreator-proxy");l&&(o.currentOrientation.availableDivs.remove(l),l.remove())}}else o.assignmentStore&&i.eventStore.assignEventToResource(e,t,!0);o.trigger("afterEventSave",{eventRecord:e}),i.onAfterSave(e),n(e)}},{key:"save",value:function(){var e=this;return new Promise((function(t,n){var r=e,i=r.scheduler,o=r.eventRecord;if(o&&r.isValid){var a=r.eventStore,s=r.values,l=r.resourceField&&r.resourceField.records||[r.resourceRecord],c=l[0];if(!r.scheduler.allowOverlap&&a)if(l.some((function(e){return!a.isDateRangeAvailable(s.startDate,s.endDate,o,e)})))return void t(!1);var u={finalize:function(e){try{!1!==e?r.finalizeEventSave(o,l,t,n):t(!1)}catch(e){n(e)}}};!1!==i.trigger("beforeEventSave",{eventRecord:o,resourceRecords:l,resourceRecord:c,values:s,context:u})?u.finalize():u.async||t()}else t(!1)}))}},{key:"deleteEvent",value:function(){var e=this;return new Promise((function(t,n){var r=e,i=r.eventRecord,o=r.editor;r.scheduler.removeRecords([i],(function(e){e&&o.containsFocus&&o.revertFocus(),t(e)}))}))}},{key:"onActivateEditor",value:function(e){var t=e.eventRecord,n=e.resourceRecord,r=e.eventElement;this.editEvent(t,n,r)}},{key:"onDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord,r=e.proxyElement;if(!this.disabled){this.scheduler.onEventCreated(t);var i=r.cloneNode(!0);i.removeAttribute("id"),r.parentElement.appendChild(i),this.editEvent(t,n,i)}}},{key:"onEventEnterKey",value:function(e){var t=e.assignmentRecord,n=e.eventRecord;t?this.editEvent(n,t.resource):n&&this.editEvent(n,n.resource)}},{key:"onEventTypeChange",value:function(e){var t=e.value;this.toggleEventType(t)}},{key:"getEventMenuItems",value:function(e){var t=this,n=e.eventRecord,r=e.resourceRecord,i=e.items;this.scheduler.readOnly||(i.editEvent={text:this.L("Edit Event"),icon:"b-icon b-icon-edit",weight:-200,onItem:function(){t.editEvent(n,r)}})}},{key:"readOnly",get:function(){return this.editor?this.editor.readOnly:this._readOnly},set:function(e){this._readOnly=e,this.editor&&(this.editor.readOnly=e)}},{key:"values",get:function(){var e=se()(J()(r.prototype),"values",this);return!this.scheduler.assignmentStore&&e.resource&&(e.resourceId=e.resource.id,delete e.resource),e}},{key:"resourceStore",get:function(){return this._resourceStore},set:function(e){this._resourceStore=e,this.resourceField&&(this.resourceField.store=e)}}],[{key:"$name",get:function(){return"EventEdit"}},{key:"defaultConfig",get:function(){return{triggerEvent:"eventdblclick",showResourceField:!0,resourceFieldConfig:null,typeField:"eventType",eventRecord:null,readOnly:null,editorConfig:{title:"L{Edit Event}",localeClass:this,closable:!0,items:[{type:"text",localeClass:this,label:"L{Name}",clearable:!0,name:"name",ref:"nameField"},{type:"combo",localeClass:this,label:"L{Resource}",name:"resource",ref:"resourceField",editable:!0,valueField:"id",displayField:"name"},{type:"date",cls:"b-inline",clearable:!1,required:!0,localeClass:this,label:"L{Start}",name:"startDate",ref:"startDateField",flex:"1 0 60%"},{type:"time",clearable:!1,required:!0,name:"startDate",ref:"startTimeField",cls:"b-match-label",flex:"1 0 40%"},{type:"date",cls:"b-inline",clearable:!1,required:!0,localeClass:this,label:"L{End}",name:"endDate",ref:"endDateField",flex:"1 0 60%"},{type:"time",clearable:!1,required:!0,name:"endDate",ref:"endTimeField",cls:"b-match-label",flex:"1 0 40%"},{type:"extraItems"}],bbar:[{type:"widget",cls:"b-label-filler"},{color:"b-green",localeClass:this,text:"L{Save}",ref:"saveButton"},{color:"b-gray",localeClass:this,text:"L{Delete}",ref:"deleteButton"},{color:"b-gray",localeClass:this,text:"L{Cancel}",ref:"cancelButton"}]}}}},{key:"pluginConfig",get:function(){return{chain:["getEventMenuItems","onEventEnterKey"],assign:["editEvent"]}}}]),r}(xy(Zp));function Ty(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Dy._$name="EventEdit",bd.registerFeature(Dy,!0,"Scheduler");var My=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ty()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,t),this.scheduler=e}},{key:"getHeaderMenuItems",value:function(e,t){var n=this;"timeAxis"===e.type&&t.push({text:n.L("filterEvents"),icon:"b-fw-icon b-icon-filter",disabled:n.disabled,menu:{type:"popup",items:[{type:"textfield",cls:"b-eventfilter b-last-row",clearable:!0,keyStrokeChangeDelay:300,label:n.L("byName"),width:200,listeners:{change:n.onEventFilterChange,thisObj:n}}],onBeforeShow:function(e){var t=e.source,r=te()(t.items,1)[0],i=n.scheduler.eventStore.filters.getBy("property","name");r.value=i&&i.value}}})}},{key:"onEventFilterChange",value:function(e){var t=e.value;""!==t?this.scheduler.eventStore.filter("name",t):this.scheduler.eventStore.removeFieldFilter("name")}}],[{key:"$name",get:function(){return"EventFilter"}},{key:"pluginConfig",get:function(){return{chain:["getHeaderMenuItems"]}}}]),r}(ho);function Ay(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}My.featureClass="b-event-filter",My._$name="EventFilter",bd.registerFeature(My,!0,["Scheduler","Gantt"]);var Iy={top:"b-t",right:"b100-t100",bottom:"t-b",left:"b0-t0"},Fy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ay()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"render",value:function(){var e=this;e.resize&&e.resize.destroy(),e.resize=e.createResizeHelper(),e.showTooltip&&(e.clockTemplate=new Hp({scheduler:e.client}))}},{key:"doDestroy",value:function(){var e=this;e.tip&&e.tip.destroy(),e.clockTemplate&&e.clockTemplate.destroy(),e.resize&&e.resize.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"isElementResizable",value:function(e,t){var n=this.client,r=this.resize,i=n.resolveTimeSpanRecord(e);if(n.readOnly)return!1;var o=i&&i.isResizable,a=(e=on.up(t.target,n.eventSelector))?e.firstElementChild:e,s=t.target.closest('[class$="-handle"]');if(!o||s&&s!==a)return!1;var l=e.classList.contains("b-sch-event-startsoutside"),c=e.classList.contains("b-sch-event-endsoutside");if(!0===o){if(l&&c)return!1;if(l)o="end";else{if(!c)return r.overStartHandle(t,e)||r.overEndHandle(t,e);o="start"}}return!(l&&"start"===o||c&&"end"===o)&&!!(r.overStartHandle(t,e)&&"start"===o||r.overEndHandle(t,e)&&"end"===o)}},{key:"onBeforeResizeStart",value:function(e){var t,n=e.element,r=e.event,i=this.client,o=i.scheduledEventName,a=i.resolveTimeSpanRecord(n);return!this.disabled&&!1!==i.trigger("before".concat(i.capitalizedEventName,"Resize"),(t={},oe()(t,o+"Record",a),oe()(t,"event",r),t))}},{key:"onResizeStart",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.client,a=o.resolveTimeSpanRecord(n.element),s=o.scheduledEventName;o.element.classList.add("b-resizing-event"),i.setupProductResizeContext(n,r),i.showTooltip&&(i.tip?(i.tip.align=Iy[n.edge],i.tip.showBy(i.getTooltipTarget())):(i.tip=new Ui({id:"".concat(o.id,"-event-resize-tip"),autoShow:!0,axisLock:!0,trackMouse:!1,updateContentOnMouseMove:!0,getHtml:i.getTipHtml.bind(i),align:Iy[n.edge],hideDelay:0}),i.tip.on("innerhtmlupdate",i.updateDateIndicator,i))),a.instanceMeta(o).retainElement=!0,o.trigger("".concat(s,"ResizeStart"),(t={},oe()(t,"".concat(s,"Record"),a),oe()(t,"event",r),t))}},{key:"updateDateIndicator",value:function(){var e=this.resize.context,t=e.edge,n=e.startDate,r=e.endDate,i=this.tip.element;(n||r)&&("right"===t||"bottom"===t?this.clockTemplate.updateDateIndicator(i.querySelector(".b-sch-tooltip-enddate"),r):this.clockTemplate.updateDateIndicator(i,n))}},{key:"getTooltipTarget",value:function(){var e=this,t=In.from(e.resize.context.element,null,!0);return"horizontal"===e.resize.direction?("right"===e.resize.context.edge&&(t.x=t.right-1),t.width=e.tip.anchorSize[0]/2):("bottom"===e.resize.context.edge&&(t.y=t.bottom-1),t.height=e.tip.anchorSize[1]/2),{target:t}}},{key:"onResizing",value:function(e){var t,n,r,i=e.context,o=e.event,a=this,s=a.client,l=s.features.dependencies,c=a.getTimespanRecord(i),u=s.scheduledEventName,d=i.element,f=i.edge,h=on.getTranslateXY(d);if("top"===f||"left"===f?(r=c.endDate,s.snapRelativeToEventStartDate?(n=s.getDateFromXY(h,null,!0),n=s.timeAxis.roundDate(n,c.startDate)):n=s.getDateFromXY(h,"round",!0)):(h[0]+=d.offsetWidth,h[1]+=d.offsetHeight,n=c&&c.startDate,s.snapRelativeToEventStartDate?(r=s.getDateFromXY(h,null,!0),r=s.timeAxis.roundDate(r,c.endDate)):r=s.getDateFromXY(h,"round",!0)),n=n||i.startDate,r=r||i.endDate,i.dateConstraints&&(n=ft.constrain(n,i.dateConstraints.start,i.dateConstraints.end),r=ft.constrain(r,i.dateConstraints.start,i.dateConstraints.end)),a.showExactResizePosition||s.timeAxisViewModel.snap){var g="top"===f||"left"===f?s.timeAxisViewModel.getDistanceBetweenDates(n,c.endDate):s.timeAxisViewModel.getDistanceBetweenDates(c.startDate,r);switch(f){case"top":on.setTranslateY(d,i.elementStartY+i.elementWidth-g),d.style.height=g+"px";break;case"right":d.style.width=g+"px";break;case"bottom":d.style.height=g+"px";break;case"left":on.setTranslateX(d,i.elementStartX+i.elementWidth-g),d.style.width=g+"px"}}var v=i.endDate-r!=0||i.startDate-n!=0;i.endDate=r,i.startDate=n,v&&(i.valid=a.checkValidity(i,o)),s.trigger("".concat(u,"PartialResize"),(t={},oe()(t,"".concat(u,"Record"),c),oe()(t,"startDate",n),oe()(t,"endDate",r),oe()(t,"element",d),oe()(t,"context",i),t)),l&&l.updateDependenciesForTimeSpan(c,d),a.showTooltip&&a.tip.alignTo(a.getTooltipTarget())}},{key:"checkValidity",value:function(e,t){var n=e.startDate&&e.endDate>e.startDate&&this.validatorFn.call(this.validatorFnThisObj||this,e,t);return n&&"boolean"!=typeof n&&(e.message=n.message||"",n=n.valid),!1!==n}},{key:"onFinishResize",value:function(e){e.source;var t=e.context,n=e.event,r=this,i=r.getTimespanRecord(t),o=i.startDate,a=i.endDate,s=t.startDate||o,l=t.endDate||a,c=r.client,u=!1;i.instanceMeta(c).retainElement=!1;var d=t.finalize;t.finalize=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.async&&r.finalize.apply(r,n),d.call(t,n)},t.valid=s&&l&&l-s>0&&(s-o!=0||l-a!=0)&&!1!==t.valid,t.valid&&(c.trigger("before".concat(c.scheduledEventName,"ResizeFinalize"),{context:t,event:n}),u=!0),t.async||r.finalize(u)}},{key:"onCancelResize",value:function(e){var t=e.context,n=this.getTimespanRecord(t);n&&(n.instanceMeta(this.client).retainElement=!1),this.finalize(!1)}},{key:"finalize",value:function(e){var t=this,n=t.client,r=t.resize.context,i=t.getTimespanRecord(r),o=n.scheduledEventName,a=!1;if(t.tip&&t.tip.hide(),r.started&&(e&&(a=t.internalUpdateRecord(r,i)),!e||!a)){var s=n.features.dependencies;t.resize.abortResize(null,!0),s&&s.scheduleDraw(!0)}n.element.classList.remove("b-resizing-event"),n.trigger("".concat(o,"ResizeEnd"),oe()({changed:a},"".concat(o,"Record"),i||n.resolveEventRecord(r.element)))}},{key:"getTipHtml",value:function(e){var t=e.tip,n=this,r=n.resize.context,i=r.startDate,o=r.endDate,a=r.valid,s=r.message;if(!i||!o)return t.html;void 0===s&&(s=""),o=n.client.getDisplayEndDate(o,i);var l=n.client.getFormattedDate(i),c=n.client.getFormattedDate(o);return n.tipTemplate({valid:a,startDate:i,endDate:o,startText:l,endText:c,message:s,startClockHtml:n.clockTemplate.template({date:i,text:l,cls:"b-sch-tooltip-startdate"}),endClockHtml:n.clockTemplate.template({date:o,text:c,cls:"b-sch-tooltip-enddate"})})}},{key:"getRowRecord",value:function(e){throw new Error("Implement in subclass")}},{key:"getTimespanRecord",value:function(e){throw new Error("Implement in subclass")}},{key:"setupProductResizeContext",value:function(e,t){throw new Error("Implement in subclass")}},{key:"store",get:function(){throw new Error("Implement in subclass")}}],[{key:"defaultConfig",get:function(){return{showTooltip:!0,showExactResizePosition:!1,validatorFn:function(){},validatorFnThisObj:null,tip:null,tipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")}}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),r}(ho);function Oy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Fy._$name="ResizeBase";var _y=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Oy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"createResizeHelper",value:function(){var e=this,t=e.client;return new jc({direction:t.isVertical?"vertical":"horizontal",name:e.constructor.$name,isElementResizable:function(t,n){return e.isElementResizable(t,n)},targetSelector:t.eventSelector,handleContainerSelector:t.eventInnerSelector,resizingCls:"b-sch-event-wrap-resizing",allowResize:e.isElementResizable.bind(e),outerElement:t.timeAxisSubGridElement,scrollManager:t.scrollManager,dragThreshold:0,dynamicHandleSize:!0,reservedSpace:5,scroller:t.timeAxisSubGrid.scrollable,listeners:{beforeresizestart:e.onBeforeResizeStart,resizestart:e.onResizeStart,resizing:e.onResizing,resize:e.onFinishResize,cancel:e.onCancelResize,thisObj:e}})}},{key:"getTimespanRecord",value:function(e){return e.eventRecord}},{key:"getRowRecord",value:function(e){return e.resourceRecord}},{key:"setupProductResizeContext",value:function(e,t){var n=this.client,r=n.resolveEventRecord(e.element),i=n.resolveResourceRecord(e.element);Object.assign(e,{eventRecord:r,resourceRecord:i,dateConstraints:n.getDateConstraints(i,r)})}},{key:"onResizeStart",value:function(e){var t=e.context,n=e.event;se()(J()(r.prototype),"onResizeStart",this).call(this,{context:t,event:n}),this.client.features.dependencies&&this.client.features.dependencies.hideTerminals(t.element),t.element.querySelector(".b-sch-event").classList.add("b-sch-event-resizing")}},{key:"checkValidity",value:function(e,t){return(this.client.allowOverlap||this.client.isDateRangeAvailable(e.startDate,e.endDate,e.eventRecord,e.resourceRecord))&&se()(J()(r.prototype),"checkValidity",this).call(this,e,t)}},{key:"onFinishResize",value:function(e){var t=e.source,n=e.context,i=e.event;se()(J()(r.prototype),"onFinishResize",this).call(this,{source:t,context:n,event:i}),this.client.features.dependencies&&this.client.features.dependencies.showTerminals(n.eventRecord,n.element)}},{key:"internalUpdateRecord",value:function(e,t){var n=this.store,r=t.generation;return"left"===e.edge||"top"===e.edge?t.setStartDate(e.startDate,!1,n.skipWeekendsDuringDragDrop):t.setEndDate(e.endDate,!1,n.skipWeekendsDuringDragDrop),t.generation!==r||(this.client.repaintEventsForResource(e.resourceRecord),!1)}},{key:"finalize",value:function(e){this.resize.context.element.querySelector(".b-sch-event").classList.remove("b-sch-event-resizing"),se()(J()(r.prototype),"finalize",this).call(this,e)}},{key:"store",get:function(){return this.client.eventStore}}],[{key:"$name",get:function(){return"EventResize"}}]),r}(Fy);function Py(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}_y._$name="EventResize",bd.registerFeature(_y,!0,"Scheduler");var Ly=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Py()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;t=n.processConfig(t),se()(J()(r.prototype),"construct",this).call(this,e,t),n.forSelector||(n.forSelector="".concat(e.eventInnerSelector,":not(.b-dragproxy)")),n.clockTemplate=new Hp({scheduler:e}),e.on(oe()({},"before".concat(e.scheduledEventName,"drag"),(function(){n.tooltip&&n.tooltip.hide()})))}},{key:"processConfig",value:function(e){return"function"==typeof e?{template:e}:e}},{key:"setConfig",value:function(e){se()(J()(r.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){this.clockTemplate&&this.clockTemplate.destroy(),this.tooltip&&this.tooltip.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.tooltip&&(this.tooltip.disabled=e),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"render",value:function(){var e=this,t=e.client,n=[".b-dragselecting",".b-eventeditor-editing",".b-resizing-event",".b-dragcreating",".b-dragging-".concat(t.scheduledEventName),".b-creating-dependency",".b-dragproxy"].map((function(e){return":not(".concat(e,")")})).join("");e.tooltip&&e.tooltip.destroy(),e.tooltip=new Ui(Object.assign({axisLock:"flexible",id:e.tipId||"".concat(e.client.id,"-event-tip"),cls:e.tipCls,forSelector:".b-timelinebase".concat(n," .b-grid-body-container:not(.b-scrolling) ").concat(e.forSelector),scrollAction:"realign",clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],forElement:t.timeAxisSubGridElement,showOnHover:!0,hoverDelay:0,hideDelay:100,anchorToTarget:!0,allowOver:Boolean(e.config.items||e.config.tools),getHtml:e.getTipHtml.bind(e),disabled:e.disabled},e.config)),e.tooltip.on("innerhtmlupdate",e.updateDateIndicator,e)}},{key:"updateDateIndicator",value:function(){var e=this.client,t=this.tooltip,n=t.activeTarget&&e.resolveTimeSpanRecord(t.activeTarget),r=t.element.querySelector(".b-sch-tooltip-enddate");n&&(this.clockTemplate.updateDateIndicator(t.element,n.startDate),r&&this.clockTemplate.updateDateIndicator(r,n.endDate))}},{key:"resolveTimeSpanRecord",value:function(e){return this.client.resolveTimeSpanRecord(e)}},{key:"getTipHtml",value:function(e){var t=e.tip,n=e.activeTarget,r=this,i=r.client,o=r.recordType||"".concat(i.scheduledEventName,"Record"),a=r.resolveTimeSpanRecord(n);if(a){var s,l=a.startDate,c=a.endDate,u=i.getFormattedDate(l),d=i.getDisplayEndDate(c,l),f=i.getFormattedDate(d);return t.eventRecord=a,t.title=a.name,r.template((s={tip:t},oe()(s,"".concat(o),a),oe()(s,"startDate",l),oe()(s,"endDate",c),oe()(s,"startText",u),oe()(s,"endText",f),oe()(s,"startClockHtml",r.clockTemplate.template({date:l,text:u,cls:"b-sch-tooltip-startdate"})),oe()(s,"endClockHtml",a.isMilestone?"":r.clockTemplate.template({date:d,text:f,cls:"b-sch-tooltip-enddate"})),s))}return t.hide(),""}}],[{key:"defaultConfig",get:function(){return{autoUpdate:!1,template:null,cls:null,align:{align:"b-t"},clockTemplate:null}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),r}(ho);function Hy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ly._$name="TooltipBase";var jy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Hy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;se()(J()(r.prototype),"construct",this).call(this,e,t),"string"==typeof n.align&&(n.align={align:n.align}),n.client.features.dependencies&&(n.align.offset=[0,10])}}],[{key:"$name",get:function(){return"EventTooltip"}},{key:"defaultConfig",get:function(){return{template:function(e){return"\n                ".concat(e.eventRecord.name?'<div class="b-sch-event-title">'.concat(e.eventRecord.name,"</div>"):"","\n                ").concat(e.startClockHtml,"\n                ").concat(e.endClockHtml)},cls:"b-sch-event-tooltip"}}}]),r}(Ly);function By(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}jy._$name="EventTooltip",bd.registerFeature(jy,!0,"Scheduler");var Ny=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(By()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"generateHtml",value:function(e,t,n){var r=this.store,i=e.summaries||(e.sum?[{sum:e.sum,renderer:e.summaryRenderer}]:[]),o='<table class="'.concat(n,'">');return i.forEach((function(n){var i=n.sum,a=null;switch(!0===i&&(i="sum"),i){case"sum":case"add":a=r.sum(e.field,t);break;case"max":a=r.max(e.field,t);break;case"min":a=r.min(e.field,t);break;case"average":case"avg":a=r.average(e.field,t);break;case"count":a=t.length;break;case"countNotEmpty":a=t.reduce((function(t,n){var r=n[e.field];return t+(null!=r?1:0)}),0)}if("function"==typeof i&&(a=t.reduce(i,"seed"in n?n.seed:0)),null!==a){var s,l=n.label?'<td class="b-grid-summary-label">'.concat(n.label,"</td>"):"",c=n.renderer?n.renderer({config:n,sum:a}):a;null==c&&(c=""),s=String(c).includes("<td>")?c:l?"".concat(l,'<td class="').concat("b-grid-summary-value",'">').concat(c,"</td>"):'<td colspan="2" class="'.concat("b-grid-summary-value",'">').concat(c,"</td>"),o+="<tr>".concat(s,"</tr>")}})),o+"</table>"}}]),r}(e||G)};function zy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Vy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(zy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;if(Object.assign(n,{grid:e,store:e.store}),se()(J()(r.prototype),"construct",this).call(this,e,t),!e.features.group)throw new Error("Requires Group feature to work, please enable");n.store.on({update:n.onStoreUpdate,prio:1,thisObj:n}),n.grid.rowManager.on({beforerenderrow:n.onBeforeRenderRow,rendercell:n.renderCell,thisObj:n})}},{key:"doDisable",value:function(e){this.store.useGroupFooters=!e,this.isConfiguring||this.store.group(),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,n=e.record;t.isGroupFooter&&!n.meta.hasOwnProperty("groupFooterFor")&&(t.isGroupFooter=!1,t.removeCls("b-group-footer"),t.forceInnerHTML=!0)}},{key:"renderCell",value:function(e){var t=e.column,n=e.cellElement,r=e.rowElement,i=e.row,o=e.record,a=e.size;if(this.store.isGrouped&&o.meta.hasOwnProperty("groupFooterFor")){r.classList.add("b-group-footer"),i.isGroupFooter=!0;var s=this.updateSummaryHtml(n,t,o.meta.groupRecord.groupChildren),l="number"==typeof s?s:s.count;l>1&&(a.height=this.grid.rowHeight+l*this.grid.rowHeight*.1),s.height&&(a.height+=s.height)}}},{key:"updateSummaryHtml",value:function(e,t,n){(n=n.slice()).pop();var r=this.generateHtml(t,n,"b-grid-group-summary");return e.children.length?on.sync(r,e.firstElementChild):e.innerHTML=r,t.summaries?t.summaries.length:t.sum?1:0}},{key:"onStoreUpdate",value:function(e){var t=this,n=e.source,r=e.changes;if(!this.disabled&&n.isGrouped){if(r&&n.groupers.find((function(e){return e.field in r})))return;Object.keys(r).some((function(e){var n=t.grid.columns.get(e);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))}))&&(this.grid.forceFullRefresh=!0)}}}],[{key:"$name",get:function(){return"GroupSummary"}}]),r}(Ny(ho));function Wy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Vy.featureClass="b-group-summary",Vy._$name="GroupSummary",bd.registerFeature(Vy);var Uy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Wy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"refreshContent",value:function(){this.headersElement&&0===this.headersElement.childNodes.length&&se()(J()(r.prototype),"refreshContent",this).call(this)}}],[{key:"$name",get:function(){return"SchedulerHeader"}}]),r}(wh);function Gy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Uy._$name="Header";var Yy=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Gy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;t.unitToPixelsCache={},se()(J()(r.prototype),"construct",this).call(this,e);var n=t.timeAxis.viewPreset||t.viewPreset;if(n)if(n instanceof Jv)t.consumeViewPreset(n);else{var i=tp.getPreset(n);i&&t.consumeViewPreset(i)}t.timeAxis.on("reconfigure",t.onTimeAxisReconfigure,t),t.configured=!0}},{key:"doDestroy",value:function(){this.timeAxis.un("reconfigure",this.onTimeAxisReconfigure,this)}},{key:"reconfigure",value:function(e){this.headers=null,this.setConfig(e),this.trigger("reconfigure")}},{key:"onTimeAxisReconfigure",value:function(e){var t=e.source,n=e.suppressRefresh;this.viewPreset!==t.viewPreset&&this.consumeViewPreset(t.viewPreset),n||this.update()}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.timeAxis,o=r.headers;if(r.isConfiguring||r._availableSpace===e)n&&r.trigger("update");else{if(r._availableSpace=Math.max(e||r.availableSpace||0,0),"number"!=typeof r.availableSpace)throw new Error("Invalid available space provided to TimeAxisModel");r.availableSpace<=0&&console.warn("No available space provided for time axis. Make sure you have set width for horizontal mode and height for vertical"),r.columnConfig=[];var a=r._tickSize=r.calculateTickSize(r.originalTickSize);if("number"!=typeof a||a<=0)throw new Error("Invalid timeAxis tick size");r.unitToPixelsCache={},r._totalSize=null;for(var s=0,l=o.length;s<l;s++){var c=o[s];if(c.cellGenerator){var u=c.cellGenerator.call(r,i.startDate,i.endDate);r.columnConfig[s]=r.createHeaderRow(s,c,u)}else r.columnConfig[s]=r.createHeaderRow(s,c)}t||r.trigger("update")}}},{key:"getDistanceBetweenDates",value:function(e,t){return Math.round(this.getPositionFromDate(t)-this.getPositionFromDate(e))}},{key:"getDistanceForDuration",value:function(e){var t=this.timeAxis.getAt(0);return this.tickSize/(t.endDate-t.startDate)*e}},{key:"getPositionFromDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=n.getScaledTick(e,t);return-1===r?-1:Math.round(n.tickSize*(r-n.timeAxis.visibleTickStart))}},{key:"getScaledTick",value:function(e,t){var n=t.respectExclusion,r=t.snapToNextIncluded,i=t.isEnd,o=t.min,a=t.max,s=this.timeAxis,l=s.include,c=s.unit,u=s.weekStartDay,d=s.getTickFromDate(e);if(-1!==d&&n&&l){var f=!1;if(l.hour&&ft.compareUnits(c,"hour")>0&&"day"!==c){var h=l.hour,g=h.from,v=h.to,p=h.lengthFactor,y=h.center,m=e.getHours(),b=Math.min(Math.max(m,g),v);if(!r&&b!==m)return-1;var k=y-(y-(b+e.getMinutes()/60))*p;e=ft.add(e,k-m,"h"),f=!0}if(l.day&&ft.compareUnits(c,"day")>0){var w=l.day,S=w.from,C=w.to,R=w.lengthFactor,x=w.center,E=e.getDay();i&&0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()&&--E<0&&(E=6);var D=0;if(E<S||E>=C){if(!r)return-1;if(D=i?(C-E-8)%7:(S-E+7)%7,e=ft.add(e,D,"d"),e=ft.startOf(e,"d",!1),a&&e.getTime()>=a||o&&e.getTime()<=o)return-1}var T=0===e.getDay()?0:x,M=e.getDay()+e.getHours()/24,A=T-(T-M)*R;e=ft.add(e,A-M+u,"d"),f=!0}f&&(e=ft.constrain(e,s.startDate,s.endDate),d=s.getTickFromDate(e))}return d}},{key:"getDateFromPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.timeAxis,o=r.getScaledPosition(e)/r.tickSize+i.visibleTickStart;return o<0||o>i.count?n?o<0?ft.add(i.startDate,o,i.unit):ft.add(i.endDate,o-i.count,i.unit):null:i.getDateFromTick(o,t)}},{key:"getScaledPosition",value:function(e){var t=this.timeAxis,n=t.include,r=t.unit,i=t.weekStartDay;if(n){var o=this.getSingleUnitInPixels("day");if(n.day&&ft.compareUnits(r,"day")>0){var a=n.day,s=a.from,l=e%(7*o);e=l/a.lengthFactor+(s-i)*o+(e-l)}if(n.hour&&ft.compareUnits(r,"hour")>0&&"day"!==r){var c=n.hour,u=c.from,d=e%o;e=d/c.lengthFactorExcl+u*this.getSingleUnitInPixels("hour")+(e-d)}}return e}},{key:"getSingleUnitInPixels",value:function(e){var t=this;return t.unitToPixelsCache[e]||(t.unitToPixelsCache[e]=ft.getUnitToBaseUnitRatio(t.timeAxis.unit,e,!0)*t.tickSize/t.timeAxis.increment)}},{key:"setTickSize",value:function(e,t){this._tickSize=this.originalTickSize=e,this.update(void 0,t)}},{key:"calculateTickSize",value:function(e){var t=this,n=t.forceFit,r=t.timeAxis,i=r.unit,o=0,a=1;if(t.snap){var s=r.resolution;a=ft.getUnitToBaseUnitRatio(i,s.unit)*s.increment}if(t.suppressFit)o=e;else{var l=r.visibleTickTimeSpan,c=Math[n?"floor":"round"](t.availableSpace/l);if(o=n||e<c?c:e,a>0&&(!n||a<1)){var u=n?"floor":"round";o=Math.round(Math.max(1,Math[u](a*o))/a)}}return o}},{key:"getDates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.columnLinesFor,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=[],o=t?r.lowestHeader:e,a=r.majorHeaderLevel,s=r.headers&&r.headers[e].unit,l=null!=a&&r.headers&&r.headers[a].unit,c=null!=a&&ft.doesUnitsAlign(l,s),u=!(!r.headers||!r.headers[o].cellGenerator);if(u)for(var d=r.columnConfig[o],f=1,h=d.length;f<h;f++)i.push({date:d[f].startDate});else r.forEachInterval(o,(function(t,o){i.push({date:n?o:t,isMajor:a!==e&&c&&r.isMajorTick(n?o:t)})}));return i}},{key:"fitToAvailableSpace",value:function(e){var t=Math.floor(this.availableSpace/this.timeAxis.visibleTickTimeSpan);this.setTickSize(t,e)}},{key:"createHeaderRow",value:function(e,t,n){var r=this,i=this,o=[],a=t.align,s=ft.clearTime(new Date),l=t.headerCellCls||"",c=function(n,c,d,f){var h=ft.format(n,t.dateFormat),g={align:a,start:n,end:c,value:f?f.header:h,headerCellCls:l,width:r.getDistanceBetweenDates(n,c),index:d};0!==g.width&&(g.coord=u,u+=g.width,i.headersDatesCache[e][n.getTime()]=1,t.renderer&&(h=t.renderer.call(t.thisObj||i,n,c,g,d,i.eventStore),g.value=null==h?"":h),"day"!==t.unit||t.increment&&1!==t.increment||(g.headerCellCls+=" b-sch-dayheadercell-"+n.getDay(),i.calendar&&i.calendar.isWeekend(n)&&(g.headerCellCls+=" b-sch-dayheadercell-nonworking"),ft.clearTime(n,!0)-s==0&&(g.headerCellCls+=" b-sch-dayheadercell-today")),o.push(g))},u=0;return i.headersDatesCache[e]={},n?n.forEach((function(e,t){return c(e.start,e.end,t,e)})):i.forEachInterval(e,c),o}},{key:"isMajorTick",value:function(e){var t=this.majorHeaderLevel;return null!=t&&this.headersDatesCache[t]&&this.headersDatesCache[t][e.getTime()]||!1}},{key:"forEachInterval",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,r=this.headers;if(r)if(e===r.length-1)this.timeAxis.forEach((function(e,r){return t.call(n,e.startDate,e.endDate,r)}));else{var i=r[e];this.timeAxis.forEachAuxInterval(i.unit,i.increment,t,n)}}},{key:"forEachMainInterval",value:function(e,t){this.forEachInterval(this.mainHeaderLevel,e,t)}},{key:"consumeViewPreset",value:function(e){var t=this;t.headers=null,t._thisIsAUsedExpression(t.tickSize),t.viewPreset=e,Object.assign(t,{headers:e.headers,columnLinesFor:e.columnLinesFor,mainHeaderLevel:e.mainHeaderLevel,_tickSize:t.isHorizontal?e.tickWidth:e.tickHeight}),t.originalTickSize=t.tickSize}},{key:"columnConfig",get:function(){return this._columnConfig},set:function(e){this._columnConfig=e}},{key:"headers",get:function(){return this._headers},set:function(e){if(e&&e.length&&e[e.length-1].cellGenerator)throw new Error("`cellGenerator` cannot be used for the bottom level of your headers. Use TimeAxis#generateTicks() instead.");this._headers=e}},{key:"isTimeAxisViewModel",get:function(){return!0}},{key:"isHorizontal",get:function(){return"vertical"!==this.mode}},{key:"isVertical",get:function(){return"vertical"===this.mode}},{key:"forceFit",set:function(e){e!==this._forceFit&&(this._forceFit=e,this.update())},get:function(){return this._forceFit}},{key:"snapPixelAmount",get:function(){if(this.snap){var e=this.timeAxis.resolution;return(e.increment||1)*this.getSingleUnitInPixels(e.unit)}return 1}},{key:"tickSize",get:function(){return this._tickSize},set:function(e){this.setTickSize(e,!1)}},{key:"timeResolution",get:function(){return this.timeAxis.resolution}},{key:"totalSize",get:function(){return this._totalSize||(this._totalSize=Math.round(this.tickSize*this.timeAxis.visibleTickTimeSpan))}},{key:"availableSpace",get:function(){return this._availableSpace},set:function(e){var t=this;if(t._availableSpace=Math.max(0,e),t._availableSpace>0){var n=t.calculateTickSize(t.originalTickSize);n>0&&n!==t.tickSize&&t.update()}}},{key:"snap",get:function(){return this._snap},set:function(e){e!==this._snap&&(this._snap=e,this.configured&&this.update())}},{key:"mainHeader",get:function(){return"mainHeaderLevel"in this?this.headers[this.mainHeaderLevel]:this.bottomHeader}},{key:"bottomHeader",get:function(){return this.headers[this.headers.length-1]}},{key:"lowestHeader",get:function(){return this.headers.length-1}},{key:"majorHeaderLevel",get:function(){var e=this.headers;return e?Math.max(e.length-2,0):null}}],[{key:"defaultConfig",get:function(){return{timeAxis:null,availableSpace:null,tickSize:100,snap:!1,forceFit:!1,headers:null,calendar:null,mode:"horizontal",suppressFit:!1,columnConfig:[],viewPreset:null,columnLinesFor:null,eventStore:null,originalTickSize:null,headersDatesCache:[]}}}]),r}(pe());function $y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Yy._$name="TimeAxisViewModel";var qy=new Date;function Xy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ky={mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseover:"MouseOver",mouseout:"MouseOut"};function Jy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Qy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Zy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function em(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function tm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var nm=["viewPreset","eventBarTextField","eventRenderer","eventRendererThisObj","eventBodyTemplate"],rm={fn:"exitTransition",delay:0,cancelOutstanding:!0},im=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(tm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=e.schedulerRegion||"normal",i=e.subGridConfigs,o=void 0===i?{}:i;e.subGridConfigs=o,o[n]=o[n]||{},o[n].headerClass=Uy,"flex"in o[n]||"width"in o[n]||(o[n].flex=1),e.startDate&&(e.startDate=ft.parse(e.startDate)),e.endDate&&(e.endDate=ft.parse(e.endDate)),se()(J()(r.prototype),"construct",this).call(this,e),t.onSchedulerViewportResize=t.throttle(t.onSchedulerViewportResize,250),t.initDomEvents(),t.currentOrientation.init(),t.rowManager.on("refresh",(function(){t.forceLayout=!1}))}},{key:"doDestroy",value:function(){var e=this,t=this.currentOrientation;t&&t.destroy(),e.partneredWith&&(e.partneredWith.forEach((function(t){e.removePartner(t)})),e.partneredWith.destroy()),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"startConfigure",value:function(e){se()(J()(r.prototype),"startConfigure",this).call(this,e),this._thisIsAUsedExpression(this.partner)}},{key:"onPaint",value:function(e){var t=e.firstPaint;if(t){var n=this.timeAxisSubGrid,i=this.isVertical?Re.isIE11?n.element.parentElement.offsetHeight:n.height:n.width;this.timeAxisViewModel.update(i,!1,!0)}se()(J()(r.prototype),"onPaint",this).call(this,Array.prototype.slice.call(arguments))}},{key:"initSubGrids",value:function(){se()(J()(r.prototype),"initSubGrids",this).call(this);var e=this,t=e.timeAxisSubGrid=e.subGrids[e.timeAxisColumn.region];t.sealedColumns=!0,t.on({resize:e.onTimeAxisSubGridResize,thisObj:e})}},{key:"onSchedulerHorizontalScroll",value:function(e,t){this.currentOrientation.updateFromHorizontalScroll(t),se()(J()(r.prototype),"onSchedulerHorizontalScroll",this).call(this,e,t)}},{key:"initScroll",value:function(){var e=this,t=0;se()(J()(r.prototype),"initScroll",this).call(this),Re.isMobileSafari&&(e.scrollable.element.style.transform="translate3d(0, 0, 0)"),e.on("horizontalscroll",(function(n){var r=n.subGrid,i=n.scrollLeft;e.isPainted&&r===e.timeAxisSubGrid&&!e.isDestroying&&e.onSchedulerHorizontalScroll(r,i),t++})),"horizontal"===e.testPerformance&&e.setTimeout((function(){var n=performance.now(),r=5,i=1,o=e.setInterval((function(){if(r+=5,e.scrollLeft+=(10+Math.floor(r))*i,1===i&&e.scrollLeft>5500&&(i=-1,r=5),-1===i&&e.scrollLeft<=0){var a=1e3/((performance.now()-n)/t);a=Math.round(10*a)/10,clearInterval(o),console.log(e.eventPositionMode,e.eventScrollMode,a+"fps")}}),0)}),500)}},{key:"noFeatureElementsInAxis",value:function(){}},{key:"removePartner",value:function(e){var t=this,n=t.partneredWith;n&&n.includes(e)&&(n.remove(e),e.partneredWith.remove(t),e.scrollable.removePartner(t.scrollable),e.un({presetchange:"onPartnerPresetChange",thisObj:t}),t.un({presetchange:"onPartnerPresetChange",thisObj:e}))}},{key:"onPartnerPresetChange",value:function(e){var t=e.preset,n=e.startDate,r=e.endDate,i=e.centerDate;this._viewPresetChanging||this.viewPreset===t||this.setViewPreset(t,n,r,!1,{centerDate:i})}},{key:"applyWorkingTime",value:function(e){var t=this,n=t._workingTime;if(n){var r=null;n.fromHour>=0&&n.fromHour<24&&n.toHour>n.fromHour&&n.toHour<=24&&n.toHour-n.fromHour<24&&(r={from:n.fromHour,to:n.toHour});var i=null;n.fromDay>=0&&n.fromDay<7&&n.toDay>n.fromDay&&n.toDay<=7&&n.toDay-n.fromDay<7&&(i={from:n.fromDay,to:n.toDay}),e.include=r||i?{hour:r,day:i}:null}else e.include=null;t.isPainted&&(t.timeAxisColumn.refreshHeader(),t.features.columnLines&&t.features.columnLines.drawLines(),t.refreshWithTransition())}},{key:"setStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n._timeAxis||{},i=r.startDate,o=r.endDate,a=r.mainUnit;if("string"==typeof e&&(e=ft.parse(e)),n._timeAxis&&o){if(e){var s=o;if(t&&i){var l=ft.diff(i,o,a,!0);s=ft.add(e,l,a)}r.setTimeSpan(e,s)}}else n._tempStartDate=e}},{key:"setEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n._timeAxis||{},i=r.startDate,o=r.endDate,a=r.mainUnit;if("string"==typeof e&&(e=ft.parse(e)),n._timeAxis&&i){if(e){var s=i;if(t&&o){var l=ft.diff(i,o,a,!0);s=ft.add(e,-l,a)}r.setTimeSpan(s,e)}}else n._tempEndDate=e}},{key:"onLocaleChange",value:function(){se()(J()(r.prototype),"onLocaleChange",this).call(this),this.timeAxisColumn.refreshHeader()}},{key:"onInternalResize",value:function(e,t,n,i,o){var a=this._bodyRectangle;se()(J()(r.prototype),"onInternalResize",this).call(this,e,t,n,i,o),a&&n!==o&&this.onSchedulerViewportResize(a.width,this.bodyContainer.offsetHeight,a.width,a.height)}},{key:"onTimeAxisSubGridResize",value:function(e){var t=e.width,n=(e.height,e.oldWidth);e.oldHeight;if(this.isPainted&&t!==n){var r=this._bodyRectangle;this.onSchedulerViewportResize(t,r.height,n,r.height)}}},{key:"onSchedulerViewportResize",value:function(e,t,n,r){if(this.isPainted){var i=this,o=i.timeAxisSubGrid;i.currentOrientation.onViewportResize(e,t,n,r),null!=i._lastOverflow&&i._lastOverflow!==o.overflowingHorizontally||(i.setTimeout((function(){i.timeAxisViewModel.availableSpace=i.isHorizontal?o.width:o.height}),0),i.partneredWith&&!i.isSyncingFromPartner&&i.partneredWith.forEach((function(e){e.isSyncingFromPartner||(e.isSyncingFromPartner=!0,i.eachSubGrid((function(t){var n=e.subGrids[t.region];n.width!==t.width&&(t.collapsed?n.collapse():(n.collapsed&&n.expand(),t.flex?t.flex!==n.flex&&(n.flex=t.flex):n.width=t.width))})),e.isSyncingFromPartner=!1)}))),i.trigger("timelineViewportResize",{width:e,height:t,oldWidth:n,oldHeight:r}),i._lastOverflow=o.overflowingHorizontally}}},{key:"onTimeAxisViewModelUpdate",value:function(){this.updateCanvasSize(),this.isHorizontal&&(this.callEachSubGrid("refreshFakeScroll"),this.refreshVirtualScrollbars()),this.currentOrientation.onTimeAxisViewModelUpdate()}},{key:"updateCanvasSize",value:function(){var e=this;e.isHorizontal?(e.backgroundCanvas&&(e.backgroundCanvas.style.width="".concat(e.timeAxisViewModel.totalSize,"px")),e.foregroundCanvas.style.width="".concat(e.timeAxisViewModel.totalSize,"px")):(e.backgroundCanvas&&(e.backgroundCanvas.style.width=on.setLength(e.timeAxisColumn.width)),e.foregroundCanvas.style.width=on.setLength(e.timeAxisColumn.width))}},{key:"getHeaderDomConfigs",value:function(e){}},{key:"getForegroundDomConfigs",value:function(e){}},{key:"refresh",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;n.isPainted&&!n.refreshSuspended&&(n.hasVisibleEvents?(n.refreshRows(!1,e),t&&t()):n.rowManager.trigger("refresh"))}},{key:"render",value:function(){var e=this,t=e.timeAxisSubGridElement;e.useBackgroundCanvas&&(e._backgroundCanvas=on.createElement({className:"b-sch-background-canvas",parent:t,nextSibling:t.firstElementChild}));var n=e._foregroundCanvas=on.createElement({className:"b-sch-foreground-canvas",style:"font-size:".concat(e.rowHeight-2*e.resourceMargin,"px"),parent:t});e.timeAxisSubGrid.insertRowsBefore=n,se()(J()(r.prototype),"render",this).apply(this,arguments)}},{key:"refreshRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;n.isConfiguring||(n.currentOrientation.refreshRows(t),se()(J()(r.prototype),"refreshRows",this).call(this,e))}},{key:"getDateConstraints",value:function(){}},{key:"runWithTransition",value:function(e,t){var n=this;n.isVisible&&(null!=t&&!0!==t||(t=n.transitionDuration),t&&n.enableEventAnimations&&(n.isAnimating=!0,rm.delay=t,n.setTimeout(rm))),e()}},{key:"exitTransition",value:function(){this.isAnimating=!1,this.trigger("transitionend")}},{key:"refreshWithTransition",value:function(e){var t=this;this.runWithTransition((function(){return t.refresh(e)}))}},{key:"getVisibleDateRange",value:function(){return this.currentOrientation.getVisibleDateRange()}},{key:"hasVisibleEvents",get:function(){var e=this;return!this.noFeatureElementsInAxis()||this.eventStore.storage.values.some((function(t){return e.timeAxis.isTimeSpanInAxis(t)}))}},{key:"capitalizedEventName",get:function(){return this._capitalizedEventName||(this._capitalizedEventName=L.capitalizeFirstLetter(this.scheduledEventName)),this._capitalizedEventName}},{key:"partner",set:function(e){var t=this,n=t.partneredWith||(t.partneredWith=new Sr);t._partner=e,n.includes(e)||(n.add(e),(e.partneredWith||(e.partneredWith=new Sr)).add(t),e.on({presetchange:"onPartnerPresetChange",thisObj:t}),t.on({presetchange:"onPartnerPresetChange",thisObj:e}),t.setConfig({viewPreset:e.viewPreset,timeAxis:e.timeAxis,timeAxisViewModel:e.timeAxisViewModel}),t.initScroll=_n.createSequence(t.initScroll,(function(){t.scrollable.addPartner(e.scrollable,"x")}),t))},get:function(){return this._partner}},{key:"timeAxisColumn",get:function(){return this.columns&&this._timeAxisColumn}},{key:"columns",get:function(){return se()(J()(r.prototype),"columns",this)},set:function(e){var t,n,i,o,a=this;if(e){var s=Array.isArray(e),l=e;s||(l=e.data),t=l&&l.length,l.forEach((function(e,r){"timeAxis"===e.type&&(t=r,n=e)})),a.isVertical?(a._horizontalColumns=e,l=[{type:"verticalTimeAxis",locked:!0,timeline:a},l[t]],t=1):l=l.slice(),n=l[t]=Object.assign({type:"timeAxis",locked:!1,timeline:a,cellCls:a.timeCellCls,mode:a.mode},n),nm.forEach((function(e){null!=(o=a[e])&&(n[e]=o)})),s?e=l:e.data=l}ei()(J()(r.prototype),"columns",e,this,!0),e&&(i=a._timeAxisColumn=a.columns.getAt(t),a.isVertical&&(a.verticalTimeAxisColumn=a.columns.getAt(t-1)),i.relayAll(a))}},{key:"timeView",get:function(){var e=this;return e.columns&&e.isVertical?e.verticalTimeAxisColumn&&e.verticalTimeAxisColumn.view:e.timeAxisColumn&&e.timeAxisColumn.timeAxisView}},{key:"eventCls",set:function(e){var t=this;t._eventCls=e,t.eventSelector||(t.eventSelector=".".concat(e,"-wrap"),t.unreleasedEventSelector="".concat(t.eventSelector,":not(.b-sch-released)")),t.eventInnerSelector||(t.eventInnerSelector="."+e)},get:function(){return this._eventCls}},{key:"timeAxisViewModel",set:function(e){var t=this,n={update:"onTimeAxisViewModelUpdate",prio:100,thisObj:t};t.partner&&!e||(e&&e.isTimeAxisViewModel?e.on(n):(e=Object.assign({mode:t._mode,snap:t.snap,forceFit:t.forceFit,timeAxis:t.timeAxis,listeners:n},e),e=new Yy(e)),t._timeAxisViewModel=e)},get:function(){return this._timeAxisViewModel||(this.timeAxisViewModel=null),this._timeAxisViewModel}},{key:"timeAxis",set:function(e){var t=this;t.partner&&!e||(t.timeAxisDetacher&&t.timeAxisDetacher(),e&&e.isTimeAxis||(e=mt.assign({viewPreset:t.viewPreset,autoAdjust:t.autoAdjustTimeAxis,mode:"plain",weekStartDay:t.weekStartDay},e),t.startDate&&(e.startDate=t.startDate),t.endDate&&(e.endDate=t.endDate),t.workingTime&&t.applyWorkingTime(e),e=new rp(e)),t.timeAxisDetacher=e.on({thisObj:t,reconfigure:function(e){var n=e.config;t.trigger("timeAxisChange",{config:n})}}),t._timeAxis=e)},get:function(){return this._timeAxis||(this.timeAxis=null),this._timeAxis}},{key:"workingTime",set:function(e){this._workingTime=e,this.isConfiguring||this.applyWorkingTime(this.timeAxis)},get:function(){return this._workingTime}},{key:"startDate",set:function(e){this.setStartDate(e)},get:function(){return this._timeAxis?this._timeAxis.startDate:this._tempStartDate||new Date}},{key:"endDate",set:function(e){this.setEndDate(e)},get:function(){var e=this;return e._timeAxis?e._timeAxis.endDate:e._tempEndDate||ft.add(e.startDate,e.viewPreset.defaultSpan,e.viewPreset.mainHeader.unit)}},{key:"features",get:function(){return se()(J()(r.prototype),"features",this)},set:function(e){"regionResize"in(e=!0===e?{}:e)||(e.regionResize=!0),ei()(J()(r.prototype),"features",e,this,!0)}},{key:"eventStyle",get:function(){return this._eventStyle},set:function(e){this._eventStyle=e,this.isPainted&&this.refreshWithTransition()}},{key:"eventColor",get:function(){return this._eventColor},set:function(e){this._eventColor=e,this.isPainted&&this.refreshWithTransition()}},{key:"currentOrientation",get:function(){throw new Error("Implement in subclass")}},{key:"isHorizontal",get:function(){return!0}},{key:"backgroundCanvas",get:function(){return this._backgroundCanvas}},{key:"foregroundCanvas",get:function(){return this._foregroundCanvas}},{key:"svgCanvas",get:function(){var e=this;if(!e._svgCanvas){var t=e._svgCanvas=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("id",we.generateId("svg")),t.retainElement=!0,e.foregroundCanvas.appendChild(t),e.trigger("svgCanvasCreated")}return e._svgCanvas}},{key:"timeAxisSubGridElement",get:function(){return this.timeAxisColumn&&this.timeAxisColumn.subGridElement}}],[{key:"$name",get:function(){return"TimelineBase"}},{key:"defaultConfig",get:function(){return{workingTime:null,timeAxis:null,timeAxisViewModel:null,autoAdjustTimeAxis:!0,startDate:null,endDate:null,snap:!1,snapRelativeToEventStartDate:!1,forceFit:!1,eventCls:null,getDateConstraints:null,timeCellCls:null,timeCellSelector:null,scheduledEventName:null,createEventOnDblClick:!0,overScheduledEventClass:null,preventOverCls:!1,hoveredEventNode:null,useBackgroundCanvas:!1,enableEventAnimations:!Re.isIE11,disableGridRowModelWarning:!0,animateRemovingRows:!1,partner:null,schedulerRegion:"normal",transitionDuration:200,animationTimeout:null,milestoneLayoutMode:"default",defaultRegion:"locked"}}}]),r}(Fo(ug).mixes((function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if($y()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getDateFromCoordinate",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return n||(e=this.currentOrientation.translateToScheduleCoordinate(e)),this.timeAxisViewModel.getDateFromPosition(e,t,r)}},{key:"getDateFromX",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.getDateFromCoordinate(e,t,n)}},{key:"getDateFromXY",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.currentOrientation.getDateFromXY(e,t,n,r)}},{key:"getDateFromDomEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.getDateFromXY([e.x,e.y],t,!1,n)}},{key:"getStartEndDatesFromRectangle",value:function(e,t,n){var r,i,o=this,a=o.isHorizontal,s=a?o.timeAxisSubGrid.width:o.timeAxisSubGrid.height,l=a?e.x:e.top,c=a?e.right:e.bottom;return l>=0&&c<s?(r=o.getDateFromCoordinate(l,null,!0),i=o.getDateFromCoordinate(c,null,!0)):l<0?(i=o.getDateFromCoordinate(c,t,!0),r=ft.add(i,-n,"ms")):(r=o.getDateFromCoordinate(l,t,!0),i=ft.add(r,n,"ms")),{start:r,end:i}}},{key:"getFormattedDate",value:function(e){return ft.format(e,this.displayDateFormat)}},{key:"getDisplayEndDate",value:function(e,t){return 0!==e.getHours()||0!==e.getMinutes()||t&&e.getYear()===t.getYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()||ft.formatContainsHourInfo(this.displayDateFormat)||(e=ft.add(e,-1,"day")),e}},{key:"getFormattedEndDate",value:function(e,t){return this.getFormattedDate(this.getDisplayEndDate(e,t))}},{key:"getCoordinateFromDate",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this,i=r.timeAxisViewModel,o=r.timeAxis,a=o.isContinuous,s=o.startMS,l=o.endMS,c=o.startDate,u=o.unit,d=e.valueOf();if(!0===n?n={local:!0}:n?"local"in n||(n.local=!0):n={local:!1},e instanceof Date||(qy.setTime(e),e=qy),a&&e.getTimezoneOffset()===c.getTimezoneOffset()&&-1!==ft.getUnitToBaseUnitRatio(u,"day")){if(d<s||d>l)return-1;t=Math.round((d-s)/(l-s)*i.totalSize)}else t=i.getPositionFromDate(e,n);return n.local||(t=r.currentOrientation.translateToPageCoordinate(t)),t}},{key:"getTimeSpanDistance",value:function(e,t){return this.timeAxisViewModel.getDistanceBetweenDates(e,t)}},{key:"onSchedulerHorizontalScroll",value:function(e){e.subGrid,e.scrollLeft;this.scrollingToCenter||(this.cachedCenterDate=null)}},{key:"displayDateFormat",get:function(){return this._displayDateFormat},set:function(e){this._displayDateFormat=e,this.trigger("displayDateFormatChange",{format:e})}},{key:"viewportCenterDate",get:function(){var e=this,t=e.timeAxis,n=e.timeAxisSubGrid,r=n.scrollable,i=r.x+n.width/2,o=r.y+n.height/2;if(t.isContinuous){var a=e.isHorizontal?i/r.scrollWidth:o/r.scrollHeight,s=t.startMS+(t.endMS-t.startMS)*a;return new Date(s)}var l=e.isHorizontal?[i,0]:[0,o];return e.getDateFromXY(l,null,!0)}},{key:"viewportCenterDateCached",get:function(){return this.cachedCenterDate||(this.cachedCenterDate=this.viewportCenterDate)}},{key:"timeResolution",get:function(){return this.timeAxis.resolution},set:function(e){this.timeAxis.resolution={increment:e,unit:this.timeAxis.resolution.unit}}},{key:"snap",set:function(e){this.isConfiguring?this._snap=e:this.timeAxisViewModel.snap=e},get:function(){return this.isConfiguring?this._snap:this.timeAxisViewModel.snap}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Xy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"initDomEvents",value:function(){var e=this;e.scheduledBarEvents.element=e.schedulerEvents.element=e.timeAxisSubGridElement,e.scheduledBarEvents.thisObj=e.schedulerEvents.thisObj=e,Kn.on(e.scheduledBarEvents),Kn.on(e.schedulerEvents)}},{key:"getTimeSpanMouseEventParams",value:function(e,t){throw new Error("Implement in subclass")}},{key:"getScheduleMouseEventParams",value:function(e,t){throw new Error("Implement in subclass")}},{key:"handleScheduledBarEvent",value:function(e){var t=on.up(e.target,this.eventInnerSelector),n=Ky[e.type]||L.capitalizeFirstLetter(e.type);t&&this.trigger(this.scheduledEventName+n,this.getTimeSpanMouseEventParams(t,e))}},{key:"handleScheduleEvent",value:function(e){var t=this,n=!on.up(e.target,t.eventSelector)&&on.up(e.target,"."+t.timeCellCls),r=Ky[e.type]||L.capitalizeFirstLetter(e.type);if(n){var i=t.getDateFromDomEvent(e,"floor"),o=Ms.get(n),a=o.row.dataIndex,s=t.timeAxis.getTickFromDate(i),l=t.timeAxis.getAt(Math.floor(s));l&&t.trigger("schedule"+r,Object.assign({date:i,tickStartDate:l.startDate,tickEndDate:l.endDate,row:o.row,index:a,event:e},t.getScheduleMouseEventParams(o,e)))}}},{key:"onElementMouseOver",value:function(e){se()(J()(r.prototype),"onElementMouseOver",this).call(this,e);var t=this,n=e.target;if(n.closest(t.eventInnerSelector)){var i=n.closest(t.eventSelector);if(i.classList.add(t.overScheduledEventClass),i!==t.hoveredEventNode&&!t.preventOverCls){t.hoveredEventNode=i;var o=t.getTimeSpanMouseEventParams(i,e);o&&t.trigger(t.scheduledEventName+"MouseEnter",o)}}else t.hoveredEventNode=null}},{key:"onElementMouseOut",value:function(e){se()(J()(r.prototype),"onElementMouseOut",this).call(this,e);var t=this;if(e.target.closest(t.eventInnerSelector)&&t.resolveTimeSpanRecord(e.target)&&t.hoveredEventNode){if(e.relatedTarget&&on.isDescendant(e.target.closest(t.eventInnerSelector),e.relatedTarget))return;t.unhover(e)}}},{key:"unhover",value:function(e){var t=this,n=t.hoveredEventNode;n&&(n.classList.remove(t.overScheduledEventClass),t.trigger(t.scheduledEventName+"MouseLeave",t.getTimeSpanMouseEventParams(n,e)),t.hoveredEventNode=null)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{scheduledBarEvents:{mousedown:"handleScheduledBarEvent",mouseup:"handleScheduledBarEvent",click:"handleScheduledBarEvent",dblclick:"handleScheduledBarEvent",contextmenu:"handleScheduledBarEvent",mouseover:"handleScheduledBarEvent",mouseout:"handleScheduledBarEvent"},schedulerEvents:{click:"handleScheduleEvent",dblclick:"handleScheduleEvent",contextmenu:"handleScheduleEvent",mousemove:"handleScheduleEvent"}}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Zy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"barMargin",get:function(){return this._barMargin},set:function(e){var t=this;mt.assertNumber(e,"barMargin"),t.isHorizontal&&t.rowHeight&&(e=Math.min(Math.ceil(t.rowHeight/2),e)),t._barMargin!==e&&(t._barMargin=e,t.rendered&&(t.currentOrientation.onBeforeRowHeightChange(),t.refreshWithTransition()))}},{key:"resourceMargin",get:function(){return null==this._resourceMargin?this.barMargin:this._resourceMargin},set:function(e){var t=this;mt.assertNumber(e,"resourceMargin"),t.isHorizontal&&t.rowHeight&&(e=Math.min(Math.ceil(t.rowHeight/2),e)),t._resourceMargin!==e&&(t._resourceMargin=e,t.rendered&&(t.currentOrientation.onBeforeRowHeightChange(),t.refreshWithTransition()))}},{key:"tickWidth",set:function(e){this.tickSize=e},get:function(){return this.tickSize}},{key:"tickSize",set:function(e){mt.assertNumber(e,"tickSize"),this.timeAxisViewModel.tickSize=e},get:function(){return this.timeAxisViewModel.tickSize}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{barMargin:10,resourceMargin:null,managedEventSizing:!0,generatedIdCls:"b-sch-dirty-new",dirtyCls:"b-sch-dirty",committingCls:"b-sch-committing",endsOutsideViewCls:"b-sch-event-endsoutside",startsOutsideViewCls:"b-sch-event-startsoutside",fixedEventCls:"b-sch-event-fixed",eventStyle:"plain",eventColor:"green"}}},{key:"eventColors",get:function(){return["red","pink","purple","violet","indigo","blue","cyan","teal","green","lime","yellow","orange","gray"]}},{key:"eventStyles",get:function(){return["plain","border","hollow","colored","line","dashed","minimal"]}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(em()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"scrollToDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=n.timeAxisSubGrid.scrollable,i=r.viewport,o=n.getCoordinateFromDate(e,!0),a=n.isHorizontal?new In(n.getCoordinateFromDate(e,!1),i.y,n.timeAxisViewModel.tickSize,i.height):new In(i.x,n.getCoordinateFromDate(e,!1),i.width,n.timeAxisViewModel.tickSize);return n.scrollToCoordinate(o,a,e,t)}},{key:"scrollToNow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.scrollToDate(new Date,e)}},{key:"scrollToCoordinate",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this;if(e<0){var o=(i.timeAxis.endDate-i.timeAxis.startDate)/2,a=new Date(n.getTime()-o),s=new Date(n.getTime()+o);return a-i.startDate!=0&&s-i.endDate!=0?(i.setTimeSpan(a,s),i.scrollToDate(n,r)):void 0}return i.timeAxisSubGrid.scrollable.scrollIntoView(t,r)}},{key:"scrollHorizontallyTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.timeAxisSubGrid.scrollable.scrollTo(e,null,t)}},{key:"scrollVerticallyTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.scrollable.scrollTo(null,e,t)}},{key:"scrollTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.timeAxisSubGrid.scrollable.scrollTo(e,null,t)}},{key:"scrollLeft",set:function(e){this.timeAxisSubGrid.scrollable.x=e},get:function(){return this.timeAxisSubGrid.scrollable.x}},{key:"scrollTop",set:function(e){this.scrollable.y=e},get:function(){return this.scrollable.y}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Jy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"normalizePreset",value:function(e){var t=e,n=this.presets;if(!(e instanceof Jv)){if("object"===re()(e)){if(e.base){var r=n.getById(e.base)||tp.getById(e.base);if(!r)throw new Error("ViewPreset base '".concat(e.base,"' does not exist"));e=mt.merge(mt.clone(r.data),tp.createRecord(e).data)}e.id?e=n.createRecord(e):(e=n.createRecord(mt.assign({},e))).id=e.generateId(n)}else e="number"==typeof e?n.getAt(e):n.getById(e)||tp.getById(e);if(!e)throw new Error("Invalid ViewPreset requested: ".concat(t))}return n.add(e)[0]}},{key:"setViewPreset",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=this,a=o.isHorizontal,s=o._timeAxis,l={startDate:t,endDate:n,from:o.viewPreset};if(e=l.to=l.preset=o.normalizePreset(e),Object.keys(i).length||!o._viewPreset||o._viewPreset!==e&&!o._viewPreset.equals(e)){r=r||o.isConfiguring;var c=i.centerDate;if(r||!1!==o.trigger("beforePresetChange",l)&&!1!==o.trigger("beforeZoomChange",l)){if(o._viewPreset=e,o._viewPresetChanging=!0,o.displayDateFormat=o.config.displayDateFormat||e.displayDateFormat,s){if(o.suspendRefresh(),!r||!s.isConfigured){var u={weekStartDay:o.weekStartDay,startTime:o.startTime,endTime:o.endTime};r?(0===s.count||t)&&(u.startDate=t||new Date,u.endDate=n):t?(u.startDate=t,u.endDate=n,!c&&n&&(c=new Date((t.getTime()+n.getTime())/2))):(u.startDate=s.startDate,u.endDate=n||s.endDate,c||(c=o.viewportCenterDate)),s.isConfigured=!1,s.viewPreset=e,s.reconfigure(u,!0),o.timeAxisViewModel.reconfigure({viewPreset:o.viewPreset,headers:e.headers,columnLinesFor:null!=e.columnLinesFor?e.columnLinesFor:e.headers.length-1,rowHeightHorizontal:o.readRowHeightFromPreset?e.rowHeight:o.rowHeight,tickSize:a?e.tickWidth:e.tickHeight||e.tickWidth||60}),o.resumeRefresh()}if(o.refresh(),!i.notScroll&&o.isPainted)if(c){o.cachedCenterDate=c,l.centerDate=c;var d=null;d=Math.max(Math.floor(o.getCoordinateFromDate(c,!0)-o.timeAxisSubGrid.width/2),0),o.viewPresetActiveScroll={left:d},o.scrollingToCenter=!0,o.scrollHorizontallyTo(d,!1),o.setTimeout((function(){o.scrollingToCenter=!1}),100)}else o.scrollHorizontallyTo(0,!1)}o.trigger("presetChange",l),o.trigger("zoomChange",l)}o._viewPresetChanging=!1}}},{key:"presets",set:function(e){!0===e&&(e=tp.allRecords),this._presets=new Zv({data:e})},get:function(){return this._presets}},{key:"viewPreset",get:function(){return this._viewPreset},set:function(e){e instanceof Jv||!e.name||e.base||(j.deprecate("Scheduler","4.0.0","ViewPreset name config replaced by base config. See https://www.bryntum.com/docs/scheduler/#guides/upgrades/3.0.md"),e.base=e.name),this._viewPreset&&this._viewPreset.equals(e)||this.setViewPreset(e)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{viewPreset:"weekAndDayLetter",displayDateFormat:null,presets:!0}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Qy()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).call(this,e),t.zoomOnMouseWheel&&Kn.on({element:t.timeAxisSubGridElement,wheel:"onWheel",thisObj:t,capture:!0,passive:!1}),t.zoomOnTimeAxisDoubleClick&&t.on("timeaxisheaderdblclick",(function(e){var n=e.startDate,r=e.endDate;t.isVertical||t.zoomToSpan({startDate:n,endDate:r})}))}},{key:"getMilliSecondsPerPixelForZoomLevel",value:function(e,t){var n=e.bottomHeader,r=this.isHorizontal?e.tickWidth:e.tickHeight;return Math.round((ft.add(new Date(1,0,1),n.increment||1,n.unit)-new Date(1,0,1))/(t?r:e.actualWidth||r))}},{key:"zoomTo",value:function(e){"object"===re()(e)?e.preset?this.zoomToLevel(e.preset,e):null!=e.level?this.zoomToLevel(e.level,e):this.zoomToSpan(e):this.zoomToLevel(e)}},{key:"zoomToLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"number"==typeof e&&(e=Math.min(Math.max(e,this.minZoomLevel),this.maxZoomLevel));var n=this,r=n.config,i=n.isVertical?"tickHeight":"tickWidth",o=n.normalizePreset(e),a=o[i],s=t.startDate,l=t.endDate,c=s&&l?{startDate:s,endDate:l}:null,u=t.centerDate||(c?new Date((s.getTime()+l.getTime())/2):n.viewportCenterDateCached),d=n.timeAxisSubGrid.width;c||(c=r.startDate&&r.endDate&&r.viewPreset&&o.equals(n.normalizePreset(r.viewPreset))?{startDate:r.startDate,endDate:r.endDate}:n.calculateOptimalDateRange(u,d,o)),"width"in t&&o.setData(i,t.width),n.isZooming=!0,n.setViewPreset(o,c.startDate||n.startDate,c.endDate||n.endDate,!1,{centerDate:u}),o.actualWidth=n.timeAxisViewModel.tickSize,n.isZooming=!1,o.setData(i,a)}},{key:"zoomToFit",value:function(e){var t=this.eventStore.getTotalTimeSpan();(e=Object.assign({leftMargin:0,rightMargin:0},e,t)).startDate&&e.endDate&&this.zoomToSpan(e)}},{key:"zoomToSpan",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((e.leftMargin||e.rightMargin)&&(e.adjustStart=0,e.adjustEnd=0),e.leftMargin||(e.leftMargin=0),e.rightMargin||(e.rightMargin=0),!e.startDate||!e.endDate)throw new Error("zoomToSpan: must provide startDate + endDate dates");var t=this,n=e.adjustStart>=0||e.adjustEnd>=0,r=e.startDate,i=e.endDate;if(n&&(r=ft.add(r,-e.adjustStart,t.timeAxis.mainUnit),i=ft.add(i,e.adjustEnd,t.timeAxis.mainUnit)),r<=i){var o,a,s=t.timeAxisViewModel.availableSpace,l=t.presets.allRecords,c=i-r||1,u=Math.floor(t.zoomLevel);-1===u&&(u=0);for(var d,f=t.getMilliSecondsPerPixelForZoomLevel(l[u],!0),h=u+(o=c/f+e.leftMargin+e.rightMargin>s?-1:1),g=null;h>=0&&h<=l.length-1;){d=l[h];var v=c/(f=t.getMilliSecondsPerPixelForZoomLevel(d,!0))+e.leftMargin+e.rightMargin;if(-1===o){if(v<=s){g=h;break}}else{if(!(v<=s))break;u!==h-o&&(g=h)}h+=o}var p=(d=l[g=null!=g?g:h-o]).bottomHeader.unit;(e.leftMargin||e.rightMargin)&&(r=new Date(r.getTime()-f*e.leftMargin),i=new Date(i.getTime()+f*e.rightMargin));var y=ft.getDurationInUnit(r,i,p,!0)/d.bottomHeader.increment;if(0===y)return null;var m=Math.floor(s/y),b=e.centerDate||new Date((r.getTime()+i.getTime())/2);return a=n?{startDate:r,endDate:i}:t.calculateOptimalDateRange(b,s,d),t.zoomToLevel(g,Object.assign(a,{width:m,centerDate:b}))}return null}},{key:"zoomIn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.zoomLevel;return t>=this.presets.count-1?null:this.zoomToLevel(Math.floor(t)+e)}},{key:"zoomOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.zoomLevel;return t<=0?null:this.zoomToLevel(Math.ceil(t)-e)}},{key:"zoomInFull",value:function(){return this.zoomToLevel(this.maxZoomLevel)}},{key:"zoomOutFull",value:function(){return this.zoomToLevel(this.minZoomLevel)}},{key:"calculateOptimalDateRange",value:function(e,t,n,r){if(r)return r;var i=this.timeAxis,o=n.bottomHeader,a=this.isHorizontal?n.tickWidth:n.tickHeight;if(this.zoomKeepsOriginalTimespan)return{startDate:i.startDate,endDate:i.endDate};var s=o.unit,l=Math.ceil(t/a*o.increment*this.visibleZoomFactor/2),c=ft.add(e,-l,s),u=ft.add(e,l,s);return{startDate:i.floorDate(c,!1,s,o.increment),endDate:i.ceilDate(u,!1,s,o.increment)}}},{key:"onWheel",value:function(e){var t=this;e.ctrlKey&&(e.preventDefault(),t.preventScrollZoom||(e.deltaY>0?t.zoomOut():e.deltaY<0&&t.zoomIn(),t.preventScrollZoom=!0,t.setTimeout((function(){return t.preventScrollZoom=!1}),30)))}},{key:"setTimeSpan",value:function(e,t){this.timeAxis.setTimeSpan(e,t)}},{key:"shift",value:function(e,t){this.timeAxis.shift(e,t)}},{key:"shiftNext",value:function(e){this.timeAxis.shiftNext(e)}},{key:"shiftPrevious",value:function(e){this.timeAxis.shiftPrevious(e)}},{key:"maxZoomLevel",get:function(){return this._maxZoomLevel||this.presets.count-1},set:function(e){if("number"!=typeof e&&(e=this.presets.count-1),e<0||e>=this.presets.count)throw new Error("Invalid range for `setMinZoomLevel`");this._maxZoomLevel=e}},{key:"minZoomLevel",get:function(){return this._minZoomLevel||0},set:function(e){if("number"!=typeof e&&(e=0),e<0||e>=this.presets.count)throw new Error("Invalid range for `minZoomLevel`");this._minZoomLevel=e}},{key:"zoomLevel",get:function(){return this.presets.indexOf(this.viewPreset)},set:function(e){this.zoomToLevel(e)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{zoomOnMouseWheel:!0,zoomOnTimeAxisDoubleClick:!0,preventScrollZoom:null,minZoomLevel:null,maxZoomLevel:null,visibleZoomFactor:5,zoomKeepsOriginalTimespan:null}}}]),r}(e||G)})));im._$name="TimelineBase";var om={SchedulerCommon:{},ExcelExporter:{"No resource assigned":"No resource assigned"},ResourceInfoColumn:{eventCountText:function(e){return e+" event"+(1!==e?"s":"")}},Dependencies:{from:"From",to:"To",valid:"Valid",invalid:"Invalid",Checking:"Checking"},DependencyEdit:{From:"From",To:"To",Type:"Type",Lag:"Lag","Edit dependency":"Edit dependency",Save:"Save",Delete:"Delete",Cancel:"Cancel",StartToStart:"Start to Start",StartToEnd:"Start to End",EndToStart:"End to Start",EndToEnd:"End to End"},EventEdit:{Name:"Name",Resource:"Resource",Start:"Start",End:"End",Save:"Save",Delete:"Delete",Cancel:"Cancel","Edit Event":"Edit event",Repeat:"Repeat"},EventDrag:{eventOverlapsExisting:"Event overlaps existing event for this resource",noDropOutsideTimeline:"Event may not be dropped completely outside the timeline"},Scheduler:{"Add event":"Add event","Delete event":"Delete event","Unassign event":"Unassign event"},HeaderContextMenu:{pickZoomLevel:"Zoom",activeDateRange:"Date range",startText:"Start date",endText:"End date",todayText:"Today"},EventFilter:{filterEvents:"Filter tasks",byName:"By name"},TimeRanges:{showCurrentTimeLine:"Show current timeline"},PresetManager:{minuteAndHour:{topDateFormat:"ddd MM/DD, hA"},hourAndDay:{topDateFormat:"ddd MM/DD"},weekAndDay:{displayDateFormat:"hh:mm A"}},RecurrenceConfirmationPopup:{"delete-title":"You are deleting an event","delete-all-message":"Do you want to delete all occurrences of this event?","delete-further-message":"Do you want to delete this and all future occurrences of this event, or only the selected occurrence?","delete-further-btn-text":"Delete All Future Events","delete-only-this-btn-text":"Delete Only This Event","update-title":"You are changing a repeating event","update-all-message":"Do you want to change all occurrences of this event?","update-further-message":"Do you want to change only this occurrence of the event, or this and all future occurrences?","update-further-btn-text":"All Future Events","update-only-this-btn-text":"Only This Event",Yes:"Yes",Cancel:"Cancel",width:600},RecurrenceLegend:{" and ":" and ",Daily:"Daily","Weekly on {1}":function(e){var t=e.days;return"Weekly on ".concat(t)},"Monthly on {1}":function(e){var t=e.days;return"Monthly on ".concat(t)},"Yearly on {1} of {2}":function(e){var t=e.days,n=e.months;return"Yearly on ".concat(t," of ").concat(n)},"Every {0} days":function(e){var t=e.interval;return"Every ".concat(t," days")},"Every {0} weeks on {1}":function(e){var t=e.interval,n=e.days;return"Every ".concat(t," weeks on ").concat(n)},"Every {0} months on {1}":function(e){var t=e.interval,n=e.days;return"Every ".concat(t," months on ").concat(n)},"Every {0} years on {1} of {2}":function(e){var t=e.interval,n=e.days,r=e.months;return"Every ".concat(t," years on ").concat(n," of ").concat(r)},position1:"the first",position2:"the second",position3:"the third",position4:"the fourth",position5:"the fifth","position-1":"the last",day:"day",weekday:"weekday","weekend day":"weekend day",daysFormat:function(e){var t=e.position,n=e.days;return"".concat(t," ").concat(n)}},RecurrenceEditor:{"Repeat event":"Repeat event",Cancel:"Cancel",Save:"Save",Frequency:"Frequency",Every:"Every",DAILYintervalUnit:"day(s)",WEEKLYintervalUnit:"week(s) on:",MONTHLYintervalUnit:"month(s)",YEARLYintervalUnit:"year(s) in:",Each:"Each","On the":"On the","End repeat":"End repeat","time(s)":"time(s)"},RecurrenceDaysCombo:{day:"day",weekday:"weekday","weekend day":"weekend day"},RecurrencePositionsCombo:{position1:"first",position2:"second",position3:"third",position4:"fourth",position5:"fifth","position-1":"last"},RecurrenceStopConditionCombo:{Never:"Never",After:"After","On date":"On date"},RecurrenceFrequencyCombo:{Daily:"Daily",Weekly:"Weekly",Monthly:"Monthly",Yearly:"Yearly"},RecurrenceCombo:{None:"None","Custom...":"Custom..."},ScheduleRangeCombo:{completeview:"Complete schedule",currentview:"Visible schedule",daterange:"Date range",completedata:"Complete schedule (for all events)"},SchedulerExportDialog:{"Schedule range":"Schedule range","Export from":"From","Export to":"To"}};for(var am in tg)om[am]=tg[am];function sm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Fe.registerLocale("En",{desc:"English",locale:om});function lm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function cm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function um(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var dm=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(um()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"clearCache",value:function(e){e?delete this.nbrOfBandsByResource[e.id]:this.nbrOfBandsByResource={}}},{key:"getNumberOfBands",value:function(e,t){var n=this.nbrOfBandsByResource;if(n.hasOwnProperty(e.id))return n[e.id];var r=("function"==typeof t?t():t).map((function(e){return{start:e.startDate,end:e.endDate,event:e}}));return this.applyLayout(r,e)}},{key:"applyLayout",value:function(e,t){var n=e.slice(),r=this.layoutEventsInBands(n);return this.nbrOfBandsByResource[t.id]=r}}],[{key:"defaultConfig",get:function(){return{nbrOfBandsByResource:{},bandIndexToPxConvertFn:null,bandIndexToPxConvertThisObj:null}}}]),r}(G);function fm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}dm._$name="HorizontalLayout";var hm=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(fm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"layoutEventsInBands",value:function(e){var t=0;do{for(var n=e[0];n;)n.top=this.bandIndexToPxConvertFn.call(this.bandIndexToPxConvertThisObj||this,t,n.event),e.splice(e.indexOf(n),1),n=this.findClosestSuccessor(n,e);t++}while(e.length>0);return t}},{key:"findClosestSuccessor",value:function(e,t){for(var n,r,i,o=1/0,a=e.endMs,s=0===e.event.duration,l=0,c=t.length;l<c;l++)(r=(i=t[l]).startMs-a)>=0&&r<o&&(r>0||i.endMs-i.startMs>0||!s)&&(n=i,o=r);return n}}]),r}(dm);function gm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}hm._$name="HorizontalLayoutStack";var vm=function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(gm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"applyLayout",value:function(e,t){for(var n,r,i,o,a=this,s=a.coordProp,l=a.sizeProp,c=0,u=e.length;c<u;c++){if(r=e[c],n=a.findStartSlot(e,r),(i=a.getCluster(e,c)).length>1){for(r[s]=n.start,r[l]=n.end-n.start,o=1;o<i.length-1&&i[o+1].start-r.start==0;)o++;var d=a.findStartSlot(e,i[o]);d&&d.start<.8&&(i.length=o)}var f=i.length,h=(n.end-n.start)/f;for(o=0;o<f;o++)t(i[o],o,n,h);c+=f-1}}},{key:"findStartSlot",value:function(e,t){var n,r=this.sizeProp,i=this.coordProp,o=this.getPriorOverlappingEvents(e,t);if(0===o.length)return{start:0,end:1};for(n=0;n<o.length;n++){if(0===n&&o[0][i]>0)return{start:0,end:o[0][i]};if(o[n][i]+o[n][r]<(n<o.length-1?o[n+1][i]:1))return{start:o[n][i]+o[n][r],end:n<o.length-1?o[n+1][i]:1}}return!1}},{key:"getPriorOverlappingEvents",value:function(e,t){for(var n=t.start,r=t.end,i=[],o=0,a=e.indexOf(t);o<a;o++)ft.intersectSpans(n,r,e[o].start,e[o].end)&&i.push(e[o]);return i.sort(this.sortOverlappers.bind(this)),i}},{key:"sortOverlappers",value:function(e,t){return e[this.coordProp]<t[this.coordProp]?-1:1}},{key:"getCluster",value:function(e,t){var n=e[t];if(t>=e.length-1)return[n];for(var r=[n],i=e.length,o=n.start,a=n.end,s=t+1;s<i&&ft.intersectSpans(o,a,e[s].start,e[s].end);)r.push(e[s]),o=ft.max(o,e[s].start),a=ft.min(e[s].end,a),s++;return r}}],[{key:"defaultConfig",get:function(){return{coordProp:"top",sizeProp:"height"}}}]),r}(e||G)};function pm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ym=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(pm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"applyLayout",value:function(e){var t=this;se()(J()(r.prototype),"applyLayout",this).call(this,e,(function(e,t,n,r){e.height=r,e.top=n.start+t*r})),e.forEach((function(e){Object.assign(e,t.bandIndexToPxConvertFn.call(t.bandIndexToPxConvertThisObj||t,e.top,e.height,null,e.event))}))}}]),r}(vm(dm));function mm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ym._$name="HorizontalLayoutPack";var bm=/-/g;function km(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var wm=Math.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Sm={add:1,update:1,remove:1,filter:1};function Cm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Rm=new Promise((function(e){return e()})),xm={block:"nearest",edgeOffset:20},Em={highlight:!1,focus:!1};function Dm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Tm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Mm=["eventLayout","barMargin","mode","tickSize","zoomLevel","eventColor","eventStyle","fillTicks","startDate","endDate"];function Am(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Im(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Fm=function(e,t){return e.startDate-t.startDate},Om=function(e){return e.preventDefault()};function _m(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Pm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pm(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Pm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Hm={},jm=document.createRange();function Bm(e){return!(e.classList.contains("b-dragging")||e.classList.contains("b-resizing"))}var Nm=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Lm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;t.view=e,t.innerElCls="".concat(e.eventCls),t.availableDivs=new fi,t.reservedIds={},t.divCount=0}},{key:"init",value:function(){var e=this;e.view.rowManager.on({beforetranslaterow:e.onBeforeTranslateRow,translaterow:e.onTranslateRow,beforerowheight:e.onBeforeRowHeightChange,thisObj:e}),e.view.on({beforetogglenode:e.onBeforeToggleNode,beforetoggleallnodes:e.onBeforeToggleAllNodes,thisObj:e})}},{key:"translateToPageCoordinate",value:function(e){var t=this.column.subGridElement;return e+t.getBoundingClientRect().left-t.scrollLeft}},{key:"refreshRows",value:function(e){e&&(this.cache.clear(this.refreshFromRerender),this.view.refreshFromRerender=!1)}},{key:"onDragAbort",value:function(e){this.view.currentOrientation.availableDivs.includes(e.element)&&e.element.classList.add("b-sch-released")}},{key:"onLocaleChange",value:function(){this.cache.clear()}},{key:"calculateMS",value:function(e){throw new Error("Implement in subclass")}},{key:"getTimeSpanRenderData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.timeAxis,o=!0===n||n.timeAxis,a=!0===n||n.viewport;if(o||i.isTimeSpanInAxis(e)){var s=r.view,l=s.getRowById(t);if(l||a){var c=s.scrollable.y,u=Math.max(c-50,0),d=Math.min(c+s._bodyRectangle.height+50,s.virtualScrollHeight);if(a||l.top<d&&l.top+(l.height||l.lastHeight)>=u){var f,h,g=r.timeAxisViewModel.getSingleUnitInPixels("minute"),v=e.startDate,p=e.endDate||v,y=i.startMS,m=i.endMS,b=r.calculateMS(e),k=b.startMS,w=b.endMS,S=b.durationMS,C=k<y|(k>m)<<1,R=w>m|(w<=y)<<1,x=S/6e4,E=R?g*x:null,D=s.getCoordinateFromDate(w,{local:!0,respectExclusion:!0,isEnd:!0}),T=!1,M=!1;if(C?h=(k-y)/6e4*g:T=-1===(h=s.getCoordinateFromDate(k,{local:!0,respectExclusion:!0,isEnd:!1,snapToNextIncluded:-1!==D})),R?D=h+E:M=-1===D,M&&!T&&(D=s.getCoordinateFromDate(w,{local:!0,respectExclusion:!0,isEnd:!0,snapToNextIncluded:!0})),E>9999999&&(1===C?1===R?(h=-100,D=s.timeAxisColumn.width+100):h=D-9999999:1===R&&(D=h+9999999)),T&&M&&(h=s.getCoordinateFromDate(k,{local:!0,respectExclusion:!0,isEnd:!1,snapToNextIncluded:!0,max:w}))===(D=s.getCoordinateFromDate(w,{local:!0,respectExclusion:!0,isEnd:!0,snapToNextIncluded:!0,min:k})))return e.instanceMeta(s).excluded=!0,null;var A=(f={},oe()(f,r.view.scheduledEventName,e),oe()(f,"left",Math.min(h,D)),oe()(f,"width",Math.abs(D-h)),oe()(f,"start",v),oe()(f,"end",p),oe()(f,"startMs",k),oe()(f,"endMs",w),oe()(f,"rowId",t.id),oe()(f,"startsOutsideView",C),oe()(f,"endsOutsideView",R),oe()(f,"clippedStart",T),oe()(f,"clippedEnd",M),oe()(f,"row",l),f);return r.view.fillTicks&&(A.dataStartMs=A.start.getTime(),A.dataEndMs=A.end.getTime()),A.top=Math.max(0,s.resourceMargin),s.managedEventSizing&&(A.height=Math.max(s.rowManager.rowHeight-2*s.resourceMargin,1)),A}}}}},{key:"onTranslateRow",value:function(e){e.source}},{key:"onBeforeRowHeightChange",value:function(e){var t=this.view,n=e?e.height:t.rowHeight;this.cache.clear(),t.foregroundCanvas&&(t.element.classList.add("b-notransition"),t.foregroundCanvas.style.fontSize="".concat(n-2*t.resourceMargin,"px"),this._thisIsAUsedExpression(window.getComputedStyle(t.foregroundCanvas).fontSize),t.element.classList.remove("b-notransition")),t.milestoneWidth=null}},{key:"onBeforeTranslateRow",value:function(e){var t=e.row;this.cache.clearRow(t.id)}},{key:"onViewportResize",value:function(){this.lastUpdateScrollPos=null,this.update()}},{key:"positionTimeSpan",value:function(e,t,n){switch(this.view.eventPositionMode||"translate"){case"position":return e.style.left="".concat(t,"px"),void(e.style.top="".concat(n,"px"));case"translate":return void(e.style.transform="translate(".concat(t,"px,").concat(n,"px)"));case"translate3d":e.style.transform="translate3d(".concat(t,"px,").concat(n,"px,0)")}}},{key:"getTimeSpanDiv",value:function(e){var t,n=this.availableDivs,r=e.id,i=e.oldId;return"move"===this.view.eventScrollMode?(r&&(t=n.get(r)||n.get(i)),t&&!Bm(t)&&(t=null),t||(t=n.find(Bm)),t&&(n.remove(t),t.classList.remove("b-sch-released")),t):null}},{key:"releaseTimeSpanDiv",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=e.style;t||e!==document.activeElement||n.view.focusElement.focus(),"move"===n.view.eventScrollMode?(n.availableDivs.add(e),!t&&Bm(e)&&e.classList.add("b-sch-released")):t||(r.opacity=0,r.pointerEvents="none",n.setTimeout((function(){e.remove(),r.opacity=1,r.pointerEvents=""}),200))}},{key:"updateElementId",value:function(e,t){var n=this.availableDivs;n.includes(e)&&(n.changeId(e,t),n.items.delete(e),n.items.add(e))}},{key:"triggerPaint",value:function(e,t){throw new Error("Implement in subclass")}},{key:"addTemporaryDragElement",value:function(e){var t=this.scheduler,n=t.generateTplData(e,e.resource,{timeAxis:!0,viewport:!0});n.top=n.row?n.top+n.row.top:t.getResourceEventBox(e,e.resource,!0).top;var r=this.renderTimeSpan(n,{},null,!0);return this.scheduler.currentOrientation.availableDivs.add(r),r}},{key:"renderTimeSpan",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=o.view,s=e.cls,l=e.id,c=t&&t.div,u=!1,d=!1,f=!1;i||c||!(c=o.getTimeSpanDiv(e))||(u=c.id!==l);var h=c&&c.classList.contains("b-sch-dragcreator-proxy");if(!c||u){if(u)(r=c.innerElement||c.firstElementChild).innerHTML="",r.style.cssText="",r.nextSibling&&(jm.setStartAfter(r),jm.setEndAfter(c.lastChild),jm.deleteContents());else{var g=on.createElement({tabIndex:0,children:[{className:"".concat(o.innerElCls)}]},!0),v=te()(g,2);c=v[0],r=v[1],c.innerElement=r}c.id=l,e[a.scheduledEventName+"Id"]&&(c.dataset[a.scheduledEventName+"Id"]=e[a.scheduledEventName+"Id"]),on.syncClassList(c,e.wrapperCls),c.parentNode!==a.foregroundCanvas&&a.foregroundCanvas.appendChild(c),on.syncClassList(r,s),(e.style||e.internalStyle)&&(r.style.cssText=(e.internalStyle||"")+(e.style||"")),e.body&&r.appendChild(e.body.cloneNode(!0)),c.style.cssText="width:".concat(e.width,"px;height:").concat(e.height,"px;").concat(e.wrapperStyle||""),o.positionTimeSpan(c,e.left,e.top),d=!0}else{var p=n&&t.div?n:Hm;if(r=c.querySelector(".".concat(o.innerElCls))||c.firstElementChild,on.syncClassList(c,e.wrapperCls),on.syncClassList(r,e.cls),e.style?r.style.cssText=e.style:r.style.cssText="",e.body){var y=r.innerHTML,m=r.featureEls;m&&m.forEach((function(t){return e.body.appendChild(t)})),r.innerHTML="",r.appendChild(e.body.cloneNode(!0)),d=r.innerHTML!==y}document.activeElement&&document.activeElement.id===e.id&&c.classList.add(a.focusCls),f=!0,e.wrapperStyle&&(c.style.cssText+=e.wrapperStyle),(p.left!==e.left||p.top!==e.top||e.style)&&(o.positionTimeSpan(c,e.left,e.top),d=!0),(p.width!==e.width||e.style)&&(c.style.width="".concat(e.width,"px"),d=!0),(p.height!==e.height||e.style)&&(c.style.height="".concat(e.height,"px"),d=!0)}return t.div=c,t.eventEl=r,d&&(f&&h&&(f=!1,c.classList.remove("b-sch-dragcreator-proxy")),o.triggerPaint(e,c,f)),c}},{key:"cacheTimeSpanElement",value:function(e,t,n){var r=this.availableDivs,i=this.view,o=i.getEventRenderId(e,t);r.includes(o)||(n?(n.id=o,i.foregroundCanvas.appendChild(n)):n=on.createElement({id:o,tabIndex:0,children:[{className:"".concat(this.innerElCls)}]}),r.add(n))}},{key:"updateRowTimeSpans",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"renderer",value:function(e){}},{key:"updateFromHorizontalScroll",value:function(e){var t=this,n=t.view,r=n.timeAxisSubGrid.width,i=n.getDateFromX(Math.max(0,e-100)),o=n.getDateFromX(e+r+100)||n.timeAxis.endDate,a=t.view.timeAxisSubGrid.scrollable.x,s=t.lastUpdateScrollPos;t.viewportStart=i&&i.getTime(),t.viewportEnd=o&&o.getTime(),(!s||Math.abs(a-s.x)>50)&&t.update(),n.timeView.range={startDate:i,endDate:o}}},{key:"update",value:function(){var e=this.view;this.lastUpdateScrollPos={x:e.timeAxisSubGrid.scrollable.x,y:e.scrollable.y};var t,n=_m(e.rowManager);try{for(n.s();!(t=n.n()).done;){var r=t.value.getCell(e.timeAxisColumn.id),i=Ms.get(r),o=e.store.getById(i.id);o&&this.updateRowTimeSpans(i.row,o,!1,!0)}}catch(e){n.e(e)}finally{n.f()}}},{key:"getDateFromXY",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e[0];return n||(i=this.translateToScheduleCoordinate(i)),this.timeAxisViewModel.getDateFromPosition(i,t,r)}},{key:"translateToScheduleCoordinate",value:function(e){return e-this.column.subGridElement.getBoundingClientRect().left+this.view.scrollLeft}},{key:"onBeforeToggleNode",value:function(e){var t=e.record;if(t.children&&t.children.length)for(var n=this.view.store.getNext(t);n&&this.view.getRowFor(n);)this.cache.clearRow(n.id),n=this.view.store.getNext(n.id)}},{key:"onBeforeToggleAllNodes",value:function(){this.cache.clear()}},{key:"onRowRecordUpdate",value:function(e){var t=e.record,n=e.changes,r=void 0===n?{}:n;"id"in r&&this.cache.clearRow(r.id.oldValue,!1,!0),this.cache.clearRow(t.id,!1,!0)}},{key:"onRowRecordRemove",value:function(e){var t=this;e.records.forEach((function(e){return e.traverse((function(e){return t.cache.clearRow(e.id)}))}))}},{key:"getRowRegion",value:function(e,t,n){var r=this.view,i=this.column,o=r.getRowById(e.id);if(!o)return null;var a=o.getElement(i.region),s=this.timeAxis.startDate,l=this.timeAxis.endDate,c=t?ft.max(s,t):s,u=n?ft.min(l,n):l,d=r.getCoordinateFromDate(c),f=r.getCoordinateFromDate(u,!0,!0),h=o.top+r.verticalScroller.scrollTop,g=Math.min(d,f),v=h+a.offsetHeight;return new In(g,h,Math.max(d,f)-g,v-h)}},{key:"getVisibleDateRange",value:function(){var e=this.view,t=e.timeAxisSubGrid.scrollable.x,n=e.timeAxisSubGrid.width;return{startDate:e.getDateFromX(t),endDate:e.getDateFromX(t+n)||e.timeAxis.endDate}}},{key:"getConnectorStartSide",value:function(e){}},{key:"getConnectorEndSide",value:function(e){}},{key:"column",get:function(){return this.view.timeAxisColumn}},{key:"timeAxis",get:function(){return this.view.timeAxis}},{key:"timeAxisViewModel",get:function(){return this.view.timeAxisViewModel}}]),r}(or(G));Nm._$name="BaseHorizontalMapper";var zm=function(){function e(t){D()(this,e);this.mapper=t,this.renderedEventsMap={},this.rowLayoutCache={}}return M()(e,[{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.renderedEventsMap={},Object.keys(t.rowLayoutCache).forEach((function(n){return t.clearRow(n,!!e&&"immediate")}))}},{key:"addRenderedEvents",value:function(e,t){this.renderedEventsMap[e]=t}},{key:"addRenderedEvent",value:function(e){e.resourceId in this.renderedEventsMap&&((this.renderedEventsMap[e.resourceId]||(this.renderedEventsMap[e.resourceId]={}))[e.id]=e)}},{key:"getRenderedTimeSpan",value:function(e,t){var n=this.renderedEventsMap[e];return n&&n[t]}},{key:"clearRenderedTimeSpan",value:function(e,t){if(this.renderedEventsMap[e]){var n=this.renderedEventsMap[e][t];return delete this.renderedEventsMap[e][t],n}}},{key:"getRenderedEvents",value:function(e){return this.renderedEventsMap[e]}},{key:"clearRenderedEvents",value:function(e){this.renderedEventsMap[e]=null}},{key:"getTimeSpan",value:function(e,t){var n=this.getTimeSpanCache(e,t);return n?n.layoutCache:null}},{key:"getTimeSpanCache",value:function(e,t){var n=this.rowLayoutCache[t];return n&&n[e]}},{key:"clearEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=i.getTimeSpan(e,t);if(!o)return null;o.div&&i.mapper.clearDiv(o.div,n,r),i.rowLayoutCache[t][e].layoutCache=null}},{key:"getRow",value:function(e){return this.rowLayoutCache[e]}},{key:"addRow",value:function(e,t){this.rowLayoutCache[e]=t}},{key:"clearRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.rowLayoutCache[e];i&&(r.renderedEventsMap[e]&&delete r.renderedEventsMap[e],Object.keys(i).forEach((function(i){"_allEvents"!==i&&"_rowHeight"!==i&&r.clearEvent(i,e,t,n)})),delete r.rowLayoutCache[e])}}]),e}();function Vm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zm._$name="HorizontalEventMapperCache";var Wm=function(e,t,n,r,i){if(e.fillTicks){var o=t.getTickFromDate(n);if(o>=0){i&&o===Math.round(o)&&o>0&&o--;var a=Math.floor(o);return t.getAt(a)[i?"endDate":"startDate"].getTime()}}return r},Um=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Vm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){this.scheduler=e,se()(J()(r.prototype),"construct",this).call(this,e),this.cache=new zm(this)}},{key:"init",value:function(){se()(J()(r.prototype),"init",this).call(this),this.scheduler.on({togglegroup:this.onToggleGroup,rowremove:this.onRowRemove,prio:2,thisObj:this})}},{key:"clearDiv",value:function(e,t,n){var r=e.style;!t||n?this.releaseTimeSpanDiv(e,n):"immediate"!==t&&this.scheduler.enableEventAnimations?(e.id=we.generateId("obsolete-event"),r.opacity=0,r.pointerEvents="none",this.setTimeout((function(){e.remove(),r.opacity=1,r.pointerEvents=""}),200)):e.remove()}},{key:"clearAllDivs",value:function(){this.availableDivs.forEach((function(e){return e.remove()})),this.availableDivs.clear()}},{key:"clearEvents",value:function(){this.cache.clear(!0)}},{key:"releaseEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.cache.getRenderedTimeSpan(e,t),o=i&&r.cache.getTimeSpan(i.eventId,e);return o&&o.div&&(r.releaseTimeSpanDiv(o.div,n),o.div=o.eventEl=null),r.cache.clearRenderedTimeSpan(e,t)}},{key:"getElementFromEventRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scheduler.eventStore.getResourcesForEvent(e)[0];if(t){var n=this.cache.getRenderedEvents(t.id);if(n){var r=this.scheduler.getEventRenderId(e,t),i=n[r],o=i&&i.layoutCache;return o&&o.eventEl}}}},{key:"getElementsFromEventRecord",value:function(e,t){var n=this;return t?[n.getElementFromEventRecord(e,t)]:n.scheduler.eventStore.getResourcesForEvent(e).reduce((function(t,r){var i=n.getElementFromEventRecord(e,r);return i&&t.push(i),t}),[])}},{key:"resolveRowRecord",value:function(e){var t=this.view,n=e instanceof Event?e.target:e,r=3===n.nodeType?n.parentElement:n,i=r.matches(t.eventSelector)&&r||on.up(r,t.eventSelector);return i?t.getResourceRecordFromDomId(i.id):t.getRecordFromElement(r)}},{key:"toggleCls",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var i=this.cache.getTimeSpanCache(e.id,t.id),o=this.getElementFromEventRecord(e,t);i&&(i.cls[n]=r?1:0),o&&o.classList[r?"add":"remove"](n)}}},{key:"getResourceEventBox",value:function(e,t){var n=this.cache.getTimeSpan(e,t);if(n)return n}},{key:"getScheduleRegion",value:function(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this,o=i.view,a=i.column;if(e){var s=t&&i.getElementsFromEventRecord(t,e)[0];if(n=In.from(o.getRowById(e.id).getElement("locked")),s){var l=In.from(s,a.subGridElement);n.y=l.y,n.bottom=l.bottom}else n.y=n.y+o.resourceMargin,n.bottom=n.bottom-o.resourceMargin}else(n=In.from(a.subGridElement).moveTo(null,0)).width=a.subGridElement.scrollWidth,n.y=n.y+o.resourceMargin,n.bottom=n.bottom-o.resourceMargin;var c=i.timeAxis.startDate,u=i.timeAxis.endDate,d=o.getDateConstraints(e,t)||{start:c,end:u},f=n.y,h=n.bottom,g=o.getCoordinateFromDate(ft.max(c,d.start)),v=o.getCoordinateFromDate(ft.min(u,d.end));return r||(g=i.translateToPageCoordinate(g),v=i.translateToPageCoordinate(v)),{top:f,right:Math.max(g,v),bottom:h,left:Math.min(g,v)}}},{key:"getResoureEventBox",value:function(e,t){return this.cache.getTimeSpan(e,t)}},{key:"layoutEventVerticallyStack",value:function(e){var t=this.scheduler,n=t.resourceMargin,r=t.rowHeight,i=t.barMargin;return 0===e?n:n+e*(r-2*n)+e*i}},{key:"layoutEventVerticallyPack",value:function(e,t){var n=this.scheduler,r=n.resourceMargin,i=n.rowHeight,o=n.barMargin,a=1/t,s=e*a,l=(i-2*r-(a-1)*o)*t;return{top:r+s*l+s*o,height:l}}},{key:"calculateMS",value:function(e){var t=this.view,n=Wm(t,this.timeAxis,e.startDate,e.startDateMS,!1),r=Wm(t,this.timeAxis,e.endDate,e.endDateMS,!0),i=r-n;if("default"!==t.milestoneLayoutMode&&0===i){var o=this.timeAxisViewModel.getSingleUnitInPixels("minute");switch(i=60*(t.getMilestoneLabelWidth(e)*(1/o))*1e3,t.milestoneAlign){case"start":case"left":r=n+i;break;case"end":case"right":n=(r=n)-i;break;default:n=(r=n+i/2)-i}}return{startMS:n,endMS:r,durationMS:i}}},{key:"layoutEvents",value:function(e,t,n){var r=this,i=r.timeAxis,o=e.eventStore,a=t.id,s=o.getEventsForResource(a),l=o.isFiltered?s.filter((function(e){return o.indexOf(e)>-1})):s,c=(e.getEventsToRender(t,l)||[]).filter((function(e){return i.isTimeSpanInAxis(e)})).reduce((function(n,i){var o=e.generateTplData(i,t);return o?n.push(o):r.cache.getRenderedEvents(a)&&r.releaseEvent(a,e.getEventRenderId(i,t)),n}),[]);if(!c.length)return r.cache.clearRenderedEvents(a),!1;c.sort(e.horizontalEventSorterFn||r.eventSorter);var u=e.rowHeight,d=e.currentEventLayout,f=c.filter((function(e){return e.event.isEvent||e.event.isTask}));if("stack"===e.eventLayout){var h=d.applyLayout(f,t),g=e.rowHeight-2*e.resourceMargin;u=h*g+(h-1)*e.barMargin+2*e.resourceMargin}else"pack"===e.eventLayout&&d.applyLayout(f,t);var v=n.top;u!==n.height&&n.estimatedTop&&(v=n.top+n.height-u);var p={_allEvents:c,_rowHeight:u};return c.forEach((function(e){var t=r.cache.getTimeSpan(e.eventId,a),n=e.top;e.top+=v,e.rowTop=v,e.fillSize&&(e.height=u),e.layoutCache={layout:!0,div:t&&t.div,eventEl:t&&t.eventEl,width:e.width,height:e.height,start:e.left,end:e.left+e.width,relativeTop:n,top:e.top,relativeBottom:n+e.height,bottom:e.top+e.height},p[e.eventId]=e})),r.cache.addRow(a,p),!0}},{key:"eventSorter",value:function(e,t){var n=e.dataStartMs||e.startMs,r=e.dataEndMs||e.endMs,i=t.dataStartMs||t.startMs,o=t.dataEndMs||t.endMs;return n===i?r-o==0?e.event.name<t.event.name?-1:1:r>o?-1:1:n<i?-1:1}},{key:"onTranslateRow",value:function(e){var t=e.row;this.matchRowTranslation(t)}},{key:"renderEvent",value:function(e){var t=this,n=t.view.scheduledEventName+"Id",r=e[n],i=t.cache.getTimeSpan(r,e.resourceId),o=t.cache.getRenderedEvents(e.resourceId),a=e.event.instanceMeta(t.scheduler),s=t.renderTimeSpan(e,i,o[e.id],a.requireElement&&!a.fromDragProxy);e.assignment&&(s.dataset.assignmentId=e.assignment.id),r&&(s.dataset[n]=r),o[e.id]=e,a.requireElement&&(delete a.requireElement,delete a.fromDragProxy),t.scheduler.trigger("renderEvent",{eventRecord:e.event,resourceRecord:e.resource,assignmentRecord:e.assignment,element:s,tplData:e})}},{key:"triggerPaint",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.scheduler;r.trigger(n?"eventRepaint":"eventPaint",{scheduler:r,eventRecord:e.event,resourceRecord:e.resource,element:t})}},{key:"isEventInView",value:function(e){return e.startMs===e.endMs?e.startMs<=this.viewportEnd&&e.endMs>this.viewportStart:e.startMs<this.viewportEnd&&e.endMs>this.viewportStart}},{key:"updateRowTimeSpans",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=i.scheduler,a=i.cache,s=t.id,l=a.getRenderedEvents(s),c=a.getRow(s);if((o.forceLayout||n||!c)&&!i.layoutEvents(o,t,e))return c&&c._rowHeight||0;if(!(c=a.getRow(s)))return 0;var u=c._allEvents.filter((function(e){return e.event.instanceMeta(o).retainElement||e.assignment&&e.assignment.instanceMeta(o).retainElement||i.isEventInView(e)}));l||(l={},a.addRenderedEvents(s,l));for(var d=0;d<u.length;d++){var f=u[d];if(o._firstRenderDone&&o._firstRenderDone(),!r&&!f.event.instanceMeta(o).retainElement||r&&!f.layoutCache.div){var h=o.isFirstRender&&f.top<o.bodyHeight&&o.useInitialAnimation;h&&(f.wrapperCls.add("b-first-render"),f.internalStyle="animation-delay: ".concat(f.row.index/20,"s;")),i.renderEvent(f),f.wrapperCls["b-first-render"]=null}}for(var g=Object.keys(l),v=function(e){var t=g[e];u.some((function(e){return e.id===t}))||i.releaseEvent(s,t)},p=0;p<g.length;p++)v(p);return c._rowHeight}},{key:"renderer",value:function(e){e.size.height=this.updateRowTimeSpans(e.row,e.record)}},{key:"matchRowTranslation",value:function(e){var t=this,n=t.scheduler.store.getAt(e.dataIndex).id,r=t.cache.getRow(n),i=r&&r._allEvents.length>0&&r._allEvents[0];if(i&&i.rowTop!==e.top){var o=e.top-i.rowTop;r._allEvents.forEach((function(n){var r=n.layoutCache;r.top+=o,r.bottom+=o,r.div&&t.positionTimeSpan(r.div,r.start,r.top),n.top+=o,n.rowTop=e.top}))}}},{key:"onTimeAxisViewModelUpdate",value:function(){this.cache.clear(),this.scheduler.rowManager.clearKnownHeights(),this.updateFromHorizontalScroll(this.scheduler.timeAxisSubGrid.scrollable.x)}},{key:"onRowRemove",value:function(e){var t=this,n=e.isCollapse,r=this.scheduler;n||r.runWithTransition((function(){r.rowManager.forEach((function(e){return t.matchRowTranslation(e)}))}))}},{key:"onToggleGroup",value:function(e){var t=this,n=e.groupRecord,r=e.collapse,i=this.scheduler.store,o=i.indexOf(n)+(r?1:n.groupChildren.length);for(r&&n.groupChildren.forEach((function(e){t.cache.clearRow(e.id)}));o<i.count;o++)this.cache.clearRow(i.getAt(o).id)}},{key:"onEventDataset",value:function(){this.cache.clear(!0),this.scheduler.rowManager.clearKnownHeights()}},{key:"onEventAdd",value:function(e){var t=e.records,n=e.resources,r=this;t.forEach((function(e){var t=e.startDate,i=e.endDate;if(t&&i&&r.timeAxis.timeSpanInAxis(t,i)){var o=e.resources;o&&o.some((function(e){return r.scheduler.getRowFor(e)}))&&(e.instanceMeta(r.scheduler).requireElement=!0),n.forEach((function(e){return r.cache.clearRow(e.id,!1,!0)})),r.scheduler.rowManager.invalidateKnownHeight(n)}}))}},{key:"onEventRemove",value:function(e){var t=this,n=e.resources;n.forEach((function(e){return t.cache.clearRow(e.id,!0)})),this.scheduler.rowManager.invalidateKnownHeight(n)}},{key:"onEventUpdate",value:function(e){var t=e.source,n=e.record,r=e.changes,i=void 0===r?{}:r,o=e.resources,a=this,s=a.cache,l=a.scheduler,c=l.rowManager,u="resourceId"in i;if(u||o.length){if(u){var d=t.resourceStore.getById(i.resourceId.oldValue),f=n.resource,h=f&&t.resourceStore.isAvailable(f),g=n.resource&&Boolean(a.getTimeSpanRenderData(n,n.resource));if(c.invalidateKnownHeight([d,f]),d){var v=s.getTimeSpan(n.id,d.id);v&&(h?(v.div&&f&&(v.div.id=l.getEventRenderId(n,f)),s.clearRow(d.id,!1,h)):s.clearEvent(n.id,i.resourceId.oldValue,!0))}else h&&(n.instanceMeta(l).requireElement=!0);h&&s.clearRow(f.id,!1,g)}else("startDate"in i||"endDate"in i)&&c.invalidateKnownHeight(o);o.forEach((function(e){var t=a.getTimeSpanRenderData(n,e),r=Boolean(t&&a.isEventInView(t));s.clearRow(e.id,!1,r)}))}}},{key:"onEventStoreIdChange",value:function(e){var t=e.oldValue,n=e.value,r=this.view;on.forEachSelector(r.element,'[data-event-id="'.concat(t,'"]'),(function(e){e.id=r.getEventRenderId(n,r.getResourceIdFromDomNodeId(e.id))}))}},{key:"onEventClearChanges",value:function(){this.cache.clear()}},{key:"onEventFilter",value:function(){this.cache.clear(),this.scheduler.rowManager.clearKnownHeights()}},{key:"onEventRemoveAll",value:function(){this.cache.clear(!0),this.scheduler.rowManager.clearKnownHeights()}},{key:"getConnectorStartSide",value:function(e){return"left"}},{key:"getConnectorEndSide",value:function(e){return"right"}}]),r}(Nm);function Gm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Um._$name="HorizontalEventMapper";var Ym=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Gm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"applyLayout",value:function(e,t,n,i,o){var a=this;se()(J()(r.prototype),"applyLayout",this).call(this,e,(function(e,r,o,s){if("none"===a.scheduler.eventLayout)e.width=t-2*n,e.left+=n;else{e.widthFactor=s;var l=e.leftFactor=o.start+r*s,c=Math.round(1/s),u=l/s,d=t-2*n-i*(c-1);"mixed"===a.scheduler.eventLayout&&2===c?(e.left+=l*t/5+i,e.width=t-l*t/5-2*i,e.zIndex=5+u):(e.width=s*d,e.left+=l*d+n+i*u)}}))}}],[{key:"defaultConfig",get:function(){return{coordProp:"leftFactor",sizeProp:"widthFactor"}}}]),r}(vm());function $m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ym._$name="VerticalLayout";var qm={releaseElement:1,reuseElement:1},Xm={newElement:1,reuseOwnElement:1,reuseElement:1},Km=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if($m()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){this.scheduler=e,this.timeAxisViewModel=e.timeAxisViewModel,this.verticalLayout=new Ym({scheduler:e}),se()(J()(r.prototype),"construct",this).call(this,{})}},{key:"init",value:function(){var e=this,t=e.scheduler;e.resourceColumns=t.timeAxisColumn.resourceColumns,t.element.classList.add("b-sch-vertical"),t.on({assignmentstorechange:e.onChangeAssignmentStore,resourcestorechange:e.onChangeResourceStore,thisObj:e}),e.resourceColumns.on({columnWidthChange:e.onResourceColumnWidthChange,thisObj:e}),e.resourceStore=t.resourceStore,e.assignmentStore=t.assignmentStore,e.initialized=!0,t.isPainted&&e.renderer(),e.resourceColumns.availableWidth=t.timeAxisSubGrid.width}},{key:"resolveRowRecord",value:function(e,t){var n=this.scheduler,r=e instanceof Event?e:null,i=r?r.target:e,o=r?[r.offsetX,r.offsetY]:t,a=3===i.nodeType?i.parentElement:i,s=on.up(a,n.eventSelector);if(s)return n.resourceStore.getById(s.dataset.resourceId);if(!on.up(i,".b-sch-timeaxis-cell"))return null;if(!o)throw new Error("Vertical mode needs coordinates to resolve this element. Can also be called with a browser \n                event instead of element to extract element and coordinates from");var l=Math.floor(o[0]/this.resourceColumns.columnWidth);return n.resourceStore.getAt(l)}},{key:"getElementFromEventRecord",value:function(e,t){var n=this.getElementsFromEventRecord(e,t);return n.length?n[0]:null}},{key:"getElementsFromEventRecord",value:function(e){var t=this.scheduler.foregroundCanvas.syncIdMap,n=this.scheduler.eventInnerSelector,r=e.assignments||[e],i=[];return r.forEach((function(e){t[e.id]&&i.push(t[e.id].querySelector(n))})),i}},{key:"toggleCls",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=mt.getPath(this.eventMap,"".concat(e.id,".").concat(t.id));if(i){i.tplData.cls[n]=r?1:0;var o=this.getElementFromEventRecord(e,t);o&&o.classList[r?"add":"remove"](n)}}},{key:"getDateFromXY",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e[1];return n||(i=this.translateToScheduleCoordinate(i)),this.timeAxisViewModel.getDateFromPosition(i,t,r)}},{key:"translateToScheduleCoordinate",value:function(e){return e-this.scheduler._bodyRectangle.y+this.scheduler.scrollTop}},{key:"translateToPageCoordinate",value:function(e){return e+this.scheduler._bodyRectangle.y-this.scheduler.scrollTop}},{key:"getResourceEventBox",value:function(e,t){var n=(mt.getPath(this.eventMap,"".concat(e,".").concat(t))||{}).tplData;return n||(this.layoutResource(this.scheduler.resourceStore.getById(t)),n=mt.getPath(this.eventMap,"".concat(e,".").concat(t)).tplData),n?{start:n.left,end:n.left+n.width,top:n.top,bottom:n.bottom}:null}},{key:"getScheduleRegion",value:function(e,t,n){var r=this.scheduler,i=In.from(r.timeAxisSubGridElement);e&&(i.left=this.resourceStore.indexOf(e)*r.resourceColumnWidth,i.right=i.left+r.resourceColumnWidth);var o=r.timeAxis.startDate,a=r.timeAxis.endDate,s=r.getDateConstraints(e,t)||{start:o,end:a},l=r.getCoordinateFromDate(ft.max(o,s.start)),c=r.getCoordinateFromDate(ft.min(a,s.end));return n?(i.top=l,i.bottom=c):(i.top=this.translateToPageCoordinate(l),i.bottom=this.translateToPageCoordinate(c)),i}},{key:"getRowRegion",value:function(e,t,n){var r=this.scheduler,i=this.resourceStore.indexOf(e)*r.resourceColumnWidth,o=r.timeAxis.startDate,a=r.timeAxis.endDate,s=t?ft.max(o,t):o,l=n?ft.min(a,n):a,c=r.getCoordinateFromDate(s),u=r.getCoordinateFromDate(l,!0,!0),d=Math.min(c,u),f=Math.abs(c-u);return new In(i,d,r.resourceColumnWidth,f)}},{key:"getVisibleDateRange",value:function(){var e=this.scheduler,t=e.scrollable.y,n=e.scrollable.clientHeight;return{startDate:e.getDateFromCoordinate(t),endDate:e.getDateFromCoordinate(t+n)||e.timeAxis.endDate}}},{key:"onResourceColumnWidthChange",value:function(e){var t=e.width,n=e.oldWidth,r=this,i=r.scheduler;r.resourceColumns.width=i.timeAxisColumn.width=r.resourceStore.count*t,r.clearAll(),i.runWithTransition((function(){return r.renderer()}),Math.abs(t-n)>30)}},{key:"onEventStoreChange",value:function(e){var t=e.action,n=e.records,r=e.record,i=e.replaced,o=e.changes,a=e.fromRelationUpdate,s=this,l=n||(r?[r]:[]),c=new Set,u=!0;switch(l.forEach((function(e){e.resources.forEach((function(e){return c.add(e.id)}))})),t){case"sort":case"group":case"move":return;case"dataset":s.clearAll(),u=!1;break;case"add":case"remove":case"updateMultiple":s.clearResources(c);break;case"replace":i.forEach((function(e){var t=te()(e,2),n=t[0],r=t[1];n.resources.map((function(e){return c.add(e.id)})),r.resources.map((function(e){return c.add(e.id)}))})),s.clearResources(c);break;case"removeall":case"filter":s.clearAll();break;case"update":if(r.meta.removingResource)return;var d=!1;if(("startDate"in o||"endDate"in o||"duration"in o||"id"in o)&&(s.clearResources(c),d=!0),"resourceId"in o){if(a)return;c.add(o.resourceId.oldValue),s.clearResources(c),d=!0}if(!d)Object.values(s.eventMap[r.id]).forEach((function(e){var t=e.tplData;e.tplData=s.scheduler.generateTplData(t.eventRecord,t.resourceRecord),e.tplData.left=t.left,e.tplData.width=t.width}))}s.scheduler.runWithTransition((function(){return s.renderer()}),u)}},{key:"onChangeResourceStore",value:function(e){var t=e.newResourceStore,n=this;n.firstResource=n.lastResource=null,n.clearAll(),n.resourceStore=t,n.renderer()}},{key:"onResourceStoreChange",value:function(e){var t=e.source,n=e.action,r=e.records,i=e.record,o=this,a=r||(i?[i]:[]);switch(o.firstResource=o.lastResource=null,n){case"add":for(var s=a.reduce((function(e,n){return Math.min(e,t.indexOf(n))}),t.count);s<t.count;s++)o.clearResources([t.getAt(s).id]);return;case"remove":case"removeall":return void o.clearAll();case"replace":case"update":break;case"filter":o.clearAll()}o.scheduler.runWithTransition((function(){return o.renderer()}))}},{key:"onResourceStoreRefresh",value:function(e){var t=e.action,n=this;if("group"===t)throw new Error("Grouping of resources not supported in vertical mode");"sort"===t&&(n.firstResource=n.lastResource=null,n.clearAll(),n.scheduler.runWithTransition((function(){return n.renderer()})))}},{key:"onChangeAssignmentStore",value:function(e){var t=e.newAssignmentStore;this.assignmentStore=t}},{key:"onAssignmentStoreChange",value:function(e){var t=e.action,n=e.records,r=e.replaced,i=e.record,o=e.changes,a=this,s=new Set((n||(i?[i]:[])).map((function(e){return e.resourceId})));switch(t){case"add":case"remove":case"updateMultiple":a.clearResources(s);break;case"filter":case"removeall":a.clearAll();break;case"replace":r.forEach((function(e){var t=te()(e,2),n=t[0],r=t[1];s.add(n.resourceId),s.add(r.resourceId)})),a.clearResources(s);break;case"update":"resourceId"in o&&s.add(o.resourceId.oldValue),a.clearResources(s)}a.scheduler.runWithTransition((function(){return a.renderer()}))}},{key:"refreshRows",value:function(e){e&&(this.clearAll(),this.scheduler.refreshFromRerender=!1)}},{key:"updateFromHorizontalScroll",value:function(e){e!==this.prevScrollLeft&&(this.renderer(),this.prevScrollLeft=e)}},{key:"updateFromVerticalScroll",value:function(){this.renderer()}},{key:"scrollResourceIntoView",value:function(e,t){var n=this.scheduler,r=n.resourceStore.indexOf(e)*n.resourceColumnWidth;return n.scrollHorizontallyTo(r,t)}},{key:"onViewportResize",value:function(e){this.resourceColumns.availableWidth=e,this.renderer()}},{key:"onLocaleChange",value:function(){this.clearAll()}},{key:"onDragAbort",value:function(){}},{key:"onBeforeRowHeightChange",value:function(){}},{key:"onTimeAxisViewModelUpdate",value:function(){}},{key:"clearEvents",value:function(){}},{key:"updateElementId",value:function(){}},{key:"releaseTimeSpanDiv",value:function(){}},{key:"getTimeSpanRenderData",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=this,r=n.scheduler,i=e.startDate,o=e.endDate,a=r.getCoordinateFromDate(i),s=n.resourceStore.indexOf(t)*r.resourceColumnWidth,l=r.resourceColumnWidth-2*r.resourceMargin,c=i.getTime(),u=o.getTime(),d=r.getCoordinateFromDate(o),f=d-a;return-1===d&&(d=a+(f=Math.round((u-c)*r.timeAxisViewModel.getSingleUnitInPixels("ms")))),{eventRecord:e,resourceRecord:t,left:s,top:a,bottom:d,width:l,height:f,startDate:i,endDate:o,startDateMS:c,endDateMS:u,start:i,end:o,startMs:c,endMs:u}}},{key:"eventSorter",value:function(e,t){var n=e.dataStartMs||e.startDateMS,r=e.dataEndMs||e.endDateMS,i=t.dataStartMs||t.startDateMS,o=t.dataEndMs||t.endDateMS;return n===i?r-o==0?e.eventRecord.name<t.eventRecord.name?-1:1:r>o?-1:1:n<i?-1:1}},{key:"layoutResource",value:function(e){var t=this,n=t.scheduler,r=t.resourceMap[e.id]={},i=n.resourceStore.indexOf(e),o=n.eventStore.getEventsForResource(e),a=(o=n.getEventsToRender(e,o)).reduce((function(o,a){var s=n.generateTplData(a,e),l={tplData:s};return mt.setPath(t.eventMap,"".concat(s.eventId,".").concat(e.id),l),r[s.eventId]=l,s.fillSize?(s.left=i*n.resourceColumnWidth,s.width=n.resourceColumnWidth):o.push(s),o}),[]);return a.sort(t.eventSorter),t.verticalLayout.applyLayout(a,n.resourceColumnWidth,n.resourceMargin,n.barMargin,i),r}},{key:"addTemporaryDragElement",value:function(e){var t=this.scheduler,n=t.generateTplData(e,e.resource,{timeAxis:!0,viewport:!0});n.top=n.row?n.top+n.row.top:t.getResourceEventBox(e,e.resource,!0).top;var r=this.renderEvent({tplData:n}),i=r.dataset;delete r.tabIndex,delete i.eventId,delete i.resourceId,delete i.syncId,i.transient=!0,r.parent=this.scheduler.foregroundCanvas,r.retainElement=!0;var o=on.createElement(r);return o.innerElement=o.firstChild,e.instanceMeta(t).hasTemporaryDragElement=!0,o}},{key:"renderEvent",value:function(e){var t=e.tplData,n=t.resourceRecord,r=t.eventRecord,i={className:t.wrapperCls,tabIndex:"0",children:[{className:t.cls,style:(t.internalStyle||"")+(t.style||""),html:t.body.cloneNode(!0),compareHtml:t.eventContent}],style:{transform:"translate(".concat(t.left,"px, ").concat(t.top,"px)"),height:t.height,width:t.width,zIndex:t.zIndex},dataset:{resourceId:n.id,eventId:t.eventId,syncId:t.assignment?t.assignment.id:t.eventId},elementData:e,retainElement:r.instanceMeta(this.scheduler).retainElement};return t.assignment&&(i.dataset.assignmentId=t.assignment.id),i}},{key:"renderResource",value:function(e){var t=this,n=t.topDateMS,r=t.bottomDateMS,i=[],o=t.resourceMap[e.id];for(var a in o||(o=t.layoutResource(e)),o){var s=o[a],l=s.tplData,c=l.endDateMS,u=l.startDateMS,d=l.eventRecord;c>=n&&u<=r&&!d.instanceMeta(t.scheduler).hasTemporaryDragElement&&i.push(t.renderEvent(s))}return i}},{key:"renderer",value:function(){var e=this,t=e.scheduler,n=t.resourceStore,r=e.resourceRange,i=r.firstResource,o=r.lastResource,a=e.dateRange,s=a.topDate,l=a.bottomDate,c=[],u=[];if(e.initialized){if(ft.isEqual(s,e.topDate)&&ft.isEqual(l,e.bottomDate)||(e.topDate=s,e.bottomDate=l,e.topDateMS=s.getTime(),e.bottomDateMS=l.getTime(),e.timeView.range={startDate:s,endDate:l}),-1!==i&&-1!==o)for(var d=i;d<=o;d++)c.push.apply(c,e.renderResource(n.getAt(d)));t.getForegroundDomConfigs(u),c.push.apply(c,u),vc.sync({domConfig:{onlyChildren:!0,children:c},targetElement:t.foregroundCanvas,syncIdField:"syncId",callback:function(e){var n=e.action,r=e.domConfig,i=e.lastDomConfig,o=e.targetElement;if(r&&r.className&&r.className[t.eventCls+"-wrap"]){var a=Xm[n];if(qm[n]&&i&&!i.isReleased){var s=i.elementData.tplData,l={tplData:s,assignmentRecord:s.assignment,eventRecord:s.eventRecord,resourceRecord:s.resourceRecord,targetElement:o};t.trigger("releaseEvent",l)}if(a){var c=r.elementData.tplData,u={tplData:c,assignmentRecord:c.assignment,eventRecord:c.eventRecord,resourceRecord:c.resourceRecord,targetElement:o};o.elementData.element=o,u.reusingElement="reuseElement"===n,t.trigger("renderEvent",u)}"none"===n&&(r.elementData.element=o)}}}),e.firstResource===i&&e.lastResource===o||(e.resourceColumns.range={firstResource:i,lastResource:o},e.firstResource=i,e.lastResource=o)}}},{key:"clearResources",value:function(e){var t=this;e.forEach((function(e){t.resourceMap[e]&&(Object.keys(t.resourceMap[e]).forEach((function(n){delete t.eventMap[n][e]})),delete t.resourceMap[e])}))}},{key:"clearAll",value:function(){this.resourceMap={},this.eventMap={}}},{key:"resourceStore",set:function(e){var t=this;t.resourceStoreDetacher&&t.resourceStoreDetacher(),t.resourceColumns.resourceStore=t._resourceStore=e,t.resourceStoreDetacher=e.on({change:t.onResourceStoreChange,refresh:t.onResourceStoreRefresh,thisObj:t,prio:1})},get:function(){return this._resourceStore}},{key:"timeView",get:function(){return this.scheduler.timeView}},{key:"assignmentStore",set:function(e){var t=this;t.assignmentStoreDetacher&&t.assignmentStoreDetacher(),t._assignmentStore=e,e&&(t.assignmentStoreDetacher=e.on({change:t.onAssignmentStoreChange,thisObj:t}))},get:function(){return this._assignmentStore}},{key:"resourceRange",get:function(){var e=this.scheduler,t=this.resourceStore;return t&&t.count?{firstResource:Math.max(Math.floor(e.scrollLeft/e.resourceColumnWidth)-1,0),lastResource:Math.min(Math.floor((e.scrollLeft+e.timeAxisSubGrid.width)/e.resourceColumnWidth)+1,t.count-1)}:{firstResource:-1,lastResource:-1}}},{key:"dateRange",get:function(){var e=this.scheduler,t=e.getDateFromCoordinate(Math.min(e.scrollTop+e.bodyHeight+e.tickSize-1,(e.virtualScrollHeight||e.scrollable.scrollHeight)-1));return t||(t=e.timeAxis.last.endDate),{topDate:e.getDateFromCoordinate(Math.max(e.scrollTop-e.tickSize,0)),bottomDate:t}}}],[{key:"properties",get:function(){return{eventMap:{},resourceMap:{},releasedElements:{}}}}]),r}(or(G));Km._$name="VerticalEventMapper";n(274);function Jm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jm(Object(n),!0).forEach((function(t){oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function eb(e,t){return e===t.length-1}function tb(e,t){return t===e.cells[e.cells.length-1]}var nb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Zm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildCells",value:function(){var e=this,t=e.sizeProperty,n=[],r=e.levels.map((function(n,r){var i;return{className:(i={"b-sch-header-row":1},oe()(i,"b-sch-header-row-".concat(n.position),1),oe()(i,"b-sch-header-row-main",r===e.model.viewPreset.mainHeaderLevel),oe()(i,"b-lowest",eb(r,e.levels)),i),syncOptions:{releaseThreshold:5,syncIdField:"tickIndex"},dataset:{headerFeature:"headerRow".concat(r),headerPosition:n.position},children:n.cells.filter((function(t){return t.start<e.endDate&&t.end>e.startDate})).map((function(r){var i,o;return{className:(i={"b-sch-header-timeaxis-cell":1},oe()(i,r.headerCellCls,r.headerCellCls),oe()(i,"b-align-".concat(r.align),r.align),oe()(i,"b-last",tb(n,r)),i),dataset:Qm({tickIndex:r.index},window.DEBUG&&{date:r.start.getTime()}),style:(o={},oe()(o,e.positionProperty,r.coord),oe()(o,t,r.width),oe()(o,"min-".concat(t),r.width),o),children:e.wrapText?[{className:"b-sch-header-text",html:r.value}]:null,html:e.wrapText?null:r.value}}))}}));return e.client&&e.client.getHeaderDomConfigs(n),r.push.apply(r,n),{className:"b-widget ".concat(e.cls),syncOptions:{releaseThreshold:0},style:oe()({},t,e.size),children:r}}},{key:"render",value:function(e){se()(J()(r.prototype),"render",this).call(this,e),this.refresh(!0)}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.levels.length,t=this,n=t.model.columnConfig,r=t.levels,i=r.length;if(e){r.length=0,n.forEach((function(e,t){return r[t]={position:t,cells:e}})),t.size=r[0].cells.reduce((function(e,t){return e+t.width}),0);var o=t.element.parentElement;o&&(o.classList.remove("b-sch-timeaxiscolumn-levels-".concat(i)),o.classList.add("b-sch-timeaxiscolumn-levels-".concat(r.length)))}t.startDate&&t.endDate&&(vc.sync({domConfig:t.buildCells(),targetElement:t.element,syncIdField:"headerFeature"}),t.trigger("refresh"))}},{key:"range",set:function(e){this.startDate=e.startDate,this.endDate=e.endDate,this.refresh(),this.trigger("rangeChange",{startDate:e.startDate,endDate:e.endDate})}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{compactCellWidthThreshold:15,model:null,cls:null,sizeProperty:null,positionProperty:null,wrapText:null}}},{key:"properties",get:function(){return{startDate:null,endDate:null,levels:[],size:null}}}]),r}(Nr);function rb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}nb._$name="TimeAxisBase";var ib=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(rb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){se()(J()(r.prototype),"construct",this).apply(this,arguments),this.model.on({update:this.onModelUpdate,thisObj:this})}},{key:"onModelUpdate",value:function(){this.model.availableSpace!==this.width&&this.refresh(!0)}},{key:"width",get:function(){return this.size}}],[{key:"$name",get:function(){return"HorizontalTimeAxis"}},{key:"defaultConfig",get:function(){return{cls:"b-horizontaltimeaxis",sizeProperty:"width",positionProperty:"left",wrapText:!1}}}]),r}(nb);function ob(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ib._$name="HorizontalTimeAxis";var ab=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(ob()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e);var t=this;null!=t.imagePath&&(Kn.on({element:t.element,delegate:".b-resource-image",capture:!0,error:function(e){return t.setDefaultResourceImage(e.target)},thisObj:t}),t.element.classList.add("b-has-images")),Kn.on({element:t.element,delegate:".b-resourceheader-cell",capture:!0,click:"onResourceMouseEvent",dblclick:"onResourceMouseEvent",contextmenu:"onResourceMouseEvent",thisObj:t})}},{key:"onResourceStoreDataChange",value:function(e){var t=e.action,n=this,r=n.resourceStore.count*n.columnWidth;r!==n.width&&(n.element.style.width=r+"px",n.column.set("width",r,n.column.grid.isConfiguring)),"removeall"===t&&(n.element.innerHTML=""),"remove"!==t&&"add"!==t&&"filter"!==t||n.refreshWidths()}},{key:"setDefaultResourceImage",value:function(e){if(this.defaultImageName){var t=this.getImageURL(this.defaultImageName);e.src&&!e.src.endsWith(t.replace(/^[./]*/gm,""))&&(e.src=t)}}},{key:"getImageURL",value:function(e){return L.joinPaths([this.imagePath||"",e||""])}},{key:"refreshWidths",value:function(){var e=this,t=e.availableWidth,n=e._originalColumnWidth,r=e.resourceStore&&e.resourceStore.count;if(t&&r){e.refreshingWidths=!0;var i=e.fitWidth||e.fillWidth&&n*r<t?Math.floor(t/r):n,o=e.column.grid.enableEventAnimations&&Math.abs(e._columnWidth-i)>30;on.addTemporaryClass(e.element,"b-animating",o?300:0,e),e.columnWidth=i,e.refreshingWidths=!1}}},{key:"refresh",value:function(){var e=this,t=e.firstResource,n=e.lastResource;if(!(e.column.grid.isConfiguring||-1===t||-1===n||n>=e.resourceStore.count)){for(var r=[],i=t;i<=n;i++){var o=e.resourceStore.getAt(i),a={className:new bt({"b-resourceheader-cell":1}),dataset:{resourceId:o.id},style:{left:i*e.columnWidth,width:e.columnWidth},children:[]};if(e.headerRenderer){var s=e.headerRenderer({elementConfig:a,resourceRecord:o});null!=s&&(a.html=s)}else{var l=void 0;if(o.imageUrl)l=o.imageUrl;else if(null!=e.imagePath){var c=o.image||o.name&&o.name.toLowerCase()+e.imageExtension||e.defaultImageName;l=e.getImageURL(c)}null!=l&&a.children.push({tag:"img",className:"b-resource-image",src:l}),o.iconCls&&a.children.push({tag:"i",className:o.iconCls}),a.children.push({tag:"span",className:"b-resource-name",html:o.name})}r.push(a)}vc.sync({domConfig:{onlyChildren:!0,children:r},targetElement:e.element,syncIdField:"resourceId"})}}},{key:"onResourceMouseEvent",value:function(e){var t=e.target.closest(".b-resourceheader-cell"),n=this.resourceStore.getById(t.dataset.resourceId);this.trigger("resourceHeader"+L.capitalizeFirstLetter(e.type),{resourceRecord:n,event:e})}},{key:"resourceStore",set:function(e){var t=this;e!==t._resourceStore&&(t.resourceStoreDetacher&&t.resourceStoreDetacher(),t._resourceStore=e,t.resourceStoreDetacher=e.on({change:"onResourceStoreDataChange",thisObj:t}),e.count&&t.onResourceStoreDataChange({}))},get:function(){return this._resourceStore}},{key:"columnWidth",get:function(){return this._columnWidth},set:function(e){var t=this;if(e!==t._columnWidth){var n=t._columnWidth;t._columnWidth=e,t.refreshingWidths||(t._originalColumnWidth=e,t.refreshWidths()),t.isConfiguring||(t.refresh(),t.trigger("columnWidthChange",{width:t._columnWidth,oldWidth:n}))}}},{key:"fillWidth",get:function(){return this._fillWidth},set:function(e){this._fillWidth=e,this.refreshWidths()}},{key:"fitWidth",get:function(){return this._fitWidth},set:function(e){this._fitWidth=e,this.refreshWidths()}},{key:"imagePath",get:function(){return this._imagePath},set:function(e){this._imagePath=e,this.refresh()}},{key:"availableWidth",get:function(){return this._availableWidth},set:function(e){this._availableWidth=e,this.refreshWidths()}},{key:"range",set:function(e){this.firstResource=e.firstResource,this.lastResource=e.lastResource,this.refresh()}}],[{key:"$name",get:function(){return"ResourceHeader"}},{key:"defaultConfig",get:function(){return{resourceStore:null,columnWidth:150,headerRenderer:null,fillWidth:!0,fitWidth:!1,imagePath:null,imageExtension:null,defaultImageName:null}}},{key:"properties",get:function(){return{firstResource:-1,lastResource:-1}}}]),r}(Nr);function sb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ab._$name="ResourceHeader";var lb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(sb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=this;se()(J()(r.prototype),"construct",this).apply(this,arguments),e.initialRender=!0,e.thisObj=e,e.timeAxisViewModel=e.timeline.timeAxisViewModel,e.mode=e.mode,e.grid.on({paint:"onTimelinePaint",thisObj:e,once:!0}),e.timeAxisViewModel.on({update:e.onViewModelUpdate,thisObj:e})}},{key:"doDestroy",value:function(){this.resourceColumns&&this.resourceColumns.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onViewModelUpdate",value:function(e){var t=e.source,n=this;"horizontal"===n.mode?(n.refreshHeader(!0),n.width=t.totalSize,n.timeline.refresh()):"vertical"===n.mode&&n.timeline.refreshRows()}},{key:"onTimelinePaint",value:function(e){var t=e.firstPaint,n=this;n.subGrid.insertRowsBefore&&t&&(n.subGridElement.classList.add("b-timeline-subgrid"),n.element&&Kn.on({element:n.element,thisObj:n,click:"onContainerElementClick",dblclick:"onContainerElementClick",contextmenu:"onContainerElementClick"}),"vertical"===n.mode&&n.refreshHeader())}},{key:"refreshHeader",value:function(e){var t=this,n=t.element;n&&("horizontal"===t.mode?(!e&&t.timeAxisViewModel.update(null,!0),t.timeAxisView.rendered?t.timeAxisView.refresh(!0):(n.innerHTML="",t.timeAxisView.render(n))):"vertical"===t.mode&&(t.resourceColumns.currentElement||(n.innerHTML="",t.resourceColumns.render(n))))}},{key:"renderer",value:function(e){return this.timeline.currentOrientation.renderer(e)}},{key:"onContainerElementClick",value:function(e){var t=on.up(e.target,".b-sch-header-timeaxis-cell");if(t){var n=t.dataset.tickIndex,r=t.parentElement.dataset.headerPosition,i=this.timeAxisViewModel.columnConfig[r][n],o=this.grid.features.contextMenu;o&&e.type===o.triggerEvent||this.trigger("timeAxisHeader"+L.capitalizeFirstLetter(e.type),{startDate:i.start,endDate:i.end,event:e})}}},{key:"mode",set:function(e){var t=this,n=t.timeline;t.set("mode",e),"horizontal"===e?t.timeAxisView=new ib({model:t.timeAxisViewModel,compactCellWidthThreshold:t.compactCellWidthThreshold,owner:t.grid,client:t.grid}):"vertical"===e&&(t.resourceColumns=new ab(mt.assign({column:t,resourceStore:n.resourceStore,imagePath:n.resourceImagePath,imageExtension:n.resourceImageExtension,defaultImageName:n.defaultResourceImageName},n.resourceColumns||{})),t.relayEvents(t.resourceColumns,["resourceheaderclick","resourceheaderdblclick","resourceheadercontextmenu"]))},get:function(){return this.get("mode")}}],[{key:"autoExposeFields",get:function(){return!0}},{key:"fields",get:function(){return["mode"]}},{key:"defaults",get:function(){return{draggable:!1,groupable:!1,hideable:!1,showColumnPicker:!1,filterable:!1,sortable:!1,resizable:!1,searchable:!1,editor:!1,enableCellContextMenu:!1,tooltipRenderer:!1,cls:"b-sch-timeaxiscolumn",needWidth:!0,mode:null,region:"normal",exportable:!1}}},{key:"type",get:function(){return"timeAxis"}}]),r}(pe(Hu));function cb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(lb),lb._$name="TimeAxisColumn";var ub=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(cb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"height",get:function(){return this.size}}],[{key:"$name",get:function(){return"VerticalTimeAxis"}},{key:"defaultConfig",get:function(){return{cls:"b-verticaltimeaxis",sizeProperty:"height",positionProperty:"top",wrapText:!0}}}]),r}(nb);function db(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ub._$name="VerticalTimeAxis";var fb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(db()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;se()(J()(r.prototype),"construct",this).apply(this,arguments),t.timeAxisViewModel=e.timeline.timeAxisViewModel,t.view=new ub({model:t.timeAxisViewModel,client:e.timeline})}},{key:"renderer",value:function(e){var t=e.cellElement,n=e.size;this.view.render(t),n.height=this.view.height}}],[{key:"type",get:function(){return"verticalTimeAxis"}},{key:"defaults",get:function(){return{draggable:!1,groupable:!1,hideable:!1,showColumnPicker:!1,filterable:!1,sortable:!1,searchable:!1,editor:!1,enableCellContextMenu:!1,tooltipRenderer:!1,cellCls:"b-verticaltimeaxiscolumn"}}}]),r}(Hu);function hb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(fb),fb._$name="VerticalTimeAxisColumn";var gb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(hb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;se()(J()(r.prototype),"construct",this).call(this,e),t.createEventOnDblClick&&t.on("scheduledblclick",t.onSchedulerDblClick)}},{key:"onLocaleChange",value:function(){this.currentOrientation.onLocaleChange(),se()(J()(r.prototype),"onLocaleChange",this).call(this)}},{key:"onSchedulerDblClick",value:function(e){var t=e.date,n=e.resourceRecord,r=e.row;this.readOnly||n.meta.specialRow||this.internalAddEvent(t,n,r)}},{key:"onColumnsChanged",value:function(e){e.action;var t=e.changes,n=e.record;n===this.timeAxisColumn&&"width"in t&&this.updateCanvasSize(),se()(J()(r.prototype),"onColumnsChanged",this).apply(this,arguments)}},{key:"onVerticalScroll",value:function(e){var t=e.scrollTop;this.currentOrientation.updateFromVerticalScroll(t)}},{key:"onEventCreated",value:function(e){}},{key:"onElementKeyDown",value:function(e){se()(J()(r.prototype),"onElementKeyDown",this).call(this,e)}},{key:"onElementKeyUp",value:function(e){se()(J()(r.prototype),"onElementKeyUp",this).call(this,e)}},{key:"onElementMouseOver",value:function(e){se()(J()(r.prototype),"onElementMouseOver",this).call(this,e)}},{key:"onElementMouseOut",value:function(e){se()(J()(r.prototype),"onElementMouseOut",this).call(this,e)}},{key:"getEventMenuItems",value:function(){}},{key:"getScheduleMenuItems",value:function(){}},{key:"internalAddEvent",value:function(e,t,n){var r=this,i=[t],o=new r.eventStore.modelClass({startDate:e,endDate:ft.add(e,1,r.timeAxis.unit)});if(r.onEventCreated(o),r.eventEdit){var a=r.currentOrientation.getTimeSpanRenderData(o,t),s=on.createElement({parent:r.foregroundCanvas,className:"b-sch-dragcreator-proxy",style:"width:".concat(a.width,"px;height:").concat(a.height,"px")});return on.setTranslateXY(s,a.left,(n&&n.top||0)+a.top),void r.editEvent(o,t,s)}!1!==r.trigger("beforeEventAdd",{eventRecord:o,resourceRecords:i,resources:i})&&(r.eventStore.add(o),r.eventStore.assignEventToResource(o,t))}},{key:"isDateRangeAvailable",value:function(e,t,n,r){return this.eventStore.isDateRangeAvailable(e,t,n,r)}},{key:"toggleEmptyText",value:function(){var e=this;e.bodyContainer&&on.toggleClasses(e.bodyContainer,"b-grid-empty",!(e.rowManager.rowCount||e.crudManager&&e.crudManager.isLoading))}},{key:"timeAxisViewModel",set:function(e){ei()(J()(r.prototype),"timeAxisViewModel",e,this,!0),this.eventStore&&(this.timeAxisViewModel.eventStore=this.eventStore)},get:function(){return se()(J()(r.prototype),"timeAxisViewModel",this)}},{key:"store",get:function(){return se()(J()(r.prototype),"store",this)},set:function(e){ei()(J()(r.prototype),"store",e,this,!0)}},{key:"isHorizontal",get:function(){return"horizontal"===this.mode}},{key:"isVertical",get:function(){return"vertical"===this.mode}},{key:"mode",get:function(){return this._mode},set:function(e){var t=this;t._mode=e,t[e]||("horizontal"===e?(t.horizontal=new Um(t),t.isPainted&&t.horizontal.init(),t.un("scroll",t.onVerticalScroll,t)):"vertical"===e&&(t.zoomOnTimeAxisDoubleClick=t.zoomOnMouseWheel=!1,t.vertical=new Km(t),t.rendered&&t.vertical.init(),t.on("scroll",t.onVerticalScroll,t)))}},{key:"currentOrientation",get:function(){return this[this.mode]}}],[{key:"$name",get:function(){return"SchedulerBase"}},{key:"defaultConfig",get:function(){return{mode:"horizontal",eventCls:"b-sch-event",timeCellCls:"b-sch-timeaxis-cell",timeCellSelector:".b-sch-timeaxis-cell",scheduledEventName:"event",overScheduledEventClass:"b-sch-event-hover",allowOverlap:!0,rowHeight:60,milestoneCharWidth:10,milestoneAlign:"center",milestoneMinWidth:40,crudManagerClass:zv,testConfig:{loadMaskHideTimeout:10}}}}]),r}(Fo(im).mixes(Mg,(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(sm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getElementFromAssignmentRecord",value:function(e){return this.currentOrientation.getElementFromEventRecord(e.event,e.resource)}},{key:"getElementFromEventRecord",value:function(e,t){return this.currentOrientation.getElementFromEventRecord(e,t)}},{key:"getElementsFromEventRecord",value:function(e,t){return this.currentOrientation.getElementsFromEventRecord(e,t)}},{key:"getEventIdFromDomNodeId",value:function(e){var t=e.substring(this.eventPrefix.length).split("-")[0];return t&&t.replace(/\._\./g,"-")}},{key:"getEventRecordFromDomId",value:function(e){return e=this.getEventIdFromDomNodeId(e),this.eventStore.getById(e)}},{key:"getResourceIdFromDomNodeId",value:function(e){var t=e.substring(this.eventPrefix.length).split("-")[1];return t&&t.replace(/\._\./g,"-")}},{key:"getResourceRecordFromDomId",value:function(e){return e=this.getResourceIdFromDomNodeId(e),this.resourceStore.getById(e)}},{key:"resolveResourceRecord",value:function(e,t){return this.currentOrientation.resolveRowRecord(e,t)}},{key:"resolveEventRecord",value:function(e){if(e=on.up(e,this.eventSelector)){if(e.dataset.eventId)return this.eventStore.getById(e.dataset.eventId);if(e.dataset.assignmentId)return this.assignmentStore.getById(e.dataset.assignmentId).event}return null}},{key:"resolveTimeSpanRecord",value:function(e){return this.resolveEventRecord(e)}},{key:"resolveAssignmentRecord",value:function(e){var t=this.eventStore.assignmentStore,n=null;if(t){var r=on.up(e,this.eventSelector),i=this.resolveEventRecord(r),o=this.resolveResourceRecord(r);i&&o&&(n=t.getAssignmentForEventAndResource(i,o))}return n}},{key:"isRowVisible",value:function(e){return this.store.indexOf(e)>=0}},{key:"getMilestoneLabelWidth",value:function(e){var t=this,n=t.milestoneLayoutMode;if("measure"===n){var r=t.milestoneMeasureElement||(t.milestoneMeasureElement=on.createElement({className:"b-sch-event-wrap b-milestone-wrap b-measure",children:[{className:"b-sch-event b-milestone",html:"<label></label>"}],parent:t.foregroundCanvas}));return r.firstElementChild.firstElementChild.innerHTML=e.name,r.offsetWidth}return"estimate"===n?Math.max(e.name.length*t.milestoneCharWidth,t.milestoneMinWidth):"data"===n?Math.max(e.milestoneWidth,t.milestoneMinWidth):0}},{key:"milestoneLayoutMode",set:function(e){this._milestoneLayoutMode=e,this.element.classList["default"!==e?"add":"remove"]("b-sch-layout-milestones"),this.refresh()},get:function(){return this._milestoneLayoutMode}},{key:"milestoneAlign",set:function(e){this._milestoneAlign=e,this.refresh()},get:function(){return this._milestoneAlign}},{key:"milestoneCharWidth",set:function(e){this._milestoneCharWidth=e,this.refresh()},get:function(){return this._milestoneCharWidth}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(lm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getTimeSpanMouseEventParams",value:function(e,t){return{eventRecord:this.resolveEventRecord(e),resourceRecord:this.resolveResourceRecord(e),assignmentRecord:this.resolveAssignmentRecord(e),eventElement:e,event:t}}},{key:"getScheduleMouseEventParams",value:function(e,t){return{resourceRecord:this.isVertical?this.resolveResourceRecord(t):this.store.getById(e.id)}}},{key:"onElementKeyDown",value:function(e){se()(J()(r.prototype),"onElementKeyDown",this).call(this,e);this.selectedEvents.length&&this.trigger(this.scheduledEventName+"KeyDown",{eventRecord:this.selectedEvents})}},{key:"onElementKeyUp",value:function(e){se()(J()(r.prototype),"onElementKeyUp",this).call(this,e);this.selectedEvents.length&&this.trigger(this.scheduledEventName+"KeyUp",{eventRecord:this.selectedEvents})}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(cm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){se()(J()(r.prototype),"construct",this).call(this,e),this.hasFeature("eventDragCreate")&&this.on({dragcreateend:this.internalOnDragCreateEnd,thisObj:this})}},{key:"internalOnDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord,r=this;if(!r.hasFeature("eventEdit")||r.features.eventEdit.disabled){var i=n?[n]:[];!1!==r.trigger("beforeEventAdd",{eventRecord:t,resources:i,resourceRecords:i})&&(r.onEventCreated(t),r.eventStore.add(t),t.assign(n))}}},{key:"eventEditor",get:function(){return this._eventEditor},set:function(e){this._eventEditor=e}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(km()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onStoreDataChange",value:function(e){e.source,e.action;this.currentOrientation.clearEvents(),se()(J()(r.prototype),"onStoreDataChange",this).apply(this,arguments)}},{key:"refreshFromRowOnStoreAdd",value:function(e,t){var n=this,i=t.isExpand,o=arguments;this.runWithTransition((function(){var t;return(t=se()(J()(r.prototype),"refreshFromRowOnStoreAdd",n)).call.apply(t,[n,e].concat(Z()(o)))}),!i)}},{key:"onStoreAdd",value:function(e){var t=e.source,n=e.records,i=e.isChild,o=e.isExpandAll,a=this,s=a.rowManager;if(!(o||i&&!n[0].ancestorsExpanded(t))){s.calculateRowCount(!1,!0,!0);var l=Math.max(s.topIndex+s.rowCount,Math.min(s.visibleRowCount,t.count));n=n.sort((function(e,n){return t.indexOf(e)-t.indexOf(n)}));var c=t.indexOf(n[0]);if(c<l)for(var u=c=Math.max(c,s.topIndex);u<l;u++)a.currentOrientation.onRowRecordUpdate({record:t.getAt(u)});else s.estimateTotalHeight();se()(J()(r.prototype),"onStoreAdd",this).apply(this,arguments)}}},{key:"onStoreUpdateRecord",value:function(){var e;(e=this.currentOrientation).onRowRecordUpdate.apply(e,arguments),se()(J()(r.prototype),"onStoreUpdateRecord",this).apply(this,arguments)}},{key:"onStoreRemove",value:function(){var e;(e=this.currentOrientation).onRowRecordRemove.apply(e,arguments),se()(J()(r.prototype),"onStoreRemove",this).apply(this,arguments)}},{key:"onStoreRemoveAll",value:function(){this.currentOrientation.clearEvents(),se()(J()(r.prototype),"onStoreRemoveAll",this).call(this)}},{key:"doDestroy",value:function(){se()(J()(r.prototype),"doDestroy",this).call(this);var e=this;e.destroyStores&&e.constructor.destroy(e.assignmentStore,e.resourceStore,e.dependencyStore,e.eventStore)}},{key:"getResourceStoreListenerConfig",value:function(){return{}}},{key:"getEventStoreListenerConfig",value:function(){return{thisObj:this,detachable:!0,change:"onInternalEventStoreChange",clearchanges:"onEventClearChanges",beforecommit:"onEventBeforeCommit",commit:"onEventCommit",beforeRemove:"onEventStoreBeforeRemove",refresh:"onEventStoreRefresh",exception:"onEventException",idchange:"onEventIdChange"}}},{key:"getAssignmentStoreListenerConfig",value:function(){var e=this;return{thisObj:e,refresh:e.onAssignmentRefresh,update:e.onAssignmentUpdate,add:e.onAssignmentAdd,beforeRemove:{fn:e.onBeforeAssignmentRemove,prio:-1e3},remove:e.onAssignmentRemove,filter:e.onAssignmentFilter,removeall:e.onAssignmentRemoveAll}}},{key:"getDependencyStoreListenerConfig",value:function(){return{}}},{key:"onEventIdChange",value:function(e){this.currentOrientation.onEventStoreIdChange&&this.currentOrientation.onEventStoreIdChange(e)}},{key:"onInternalEventStoreChange",value:function(e){var t=this;if(t._mode)if(t.isVertical)t.currentOrientation.onEventStoreChange(e);else{var n=function(){var n,r,i=t.currentOrientation,o=e.source,a=t.rowManager,s=t.resourceStore,l=e.action,c=e.changes,u=e.isCollapse,d=e.records||(e.record?[e.record]:null),f=[],h=new Set,g=!1;if(!t.isPainted)return{v:void 0};if(u||"update"===l&&d.length&&d[0].meta.removingResource)return{v:void 0};if(!("filter"===l&&t.hasFeature("resourceTimeRanges"))&&Sm[l]&&d){if(c&&"resourceId"in c&&null!=c.resourceId.oldValue){var v=s.getById(c.resourceId.oldValue),p=v&&a.getRowFor(v);p&&(f.push(v),h.add(p))}for(r=0,n=d.length;r<n;r++)f.push.apply(f,Z()(o.getResourcesForEvent(d[r]).filter((function(e){if(e&&t.resourceStore.isAvailable(e.id)){var n=a.getRowFor(e);if(n)return h.add(n),!0}return!1}))));if(f.length){if(h.size>1)h=new Set(Z()(h).sort((function(e,t){return e.dataIndex-t.dataIndex})));else if(!h.size)return{v:void 0}}else if("filter"!==l||d.length)return a.estimateTotalHeight(),{v:void 0};e.resources=f}switch(l){case"dataset":i.onEventDataset();break;case"add":i.onEventAdd(e),g=!0;break;case"update":i.onEventUpdate(e),g=!0;break;case"remove":i.onEventRemove(e),g=!0;break;case"removeall":i.onEventRemoveAll(),g=!0;break;case"filter":i.onEventFilter(e),h.clear(),g=!0;break;case"clearchanges":i.onEventClearChanges(e)}t.runWithTransition((function(){h.size?a.renderRows(h):a.renderFromRow()}),g)}();if("object"===re()(n))return n.v}}},{key:"onEventStoreRefresh",value:function(e){"batch"===e.action&&this.rowManager.rowCount&&(this.currentOrientation.onEventDataset&&this.currentOrientation.onEventDataset(),this.refresh())}},{key:"onEventStoreBeforeRemove",value:function(e){var t=e.records,n=this;if(n.activeEvent&&t.includes(n.activeEvent)){var r;if("key"===Gr.lastInteractionType)for(var i=0,o=t.length;i<o&&(!r||t.includes(r));i++)if(n.eventStore.getResourcesForEvent(t[i]).length){var a=t[i],s=a.assignments&&a.assignments.length?a.assignments[0]:a;r=n.getNext(s,!0)||n.getPrevious(s,!0)}r?n.navigateTo(r):on.focusWithoutScrolling(n.focusElement)}}},{key:"onEventCommit",value:function(e){var t=this,n=e.changes,r=[].concat(Z()(n.added),Z()(n.modified)).map((function(e){return t.eventStore.getResourcesForEvent(e)}));r=Array.prototype.concat.apply([],r),new Set(r).forEach((function(e){return t.repaintEventsForResource(e)}))}},{key:"onEventBeforeCommit",value:function(e){var t=this,n=e.changes;[].concat(Z()(n.added),Z()(n.modified)).forEach((function(e){return t.getElementsFromEventRecord(e).forEach((function(e){return e.classList.add(t.committingCls)}))}))}},{key:"onEventException",value:function(e){var t=this;if("commit"===e.action){var n=this.eventStore.changes;[].concat(Z()(n.added),Z()(n.modified),Z()(n.removed)).forEach((function(e){return t.repaintEvent(e)}))}}},{key:"onEventClearChanges",value:function(){this.refresh()}},{key:"onAssignmentRefresh",value:function(e){!this.isHorizontal||"dataset"!==e.action&&"batch"!==e.action||this.refresh()}},{key:"onAssignmentAdd",value:function(e){var t=this,n=e.records;this.isHorizontal&&n.forEach((function(e){var n=e.resource;n&&t.repaintEventsForResource(n)}))}},{key:"onAssignmentUpdate",value:function(e){var t=e.record,n=e.changes;if(this.isHorizontal){var r,i=this.rowManager,o=this.currentOrientation.cache,a="resourceId"in n&&n.resourceId.oldValue,s=t.resourceId,l=wm;null!=a&&(r=i.getRowFor(a))&&(o.clearRow(a),l=Math.min(l,r.index)),s&&(r=i.getRowFor(s))&&(o.clearRow(s),l=Math.min(l,r.index)),l!==wm&&i.renderFromRow(i.rows[l])}}},{key:"onBeforeAssignmentRemove",value:function(e){var t=e.source,n=e.records,r=e.doRemoveLastEvent;if(!t.isRemovingEvent){var i,o=this,a=n.reduce((function(e,t){var n=t.event;return!n||n.placeHolder||e.includes(n)||e.push(n),e}),[]);if(o.activeEvent&&a.includes(o.activeEvent)){if("key"===Gr.lastInteractionType)for(var s=0,l=n.length;s<l&&(!i||n.includes(i));s++)if(o.eventStore.getResourcesForEvent(n[s].event).length){var c=n[s],u=c.assignments&&c.assignments.length?c.assignments[0]:c;i=o.getNext(u)||o.getPrevious(u)}i?o.navigateTo(i):on.focusWithoutScrolling(o.focusElement)}if(o.removeUnassignedEvent&&!o.isRemoving&&!1!==r&&(!t.stm||!t.stm.isRestoring)){var d=a.reduce((function(e,t){var r=t.assignments?t.assignments.length:0;return(r-=n.filter((function(e){return e.event===t})).length)||e.push(t),e}),[]);o.eventStore.remove(d)}}}},{key:"onAssignmentRemove",value:function(e){var t=this,n=e.records;this.isHorizontal&&n.forEach((function(e){var n=e.resource;n&&t.repaintEventsForResource(n)}))}},{key:"onAssignmentRemoveAll",value:function(){this.isHorizontal&&this.refresh()}},{key:"onAssignmentFilter",value:function(){this.isHorizontal&&this.refresh()}},{key:"applyStartEndParameters",value:function(e){var t=e.source,n=e.params,r=t.modelClass.fieldMap.startDate.dateFormat;n[this.startParamName]=ft.format(this.startDate,r),n[this.endParamName]=ft.format(this.endDate,r)}},{key:"store",get:function(){var e=this;return e._thisIsAUsedExpression(e.resources),!e._store&&e.isVertical&&(e._store=new ga({data:[{id:"verticalTimeAxisRow"}]})),se()(J()(r.prototype),"store",this)},set:function(e){ei()(J()(r.prototype),"store",e,this,!0)}},{key:"resources",get:function(){var e=this.resourceStore;return e&&e.records},set:function(e){this.resourceStore.data=e}},{key:"resourceStore",get:function(){var e=this;return e._resourceStore||e.crudManager&&e.crudManager.resourceStore||(e.resourceStore=new Kg),e._resourceStore},set:function(e){var t=this,n=t._resourceStore;if(e!==n){if(e instanceof Kg||(e=new Kg(e)),n){var r=n===t.store;t._resourceStore=e,e&&t.isHorizontal&&(r?(t.store=t.resourceStore,t.store.metaMapId=t.id):t.refresh())}else t._resourceStore=e;e&&(t.isVertical&&e.on({load:function(){return t.unmaskBody()},thisObj:t}),t.trigger("resourceStoreChange",{newResourceStore:e,oldResourceStore:n})),t.isHorizontal&&!t._store&&(t.store=e)}}},{key:"events",get:function(){return this._eventStore.records},set:function(e){this.eventStore.data=e}},{key:"eventStore",get:function(){var e=this;return e._eventStore||e.crudManager&&e.crudManager.eventStore||(e.eventStore=new Fv({resourceStore:e.resourceStore})),this._eventStore},set:function(e){var t=this,n=t._eventStore,r=!1;if(e!==n){var i=t.resourceStore;if(n){var o=t.eventStore,a=t.assignmentStore,s=t.dependencyStore;if(e===o)return;t.eventStoreDetacher&&t.eventStoreDetacher(),t._eventStore=e,t.timeAxisViewModel.eventStore=e,e&&(i&&!e.resourceStore&&(e.resourceStore=i),a&&!e.assignmentStore&&(e.assignmentStore=a),s&&!e.dependencyStore&&(e.dependencyStore=s),t.trigger("eventStoreChange",{newEventStore:e,oldEventStore:o}),t.refresh())}else{if(e.isEventStore){if(i&&e.resourceStore!==i){if(e.resourceStore)throw new Error("eventStore ".concat(e.id," is already linked to resourceStore ").concat(e.resourceStore.id));e.resourceStore=i}}else r=e.autoLoad,e.autoLoad=!1,e=new Fv(Object.assign({resourceStore:t.resourceStore},e));t._eventStore=e}if(e){var l=this.getEventStoreListenerConfig();t.passStartEndParameters&&(l.beforeload=t.applyStartEndParameters),t.eventStoreDetacher&&t.eventStoreDetacher(),t.eventStoreDetacher=e.on(l),e.assignmentStore&&(t.assignmentStore=e.assignmentStore),r&&e.load().catch((function(){}))}t.eventStore.count>0&&(t.eventsRendered=!0)}}},{key:"assignments",get:function(){return this.assignmentStore&&this.assignmentStore.records},set:function(e){this.assignmentStore||(this.eventStore.assignmentStore=this.assignmentStore=new Hg),this.assignmentStore.data=e}},{key:"assignmentStore",get:function(){var e=this.eventStore,t=this.crudManager;return t&&t.assignmentStore||e&&e.assignmentStore},set:function(e){var t=this,n=t.assignmentStore;t.eventStore.assignmentStore!==e&&(t.eventStore.assignmentStore=e),t.assignmentStoreDetacher&&t.assignmentStoreDetacher(),e&&(t.assignmentStoreDetacher=e.on(t.getAssignmentStoreListenerConfig()),t.trigger("assignmentStoreChange",{newAssignmentStore:e,oldAssignmentStore:n}),t.refresh())}},{key:"dependencyStore",get:function(){var e=this.eventStore,t=this.crudManager;return t&&t.dependencyStore||e&&e.dependencyStore||this._dependencyStore},set:function(e){var t=this;if(t.isConfigured){var n=t.dependencyStore;t.eventStore.dependencyStore=e,e&&(t.trigger("dependencyStoreChange",{newDependencyStore:e,oldDependencyStore:n}),t.refresh())}else t._dependencyStore=e}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{events:null,eventStore:null,resources:null,resourceStore:null,assignments:null,assignmentStore:null,dependencies:null,dependencyStore:null,timeRanges:null,resourceTimeRanges:null,store:null,startParamName:"startDate",endParamName:"endDate",passStartEndParameters:!1,removeUnassignedEvent:!0}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Cm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"scrollEventIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xm,n=this,r=e.resources||[e];if(r.length>1)throw new Error("scrollEventIntoView() is not applicable for events with multiple assignments, please use scrollResourceEventIntoView() instead.");return r.length?n.scrollResourceEventIntoView(r[0],e,null,t):(console.warn("You have asked to scroll to an event which is not assigned to a resource"),Rm)}},{key:"scrollResourceEventIntoView",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xm,o=this,a=t.startDate,s=t.endDate,l=a<o.timeAxis.startDate|(s>o.timeAxis.endDate)<<1;if(null==i.edgeOffset&&(i.edgeOffset=20),l&&!1!==i.extendTimeAxis){var c,u,d=o.timeAxis.endDate-o.timeAxis.startDate;3===l?o.timeAxis.setTimeSpan(new Date(a.valueOf()-d/2),new Date(s.getTime()+d/2)):(c=1&l?o.getCoordinateFromDate(t.endDate):o.getCoordinateFromDate(t.startDate),1&l?o.timeAxis.setTimeSpan(new Date(a),new Date(a.valueOf()+d)):o.timeAxis.setTimeSpan(new Date(s.valueOf()-d),new Date(s)),u=1&l?o.getCoordinateFromDate(t.endDate):o.getCoordinateFromDate(t.startDate),o.timeAxisSubGrid.scrollable.scrollBy(u-c))}if(r=o.getElementFromEventRecord(t,e)){on.isFocusable(r)||(r=r.parentNode);var f=o.timeAxisSubGrid.scrollable;return o.timeAxisSubGrid.forceScrollUpdate=!0,f.scrollIntoView(r,i)}return l&&!1===i.extendTimeAxis?(console.warn("You have asked to scroll to an event which is outside the current view and extending timeaxis is disabled"),Rm):o.eventStore.isAvailable(t)?o.scrollUnrenderedEventIntoView(e,t,i):(console.warn("You have asked to scroll to an event which is not available"),Rm)}},{key:"scrollUnrenderedEventIntoView",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xm;return new Promise((function(i){var o=n,a=Object.assign({edgeOffset:20},r,Em),s=o.timeAxisSubGrid.scrollable,l=o.getResourceEventBox(t,e),c=s.viewport;if(c)var u=new In(l.start,l.top,l.end-l.start,l.bottom-l.top).translate(c.x-s.x,c.y-s.y),d=s.getDeltaTo(u,a)[o.isHorizontal?"xDelta":"yDelta"],f=function(e){e.scheduler;var n=e.eventRecord,o=(e.resourceRecord,e.element),a=e.targetElement;if(n===t){var l=o||a;h(),g.then((function(){d>0&&s.scrollIntoView(l,{edgeOffset:r.edgeOffset}),r.highlight&&on.highlight(l),r.focus&&l.focus(),i()}))}},h=o.on({renderEvent:f,eventrepaint:f,eventpaint:f}),g=s.scrollIntoView(u,a);else i()}))}},{key:"scrollResourceIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xm;return this.isVertical?this.currentOrientation.scrollResourceIntoView(e,t):this.scrollRowIntoView(e,t)}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Tm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getState",value:function(){return mt.copyProperties(se()(J()(r.prototype),"getState",this).call(this),this,Mm)}},{key:"applyState",value:function(e){mt.copyProperties(this,e,Mm),se()(J()(r.prototype),"applyState",this).call(this,e)}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(mm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getEventsToRender",value:function(e,t){return t}},{key:"repaintEventsForResource",value:function(e){if(this.isHorizontal){this.currentOrientation.cache.clearRow(e.id);var t=this.getRowFor(e);t&&t.render()}}},{key:"repaintEvent",value:function(e){var t=this;this.eventStore.getResourcesForEvent(e).forEach((function(e){return t.repaintEventsForResource(e)}))}},{key:"generateTplData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{viewport:!0},r=this,i=r.currentOrientation.getTimeSpanRenderData(e,t,n),o="";if(i){var a,s=e.isResizable;i.startsOutsideView&&(!0===s?s="end":"start"===s&&(s=!1)),i.endsOutsideView&&(!0===s?s="start":"end"===s&&(s=!1));var l=e.isResourceTimeRange?new bt:e.cls.clone(),c=e.isResourceTimeRange?e.cls.clone():new bt;if(Object.assign(l,(a={},oe()(a,t.cls,t.cls),oe()(a,r.generatedIdCls,e.hasGeneratedId),oe()(a,r.dirtyCls,e.isPersistable&&e.modifications),oe()(a,r.committingCls,e.isCommitting),oe()(a,r.endsOutsideViewCls,i.endsOutsideView),oe()(a,r.startsOutsideViewCls,i.startsOutsideView),oe()(a,"b-clipped-start",i.clippedStart),oe()(a,"b-clipped-end",i.clippedEnd),a)),Object.assign(c,oe()({},"".concat(r.eventCls,"-parent"),t.isParent)),e.isEvent||e.isTask){var u,d;Object.assign(l,(u={},oe()(u,r.eventCls,1),oe()(u,"b-milestone",e.isMilestone),oe()(u,"b-sch-event-narrow",i.width<10),oe()(u,r.fixedEventCls,!1===e.isDraggable),oe()(u,"b-sch-event-resizable-".concat(s),Boolean(r.features.eventResize)),oe()(u,r.eventSelectedCls,r.isEventSelected(e)),oe()(u,"b-recurring",e.isRecurring),oe()(u,"b-occurrence",e.isOccurrence),u)),i.eventId=e.id,i.id=r.getEventRenderId(e,t),"id"in e.meta.modified&&(i.oldId=r.getEventRenderId(e.meta.modified.id,t)),Object.assign(c,(d={},oe()(d,"".concat(r.eventCls,"-wrap"),1),oe()(d,"b-milestone-wrap",e.isMilestone),d));var f=e.eventStyle||t.eventStyle||r.eventStyle,h=e.eventColor||t.eventColor||r.eventColor;i.eventColor=h,i.eventStyle=f,r.assignmentStore&&e.assignments&&(i.assignment=e.assignments.find((function(e){return e.resourceId===t.id})))}if(i.wrapperCls=c,i.cls=l,i.iconCls=new bt(e.get(r.eventBarIconClsField)||e.iconCls),e.isResourceTimeRange?(i.style="",i.wrapperStyle=e.style||""):i.style=e.style||"",i.resource=t,i.resourceId=i.rowId,e.isEvent||e.isTask){if(r.eventRenderer){var g=r.eventRenderer.call(r.eventRendererThisObj||r,{eventRecord:e,resourceRecord:t,assignmentRecord:i.assignment,tplData:i});"string"==typeof i.cls&&(i.cls=new bt(i.cls)),"string"==typeof i.wrapperCls&&(i.wrapperCls=new bt(i.wrapperCls)),"string"==typeof i.iconCls&&(i.iconCls=new bt(i.iconCls)),o=r.eventBodyTemplate&&r.eventBodyTemplate(g)||(null==g?"":String(g))}else r.eventBodyTemplate?o=r.eventBodyTemplate(e):r.eventBarTextField&&(o=e.data[r.eventBarTextField]||"");r.eventBodyTemplate||(e.isMilestone&&o&&(o="<label>".concat(o,"</label>")),i.iconCls&&i.iconCls.length&&(o='<i class="'.concat(i.iconCls,'"></i>').concat(o))),i.wrapperCls["b-sch-style-".concat(i.eventStyle)]=i.eventStyle,i.eventColor&&i.eventColor.startsWith("#")?i.style="background-color:".concat(i.eventColor,";")+i.style:i.wrapperCls["b-sch-color-".concat(i.eventColor)]=i.eventColor}i.cls["b-sch-event-withicon"]=i.iconCls.length,o.includes("<")?i.body=on.createElementFromTemplate(o,{fragment:!0}):(i.body=document.createDocumentFragment(),i.body.textContent=o),i.eventContent=o,r.onEventDataGenerated(i)}return i}},{key:"onEventDataGenerated",value:function(e){}},{key:"getEventRenderId",value:function(e,t){var n=(e instanceof zg?e.id:e).toString().replace(bm,"._."),r=(t instanceof Yg?t.id:t).toString().replace(bm,"._.");return this.eventPrefix+"".concat(n,"-").concat(r,"-x")}},{key:"restartInitialAnimation",value:function(e){this.useInitialAnimation=e,this._firstRenderDone=null,this.isFirstRender=!0,this.refresh()}},{key:"eventPrefix",get:function(){return this._eventPrefix},set:function(e){this._eventPrefix=e||this.id+"-"}},{key:"layouts",get:function(){var e=this;return e._eventLayout||(e._eventLayout={},e.horizontalLayoutPackClass&&(e._eventLayout.horizontalPack=new e.horizontalLayoutPackClass(Object.assign({scheduler:e,timeAxisViewModel:e.timeAxisViewModel,bandIndexToPxConvertFn:e.horizontal.layoutEventVerticallyPack,bandIndexToPxConvertThisObj:e.horizontal}))),e.horizontalLayoutStackClass&&(e._eventLayout.horizontalStack=new e.horizontalLayoutStackClass(Object.assign({scheduler:e,timeAxisViewModel:e.timeAxisViewModel,bandIndexToPxConvertFn:e.horizontal.layoutEventVerticallyStack,bandIndexToPxConvertThisObj:e.horizontal})))),e._eventLayout}},{key:"eventLayout",get:function(){return this._overlapMode},set:function(e){var t=this;e!=t._overlapMode&&(t.element.classList.remove("b-eventlayout-".concat(t._overlapMode)),t._overlapMode=e,t.runWithTransition((function(){t.element.classList.add("b-eventlayout-".concat(t._overlapMode)),t.refresh()})))}},{key:"fillTicks",get:function(){return this._fillTicks},set:function(e){e!=this._fillTicks&&(this._fillTicks=e,this.refreshWithTransition())}},{key:"currentEventLayout",get:function(){if(!this.isHorizontal)return null;switch(this.eventLayout){case"stack":return this.layouts.horizontalStack;case"pack":return this.layouts.horizontalPack;default:return null}}},{key:"useInitialAnimation",get:function(){return this._useInitialAnimation},set:function(e){var t=this;t._useInitialAnimation&&t.element.classList.remove("b-initial-".concat(t._useInitialAnimation)),t._useInitialAnimation=!0===e?"fade-in":e,e&&t.element.classList.add("b-initial-".concat(t._useInitialAnimation))}},{key:"isFirstRender",set:function(e){var t=this;t._isFirstRender=e,!t._firstRenderDone&&e&&(t._firstRenderDone=t.createOnFrame((function(){t._isFirstRender=!1,t._firstRenderDone=null})))},get:function(){return this._isFirstRender}},{key:"horizontalEventSorterFn",set:function(e){this._horizontalEventSorterFn=e?function(t,n){return e(t.event,n.event)}:e,this.rendered&&this.refreshWithTransition()},get:function(){return this._horizontalEventSorterFn}},{key:"resourceColumns",set:function(e){this._resourceColumns=e},get:function(){return this.timeAxisColumn&&this.timeAxisColumn.resourceColumns||this._resourceColumns}},{key:"resourceColumnWidth",get:function(){return this.resourceColumns?this.resourceColumns.columnWidth:null}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{eventRenderer:null,eventRendererThisObj:null,eventPrefix:"",eventLayout:"stack",horizontalLayoutPackClass:ym,horizontalLayoutStackClass:hm,horizontalEventSorterFn:null,eventBarTextField:"name",eventBodyTemplate:null,eventPositionMode:"translate",eventScrollMode:"move",fillTicks:!1,useInitialAnimation:!0,resourceColumns:null,resourceImagePath:null,defaultResourceImageName:"none.png",resourceImageExtension:".jpg",resourceMargin:null,isFirstRender:!0}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Dm()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"getScheduleRegion",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.currentOrientation.getScheduleRegion(e,t,n)}},{key:"getResourceRegion",value:function(e,t,n){return this.currentOrientation.getRowRegion(e,t,n)}},{key:"getResourceEventBox",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.currentOrientation.getResourceEventBox(e.id,t.id);if(i)return i;var o,a,s,l,c,u,d,f,h=r.timeAxis.startDate,g=r.timeAxis.endDate,v=e.startDate,p=e.endDate,y=null;if(v&&p&&(n||ft.intersectSpans(v,p,h,g))&&this.isRowVisible(t)){if(r.getRowFor(t))r.managedEventSizing?(o=r.currentEventLayout,a=r.eventStore.getEventsForResource(t).reduce((function(e,i){var o=r[r.mode].getTimeSpanRenderData(i,t,n);return o&&e.push(o),e}),[]),o&&o.applyLayout(a,t),(s=a.find((function(t){return t.event==e})))&&(l=r.getRecordCoords(t,!0).y,y={layout:!0,start:s.hasOwnProperty("left")?s.left:s.right,end:(s.hasOwnProperty("left")?s.left:s.right)+s.width,top:l+s.top,bottom:l+s.top+s.height})):(c=r.getElementsFromEventRecord(e,e!==t&&t)).length&&(d=(u=c[0]).getOffsetsTo(r.getEl()),f=u.getBox(),y={layout:!0,start:d[0],end:d[0]+f.width,top:d[1],bottom:d[1]+f.height});else{y={layout:!1,start:r.getCoordinateFromDate(Math.max(e.startDateMS,r.timeAxis.startMS)),end:r.getCoordinateFromDate(Math.min(e.endDateMS,r.timeAxis.endMS))};var m=r.rowManager.getRecordCoords(t,!0);y.top=m.y+r.barMargin,y.height=Math.max(r.rowManager.rowHeight-2*r.barMargin,1),y.bottom=y.top+y.height}y&&(y=r.adjustItemBox(e,y))}return y}},{key:"getItemBox",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.resources.map((function(r){return t.getResourceEventBox(e,r,n)}))}},{key:"adjustItemBox",value:function(e,t){var n=this.timeAxis.startMS,r=this.timeAxis.endMS,i=e.startDateMS,o=e.endDateMS,a=this.timeAxisViewModel.totalSize;return n>i&&(t.start=-40),n>o&&(t.end=-40),r<i&&(t.start=a+40),r<o&&(t.end=a+40),t}},{key:"widgetClass",get:function(){}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Am()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"afterConstruct",value:function(){se()(J()(r.prototype),"afterConstruct",this).call(this),this.navigator.on({navigate:"onEventNavigate",thisObj:this})}},{key:"isEventSelected",value:function(e){return this.selectedCollection.includes(e)}},{key:"selectEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isEventSelected(e)||(t?this.selectedCollection.add(e):this.selectedEvents=e)}},{key:"deselectEvent",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isEventSelected(e)&&this.selectedCollection.remove(e)}},{key:"selectEvents",value:function(e){this.selectedCollection.add(e)}},{key:"deselectEvents",value:function(e){this.selectedCollection.remove(e)}},{key:"clearEventSelection",value:function(){this.selectedEvents=[]}},{key:"onSelectedCollectionChange",value:function(e){var t=e.added,n=e.removed,r=this,i=r.selectedEvents,o=t||[],a=n||[];function s(e,t){var n=e.isTask?e:e.resource,i=e.isAssignment?e.event:e;if(i){var o=r.getElementFromEventRecord(i,n);r.currentOrientation.toggleCls(i,n,r.eventSelectedCls,t),e.isAssignment&&r.getElementsFromEventRecord(i).forEach((function(e){e!==o&&e.classList[t?"add":"remove"](r.eventAssignHighlightCls)}))}}o.forEach((function(e){return s(e,!0)})),a.forEach((function(e){return s(e,!1)})),r.silent||r.trigger("eventSelectionChange",{action:i.length>0?o.length>0&&a.length>0?"update":o.length>0?"select":"deselect":"clear",selection:i,selected:o,deselected:a})}},{key:"onInternalEventStoreChange",value:function(e){var t=e.action,n=e.records,i=e.source;se()(J()(r.prototype),"onInternalEventStoreChange",this).apply(this,arguments);var o=this;o.silent=!o.triggerSelectionChangeOnRemove,"remove"===t?o.deselectEvents(n):"dataset"===t&&(o.maintainSelectionOnDatasetChange?o.selectedEvents=o.selectedEvents.filter((function(e){return i.includes(e)})):o.clearEventSelection()),o.silent=!1}},{key:"onAssignmentRemove",value:function(e){var t=e.records;se()(J()(r.prototype),"onAssignmentRemove",this).apply(this,arguments);var n=this;n.silent=!n.triggerSelectionChangeOnRemove,n.deselectEvents(t),n.silent=!1}},{key:"onEventSelectionClick",value:function(e,t){var n=this;n.isEventSelected(t)?e.ctrlKey&&n.deselectEvent(t,n.multiEventSelect):n.selectEvent(t,e.ctrlKey&&n.multiEventSelect)}},{key:"onEventNavigate",value:function(e){var t=e.event,n=e.item;if(!this.eventSelectionDisabled){var r=this,i=n&&(1===n.nodeType?r.assignmentStore?r.resolveAssignmentRecord(n):r.resolveEventRecord(n):n);i?r.onEventSelectionClick(t,i):r.clearEventSelection()}}},{key:"selectedCollection",set:function(e){e instanceof Sr||(e=new Sr(e)),this._selectedCollection=e,e.on({change:"onSelectedCollectionChange",thisObj:this})},get:function(){return this._selectedCollection}},{key:"selectedEvents",get:function(){return this.selectedCollection.values},set:function(e){this.selectedCollection.splice(0,this.selectedCollection.count,e||[])}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{multiEventSelect:!1,eventSelectionDisabled:!1,eventSelectedCls:"b-sch-event-selected",triggerSelectionChangeOnRemove:!1,maintainSelectionOnDatasetChange:!0,eventAssignHighlightCls:"b-sch-event-assign-selected",selectedCollection:{}}}}]),r}(e||G)}),(function(e){return function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Im()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e){var t=this;t.isInTimeAxis=t.isInTimeAxis.bind(t),se()(J()(r.prototype),"construct",this).call(this,e);var n=t.onDeleteKey=t.throttle(t.onDeleteKey,t.onDeleteKeyBuffer,t),i=mt.merge({ownerCmp:t,target:t.timeAxisSubGridElement,processEvent:t.processEvent,itemSelector:".".concat(t.eventCls,"-wrap"),focusCls:t.focusCls,navigatePrevious:t.throttle(t.navigatePrevious,t.navigatePreviousBuffer,t,null,Om),navigateNext:t.throttle(t.navigateNext,t.navigateNextBuffer,t,null,Om),allowCtrlKey:!0,scrollSilently:!0,keys:{Space:"onEventSpaceKey",Enter:"onEventEnterKey",Delete:n,Backspace:n}},t.navigator);t.navigator=new Da(i)}},{key:"doDestroy",value:function(){this.navigator.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"isInTimeAxis",value:function(e){return!e.instanceMeta(this).excluded&&this.timeAxis.isTimeSpanInAxis(e)}},{key:"accessibleFocusCell",value:function(e,t){if((e=this.normalizeCellContext(e)).columnId!==this.timeAxisColumn.id)return se()(J()(r.prototype),"focusCell",this).call(this,e,t)}},{key:"getPrevious",value:function(e,t){var n=this,r=n.resourceStore,i=e.isAssignment;if(e.isTask)return n.eventStore.getAt(n.eventStore.indexOf(e)-1);var o=e.resource||n.eventStore.getResourcesForEvent(e)[0],a=o.getEvents().filter(n.isInTimeAxis).sort(Fm),s=i?e.event:e,l=a[a.indexOf(s)-1];if(!l)for(var c=r.indexOf(o)-1;(!l||t&&l===s)&&c>=0;c--){var u=(o=r.getAt(c)).getEvents().filter(n.isInTimeAxis).sort(Fm);l=u.length&&u[u.length-1]}return i?n.assignmentStore.getAssignmentForEventAndResource(l,o):l}},{key:"navigatePrevious",value:function(e){var t=this.getPrevious(e.assignmentRecord||e.eventRecord);e.preventDefault(),t&&(e.ctrlKey||this.clearEventSelection(),this.navigateTo(t,e))}},{key:"getNext",value:function(e,t){var n=this,r=n.resourceStore,i=e.isAssignment;if(e.isTask)return n.eventStore.getAt(n.eventStore.indexOf(e)+1);var o=i?e.resource:e.resources[0],a=o.getEvents().filter(n.isInTimeAxis).sort(Fm),s=i?e.event:e,l=a[a.indexOf(s)+1];if(!l)for(var c=r.indexOf(o)+1;(!l||t&&l===s)&&c<r.count;c++)l=(o=r.getAt(c)).getEvents().filter(n.isInTimeAxis).sort(Fm)[0];return i?n.assignmentStore.getAssignmentForEventAndResource(l,o):l}},{key:"navigateNext",value:function(e){var t=this.getNext(e.assignmentRecord||e.eventRecord);e.preventDefault(),t&&(e.ctrlKey||this.clearEventSelection(),this.navigateTo(t,e))}},{key:"navigateTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;if(e){n.navigator.disabled=!0;var r=e.resource;n.scrollResourceEventIntoView(r,e.isAssignment?e.event:e,null,{animate:100}).then((function(){n.isDestroyed||(n.navigator.disabled=!1,n.activeEvent=e,n.navigator.trigger("navigate",{event:t,item:on.up(n.getElementFromEventRecord(e,r),n.navigator.itemSelector)}))}))}}},{key:"processEvent",value:function(e){var t=this,n=on.up(e.target,t.eventSelector);return!t.navigator.disabled&&n&&(e.assignmentRecord=t.resolveAssignmentRecord(n),e.eventRecord=t.resolveEventRecord(n),e.resourceRecord=t.resolveResourceRecord(n)),e}},{key:"onDeleteKey",value:function(e){var t=e.assignmentRecord||e.eventRecord;!this.readOnly&&this.enableDeleteKey&&t&&this.removeRecords([t])}},{key:"removeRecords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.readOnly&&e.length){var n={finalize:function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&t(n),!1!==n&&e.forEach((function(e){return e.remove()}))}};if(!1!==this.trigger("beforeEventDelete",{eventRecords:e,context:n}))return n.finalize(),!0}return!1}},{key:"onEventSpaceKey",value:function(e){}},{key:"onEventEnterKey",value:function(e){}},{key:"activeEvent",set:function(e){var t=this.getElementFromEventRecord(e.isAssignment?e.event:e,e.resource);this.navigator.activeItem=t.parentNode},get:function(){var e=this.navigator.activeItem;if(e)return this.resolveEventRecord(e)}},{key:"previousActiveEvent",get:function(){var e=this.navigator.previousActiveItem;if(e)return this.resolveEventRecord(e)}},{key:"isActionableLocation",get:function(){if(!this.navigator.activeItem)return se()(J()(r.prototype),"isActionableLocation",this)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{navigator:null,focusCls:"b-active",enableDeleteKey:!0,onDeleteKeyBuffer:500,navigatePreviousBuffer:200,navigateNextBuffer:200,testConfig:{onDeleteKeyBuffer:1}}}}]),r}(or(e||G))})));function vb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}gb.localeClass="Scheduler",gb._$name="SchedulerBase",ye.register("schedulerbase",gb);var pb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(vb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,t),this.scheduler=e}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.scheduler,i=n.processItems,o=r.timeAxis,a={magnitude:o.shiftIncrement,unit:o.shiftUnit};"timeAxis"===e.type&&(t.push({text:n.L("pickZoomLevel"),icon:"b-fw-icon b-icon-search-plus",disabled:!r.presets.count||n.disabled,menu:{type:"popup",items:[{type:"slider",showValue:!1,listeners:{input:n.onZoomSliderChange,thisObj:n},minWidth:130}],onBeforeShow:function(e){var t=e.source,n=te()(t.items,1)[0];n.min=r.minZoomLevel,n.max=r.maxZoomLevel,n.value=r.zoomLevel}}}),n.startDateField=new as({label:n.L("startText"),labelWidth:"6em",required:!0,step:a,listeners:{change:n.onRangeDateFieldChange,thisObj:n}}),n.endDateField=new as({label:n.L("endText"),labelWidth:"6em",required:!0,step:a,listeners:{change:n.onRangeDateFieldChange,thisObj:n}}),t.push({text:n.L("activeDateRange"),icon:"b-fw-icon b-icon-calendar",disabled:n.disabled,menu:{type:"popup",width:"20em",items:[n.startDateField,n.endDateField,{type:"button",cls:"b-left-nav-btn",icon:"b-icon b-icon-prev",color:"b-blue b-raised",flex:1,margin:0,listeners:{click:n.onLeftShiftBtnClick,thisObj:n}},{type:"button",cls:"b-today-nav-btn",color:"b-blue b-raised",text:n.L("todayText"),flex:4,margin:"0 8",listeners:{click:n.onTodayBtnClick,thisObj:n}},{type:"button",cls:"b-right-nav-btn",icon:"b-icon b-icon-next",color:"b-blue b-raised",flex:1,listeners:{click:n.onRightShiftBtnClick,thisObj:n}}],onBeforeShow:function(){return n.initDates()}}}),n.extraItems&&t.push.apply(t,n.extraItems),i&&i({items:t}))}},{key:"onZoomSliderChange",value:function(e){var t=e.value,n=this.client.features.contextMenu.currentMenu;n.scrollAction="realign",this.scheduler.zoomLevel=t,n.setTimeout({fn:function(){return n.scrollAction="hide"},delay:100,cancelOutstanding:!0})}},{key:"initDates",value:function(){var e=this;e.startDateField.suspendEvents(),e.endDateField.suspendEvents(),e.startDateField.value=e.startDateFieldInitialValue=e.scheduler.startDate,e.endDateField.value=e.endDateFieldInitialValue=e.scheduler.endDate,e.startDateField.resumeEvents(),e.endDateField.resumeEvents()}},{key:"onRangeDateFieldChange",value:function(e){var t=this,n=e.source===t.startDateField,r=t.client,i=r.timeResolution,o=r.timeAxisSubGrid.scrollable,a=t.startDateFieldInitialValue&&!n?t.startDateFieldInitialValue:t.startDateField.value,s=r.getDateFromX(o.x),l=t.endDateFieldInitialValue&&n?t.endDateFieldInitialValue:t.endDateField.value;n?t.startDateFieldInitialValue=null:t.endDateFieldInitialValue=null,l-a?l<a&&(l=ft.add(a,i.increment,i.unit)):l=ft.add(l,i.increment,i.unit),t.scheduler.timeAxis.setTimeSpan(a,l),o.x=r.getCoordinateFromDate(s,!0),t.initDates()}},{key:"onLeftShiftBtnClick",value:function(){this.scheduler.timeAxis.shiftPrevious(),this.initDates()}},{key:"onTodayBtnClick",value:function(){var e=ft.clearTime(new Date);this.scheduler.timeAxis.setTimeSpan(e,ft.add(e,1,"day")),this.initDates()}},{key:"onRightShiftBtnClick",value:function(){this.scheduler.timeAxis.shiftNext(),this.initDates()}}],[{key:"$name",get:function(){return"HeaderContextMenu"}},{key:"defaultConfig",get:function(){return{extraItems:null,processItems:null}}},{key:"pluginConfig",get:function(){return{chain:["getHeaderMenuItems"]}}}]),r}(ho);function yb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}pb.featureClass="",pb._$name="HeaderContextMenu",bd.registerFeature(pb,!0,["Scheduler","Gantt"]);var mb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(yb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,t),this.scheduler=e}},{key:"showEventContextMenu",value:function(e){var t=this.scheduler,n=t.getEventData(e),r=n?t.columns.getById(n.columnId)===t.timeAxisColumn:t.timeAxisSubGrid.element===e.target,i=t.resolveResourceRecord(e)||t.resourceStore.last;!r||i&&i.meta.specialRow||(this.showContextMenu({menuType:"schedule",date:t.getDateFromDomEvent(e,"floor"),resourceRecord:i,event:e}),e.preventDefault())}},{key:"namedItems",get:function(){var e=this.client;return this._namedItems||(this._namedItems={addEvent:{text:e.L("Add event",null),icon:"b-icon b-icon-add",disabled:0===e.resourceStore.count,weight:100,onItem:function(t){var n=t.date,r=t.resourceRecord;e.internalAddEvent(n,r,e.getRowFor(r))}}}),this._namedItems}}],[{key:"$name",get:function(){return"ScheduleContextMenu"}},{key:"defaultConfig",get:function(){return{items:null,processItems:null,defaultItems:{addEvent:!0}}}}]),r}(Op);function bb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}mb.featureClass="",mb._$name="ScheduleContextMenu",bd.registerFeature(mb,!0,"Scheduler");var kb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(bb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"render",value:function(){var e,t=this,n=t.client;t.hoverTip&&t.hoverTip.destroy();var r=t.hoverTip=new Ui({id:"".concat(n.id,"-schedule-tip"),cls:"b-sch-scheduletip",allowOver:!0,hoverDelay:0,hideDelay:100,showOnHover:!0,forElement:n.timeAxisSubGridElement,anchorToTarget:!1,trackMouse:!0,updateContentOnMouseMove:!0,forSelector:".b-schedulerbase:not(.b-animating):not(.b-dragging-event):not(.b-dragcreating) .b-grid-body-container:not(.b-scrolling) .b-timeline-subgrid:not(.b-scrolling) > :not(.b-sch-foreground-canvas):not(.b-group-footer):not(.b-group-row) *",constrainTo:null,getHtml:t.getHoverTipHtml.bind(t),onDocumentMouseDown:function(t){r.forElement.contains(t.event.target)&&(e=Kn.on({element:n.timeAxisSubGridElement,mousemove:function(e){return r.internalOnPointerOver(e)},capture:!0}));var i=r.hideAnimation;r.hideAnimation=!1,r.constructor.prototype.onDocumentMouseDown.call(r,t),r.hideAnimation=i},listeners:{pointerover:function(r){var i=r.event,o="buttons"in i?i.buttons>0:i.which>0;return!o&&e&&e(),!t.disabled&&!n.readOnly&&!o}}});t.clockTemplate=new Hp({scheduler:n})}},{key:"doDestroy",value:function(){this.destroyProperties("clockTemplate","hoverTip"),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"getHoverTipHtml",value:function(e){var t=e.tip,n=e.event,r=this,i=r.client,o=n&&i.getDateFromDomEvent(n,"floor",!0),a=r.lastHtml;if(o){var s=i.resolveResourceRecord(n);o-r.lastTime==0&&s===r.lastResource||(r.lastResource=s,a=r.lastHtml=r.generateTipContent(o,n))}else t.hide(),r.lastTime=null,r.lastResource=null;return a}},{key:"generateTipContent",value:function(e,t){var n=this,r=n.clockTemplate.generateContent({date:e,text:n.client.getFormattedDate(e)}),i=n.messageTemplate({message:n.getText(e,t)||""});return n.lastTime=e,r+i}},{key:"getText",value:function(e,t){}}],[{key:"$name",get:function(){return"ScheduleTooltip"}},{key:"defaultConfig",get:function(){return{messageTemplate:function(e){return'<div class="b-sch-hovertip-msg">'.concat(e.message,"</div>")}}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),r}(ho);function wb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}kb.featureClass="b-scheduletip",kb._$name="ScheduleTooltip",bd.registerFeature(kb,!0,"Scheduler");var Sb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(wb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"$name",get:function(){return"Scheduler"}}]),r}(gb);function Cb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Sb._$name="Scheduler",ye.register("scheduler",Sb),j.setVersion("scheduler","3.1.2");var Rb={add:1,remove:1,update:1,removeAll:1,filter:1},xb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Cb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;if(e.isVertical)throw new Error("GroupSummary feature is not supported in vertical mode");n.scheduler=e,se()(J()(r.prototype),"construct",this).call(this,e,t),!n.summaries&&n.renderer&&(n.summaries=[{renderer:n.renderer}]),n.isScheduler=e instanceof Sb,n.isScheduler&&(e.eventStore.on({change:n.onEventStoreChange,thisObj:n}),e.timeAxis.on({reconfigure:n.onTimeAxisChange,thisObj:n}),e.timeAxisViewModel.on({update:n.onTimeAxisChange,thisObj:n}))}},{key:"doDestroy",value:function(){this._tip&&this._tip.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"onTimeAxisChange",value:function(){this.rerenderGroupSummaries()}},{key:"onEventStoreChange",value:function(e){var t=e.action;Rb[t]&&this.rerenderGroupSummaries()}},{key:"rerenderGroupSummaries",value:function(){this.scheduler.rowManager.rows.forEach((function(e){e.isGroupFooter&&e.render()}))}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,n=e.record;if(t.isGroupFooter&&!n.meta.hasOwnProperty("groupFooterFor")){var i=t.elements.normal.querySelector(".b-sch-timeaxis-cell");i&&(i.innerHTML="")}se()(J()(r.prototype),"onBeforeRenderRow",this).apply(this,arguments)}},{key:"generateHtml",value:function(e,t,n){if("timeAxis"===e.type){var i=this,o=i.scheduler,a=o.tickSize,s="";return o.timeAxis.forEach((function(e){var n=o.eventStore.getEventsInTimeSpan(e.startDate,e.endDate,!0,!0).filter((function(e){return e.resources.some((function(e){return t.includes(e)}))})),r=i.summaries.map((function(t){var r=t.renderer({startDate:e.startDate,endDate:e.endDate,eventStore:o.eventStore,resourceStore:o.resourceStore,events:n});return'<div class="b-timeaxis-summary-value">'.concat(r,"</div>")})).join("");s+='<div class="b-timeaxis-tick" style="width: '.concat(a,'px">').concat(r,"</div>")})),'<div class="b-timeaxis-group-summary">'.concat(s,"</div>")}return se()(J()(r.prototype),"generateHtml",this).call(this,e,t,n)}},{key:"updateSummaryHtml",value:function(e,t,n){var i=se()(J()(r.prototype),"updateSummaryHtml",this).call(this,e,t,n);if("timeAxis"===t.type){var o={count:0,height:0};return this.summaries.forEach((function(e){e.height?o.height+=e.height:o.count++})),o}return i}},{key:"getTipHtml",value:function(e){var t=e.activeTarget,n=this,r=Array.from(t.parentElement.children).indexOf(t),i=n.scheduler.timeAxis.getAt(r),o="<header>".concat(n.L("Summary for")," ").concat(n.scheduler.getFormattedDate(i.startDate),"</header>"),a=!1;return on.forEachSelector(t,".b-timeaxis-summary-value",(function(e,t){var r=n._labels[t],i=e.innerText.trim();o+="<label>".concat(r||"",'</label><div class="b-timeaxis-summary-value">').concat(i,"</div>"),e.innerHTML&&(a=!0)})),a?o:null}},{key:"render",value:function(){var e=this,t=e.scheduler;e.isScheduler&&e.summaries&&e.summaries.some((function(e){return e.label}))&&e.showTooltip&&!e._tip&&(e._labels=e.summaries.map((function(e){return e.label||""})),e._tip=new Ui({id:"".concat(t.id,"-groupsummary-tip"),cls:"b-timeaxis-summary-tip",hoverDelay:0,hideDelay:0,forElement:t.timeAxisSubGridElement,anchorToTarget:!0,forSelector:".b-timeaxis-group-summary .b-timeaxis-tick",clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],getHtml:e.getTipHtml.bind(e)}))}}],[{key:"$name",get:function(){return"GroupSummary"}},{key:"defaultConfig",get:function(){return{showTooltip:!0,summaries:null,renderer:null}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),r}(Vy);function Eb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}xb._$name="GroupSummary",xb._$name="GroupSummary",bd.registerFeature(xb,!1,"Scheduler");var Db=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Eb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;if(!e.touches&&0===e.button&&!t.disabled&&e.target.matches(".b-sch-header-timeaxis-cell")){var r=n.subGrids.normal.header.headersElement;t.startX=e.clientX,t.element=on.createElement({parent:r,tag:"div",className:"b-headerzoom-rect"}),t.headerElementRect=In.from(r)}}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||Re.isSafari||Re.isIE11&&!e.isTrusted){if("number"==typeof t.startX){var n=Math.max(e.clientX,t.headerElementRect.left),r=Math.min(t.startX,n),i=Math.abs(t.startX-n),o=new In(r-t.headerElementRect.x+t.client.scrollLeft,0,i,t.headerElementRect.height);on.setTranslateX(t.element,o.left),t.element.style.width=o.width+"px"}}else t.onElementMouseUp(e)}},{key:"onElementMouseUp",value:function(e){var t=this;if("number"==typeof t.startX){var n=t.client,r=In.from(t.element),i=n.getDateFromCoordinate(r.left,"round",!1),o=n.getDateFromCoordinate(r.right,"round",!1);t.element&&t.element.remove(),t.startX=null,t.client.zoomToSpan({startDate:i,endDate:o})}}}],[{key:"$name",get:function(){return"HeaderZoom"}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),r}(ho);function Tb(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Mb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mb(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Mb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ab(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Db._$name="HeaderZoom",bd.registerFeature(Db,!1,"Scheduler");var Ib=["top","left","right","bottom"],Fb={top:"b-b",right:"l-l",bottom:"t-t",left:"r-r"},Ob={top:1,bottom:1},_b=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Ab()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;if(e.isVertical)throw new Error("Labels feature is not supported in vertical mode");n.scheduler=e,n.labelElements={},se()(J()(r.prototype),"construct",this).call(this,e,t);var i=n.top,o=n.bottom,a=n.left,s=n.right;(i||o||a||s)&&(n.schedulerDetatcher=e.on({eventpaint:"onEventPaint",eventrepaint:"onEventPaint",thisObj:n}),n.updateHostClasslist())}},{key:"updateHostClasslist",value:function(){var e=this.top,t=this.bottom,n=this.scheduler.element.classList;n.remove("b-labels-topbottom"),n.remove("b-labels-top"),n.remove("b-labels-bottom"),(e||t)&&(n.add("b-labels-topbottom"),e&&n.add("b-labels-top"),t&&n.add("b-labels-bottom"))}},{key:"onLabelDblClick",value:function(e){var t=e.target;if(t&&!this.scheduler.readOnly){var n=t.dataset.side,r=this[n],i=r.editor,o=r.field;r.recordType;if(i){var a=this.scheduler.resolveEventRecord(e.target);return i instanceof ts||(r.editor=new ts({appendTo:this.scheduler.element,blurAction:this.blurAction,inputField:i,scrollAction:"realign"})),r.editor.startEdit({target:t,align:Fb[n],matchSize:!1,record:a,field:o}),e.stopImmediatePropagation(),!1}}}},{key:"processLabelSpec",value:function(e,t){if("function"==typeof e)e={renderer:e};else if("string"==typeof e)e={field:e};else{if(!e)return;e=Object.setPrototypeOf({},e)}var n,r=this.scheduler,i=r.eventStore,o=r.resourceStore,a=r.taskStore,s=(r.id,e),l=s.field,c=s.editor;(Ob[t]&&(r.milestoneWidth=null),l)&&(i&&!a&&((n=i.modelClass.fieldMap[l])?(e.fieldDef=n,e.recordType="event"):Reflect.has(i.modelClass.prototype,l)&&(e.recordType="event")),!n&&a&&((n=a.modelClass.fieldMap[l])?(e.fieldDef=n,e.recordType="task"):Reflect.has(o.modelClass.prototype,l)&&(e.recordType="task")),!n&&o&&((n=o.modelClass.fieldMap[l])?(e.fieldDef=n,e.recordType="resource"):Reflect.has(o.modelClass.prototype,l)&&(e.recordType="resource")),c&&("boolean"==typeof c?r.editor={type:"textfield"}:"string"==typeof c&&(r.editor={type:c}),Kn.on({element:r.timeAxisSubGrid.element,delegate:".b-sch-label",dblclick:"onLabelDblClick",thisObj:this})));return e}},{key:"doDestroy",value:function(){this.schedulerDetatcher&&this.schedulerDetatcher(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){se()(J()(r.prototype),"doDisable",this).call(this,e),this.client.isPainted&&this.client.refresh()}},{key:"onEventPaint",value:function(e){if(on.removeEachSelector(e.element,".b-sch-label"),!this.disabled){var t,n=Tb(Ib);try{for(n.s();!(t=n.n()).done;){var r=t.value;this[r]&&this.appendLabel(r,e.element,e)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"appendLabel",value:function(e,t,n){this.labelElements[e]=on.createElement({tag:"label",dataset:{side:e},parent:t}),this.updateLabel(e,n)}},{key:"updateLabel",value:function(e,t){var n,r=this,i=r[e],o=i.field,a=i.fieldDef,s=i.recordType,l=i.renderer,c=i.thisObj,u=r.labelElements[e];u.className="".concat(r.labelCls," ").concat(r.labelCls,"-").concat(e),l?n=l.call(c||r.thisObj||r,Object.assign({labelElement:u},t)):(n=t["".concat(s,"Record")][o],a&&"date"===a.type&&!l&&(n=ft.format(n,r.scheduler.displayDateFormat))),u.innerHTML=n||""}},{key:"top",set:function(e){this._top=this.processLabelSpec(e,"top"),this.updateHostClasslist()},get:function(){return this._top}},{key:"right",set:function(e){this._right=this.processLabelSpec(e,"right"),this.updateHostClasslist()},get:function(){return this._right}},{key:"bottom",set:function(e){this._bottom=this.processLabelSpec(e,"bottom"),this.updateHostClasslist()},get:function(){return this._bottom}},{key:"left",set:function(e){this._left=this.processLabelSpec(e,"left"),this.updateHostClasslist()},get:function(){return this._left}}],[{key:"$name",get:function(){return"Labels"}},{key:"defaultConfig",get:function(){return{labelCls:"b-sch-label",top:null,right:null,bottom:null,left:null,thisObj:null,blurAction:"cancel"}}},{key:"pluginConfig",get:function(){return{}}}]),r}(ho);_b.featureClass="b-sch-labels",_b._$name="Labels",bd.registerFeature(_b,!1,"Scheduler");n(275);function Pb(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Lb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lb(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Lb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Hb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var jb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Hb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;se()(J()(r.prototype),"construct",this).call(this,e,t),n.cls=n.cls||"b-timerange-".concat(n.constructor.$name),n.baseSelector=".".concat(n.baseCls,".").concat(n.cls),n.enableResizing&&(n.showHeaderElements=!0)}},{key:"doDestroy",value:function(){var e=this;e.storeDetacher&&e.storeDetacher(),e.timeAxisViewModelDetacher&&e.timeAxisViewModelDetacher(),e.timeAxisDetacher&&e.timeAxisDetacher(),e.clockTemplate&&e.clockTemplate.destroy(),e.tip&&e.tip.destroy(),e.drag&&e.drag.destroy(),e.resize&&e.resize.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.client.isPainted&&this.renderRanges(),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"onPaint",value:function(){var e=this;e.isPainted||(e.timeAxisViewModel=e.client.timeAxisViewModel,e.timeAxisViewModelDetacher=e.timeAxisViewModel.on({reconfigure:e.onTimeAxisViewModelUpdate,update:e.onTimeAxisViewModelUpdate,thisObj:e}),e.timeAxisDetacher=e.client.timeAxis.on({includeChange:e.onTimeAxisViewModelUpdate,thisObj:e}),e.enableResizing&&!e.client.hideHeaders&&(e.drag=new Tc({name:"rangeDrag",mode:e.client.isVertical?"translateY":"translateX",constrain:!0,outerElement:e.headerContainerElement,targetSelector:"".concat(e.baseSelector),isElementDraggable:function(t,n){return!e.client.readOnly&&e.isElementDraggable(t,n)},transitionDuration:e.client.transitionDuration,listeners:{dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,abort:e.onInvalidDrop,thisObj:e}}),e.resize=new jc({direction:e.client.mode,targetSelector:"".concat(e.baseSelector,".b-sch-range"),outerElement:e.headerContainerElement,isElementResizable:function(e){return!e.closest(".b-dragging")},listeners:{resizestart:e.onResizeStart,resizing:e.onResizeDrag,resize:e.onResize,cancel:e.onInvalidResize,thisObj:e}})),e.renderRanges())}},{key:"renderRanges",value:function(){var e=this,t=e.client.foregroundCanvas;if(t){var n=e.headerContainerElement,r=e.store;if(on.removeEachSelector(t,e.baseSelector),n&&on.removeEachSelector(n,e.baseSelector),!e.disabled){var i,o=Pb(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;e.renderRange(a,!0)}}catch(e){o.e(e)}finally{o.f()}}}}},{key:"renderRange",value:function(e,t){var n=this,r=n.client;if(e.duration&&r.timeAxis.timeSpanInAxis(e.startDate,e.endDate)||e.startDate&&r.timeAxis.dateInAxis(e.startDate)){var i,o=r.getCoordinateFromDate(ft.max(e.startDate,r.timeAxis.startDate),{respectExclusion:!0}),a=e.duration&&r.getCoordinateFromDate(ft.min(e.endDate,r.timeAxis.endDate),{respectExclusion:!0,isEnd:!0}),s="<label>".concat(e.name||"&nbsp;","</label>"),l={className:"".concat(n.baseCls," ").concat(n.cls," ").concat(a?n.rangeCls:n.lineCls," ").concat(e.cls||""),dataset:{id:e.id},style:r.isVertical?"transform: translateY(".concat(o,"px); ").concat(a?"height:".concat(a-o,"px"):"",";"):"transform: translateX(".concat(o,"px); ").concat(a?"width:".concat(a-o,"px"):"",";"),retainElement:!0},c=on.createElement(Object.assign({},l,{parent:t&&r.foregroundCanvas,style:l.style+(e.style||""),html:n.showHeaderElements?"":s}));n.showHeaderElements&&(i=on.createElement(Object.assign({parent:t&&n.headerContainerElement,html:e.name?s:""},l)));var u={bodyElement:c,headerElement:i};return t&&n.rotateLabel(u),u}}},{key:"rotateLabel",value:function(e){var t=e.bodyElement,n=t.firstChild;if(n){n.classList.remove("b-vertical");var r=this.client.isVertical?n.offsetHeight<t.offsetHeight:n.offsetWidth>t.offsetWidth;n.classList[r?"add":"remove"]("b-vertical")}}},{key:"getElementsByRecord",value:function(e){var t="object"!==re()(e)?e:e.id,n=this.client.foregroundCanvas.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]')),r=this.headerContainerElement.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]'));return n?{bodyElement:n,headerElement:r}:null}},{key:"getBodyElementByRecord",value:function(e){var t="string"==typeof e?e:e.id;return this.client.foregroundCanvas.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]'))}},{key:"getRecordByElement",value:function(e){return this.store.getById(e.dataset.id)}},{key:"getHeaderMenuItems",value:function(e,t){return[]}},{key:"onTimeAxisViewModelUpdate",value:function(){this.renderRanges()}},{key:"onStoreChanged",value:function(e){var t=this;if(!(t.isConfiguring||"refresh"===e.type&&"batch"!==e.action))if("update"===e.action){var n=e.changes.hasOwnProperty("id")?e.changes.id.oldValue:e.record.id,r=t.getElementsByRecord(n),i=t.renderRange(e.record,!r);if(r&&!i&&(r.bodyElement.remove(),r.headerElement&&r.headerElement.remove()),!r||!i)return;t.client.runWithTransition((function(){on.sync(i.bodyElement,r.bodyElement),t.showHeaderElements&&on.sync(i.headerElement,r.headerElement),t.rotateLabel(r)}))}else t.renderRanges()}},{key:"showTip",value:function(e){var t=this;t.showTooltip&&(t.clockTemplate=new Hp({scheduler:t.client}),t.tip=new Ui({id:"".concat(t.client.id,"-time-range-tip"),cls:"b-interaction-tooltip",align:"b-t",autoShow:!0,updateContentOnMouseMove:!0,forElement:e.element,getHtml:function(){return t.getTipHtml(e.record,e.element)}}))}},{key:"isElementDraggable",value:function(e){return(e=e.closest(this.baseSelector+":not(.b-resizing)"))&&!e.classList.contains("b-over-resize-handle")}},{key:"onDragStart",value:function(e){var t=e.context,n=this,r=n.getRecordByElement(t.element.closest(n.baseSelector)),i=n.getBodyElementByRecord(r),o=n.drag;Object.assign(t,{record:r,rangeBodyEl:i,originRangeX:on.getTranslateX(i),originRangeY:on.getTranslateY(i)}),n.client.isVertical?(o.minY=0,o.maxY=n.timeAxisViewModel.totalSize-t.rangeBodyEl.offsetHeight,o.minX=0,o.maxX=Number.MAX_SAFE_INTEGER):(o.minX=0,o.maxX=n.timeAxisViewModel.totalSize-t.rangeBodyEl.offsetWidth,o.minY=0,o.maxY=Number.MAX_SAFE_INTEGER),n.client.element.classList.add("b-dragging-timerange"),n.showTip(t)}},{key:"onDrag",value:function(e){var t=e.context;this.client.isVertical?on.setTranslateY(t.rangeBodyEl,on.getTranslateY(t.element)):on.setTranslateX(t.rangeBodyEl,on.getTranslateX(t.element))}},{key:"onDrop",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this,r=t.record,i=t.rangeBodyEl.getBoundingClientRect(),o=n.client.getDateFromCoordinate(n.client.isVertical?i.top:i.left,"round",!1);r.startDate-o!=0?r.setStartDate(o):n.onInvalidDrop(),n.tip&&(n.tip.destroy(),n.tip=null),n.client.element.classList.remove("b-dragging-timerange")}},{key:"onInvalidDrop",value:function(){var e=this;e.drag.reset(),e.renderRanges(),e.client.element.classList.remove("b-dragging-timerange"),e.tip&&(e.tip.destroy(),e.tip=null)}},{key:"onResizeStart",value:function(e){var t=e.context,n=this.getRecordByElement(t.element.closest(this.baseSelector)),r=this.getBodyElementByRecord(n);Object.assign(t,{record:n,rangeBodyEl:r}),this.showTip(t)}},{key:"onResizeDrag",value:function(e){var t=e.context;this.client.isVertical?("top"===t.edge&&on.setTranslateY(t.rangeBodyEl,t.newY),t.rangeBodyEl.style.height=t.newHeight+"px"):("left"===t.edge&&on.setTranslateX(t.rangeBodyEl,t.newX),t.rangeBodyEl.style.width=t.newWidth+"px")}},{key:"onResize",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this,r=n.client,i=t.record,o=t.element.getBoundingClientRect(),a=r.isVertical?o.top:o.left,s=r.isVertical?o.bottom:o.right,l=r.getDateFromCoordinate(a,"round",!1),c="left"===t.edge||"top"===t.edge,u=r.getDateFromCoordinate(s,"round",!1);(c&&i.startDate-l!=0||u&&i.endDate-u!=0)&&u>l?c?i.setStartDate(l,!1):i.setEndDate(u,!1):n.onInvalidResize(),n.tip&&(n.tip.destroy(),n.tip=null)}},{key:"onInvalidResize",value:function(){var e=this;e.resize.reset(),e.renderRanges(),e.tip&&(e.tip.destroy(),e.tip=null)}},{key:"getTipHtml",value:function(e,t){var n=this.client,r=t.getBoundingClientRect(),i=n.isVertical?r.top:r.left,o=n.isVertical?r.bottom:r.right,a=n.getDateFromCoordinate(i,"round",!1),s=e.endDate&&n.getDateFromCoordinate(o,"round",!1),l=n.getFormattedDate(a),c=s&&n.getFormattedEndDate(s,a);return this.dragTipTemplate({name:e.name||"",startDate:a,endDate:s,startText:l,endText:c,startClockHtml:this.clockTemplate.template({date:a,text:l,cls:"b-sch-tooltip-startdate"}),endClockHtml:c&&this.clockTemplate.template({date:s,text:c,cls:"b-sch-tooltip-enddate"})})}},{key:"headerContainerElement",get:function(){var e=this.client,t=e.isVertical,n=e.timeView,r=e.timeAxisColumn,i=null;return t&&n.element?i=n.element.parentElement:t||(i=r.element),i}},{key:"showHeaderElements",get:function(){return this._showHeaderElements},set:function(e){this._showHeaderElements=e,this.client.isPainted&&(e?this.client.element.classList.add("b-sch-timeranges-with-headerelements"):this.client.element.classList.remove("b-sch-timeranges-with-headerelements"),this.renderRanges())}},{key:"store",get:function(){return this._store},set:function(e){var t=this;t._store=ga.getStore(e,ga);var n=!1;t.storeDetacher&&(t.storeDetacher(),n=!0),t.storeDetacher=t._store.on({change:t.onStoreChanged,refresh:t.onStoreChanged,thisObj:t}),n&&this.renderRanges()}}],[{key:"defaultConfig",get:function(){return{rangeCls:"b-sch-range",lineCls:"b-sch-line",store:{modelClass:zg},enableResizing:!1,showTooltip:!0,showHeaderElements:!0,dragTipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    <div class="b-sch-tip-name">').concat(e.name||"","</div>\n                    ").concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml||"","\n                </div>\n            ")},baseCls:"b-sch-timerange",cls:""}}},{key:"pluginConfig",get:function(){return{chain:["onPaint","getHeaderMenuItems"]}}}]),r}(or(ho));function Bb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}jb._$name="AbstractTimeRanges";var Nb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Bb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){se()(J()(r.prototype),"construct",this).call(this,e,t),this.calendar&&e.calendar||(this.calendar=new Wg),this.bindCalendar(this.calendar)}},{key:"doDestroy",value:function(){this.bindCalendar(null),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"bindCalendar",value:function(e){var t=this;t.calendarDetacher&&t.calendarDetacher(),e&&(t.calendarDetacher=e.on({change:t.renderRanges,thisObj:t,delay:1})),t.calendar=e,t.renderRanges()}},{key:"renderRanges",value:function(){var e=this;if(e.store&&!e.store.isDestroyed){var t=ft.as(e.client.timeAxis.unit,1,"week")>=1;e.store.removeAll(!0),e.calendar&&e.highlightWeekends&&t&&e.store.add(e.calendar.getHolidaysRanges(e.client.timeAxis.startDate,e.client.timeAxis.endDate,!0),!0)}se()(J()(r.prototype),"renderRanges",this).call(this)}}],[{key:"$name",get:function(){return"NonWorkingTime"}},{key:"defaultConfig",get:function(){return{highlightWeekends:!0,showHeaderElements:!0,cls:"b-sch-nonworkingtime"}}}]),r}(jb);function zb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Nb._$name="NonWorkingTime",bd.registerFeature(Nb,!1,"Scheduler");var Vb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(zb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){if(this.timeline=e,e.features.eventDragCreate&&!e.features.eventDragCreate.disabled)throw new Error("Cannot combine Pan and eventDragCreate features");this.targetSelector=[".b-grid-cell",".b-timeline-subgrid"].join(","),se()(J()(r.prototype),"construct",this).call(this,e,t)}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.timeline,r=Object.values(n.features).find((function(e){return e instanceof Bp})),i=n.readOnly||!r||r.disabled;e.touches||0!==e.button||t.disabled||(e.target.matches(t.targetSelector)||i&&e.target.closest(n.eventSelector))&&(t.mouseX=e.clientX,t.mouseY=e.clientY)}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||Re.isSafari||Re.isIE11&&!e.isTrusted){if("number"==typeof t.mouseX){var n=t.timeline.subGrids.normal.scrollable,r=t.timeline.scrollable,i=e.clientX,o=e.clientY;e.preventDefault(),t.vertical&&r.scrollBy(0,t.mouseY-o),n.scrollBy(t.mouseX-i),t.mouseX=i,t.mouseY=o}}else t.onElementMouseUp()}},{key:"onElementMouseUp",value:function(e){this.mouseX=this.mouseY=null}}],[{key:"$name",get:function(){return"Pan"}},{key:"defaultConfig",get:function(){return{vertical:!0}}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),r}(ho);function Wb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Vb._$name="Pan",bd.registerFeature(Vb,!1,["Scheduler","Gantt"]);var Ub=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Wb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){this.isConstructing=!0,se()(J()(r.prototype),"construct",this).call(this,e,t),this.isConstructing=!1}},{key:"afterConstruct",value:function(){this.disabled||!this.isRecurrenceSupported?this.disableRecurringTimeSpans():this.enableRecurringTimeSpans()}},{key:"enableRecurringTimeSpans",value:function(){var e=this.client,t=this.store;e&&t&&(this.bindClient(e),this.bindStore(t),this.refreshOccurrences())}},{key:"disableRecurringTimeSpans",value:function(){this.bindClient(null),this.bindStore(null),this.store&&this.removeOccurrences()}},{key:"suspendTracking",value:function(){isNaN(this._trackingSuspended)&&(this._trackingSuspended=0),this._trackingSuspended++}},{key:"resumeTracking",value:function(){isNaN(this._trackingSuspended)?this._trackingSuspended=0:this._trackingSuspended--}},{key:"bindClient",value:function(e){this.bindTimeAxis(e&&e.timeAxis)}},{key:"bindStore",value:function(e){this.detachListeners("store"),e&&e.on({name:"store",refresh:"onTimeSpansRefresh",add:"onTimeSpanAdd",update:"onTimeSpanUpdate",remove:"onTimeSpanRemove",delayedgenerateoccurrencesstart:"onGenerateOccurrencesStart",delayedgenerateoccurrencesend:"onGenerateOccurrencesEnd",delayedregenerateoccurrencesstart:"onGenerateOccurrencesStart",delayedregenerateoccurrencesend:"onGenerateOccurrencesEnd",thisObj:this})}},{key:"bindTimeAxis",value:function(e){this.detachListeners("timeAxis"),e&&e.on({name:"timeAxis",reconfigure:"onTimeAxisReconfigure",thisObj:this})}},{key:"onTimeAxisReconfigure",value:function(){this.trackingSuspended||this.refreshOccurrences()}},{key:"onGenerateOccurrencesStart",value:function(){this.suspendTracking()}},{key:"onGenerateOccurrencesEnd",value:function(){this.resumeTracking()}},{key:"refreshOccurrences",value:function(){var e=this.store,t=this.startDate,n=this.endDate;e&&t&&n&&e.generateOccurrencesForTimeSpansBuffered(e.getRecurringTimeSpans(),t,n)}},{key:"removeOccurrences",value:function(){var e=this.store;e&&e.removeOccurrencesForAll()}},{key:"onTimeSpansRefresh",value:function(e){var t=e.source,n=e.action,r=e.records;if("dataset"==n&&!this.trackingSuspended){var i=r.filter((function(e){return e.isRecurring}));i.length&&t.generateOccurrencesForTimeSpansBuffered(i,this.startDate,this.endDate)}}},{key:"onTimeSpanAdd",value:function(e){var t=e.source,n=e.records,r=e.allRecords;if(!this.trackingSuspended){var i=(r||n).filter((function(e){return e.isRecurring}));i.length&&t.generateOccurrencesForTimeSpansBuffered(i,this.startDate,this.endDate)}}},{key:"onTimeSpanUpdate",value:function(e){var t=e.source,n=e.record,r=e.changes;if(!this.trackingSuspended&&this.isRecurrenceRelatedFieldChange(n,r)){var i=this.startDate,o=this.endDate,a=n.startDate,s=n.recurrence;s?i&&o&&a&&(!s.endDate||s.endDate>=i&&a<=o)&&t.regenerateOccurrencesForTimeSpansBuffered(n,i,o):t.removeOccurrencesForTimeSpans(n)}}},{key:"onTimeSpanRemove",value:function(e){var t=e.source,n=e.allRecords,r=e.records;if(!this.trackingSuspended){var i=(n||r).filter((function(e){return e.isRecurring}));i.length&&t.removeOccurrencesForTimeSpans(i)}}},{key:"isRecurrenceRelatedFieldChange",value:function(e,t){return e.isRecurring||"recurrenceRule"in t}},{key:"disabled",get:function(){return se()(J()(r.prototype),"disabled",this)},set:function(e){ei()(J()(r.prototype),"disabled",e,this,!0);this.isConstructing||(e||!this.isRecurrenceSupported?this.disableRecurringTimeSpans():this.enableRecurringTimeSpans())}},{key:"trackingSuspended",get:function(){return Boolean(this._trackingSuspended)}},{key:"client",get:function(){return se()(J()(r.prototype),"client",this)},set:function(e){ei()(J()(r.prototype),"client",e,this,!0),this.isConstructing||this.bindClient(e)}},{key:"store",set:function(e){var t=this;e=e&&e.supportsRecurringTimeSpans?e:null,t._store=e,t.isConstructing||(t.bindStore(e),t.isRecurrenceSupported&&!t.disabled?t.enableRecurringTimeSpans():t.disableRecurringTimeSpans())},get:function(){return this._store}},{key:"isRecurrenceSupported",get:function(){var e=this.store,t=this.startDate,n=this.endDate;return Boolean(e&&e.supportsRecurringTimeSpans&&t&&n)}},{key:"timeAxis",get:function(){return this.client&&this.client.timeAxis}},{key:"startDate",get:function(){return this.timeAxis&&this.timeAxis.startDate}},{key:"endDate",get:function(){return this.timeAxis&&this.timeAxis.endDate}}],[{key:"$name",get:function(){return"RecurringTimeSpans"}},{key:"defaultConfig",get:function(){return{store:void 0}}}]),r}(ho);function Gb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Ub._$name="RecurringTimeSpans",bd.registerFeature(Ub,!1,"Scheduler");var Yb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Gb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"bindClient",value:function(e){var t=this;se()(J()(r.prototype),"bindClient",this).call(this,e),t._eventPanelDetacher&&t._eventPanelDetacher(),e&&(t._eventPanelDetacher=e.on({beforeeventdropfinalize:t.onBeforeEventDropFinalize,beforeeventresizefinalize:t.onBeforeEventResizeFinalize,beforeEventDelete:t.onRecurrableEventBeforeDelete,thisObj:t}))}},{key:"onEventStoreChange",value:function(e){var t=e.newEventStore;e.oldEventStore;this.store=t}},{key:"showDisplayConfirmationOnEventDelete",value:function(e){var t=this.client.features.eventEdit;return e.supportsRecurring&&(e.isRecurring||e.isOccurrence)&&(!t||!t.isEditing||t.eventRecord!==e)}},{key:"onRecurrableEventBeforeDelete",value:function(e){var t=e.eventRecords,n=e.context,r=te()(t,1)[0];if(this.showDisplayConfirmationOnEventDelete(r))return this.confirmationPopup.confirm({actionType:"delete",eventRecord:r,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"onBeforeEventDropFinalize",value:function(e){var t=e.context,n=t.record;n.supportsRecurring&&(n.isRecurring||n.isOccurrence)&&(t.async=!0,this.confirmationPopup.confirm({actionType:"update",eventRecord:n,changerFn:function(){t.finalize(!0)},cancelFn:function(){t.finalize(!1)}}))}},{key:"onBeforeEventResizeFinalize",value:function(e){var t=e.context,n=t.eventRecord;n.supportsRecurring&&(n.isRecurring||n.isOccurrence)&&(t.async=!0,this.confirmationPopup.confirm({actionType:"update",eventRecord:n,changerFn:function(){t.finalize(!0)},cancelFn:function(){t.finalize(!1)}}))}},{key:"client",get:function(){return se()(J()(r.prototype),"client",this)},set:function(e){ei()(J()(r.prototype),"client",e,this,!0),e&&(this._onEventStoreChangeDetacher&&this._onEventStoreChangeDetacher(),this._onEventStoreChangeDetacher=e.on("eventstorechange",this.onEventStoreChange,this)),this.store=e?e.eventStore:null}},{key:"confirmationPopup",get:function(){return this._confirmationPopup||(this._confirmationPopup=new ry),this._confirmationPopup},set:function(e){this._confirmationPopup=e}}],[{key:"$name",get:function(){return"RecurringEvents"}}]),r}(Ub);function $b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Yb._$name="RecurringEvents",bd.registerFeature(Yb,!1,"Scheduler");var qb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if($b()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"noFeatureElementsInAxis",value:function(){var e=this.scheduler.timeAxis;return!this.store.storage.values.some((function(t){return e.isTimeSpanInAxis(t)}))}},{key:"construct",value:function(e,t){var n=this;n.scheduler=e,se()(J()(r.prototype),"construct",this).call(this,e,t),Object.defineProperty(e,"resourceTimeRanges",{get:function(){return n.store.records},set:function(e){return n.store.data=e}})}},{key:"doDisable",value:function(e){this.client.isPainted&&this.client.refresh(),se()(J()(r.prototype),"doDisable",this).call(this,e)}},{key:"getEventsToRender",value:function(e,t){return e.timeRanges&&e.timeRanges.length&&!this.disabled&&t.push.apply(t,Z()(e.timeRanges)),t}},{key:"onEventDataGenerated",value:function(e){var t=this,n=e.event||e.eventRecord;n.isResourceTimeRange&&(t.scheduler.isVertical?e.width=t.scheduler.resourceColumnWidth:(e.top=0,e.id="".concat(t.scheduler.id,"-").concat(t.idPrefix,"-").concat(n.id)),e.fillSize=!0,e.wrapperCls[t.rangeCls]=1,e.wrapperCls["b-sch-color-".concat(n.timeRangeColor)]=n.timeRangeColor,e.body=document.createDocumentFragment(),e.body.textContent=n.name,e.eventId="".concat(t.idPrefix,"-").concat(n.id),e.eventContent=n.name)}},{key:"onStoreChange",value:function(e){this.scheduler.onInternalEventStoreChange(e)}},{key:"store",set:function(e){var t=this,n=t.scheduler;t._store=e=e||new $v,n.resourceTimeRangeStore||(n.resourceTimeRangeStore=e),n.resourceTimeRanges&&(e.add(n.resourceTimeRanges),delete n.resourceTimeRanges),e.resourceStore||(e.resourceStore=n.resourceStore),t.storeDetacher&&t.storeDetacher(),t.storeDetacher=t.store.on({change:t.onStoreChange,thisObj:t})},get:function(){return this._store}}],[{key:"$name",get:function(){return"ResourceTimeRanges"}},{key:"defaultConfig",get:function(){return{idPrefix:"resourcetimerange",rangeCls:"b-sch-resourcetimerange",store:!1,resourceTimeRanges:null}}},{key:"pluginConfig",get:function(){return{chain:["getEventsToRender","onEventDataGenerated","noFeatureElementsInAxis"]}}}]),r}(ho);function Xb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}qb.featureClass="",qb._$name="ResourceTimeRanges",bd.registerFeature(qb,!1,"Scheduler");var Kb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Xb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n,i=this;i.scheduler=e,i.eventStore=e.eventStore,e.eventEdit=i,se()(J()(r.prototype),"construct",this).call(this,e,t),i.clientListenersDetacher=e.on((n={},oe()(n,i.triggerEvent,(function(e){var t=e.eventRecord,n=e.eventElement;return i.editEvent(t,t.resource,n)})),oe()(n,"dragcreateend",i.onDragCreateEnd),oe()(n,"thisObj",i),n))}},{key:"doDestroy",value:function(){this.clientListenersDetacher(),this.editor&&this.editor.destroy(),se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"editEvent",value:function(e,t,n){var r=this,i=r.scheduler;i.readOnly||r.disabled||(n=on.down(n,i.eventInnerSelector)||n,e=e instanceof Pg?e.event:e,r.resource=t,r.event=e,r.element=n,i.element.classList.add("b-eventeditor-editing"),r.editor||(r.editor=new ts(Object.assign({owner:r.scheduler.timeAxisSubGrid,appendTo:r.scheduler.timeAxisSubGridElement,scrollAction:"realign",cls:"b-simpleeventeditor",listeners:{complete:r.onEditorComplete,cancel:r.onEditorCancel,thisObj:r}},r.editorConfig)),r.relayEvents(r.editor,["beforestart","start","beforecomplete","complete","beforecancel","cancel"])),r.editor.startEdit({target:n,record:e,field:r.field}),r.scheduler.navigator.disabled=!0)}},{key:"onEditorComplete",value:function(){var e=this;0===e.event.stores.length&&(e.eventStore.add(e.editor.record),e.event.assign(e.resource)),e.element&&e.element.classList.contains("b-sch-dragcreator-proxy")&&e.element.remove(),e.reset()}},{key:"onEditorCancel",value:function(){0===this.event.stores.length&&this.element.remove(),this.reset()}},{key:"reset",value:function(){this.scheduler.element.classList.remove("b-eventeditor-editing"),this.scheduler.navigator.disabled=!1}},{key:"onEventEnterKey",value:function(e){var t=e.assignmentRecord,n=e.eventRecord,r=t?this.scheduler.getElementFromAssignmentRecord(t):this.scheduler.getElementFromEventRecord(n),i=(t||n).resource;this.editEvent(n,i,r)}},{key:"onDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord,r=e.proxyElement;this.scheduler.onEventCreated(t);var i=r.cloneNode(!0);i.removeAttribute("id"),r.parentElement.appendChild(i),this.element=i,this.editEvent(t,n,i)}}],[{key:"$name",get:function(){return"SimpleEventEdit"}},{key:"defaultConfig",get:function(){return{triggerEvent:"eventdblclick",eventRecord:null,field:"name",editorConfig:null}}},{key:"pluginConfig",get:function(){return{chain:["onEventEnterKey"],assign:["editEvent"]}}}]),r}(ho);function Jb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Kb._$name="SimpleEventEdit",bd.registerFeature(Kb,!1,"Scheduler");var Qb=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Jb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;Object.assign(n,{grid:e,store:e.store}),se()(J()(r.prototype),"construct",this).call(this,e,t),n.store.on({change:n.onStoreChanged,thisObj:n}),n.grid.eachSubGrid((function(e){e.footer||(e.footer=new ih({subGrid:e,parent:e}))}))}},{key:"doDestroy",value:function(){se()(J()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){se()(J()(r.prototype),"doDisable",this).call(this,e),e?this.grid.element.classList.add("b-summary-disabled"):(this.updateSummaries(),this.grid.element.classList.remove("b-summary-disabled"))}},{key:"renderRows",value:function(){this.updateSummaries()}},{key:"updateSummaries",value:function(){var e=this,t=e.grid,n=e.store,r=on.children(t.element,".b-grid-footer"),i=n.storage.values.filter((function(e){return!e.meta.specialRow}));t.columns.forEach((function(e){e.summaries&&e.summaries.forEach((function(e){"seed"in e&&("initialSeed"in e||(e.initialSeed=e.seed),["number","string","date"].includes(re()(e.initialSeed))?e.seed=e.initialSeed:e.seed=Object.assign({},e.initialSeed))}))})),r.forEach((function(n){var r=t.columns.get(n.dataset.column),o=e.generateHtml(r,i,"b-grid-footer-summary");(r.summaries?r.summaries.length:!!r.sum)&&(n.children.length?on.sync(o,n.firstElementChild):n.innerHTML=o)}))}},{key:"onStoreChanged",value:function(e){var t=this,n=e.action,r=e.changes,i=!0;this.disabled||("update"===n&&(i=Object.keys(r).some((function(e){var n=t.grid.columns.get(e);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))}))),i&&this.updateSummaries())}}],[{key:"$name",get:function(){return"Summary"}},{key:"pluginConfig",get:function(){return{chain:["renderRows"]}}}]),r}(Ny(ho));function Zb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Qb.featureClass="b-summary",Qb._$name="Summary",bd.registerFeature(Qb);var ek=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Zb()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;if(e.isVertical)throw new Error("Summary feature is not supported in vertical mode");n.scheduler=e,se()(J()(r.prototype),"construct",this).call(this,e,t),n.summaries||(n.summaries=[{renderer:n.renderer}]),e instanceof Sb&&(e.eventStore.on({change:n.updateScheduleSummaries,thisObj:n}),e.resourceStore.on({change:n.updateScheduleSummaries,thisObj:n}),e.timeAxisViewModel.on({update:n.renderRows,thisObj:n}))}},{key:"renderRows",value:function(){se()(J()(r.prototype),"renderRows",this).call(this),this.render()}},{key:"updateScheduleSummaries",value:function(){var e=this,t=e.scheduler,n=t.element.querySelector(".b-grid-footer.b-sch-timeaxiscolumn");n&&on.forEachSelector(n,".b-timeaxis-tick",(function(n,r){var i=t.timeAxis.getAt(r),o=t.eventStore.getEventsInTimeSpan(i.startDate,i.endDate,!0,!0),a="",s="<header>".concat(e.L("Summary for")," ").concat(t.getFormattedDate(i.startDate),"</header>");e.summaries.forEach((function(r){var l=r.renderer({startDate:i.startDate,endDate:i.endDate,eventStore:t.eventStore,resourceStore:t.resourceStore,events:o,element:n}),c='<div class="b-timeaxis-summary-value">'.concat(l,"</div>");(e.summaries.length>1||""!==l)&&(a+=c),s+="<label>".concat(r.label||"","</label>")+c})),n.innerHTML=a,n._tipHtml=s}))}},{key:"render",value:function(){var e=this,t=e.scheduler,n=t.element.querySelector(".b-grid-footer.b-sch-timeaxiscolumn");n&&(e.summaries.some((function(e){return e.label}))&&e.showTooltip&&!e._tip&&(e._tip=new Ui({id:"".concat(t.id,"-summary-tip"),cls:"b-timeaxis-summary-tip",hoverDelay:0,hideDelay:100,forElement:n,anchorToTarget:!0,trackMouse:!1,forSelector:".b-timeaxis-tick",getHtml:function(e){return e.activeTarget._tipHtml}})),n.innerHTML='<div class="b-timeaxis-tick" style="width: '.concat(t.tickSize,'px"></div>').repeat(t.timeAxis.count),e.updateScheduleSummaries())}}],[{key:"$name",get:function(){return"Summary"}},{key:"defaultConfig",get:function(){return{showTooltip:!0,summaries:null,renderer:null}}}]),r}(Qb);function tk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ek._$name="Summary",ek._$name="Summary",bd.registerFeature(ek,!1,"Scheduler");var nk=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(tk()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(e,t){var n=this;se()(J()(r.prototype),"construct",this).call(this,e,t),e._timeRangesExposed||(Object.defineProperty(e,"timeRanges",{get:function(){return n.store.records},set:function(e){return n.store.data=e}}),e._timeRangesExposed=!0)}},{key:"startConfigure",value:function(e){var t=this.client;if(t.project){var n=t.project.timeRangeStore;n&&(e.store=n)}}},{key:"initCurrentTimeLine",value:function(){var e=this,t=new Date;!e.currentTimeLine&&e.showCurrentTimeLine&&(e.currentTimeLine=new e.store.modelClass({id:"currentTime",cls:"b-sch-current-time",startDate:t,name:ft.format(t,e.currentDateFormat)}),e.updateCurrentTimeLine=e.updateCurrentTimeLine.bind(e),e.currentTimeInterval=e.setInterval(e.updateCurrentTimeLine,e.updateCurrentTimeLineInterval),e.client.isPainted&&e.renderRanges())}},{key:"updateCurrentTimeLine",value:function(){var e=this;e.currentTimeLine.startDate=new Date,e.currentTimeLine.name=ft.format(e.currentTimeLine.startDate,e.currentDateFormat),e.onStoreChanged({action:"update",record:e.currentTimeLine,changes:{}})}},{key:"hideCurrentTimeLine",value:function(){var e=this;e.currentTimeLine&&(e.clearInterval(e.currentTimeInterval),e.currentTimeLine=null,e.client.isPainted&&e.renderRanges())}},{key:"renderRanges",value:function(){se()(J()(r.prototype),"renderRanges",this).call(this),this.showCurrentTimeLine&&!this.disabled&&this.renderRange(this.currentTimeLine,!0)}},{key:"getHeaderMenuItems",value:function(e,t){var n=this;t.some((function(e){return e.isCurrentTimeline}))||"timeAxis"!==e.type||t.push({isCurrentTimeline:!0,text:n.L("showCurrentTimeLine"),checked:n.showCurrentTimeLine,onToggle:function(e){var t=e.checked;n.showCurrentTimeLine=t}})}},{key:"showCurrentTimeLine",get:function(){return this._showCurrentTimeLine},set:function(e){this._showCurrentTimeLine=e,e?this.initCurrentTimeLine():this.hideCurrentTimeLine()}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,this.client.isPainted&&this.renderRanges()}},{key:"store",get:function(){return this._store},set:function(e){var t=this,n=t.client;e.storeId||(e.storeId="timeRanges"),ei()(J()(r.prototype),"store",e,this,!0),n.timeRanges&&!n._timeRangesExposed&&(t._store.add(n.timeRanges),delete n.timeRanges),t.timeRanges&&(t._store.add(t.timeRanges),delete t.timeRanges)}}],[{key:"$name",get:function(){return"TimeRanges"}},{key:"defaultConfig",get:function(){return{store:{modelClass:zg,storeId:"timeRanges"},updateCurrentTimeLineInterval:1e4,currentDateFormat:"HH:mm",timeRanges:null,showCurrentTimeLine:!1}}}]),r}(jb);nk._$name="TimeRanges",bd.registerFeature(nk,!1,["Scheduler","Gantt"]);var rk={completeview:"completeview",currentview:"currentview",daterange:"daterange"};function ik(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ok=function(e){return function(e){$()(s,e);var t,n,r,i,o,a=(t=s,function(){var e,n=J()(t);if(ik()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function s(){return D()(this,s),a.apply(this,arguments)}return M()(s,[{key:"scrollRowIntoView",value:(o=ta()(Zo.a.mark((function e(t,n){var r,i,o;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],i=!1,o=t.scrollable.on({scrollStart:function(e){null!=e.y&&(i=!0)}}),r.push(t.scrollRowIntoView(t.store.getAt(n),{block:"start"})),o(),i&&r.push(new Promise((function(e){t.scrollable.on({scrollEnd:function(){e()},once:!0})}))),e.abrupt("return",Promise.all(r));case 7:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"scrollToDate",value:(i=ta()(Zo.a.mark((function e(t,n){var r,i,o;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,i=[],o=t.timeAxisSubGrid.scrollable.on({scrollstart:function(e){null!=e.x&&(r=!0)}}),i.push(t.scrollToDate(n)),o(),r&&i.push(new Promise((function(e){t.timeView.on({refresh:function(){e()},once:!0})}))),e.next=8,Promise.all(i);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"prepareComponent",value:(r=ta()(Zo.a.mark((function e(t){var n,r,i,o,a,l,c,u,d,f,h;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this,r=t.client,e.t0=t.scheduleRange,e.next=e.t0===rk.completeview?4:e.t0===rk.currentview?7:11;break;case 4:return t.rangeStart=r.startDate,t.rangeEnd=r.endDate,e.abrupt("break",11);case 7:return i=r.getVisibleDateRange(),o=i.startDate,a=i.endDate,t.rangeStart=o,t.rangeEnd=a,e.abrupt("break",11);case 11:return r.setTimeSpan(t.rangeStart,t.rangeEnd),e.next=14,se()(J()(s.prototype),"prepareComponent",this).call(this,t);case 14:if(l=n.exportMeta,c=n.element.querySelector(".b-sch-foreground-canvas"),u=n.element.querySelector(".b-horizontaltimeaxis"),t.scheduleRange!==rk.completeview&&(l.totalWidth-=l.subGrids.normal.width,l.totalWidth+=l.subGrids.normal.width=r.timeAxisViewModel.getDistanceBetweenDates(t.rangeStart,t.rangeEnd),l.subGrids.normal.scrollLeft=r.getCoordinateFromDate(t.rangeStart)),l.timeAxisHeaders=[],l.timeAxisPlaceholders=[],l.headersColleted=!1,on.forEachSelector(u,".b-sch-header-row",(function(e){l.timeAxisPlaceholders.push(n.createPlaceholder(e)),l.timeAxisHeaders.push(new Map)})),l.subGrids.normal.eventsPlaceholder=n.createPlaceholder(c,!1),on.removeEachSelector(c,".b-sch-event-wrap"),l.eventsBoxes=new Map,l.client=r,r.features.dependencies&&!r.features.dependencies.disabled&&(d=n.element.querySelector('[id="'.concat(r.svgCanvas.getAttribute("id"),'"]')),(l.dependenciesPlaceholder=d)&&on.removeEachSelector(d,".b-sch-dependency")),ft.betweenLesser(t.rangeStart,r.startDate,r.endDate)){e.next=28;break}return e.next=28,n.scrollToDate(r,t.rangeStart);case 28:f=Math.ceil(l.totalWidth/l.pageWidth),h=f*l.verticalPages,l.horizontalPages=f,l.totalPages=h;case 31:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onRowsCollected",value:(n=ta()(Zo.a.mark((function e(t,n){var r,i,o,a,l,c,u,d;return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se()(J()(s.prototype),"onRowsCollected",this).call(this,t);case 2:return r=this,i=n.client,o=i.timeView,a=r.getCurrentPageDateRange(n),l=a.pageRangeStart,c=a.pageRangeEnd,u=!1,e.next=6,r.scrollToDate(i,l);case 6:if(u){e.next=24;break}if(r.collectHeaders(n),r.collectEvents(t,n),!ft.timeSpanContains(o.startDate,o.endDate,l,c)){e.next=13;break}u=!0,e.next=22;break;case 13:if(!(o.endDate.getTime()>=c.getTime())){e.next=17;break}u=!0,e.next=22;break;case 17:return d=o.endDate,e.next=20,r.scrollToDate(i,o.endDate);case 20:if(d.getTime()!==o.endDate.getTime()){e.next=22;break}throw new Error("Could not scroll to date");case 22:e.next=6;break;case 24:return e.next=26,r.scrollToDate(i,n.rangeStart);case 26:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getCurrentPageDateRange",value:function(e){var t,n,r=e.rangeStart,i=e.rangeEnd,o=e.client,a=this.exportMeta,s=a.horizontalPages,l=a.horizontalPosition,c=a.pageWidth,u=a.subGrids;if(s>1){var d=l*c,f=(l+1)*c,h=u.locked.width;f<=h?n=t=null:(t=o.getDateFromCoordinate(Math.max(d-h,0)),n=o.getDateFromCoordinate(1.2*(f-h))||i)}else t=r,n=i;return{pageRangeStart:t,pageRangeEnd:n}}},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta,n=t.subGrids.normal,r=n.id,i=n.headerId,o=n.footerId,a=n.scrollLeft,l=e.querySelector('[id="'.concat(r,'"]'));return[".b-sch-background-canvas",".b-sch-foreground-canvas"].forEach((function(e){var n=l.querySelector(e);n&&(t.lastExportedRowBottom?n.style.height="".concat(t.lastExportedRowBottom,"px"):n.style.height="",a&&(n.style.marginLeft="-".concat(a,"px")))})),a&&[i,o].forEach((function(t){var n=e.querySelector('[id="'.concat(t,'"] .b-widget-scroller'));n&&(n.style.marginLeft="-".concat(a,"px"))})),se()(J()(s.prototype),"prepareExportElement",this).call(this)}},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(n){var r=te()(n,2),i=r[0],o=[r[1].outerHTML,e.top,e.offsetHeight];"normal"===i&&o.push(new Map),t[i].rows.push(o)}))}},{key:"collectHeaders",value:function(e){var t=e.client,n=this.exportMeta;if(!n.headersCollected){var r=t.timeView.element,i=n.timeAxisHeaders;on.forEachSelector(r,".b-sch-header-row",(function(e,r,o){var a=i[r];on.forEachSelector(e,".b-sch-header-timeaxis-cell",(function(e){a.has(e.dataset.tickIndex)||a.set(e.dataset.tickIndex,e.outerHTML)})),r===o.length-1&&a.has(String(t.timeAxis.count-1))&&(n.headersCollected=!0)}))}}},{key:"collectEvents",value:function(e,t){var n=e.length,r=t.client,i=this.exportMeta.subGrids.normal.rows;e.forEach((function(e,t){var o=i[i.length-n+t],a=r.store.getAt(e.dataIndex),s=o[3];a.events.forEach((function(e){if(e.isScheduled){var t=r.getElementFromEventRecord(e,a);t&&(t=t.parentElement)&&!s.has(e.id)&&s.set(e.id,[t.outerHTML,In.from(t,t.offsetParent)])}}))}))}},{key:"buildPageHtml",value:function(){var e=this,t=e.exportMeta,n=t.subGrids,r=t.timeAxisHeaders,i=t.timeAxisPlaceholders,o=e.prepareExportElement();return Object.values(n).forEach((function(t){var n=t.placeHolder,r=t.eventsPlaceholder,i=t.rows,a=n.outerHTML,s=e.positionRows(i),l=s.resources,c=s.events;o=o.replace(a,l.join("")),r&&(o=o.replace(r.outerHTML,c.join("")))})),r.forEach((function(e,t){o=o.replace(i[t].outerHTML,Array.from(e.values()).join(""))})),o=e.buildDependenciesHtml(o)}},{key:"getDependenciesOuterHTML",value:function(){var e,t=this.exportMeta.dependenciesPlaceholder;if(Re.isIE11){var n=document.createElement("div"),r=t.cloneNode(!0);n.appendChild(r),e=n.innerHTML}else e=t.outerHTML;return e}},{key:"renderDependencies",value:function(){var e=this.exportMeta,t=e.client,n=e.dependenciesPlaceholder,r=e.eventsBoxes,i=t.dependencies,o=t.features.dependencies,a=Array.from(r.keys());i.filter((function(e){return a.includes(String(e.from))||a.includes(String(e.to))})).forEach((function(e){var t=r.get(String(e.from)),i=r.get(String(e.to)),a=e.sourceEvent,s=e.targetEvent;if(!t&&a){var l=o.getBox(e,!0);l&&(t=l instanceof In?l:new In(l.start,l.top,l.end-l.start,l.bottom-l.top))}if(!i&&s){var c=o.getBox(e,!1);c&&(i=c instanceof In?c:new In(c.start,c.top,c.end-c.start,c.bottom-c.top))}var u={startRectangle:t&&t.clone(),endRectangle:i&&i.clone()};t&&i&&o.drawDependency(e,u,null,n,!1)}));var s=this.getDependenciesOuterHTML();return on.removeEachSelector(n,".b-sch-dependency"),s}},{key:"buildDependenciesHtml",value:function(e){if(this.exportMeta.dependenciesPlaceholder){var t=this.getDependenciesOuterHTML();e=e.replace(t,this.renderDependencies())}return e}}]),s}(e)};function ak(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var sk=function(e){$()(i,e);var t,n,r=(t=i,function(){var e,n=J()(t);if(ak()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function i(){return D()(this,i),r.apply(this,arguments)}return M()(i,[{key:"stateNextPage",value:(n=ta()(Zo.a.mark((function e(t){return Zo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se()(J()(i.prototype),"stateNextPage",this).call(this,t);case 2:this.exportMeta.eventsBoxes.clear();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=this,n=[],r=[];return e.forEach((function(e){var i=te()(e,4),o=i[0],a=(i[1],i[2],i[3]);n.push(o),a&&Array.from(a.entries()).forEach((function(e){var n=te()(e,2),i=n[0],o=te()(n[1],2),a=o[0],s=o[1];r.push(a),t.exportMeta.eventsBoxes.set(String(i),s)}))})),{resources:n,events:r}}}]),i}(ok(zf));function lk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}sk._$name="MultiPageExporter";var ck=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(lk()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"buildLocalizedItems",value:function(){var e=this;return Object.entries(rk).map((function(t){var n=te()(t,2),r=n[0],i=n[1];return{id:r,text:e.L(i)}}))}}],[{key:"$name",get:function(){return"ScheduleRangeCombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),r}(Ef);function uk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}ck._$name="ScheduleRangeCombo",ye.register(ck.$name.toLowerCase(),ck);var dk=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(uk()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"onLocaleChange",value:function(){var e=this.L("labelWidth");this.width=this.L("width"),this.items.forEach((function(t){t instanceof so?t.labelWidth=e:"rangeFieldsContainer"===t.ref&&(t.items[0].width=e)}))}},{key:"buildDialogItems",value:function(e){var t=this,n=e.client,i=se()(J()(r.prototype),"buildDialogItems",this).call(this,e),o=t.L("labelWidth");t.columnsStore=n.columns.chain((function(e){return e.isLeaf&&!(e instanceof lb)}));var a=i.find((function(e){return"columnsField"===e.ref}));return a.store=t.columnsStore,a.value=t.columnsStore.allRecords,i.splice(1,0,{labelWidth:o,type:"schedulerangecombo",ref:"scheduleRangeField",label:"L{Schedule range}",localeClass:t,value:rk.completeview,onChange:function(e){var t=e.value!==rk.daterange,n=this.owner.widgetMap;n.rangeStartField.hidden=n.rangeEndField.hidden=t}},{type:"container",ref:"rangeFieldsContainer",flex:"1 0 100%",items:[{type:"widget",width:o},{type:"datefield",ref:"rangeStartField",label:"L{Export from}",hidden:!0,flex:"1 0 25%",localeClass:t,value:e.client.startDate},{type:"datefield",ref:"rangeEndField",label:"L{Export to}",hidden:!0,flex:"1 0 25%",localeClass:t,value:e.client.endDate}]}),i}}],[{key:"$name",get:function(){return"SchedulerExportDialog"}}]),r}(Ff);function fk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}dk._$name="SchedulerExportDialog";var hk=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(fk()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"collectDependencies",value:function(){}},{key:"positionRows",value:function(e){var t=this,n=0,r=[],i=[],o=/translate\((\d+.?\d*)px, (\d+.?\d*)px\)/;return e.forEach((function(e){var a=te()(e,4),s=a[0],l=a[1],c=a[2],u=a[3];r.push(s.replace(o,"translate($1px, ".concat(n,"px)")));var d=n-l;u&&Array.from(u.entries()).forEach((function(e){var n=te()(e,2),r=n[0],a=te()(n[1],2),s=a[0],l=a[1];l.translate(0,d),t.exportMeta.eventsBoxes.set(String(r),l),i.push(s.replace(o,"translate($1px, ".concat(l.y,"px)")))})),n+=c})),{resources:r,events:i}}}]),r}(ok(Wf));function gk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}hk._$name="SinglePageExporter";var vk=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(gk()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"showExportDialog",value:function(){var e=this;e.exportDialog||(e.exportDialog=new dk({client:e.client,exporters:e.exporters,listeners:{export:e.onExportDialogExport,thisObj:e}})),e.exportDialog.show()}},{key:"buildExportConfig",value:function(e){e=se()(J()(r.prototype),"buildExportConfig",this).call(this,e);var t=this.scheduleRange,n=this.rangeStart,i=this.rangeEnd;return e.columns&&!e.columns.find((function(e){return"timeAxis"===e.type}))&&e.columns.push(e.client.timeAxisColumn.id),mt.assign({scheduleRange:t,rangeStart:n,rangeEnd:i},e)}}],[{key:"$name",get:function(){return"PdfExport"}},{key:"defaultConfig",get:function(){return{exporters:[hk,sk],scheduleRange:"completeview",rangeStart:null,rangeEnd:null}}}]),r}(Gf);vk._$name="PdfExport",bd.registerFeature(vk,!1,"Scheduler");n(276);function pk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var yk=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(pk()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"normalizeColumns",value:function(e){se()(J()(r.prototype),"normalizeColumns",this).call(this,e),e.eventColumns=e.eventColumns.map((function(e){return"string"==typeof e?{field:e}:e}))}},{key:"generateExportData",value:function(e){var t=this.target instanceof Sb,n=this.generateColumns(e),r=t?this.generateEventColumns(e):[];return{columns:n.concat(r),rows:this.generateRows(e)}}},{key:"generateEventColumns",value:function(e){var t=this;return e.eventColumns.map((function(n){return t.processEventColumn(n,e)}))}},{key:"processEventColumn",value:function(e,t){var n=e.width,r=e.minWidth,i=t.defaultColumnWidth;return{field:e.field,value:e.text,width:Math.max(n||i,r||i),eventColumn:!0,type:this.getColumnType(e,this.target.eventStore)}}},{key:"generateRows",value:function(e){var t,n=this,i=n.target;if(i instanceof Sb){if(t=[],i.resourceStore.map((function(r){var i=r.events||[];i.length||i.push(""),i.forEach((function(i){return t.push(n.getRowData(e,r,i))}))})),e.includeUnassigned&&e.eventColumns.length){var o=i.eventStore.query((function(e){return!e.resources.length&&!i.resourceStore.isAvailable(e)}));if(o.length){var a=new Array(e.columns.length).fill("");a.push(n.L("No resource assigned")),t.push(a),o.forEach((function(r){return t.push(n.getRowData(e,null,r))}))}}t=t.filter((function(e){return e.length}))}else t=se()(J()(r.prototype),"generateRows",this).call(this,e);return t}},{key:"getRowData",value:function(e,t,n){var r=e.columns,i=e.eventColumns,o=[];return o.push.apply(o,Z()(this.processRecord(t,r,e))),t&&t.meta.specialRow||o.push.apply(o,Z()(this.processRecord(n,i,e))),o}}],[{key:"defaultConfig",get:function(){return{includeUnassigned:!0,eventColumns:[{text:"Task",field:"name"},{text:"Starts",field:"startDate",width:140},{text:"Ends",field:"endDate",width:140}]}}}]),r}(_e($f));function mk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}yk._$name="ScheduleTableExporter";var bk=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(mk()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,null,[{key:"$name",get:function(){return"ExcelExporter"}},{key:"defaultConfig",get:function(){return{exporterClass:yk,exporterConfig:null}}}]),r}(Kf);function kk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}bk._$name="ExcelExporter",bd.registerFeature(bk,!1,"Scheduler");var wk=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(kk()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){return D()(this,r),n.apply(this,arguments)}return M()(r,[{key:"construct",value:function(){var e=this;se()(J()(r.prototype),"construct",this).apply(this,arguments),e.grid.isPainted?e.addErrorListener():e.grid.on({paint:e.addErrorListener,thisObj:e,once:!0})}},{key:"getImageURL",value:function(e){return L.joinPaths([this.imagePath||"",e||""])}},{key:"addErrorListener",value:function(){var e=this;Kn.on({element:this.grid.element,delegate:".b-resource-image",error:function(t){return e.setDefaultResourceImage(t.target)},capture:!0})}},{key:"setDefaultResourceImage",value:function(e){if(this.defaultImageName){var t=this.getImageURL(this.defaultImageName);e.src&&!e.src.endsWith(t.replace(/^[./]*/gm,""))&&(e.src=t)}}},{key:"template",value:function(e){var t,n=this,r=n.showImage,i=n.showRole,o=n.showEventCount,a=e["string"==typeof i?i:"role"],s=e.events.length,l=e.get(n.field);if(r)if(e.imageUrl)t=e.imageUrl;else{var c="string"==typeof r?r:e.image||l&&l.toLowerCase()+n.grid.resourceImageExtension||n.defaultImageName;t=n.getImageURL(c),c.includes(".")||(!n.validNames||n.validNames.includes(c)?t+=n.grid.resourceImageExtension:t=n.getImageURL(n.defaultImageName))}return'\n            <div class="b-resource-info">\n                '.concat(t?'<img class="b-resource-image" draggable="false" src="'.concat(t,'">'):"","\n                <dl>\n                <dt>").concat(l,"</dt>\n                ").concat(i?'<dd class="b-resource-role">'.concat(a,"</dd>"):"","\n                ").concat(o?'<dd class="b-resource-events">'.concat(n.L("eventCountText",s),"</dd>"):"","\n                </dl>\n            </div>\n        ")}},{key:"defaultRenderer",value:function(e){var t,n=e.grid,r=e.record,i=e.cellElement,o=e.value,a=e.isExport;return r.meta.specialRow?t="":a?t=o:(this.autoScaleThreshold&&n.rowHeight<this.autoScaleThreshold?i.style.fontSize=n.rowHeight/40+"em":i.style.fontSize="",t=this.template(r)),t}},{key:"imagePath",set:function(e){this.set("imagePath",e)},get:function(){return this.get("imagePath")||this.grid.resourceImagePath}},{key:"defaultImageName",set:function(e){this.set("defaultImageName",e)},get:function(){return this.get("defaultImageName")||this.grid.defaultResourceImageName}}],[{key:"type",get:function(){return"resourceInfo"}},{key:"fields",get:function(){return["showEventCount","showRole","showImage","imagePath","validNames","defaultImageName","autoScaleThreshold"]}},{key:"defaults",get:function(){return{showImage:!0,showEventCount:!0,showRole:!1,imagePath:null,validNames:["amit","angelo","arcady","arnold","celia","chang","dan","dave","emilia","george","gloria","henrik","hitomi","jong","kate","lee","linda","lisa","lola","macy","madison","malik","mark","maxim","mike","rob","steve"],defaultImageName:null,autoScaleThreshold:40,field:"name",htmlEncode:!1,width:140,cellCls:"b-resourceinfo-cell",autoSyncHtml:!0,editor:!j.isTestEnv&&"text"}}}]),r}(Hu);function Sk(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Ck(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ck(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Ck(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}zu.registerColumnType(wk),wk._$name="ResourceInfoColumn";var xk=function(e){$()(r,e);var t,n=(t=r,function(){var e,n=J()(t);if(Rk()){var r=J()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X()(this,e)});function r(){var e;D()(this,r),e=n.call(this);var t,i=od()(e),o=[],a=[],s=[],l=Sk(i.children);try{for(l.s();!(t=l.n()).done;){var c=t.value;if("COLUMN"===c.tagName){var u=parseInt(c.dataset.width),d=parseInt(c.dataset.flex),f={field:c.dataset.field,text:c.innerHTML};u?f.width=u:f.flex=d||1,o.push(f)}else if("DATA"===c.tagName){var h,g=Sk(c.children);try{for(g.s();!(h=g.n()).done;){var v,p=h.value,y=Sk(p.children);try{for(y.s();!(v=y.n()).done;){var m=v.value,b={};Object.assign(b,m.dataset),"EVENTS"===p.tagName?s.push(b):"RESOURCES"===p.tagName&&a.push(b)}}catch(e){y.e(e)}finally{y.f()}}}catch(e){g.e(e)}finally{g.f()}}}}catch(e){l.e(e)}finally{l.f()}var k=e.attachShadow({mode:"open"}),w=document.createElement("link");return w.rel="stylesheet",w.href="../../build/scheduler.default.css",w.onload=function(){var e=document.createElement("div");e.id="container",e.style.width="100%",e.style.height="100%",k.appendChild(e),Kr(k);var t={appendTo:e,columns:o,resources:a,events:s};Object.assign(t,i.dataset);var n=new Sb(t);window.scheduler||(window.scheduler=n)},k.appendChild(w),e}return r}(window.customElements?HTMLElement:Object);try{window.customElements&&window.customElements.define("@snovasys/snova-timeline-viewer",xk)}catch(e){}xk._$name="SchedulerTag";window.bryntum||(window.bryntum={})}])}));
//# sourceMappingURL=scheduler.umd.min.js.map