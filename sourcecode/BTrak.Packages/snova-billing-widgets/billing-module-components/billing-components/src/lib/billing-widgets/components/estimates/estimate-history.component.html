<div class="p-1 invoice-preview-height" id="style-1">
    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="anyOperationIsInprogress">
    </mat-progress-bar>
    <div *ngIf="!anyOperationIsInprogress">
        <div *ngFor="let estimate of estimateHistory">
            <div fxLayout="row wrap" fxLayoutGap="10px">
                <div mat-card-avatar fxFlex="5" fxFlex.gt-lg="3" fxFlex.xs="13">
                    <app-avatar matTooltip="{{ estimate.performedByUserName }}"
                        [name]="estimate.performedByUserName | removeSpecialCharacters"
                        [src]="estimate.performedByUserProfileImage | fetchSizedAndCachedImage: '20':''"
                        [isRound]="true" size="20">
                    </app-avatar>
                </div>
                <div fxFlex fxLayout="column" fxLayoutGap="5px">
                    <div fxLayout="row">
                        <div fxFlex="50" fxFlex.gt-lg="20" fxFlex.lg="30" fxFlex.md="45">
                            <b>{{estimate.performedByUserName}}</b>
                        </div>
                        <div fxFlex>
                            <span class="pull-right"
                                matTooltip="{{estimate.createdDateTime | utcToLocalTime| date:'dd-MM-yyyy, h:mm a'}}">{{estimate.createdDateTime | utcToLocalTime | timeago }}</span>
                        </div>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateAdded'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.ESTIMATEWITHNUMBER' | translate | softLabelsPipe : softLabels }}
                            <b>{{estimate.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.WASCREATED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateClient'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.CLIENTCHANGEDFROM' | translate }} <b>{{estimate?.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }} <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateTitle'">
                        <span *ngIf="estimate.oldValue == null || estimate.oldValue.trim() == ''">
                            {{ 'BILLINGMANAGEMENT.TITLECHANGEDTO' | translate }} <b>{{estimate.newValue}}</b>
                        </span>
                        <span
                            *ngIf="estimate.oldValue != null && estimate.oldValue.trim() != '' && estimate.newValue != null && estimate.newValue.trim() != ''">
                            {{ 'BILLINGMANAGEMENT.TITLECHANGEDFROM' | translate }} <b>{{estimate.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }} <b>{{estimate.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                        <span
                            *ngIf="(estimate.oldValue != null && estimate.oldValue.trim() != '') && (estimate.newValue == null || estimate.newValue.trim() == '')">
                            {{ 'BILLINGMANAGEMENT.TITLEREMOVED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateNumber'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.ESTIMATENUMBERCHANGEDFROM' | translate | softLabelsPipe : softLabels }}
                            <b>{{estimate?.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }} <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimatePONumber'">
                        <span *ngIf="estimate.oldValue == null || estimate.oldValue.trim() == ''">
                            {{ 'BILLINGMANAGEMENT.PONUMBERCHANGEDTO' | translate }} <b>{{estimate.newValue}}</b>
                        </span>
                        <span
                            *ngIf="estimate.oldValue != null && estimate.oldValue.trim() != '' && estimate.newValue != null && estimate.newValue.trim() != ''">
                            {{ 'BILLINGMANAGEMENT.PONUMBERCHANGEDFROM' | translate }} <b>{{estimate.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }} <b>{{estimate.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                        <span
                            *ngIf="(estimate.oldValue != null && estimate.oldValue.trim() != '') && (estimate.newValue == null || estimate.newValue.trim() == '')">
                            {{ 'BILLINGMANAGEMENT.PONUMBERREMOVED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateDueDate'">
                        <span *ngIf="estimate.oldValue == null || estimate.oldValue.trim() == ''">
                            {{ 'BILLINGMANAGEMENT.DUEDATECHANGEDTO' | translate }}
                            <b>{{estimate?.newValue}}</b>
                        </span>
                        <span
                            *ngIf="estimate.oldValue != null && estimate.oldValue.trim() != '' && estimate.newValue != null && estimate.newValue.trim() != ''">
                            {{ 'BILLINGMANAGEMENT.DUEDATECHANGEDFROM' | translate }}
                            <b>{{estimate?.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }}
                            <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                        <span
                            *ngIf="(estimate.oldValue != null && estimate.oldValue.trim() != '') && (estimate.newValue == null || estimate.newValue.trim() == '')">
                            {{ 'BILLINGMANAGEMENT.DUEDATEREMOVED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateIssueDate'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.ISSUEDATECHANGEDFROM' | translate }}
                            <b>{{estimate?.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }}
                            <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateCurrency'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.CURRENCYCHANGEDFROM' | translate }} <b>{{estimate?.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }} <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateTerms'">
                        <span *ngIf="estimate.oldValue == null || estimate.oldValue.trim() == ''">
                            {{ 'BILLINGMANAGEMENT.TERMSCHANGEDTO' | translate }} <b>{{estimate?.newValue}}</b>
                        </span>
                        <span
                            *ngIf="estimate.oldValue != null && estimate.oldValue.trim() != '' && estimate.newValue != null && estimate.newValue.trim() != ''">
                            {{ 'BILLINGMANAGEMENT.TERMSCHANGEDFROM' | translate }} <b>{{estimate?.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }} <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                        <span
                            *ngIf="(estimate.oldValue != null && estimate.oldValue.trim() != '') && (estimate.newValue == null || estimate.newValue.trim() == '')">
                            {{ 'BILLINGMANAGEMENT.TERMSREMOVED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateNotes'">
                        <span *ngIf="estimate.oldValue == null || estimate.oldValue.trim() == ''">
                            {{ 'BILLINGMANAGEMENT.NOTESCHANGEDTO' | translate }} <b>{{estimate?.newValue}}</b>
                        </span>
                        <span
                            *ngIf="estimate.oldValue != null && estimate.oldValue.trim() != '' && estimate.newValue != null && estimate.newValue.trim() != ''">
                            {{ 'BILLINGMANAGEMENT.NOTESCHANGEDFROM' | translate }} <b>{{estimate?.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }} <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                        <span
                            *ngIf="(estimate.oldValue != null && estimate.oldValue.trim() != '') && (estimate.newValue == null || estimate.newValue.trim() == '')">
                            {{ 'BILLINGMANAGEMENT.NOTESREMOVED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateDiscount'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.DISCOUNTCHANGEDFROM' | translate }}
                            <b>{{convertValue(estimate?.oldValue)}}</b> {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }}
                            <b>{{convertValue(estimate?.newValue)}}</b> {{ 'BILLINGMANAGEMENT.DONE' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateTaskAdded'">
                        <span>
                            <b>{{estimate?.newValue}}</b> {{ 'BILLINGMANAGEMENT.TASKWASCREATED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateTaskRemoved'">
                        <span>
                            <b>{{estimate?.newValue}}</b> {{ 'BILLINGMANAGEMENT.TASKREMOVED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateTaskName'">
                        <span>
                            <b>{{estimate?.oldValue}}</b> {{ 'BILLINGMANAGEMENT.TASKCHANGEDTO' | translate }}
                            <b>{{estimate?.newValue}}</b>
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateTaskDescription'">
                        <span *ngIf="estimate.oldValue == null || estimate.oldValue.trim() == ''">
                            {{ 'BILLINGMANAGEMENT.DESCRIPTIONCHANGEDTO' | translate }} <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }} <b>{{estimate?.taskName}}
                                {{ 'BILLINGMANAGEMENT.SMALLTASK' | translate }}</b>
                        </span>
                        <span
                            *ngIf="estimate.oldValue != null && estimate.oldValue.trim() != '' && estimate.newValue != null && estimate.newValue.trim() != ''">
                            {{ 'BILLINGMANAGEMENT.DESCRIPTIONCHANGEDFROM' | translate }} <b>{{estimate?.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }} <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }} <b>{{estimate?.taskName}}
                                {{ 'BILLINGMANAGEMENT.SMALLTASK' | translate }}</b>
                        </span>
                        <span
                            *ngIf="(estimate.oldValue != null && estimate.oldValue.trim() != '') && (estimate.newValue == null || estimate.newValue.trim() == '')">
                            {{ 'BILLINGMANAGEMENT.DESCRIPTIONREMOVED' | translate }}
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }} <b>{{estimate?.taskName}}
                                {{ 'BILLINGMANAGEMENT.SMALLTASKREMOVED' | translate }}</b>
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateTaskRate'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.RATECHANGEDFROM' | translate }}
                            <b>{{convertValue(estimate?.oldValue) | number}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }}
                            <b>{{convertValue(estimate?.newValue) | number}}</b>
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }} <b>{{estimate?.taskName}}
                                {{ 'BILLINGMANAGEMENT.SMALLTASK' | translate }}</b>
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateTaskHours'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.HOURSCHANGEDFROM' | translate }}
                            <b>{{convertValue(estimate?.oldValue) | number}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }}
                            <b>{{convertValue(estimate?.newValue) | number}}</b>
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }} <b>{{estimate?.taskName}}
                                {{ 'BILLINGMANAGEMENT.SMALLTASK' | translate }}</b>
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateItemAdded'">
                        <span>
                            <b>{{estimate?.newValue}}</b> {{ 'BILLINGMANAGEMENT.ITEMWASCREATED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateItemRemoved'">
                        <span>
                            <b>{{estimate?.newValue}}</b> {{ 'BILLINGMANAGEMENT.ITEMREMOVED' | translate }}
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateItemName'">
                        <span>
                            <b>{{estimate?.oldValue}}</b> {{ 'BILLINGMANAGEMENT.ITEMCHANGEDTO' | translate }}
                            <b>{{estimate?.newValue}}</b>
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateItemDescription'">
                        <span *ngIf="estimate.oldValue == null || estimate.oldValue.trim() == ''">
                            {{ 'BILLINGMANAGEMENT.DESCRIPTIONCHANGEDTO' | translate }} <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }} <b>{{estimate?.itemName}}
                                {{ 'BILLINGMANAGEMENT.SMALLITEM' | translate }}</b>
                        </span>
                        <span
                            *ngIf="estimate.oldValue != null && estimate.oldValue.trim() != '' && estimate.newValue != null && estimate.newValue.trim() != ''">
                            {{ 'BILLINGMANAGEMENT.DESCRIPTIONCHANGEDFROM' | translate }} <b>{{estimate?.oldValue}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }} <b>{{estimate?.newValue}}</b>
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }} <b>{{estimate?.itemName}}
                                {{ 'BILLINGMANAGEMENT.SMALLITEM' | translate }}</b>
                        </span>
                        <span
                            *ngIf="(estimate.oldValue != null && estimate.oldValue.trim() != '') && (estimate.newValue == null || estimate.newValue.trim() == '')">
                            {{ 'BILLINGMANAGEMENT.DESCRIPTIONREMOVED' | translate }}
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }} <b>{{estimate?.itemName}}
                                {{ 'BILLINGMANAGEMENT.SMALLITEMREMOVED' | translate }}</b>
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateItemPrice'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.PRICECHANGEDFROM' | translate }}
                            <b>{{convertValue(estimate?.oldValue) | number}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }}
                            <b>{{convertValue(estimate?.newValue) | number}}</b>
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }} <b>{{estimate?.itemName}}
                                {{ 'BILLINGMANAGEMENT.SMALLITEM' | translate }}</b>
                        </span>
                    </div>
                    <div class="mb-05" fxLayout="row" *ngIf="estimate.description == 'EstimateItemQuantity'">
                        <span>
                            {{ 'BILLINGMANAGEMENT.QUANTITYCHANGEDFROM' | translate }}
                            <b>{{convertValue(estimate?.oldValue) | number}}</b>
                            {{ 'BILLINGMANAGEMENT.SMALLTO' | translate }}
                            <b>{{convertValue(estimate?.newValue) | number}}</b>
                            {{ 'BILLINGMANAGEMENT.INTHETASK' | translate }}
                            <b>{{estimate?.itemName}} {{ 'BILLINGMANAGEMENT.SMALLITEM' | translate }}</b>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>