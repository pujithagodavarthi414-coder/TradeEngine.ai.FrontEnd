<div fxFlex="row wrap" class="testruns-dialog-operations">
    <div fxFlex>
        <div class="p-0">
            <mat-card class="testrun-status-preview fit-content-audit-status-preview"
                style="height: calc(100vh - 108px);" id="style-1">
                <mat-card-title>
                    <div fxLayout="row">
                        <div class="card-title-text test-case-title" fxFlex="95" fxFlex.xs="95" fxFlex.sm="85"
                            fxFlex.md="95">
                            <b>
                                <span class="test-case-unique-number">{{questionData.questionIdentity}} - </span>
                                <span> {{questionData.questionName}}</span>
                            </b>
                            <span *ngIf="canAccess_entityType_feature_CanAddAndViewQuestionLevelDocuments">
                                <button mat-icon-button [satPopoverAnchorFor]="FilesPopover"
                                    #FilesPopup="satPopoverAnchor" (click)="openFilesPopover(FilesPopup)"
                                    *ngIf="filesCount > 0">
                                    <fa-icon icon="file-upload" class="filter mat-color-accent"
                                        matTooltip="{{'AUDIT.ATTACHMENTS' | translate}}" style="font-size: 18px;">
                                    </fa-icon>
                                </button>
                            </span>
                            <span
                                *ngIf="canAccess_entityType_feature_CanAddAndViewQuestionLevelDocuments && filesCount > 0"
                                style="margin-left: -10px;">
                                ({{filesCount}})
                            </span>
                        </div>
                        <div fxFlex>
                            <a class="detail_close mt-05" color="warn"
                                matTooltip="{{'TESTMANAGEMENT.CLOSEDIALOG' | translate}}" (click)="closeDialog()">
                                <fa-icon icon="times"></fa-icon>
                            </a>
                        </div>
                    </div>
                </mat-card-title>
                <mat-card-content class="testrun-tab">
                    <kendo-tabstrip [tabPosition]="position" (tabSelect)="onTabSelect($event)" class="mt-1" id="tab">
                        <kendo-tabstrip-tab title="{{'AUDIT.QUESTIONDETAILS' | translate | softLabelsPipe :softLabels}}" [selected]="true">
                            <ng-template kendoTabContent>
                                <question-version-preview [question]="questionData">
                                </question-version-preview>
                            </ng-template>
                        </kendo-tabstrip-tab>
                        <!-- <kendo-tabstrip-tab title="{{'TESTMANAGEMENT.HISTORY' | translate}}">
                            <ng-template kendoTabContent>
                                <question-history [selectedConduct]=null [question]="questionData">
                                </question-history>
                            </ng-template>
                        </kendo-tabstrip-tab>
                        <kendo-tabstrip-tab title="{{'AUDIT.ANALYTICS' | translate}}">
                            <ng-template kendoTabContent>
                                <div *ngIf="selectedWorkspaceId" style="height: calc(100vh - 200px);">
                                    <ndc-dynamic [ndcDynamicFactory]="dashboard.component"
                                        [ndcDynamicComponent]="dashboard.component"
                                        *ngIf="selectedWorkspaceId && dashboard" [ndcDynamicInjector]="injector"
                                        [ndcDynamicInputs]="dashboard.inputs" [ndcDynamicOutputs]="outputs">
                                    </ndc-dynamic>
                                </div>
                                <div *ngIf="!selectedWorkspaceId" class="text-center"> No dashboard is created for the
                                    current question. </div>
                            </ng-template>
                        </kendo-tabstrip-tab>
                        <kendo-tabstrip-tab title="{{'AUDIT.CONDUCTHISTORY' | translate}}">
                            <ng-template kendoTabContent>
                                <question-conduct-history [question]="questionData">
                                </question-conduct-history>
                            </ng-template>
                        </kendo-tabstrip-tab>
                        <kendo-tabstrip-tab title="{{'AUDIT.CUSTOMFIELD' | translate}}">
                            <ng-template kendoTabContent>
                                <audit-custom-field [selectedAudit]="selectedAudit" [fileType] = "'audit'" [selectedConduct]=null [question]="questionData">
                                </audit-custom-field>
                            </ng-template>
                        </kendo-tabstrip-tab>
                        <kendo-tabstrip-tab title="{{'USERSTORY.CUSTOMFIELDSHISTORY'|translate}}">
                            <ng-template kendoTabContent>
                                <div class="text-center" *ngIf="!projectcomponentLoaded">
                                    Loading...
                                </div>
                                <div *ngIf="projectcomponentLoaded" style="height: calc(100vh - 206px);" id="style-1">
                                    <ndc-dynamic [ndcDynamicFactory]="customHistoryComponent.component"
                                        [ndcDynamicComponent]="customHistoryComponent.component" [ndcDynamicInjector]="injector"
                                        [ndcDynamicInputs]="customHistoryComponent.inputs" [ndcDynamicOutputs]="customHistoryComponent.outputs">
                                    </ndc-dynamic>
                                </div>
                            </ng-template>
                          </kendo-tabstrip-tab> -->
                    </kendo-tabstrip>
                </mat-card-content>
            </mat-card>
        </div>
    </div>
</div>

<sat-popover backdropClass="backdrop-color" #FilesPopover hasBackdrop scrollStrategy="reposition"
    [interactiveClose]="false">
    <mat-card class="p-0 expense-recipts-width">
        <div class="card-title-text mat-bg-primary p-05" fxLayout="row">
            <div fxFlex class="text-center">
                {{'AUDIT.ATTACHMENTS' | translate}}
            </div>
            <div fxFlex="20px" fxLayoutAlign="end center" class="cursor-pointer">
                <span class="inline_edit_close_btn" (click)="closeFilesPopup()">
                    <fa-icon icon="times"></fa-icon>
                </span>
            </div>
        </div>
        <mat-card-content class="p-05 mobile-view-popover" id="style-1">
            <div fxLayout="row wrap" fxFlex="100">
                <div class="mt-05 mb-05 userStory-name" fxFlex="100" fxLayout="column">
                    <span fxLayout="row" *ngFor="let img of files;let i = index">
                        <fa-icon icon="circle" class="fa-xs mr-05 mt-05" fxFlex="12px"></fa-icon>
                        <a target="_blank" [href]="sanitizeUrl(img.filePath)" fxFlex="calc(100% - 20px)"
                            class="add-test-case allgoals_txt userStory-name-control" [matTooltip]="img.fileName"
                            matTooltipShowDelay="300">{{img.fileName}}</a>
                    </span>
                </div>
            </div>
        </mat-card-content>
    </mat-card>
</sat-popover>