<div class="project-select list-project" style="right: 20px !important">
    <button mat-icon-button class="project-select pull-right mt-n1" *ngIf="(selectedTab == '6')">
        <fa-icon icon="store" matTooltip="{{ 'APP.APPSTORE' | translate}}" (click)="openAppsSettings(false)"
            class="goal-unique-menu"></fa-icon>
    </button>
    <button mat-icon-button class="project-select pull-right mt-n1" *ngIf="!listView && selectedTab == '6'">
        <fa-icon icon="bars" matTooltip="{{ 'APP.APPSVERTICAL' | translate}}" (click)="openAppsView()"
            class="mat-color-accent cursor-pointer kanban-icon-dashboard" [ngClass]="{'active': !listView}"></fa-icon>
    </button>
    <button mat-icon-button class="project-select pull-right mt-n1" *ngIf="listView && selectedTab == '6' ">
        <fa-icon icon="bars" (click)="openAppsView()" matTooltip="{{ 'APP.APPSHORIZONTAL' | translate}}"
            class="mat-color-accent cursor-pointer" [ngClass]="{'active': listView}"></fa-icon>
    </button>
</div>
<div fxLayout="row wrap" class="my-profiletabs widget-tab-static-label">
    <div fxFlex>
        <mat-tab-group class="testrail-tabs testrail-custom-pagination" [selectedIndex]="selectedTab"
            (selectedTabChange)="selectedMatTab($event)">
            <mat-tab label="{{'AUDIT.AUDITS' | translate | softLabelsPipe :softLabels}}">
                <ng-template mat-tab-label>
                    {{'AUDIT.AUDITS' | translate | softLabelsPipe :softLabels}}
                    <span class="ml-05 badge-item testsuites-count count-padding"
                        *ngIf="canAccess_entityType_feature_ViewAudit && (activeAuditsCount$ | async) > 0">{{ activeAuditsCount$ | async }}</span>
                </ng-template>
                <ng-template matTabContent>
                    <app-audits-view *ngIf="changeRoute && selectedTab == '0'">
                    </app-audits-view>
                </ng-template>
            </mat-tab>
            <mat-tab label="{{'AUDIT.CONDUCTS' | translate | softLabelsPipe :softLabels}}">
                <ng-template mat-tab-label>
                    {{'AUDIT.CONDUCTS' | translate | softLabelsPipe :softLabels}}
                    <span class="ml-05 badge-item testruns-count count-padding"
                        *ngIf="canAccess_entityType_feature_ViewAuditConducts && (activeAuditConductsCount$ | async) > 0">{{ activeAuditConductsCount$ | async }}</span>
                </ng-template>
                <ng-template matTabContent>
                    <app-conducts-view *ngIf="changeRoute && selectedTab == '1'">
                    </app-conducts-view>
                </ng-template>
            </mat-tab>
            <mat-tab label="{{'AUDIT.TIMELINE' | translate}}">
                <ng-template mat-tab-label>
                    {{'AUDIT.TIMELINE' | translate}}
                </ng-template>
                <ng-template matTabContent>
                    <app-audit-conduct-timeline-view *ngIf="changeRoute && selectedTab == '2'">
                    </app-audit-conduct-timeline-view>
                </ng-template>
            </mat-tab>
            <mat-tab label="{{'AUDIT.ACTIONS' | translate | softLabelsPipe :softLabels}}">
                <ng-template mat-tab-label>
                    {{'AUDIT.ACTIONS' | translate | softLabelsPipe :softLabels}}
                    <span class="ml-05 badge-item audit-actions-count count-padding"
                        *ngIf="canAccess_entityType_feature_ViewAuditActions && (actionsCount$ | async) > 0">{{ actionsCount$ | async }}</span>
                </ng-template>
                <ng-template matTabContent>
                    <app-audit-actions-view *ngIf="changeRoute && selectedTab == '3'"
                        [loadProjectModule]="loadProjectModule">
                    </app-audit-actions-view>
                </ng-template>
            </mat-tab>
            <mat-tab label="{{'AUDIT.REPORTS' | translate | softLabelsPipe :softLabels}}">
                <ng-template mat-tab-label>
                    {{'AUDIT.REPORTS' | translate | softLabelsPipe :softLabels}}
                    <span class="ml-05 badge-item test-reports-count count-padding"
                        *ngIf="canAccess_entityType_feature_ViewAuditReports && (activeAuditReportsCount$ | async) > 0">{{ activeAuditReportsCount$ | async }}</span>
                </ng-template>
                <ng-template matTabContent>
                    <app-audit-reports-view *ngIf="changeRoute && selectedTab == '4'">
                    </app-audit-reports-view>
                </ng-template>
            </mat-tab>
            <mat-tab label="{{'AUDIT.ACTIVITY' | translate}}">
                <ng-template mat-tab-label>
                    {{'AUDIT.ACTIVITY' | translate}}
                </ng-template>
                <ng-template matTabContent>
                    <app-audit-activity-view *ngIf="changeRoute && selectedTab == '5'">
                    </app-audit-activity-view>
                </ng-template>
            </mat-tab>
            <mat-tab label="{{'AUDIT.ANALYTICS' | translate}}">
                <ng-template mat-tab-label>
                    {{'AUDIT.ANALYTICS' | translate}}
                    <!-- <span class="ml-05 badge-item testsuites-count count-padding"
                *ngIf="canAccess_entityType_feature_ViewAudit && (activeAuditsCount$ | async) > 0">{{ activeAuditsCount$ | async }}</span> -->
                </ng-template>
                <ng-template matTabContent>
                    <div *ngIf="selectedTab == '6' && selectedWorkspaceId" style="height: 100vh;">
                        <ndc-dynamic [ndcDynamicFactory]="dashboard.component"
                            [ndcDynamicComponent]="dashboard.component" *ngIf="selectedWorkspaceId && dashboard"
                            [ndcDynamicInjector]="injector" [ndcDynamicInputs]="dashboard.inputs"
                            [ndcDynamicOutputs]="outputs">
                        </ndc-dynamic>
                    </div>
                </ng-template>
            </mat-tab>
        </mat-tab-group>
    </div>
    <div fxFlex="50px" fxFlex.xs="60px" class="search_goalinput pr-05 add-action-button" *ngIf="selectedTab == '3' &&  (actionsCount$ | async) > 0">
        <button mat-icon-button color="primary" matTooltip=" {{'AUDIT.ADDACTION' | translate | softLabelsPipe :softLabels}}"
            [satPopoverAnchorFor]="addAction" #addActionPopover="satPopoverAnchor"
            (click)="$event.stopPropagation();openAddActionPopover(addActionPopover)">
            <fa-icon class=" mr-05 add-section-square mat-color-accent" icon="plus-square"></fa-icon>
        </button>
    </div>
</div>

<sat-popover #addAction hasBackdrop backdropClass="backdrop-color" [interactiveClose]="false" verticalAlign="below"
    horizontalAlign="end">
    <mat-card class="p-0">
        <mat-card-title class="text-center mat-bg-primary">
            <div class="card-title-text p-05"> {{'AUDIT.ADDACTION' | translate | softLabelsPipe :softLabels}}
            </div>
        </mat-card-title>
        <mat-card-content class="p-05">
            <conduct-question-action *ngIf='loadAction' [loadBugs]=false (closeAction)="closeActionPopover()">
            </conduct-question-action>
        </mat-card-content>
    </mat-card>
</sat-popover>