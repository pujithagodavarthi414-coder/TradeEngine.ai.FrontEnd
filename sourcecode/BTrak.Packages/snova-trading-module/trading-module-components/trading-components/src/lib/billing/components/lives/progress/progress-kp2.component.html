<div fxLayout="row wrap" fxLayout.xs="column" class="mb-1 font-century-gothic">
    <div style="text-align: center;width: 100%;" class="mt-1">
        <b style="color :#1F6B2A !important; font-size: 22px;">Progress - SMILE Program</b>
    </div>
    <div style="right: 0px !important; position: absolute;">
        <button mat-icon-button>
            <fa-icon icon="file-excel" class="action-icon-color" (click)="fileInput.click()"
                style="font-size: 33px !important;color:#FFC000 !important">
            <input type="file" id="file" (click)="fileInput.value = null" (change)="uploadEventHandler($event.target.files,$event)" #fileInput hidden
                accept=".xlsx, .xls, .csv">
                </fa-icon>
        </button>

        <button mat-raised-button class="live-button m-2"  (click)="openProgressDialog()"
            matTooltipClass="tooltipClass-mat" matTooltip="Click here to add Progress">
            <b style="color :#FFC000 !important">ADD PROGRESS</b>
        </button>
    </div>
</div>
<div fxLayout="row" class="mt-1 font-century-gothic">
    <div fxFlex>
        <div style="position: absolute;margin-top: -50px;">
            <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="0" fxLayoutGap.xs="5px">
                <div fxFlex="40px" fxFlex.xs="35px" fxLayoutAlign="start center" id="client-3">
                    <button type="submit" mat-icon-button class="pull-right" (click)="showFilter = !showFilter"
                        matTooltipClass="tooltipClass-mat" matTooltip=" Search">
                        <fa-icon icon="filter" class="filter mat-color-accent" style="color:#FFC000 !important">
                        </fa-icon>
                    </button>
                    <div fxShow.xs="true" fxShow.gt-xs="false" class="p-03 mt-02">
                    </div>
                </div>
            </div>
        </div>
        <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="0" fxLayoutGap.xs="5px" class="filter-margin" *ngIf="showFilter"
      style="margin-top: 0 !important">
        <!-- <div fxFlex="40px" fxFlex.xs="35px" fxLayoutAlign="start center"
          id="client-3">          
          <div fxShow.xs="true" fxShow.gt-xs="false" class="p-03 mt-02">
          </div
          >
        </div> -->
        <div style="background: #e1f0ff !important" fxFlex fxLayoutAlign="start center">
          <div class="filter-section">
            <ul>
              <li>
                <span class="archive-label" style="color: #2E2F64 !important">Archive: </span>
                <mat-slide-toggle class="mr-1 archive-switch" matTooltipClass="tooltipClass-mat"
                  matTooltip="Click here for archived list" id="client-7" (change)="archive()" [ngModel]="isArchived">
                </mat-slide-toggle>
              </li>
            </ul>
          </div>
        </div>
        <!-- <div fxFlex></div> -->
      </div>
        <div class="activity-data kpi-table-height">
            <mat-progress-bar color="primary" mode="indeterminate" *ngIf="isLoadingInProgress">
            </mat-progress-bar>
            <kendo-grid [data]="progressListData" [filterable]="false" [pageSize]="state.take" [skip]="state.skip"
                [pageSize]="state.take" [sort]="state.sort" [sortable]="true" [pageable]="true"
                (cellClick)="selectedRow($event)" (dataStateChange)="dataStateChange($event)">
                <kendo-grid-column title="Sr.No" [width]="60">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Sr.No" class="headers-color">Sr.No</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-rowIndex="rowIndex">
                        {{rowIndex+1}}
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Program Name" field="programDetails">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Program Name" class="headers-color">Program
                            Name</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div>
                            {{ dataItem.formData.programDetails}}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Phase" field="selectPhase" [width]="80">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Phase" class="headers-color">Phase</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div>
                            {{dataItem.formData.selectPhase}}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Location" field="locationKpi01">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Location" class="headers-color">Location</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div style="text-transform: capitalize;word-wrap: break-word;">
                            {{ dataItem.formData.locationKpi01}}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Date" field="date">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Date" class="headers-color">Date (From - To)</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div>
                            {{dataItem.formData.from | date:'dd-MMM-YYYY'}} - {{dataItem.formData.to | date:'dd-MMM-YYYY'}}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Number of SHF's Certified" field="numberOfIndependentShFsCertified" [width]="230">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Number of Training Camps arranged for Improving Agronomic Practices & Land Productivity" class="headers-color">Number of Training Camps arranged for Improving Agronomic Practices & Land Productivity</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div>
                            {{dataItem.formData.numberOfIndependentShFsCertified | number:'1.2'}}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Number of SHF's Attended" field="numberOfShFsAttended">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Number of SHF's Attended" class="headers-color">Number of SHF's Attended</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div>
                            {{dataItem.formData.numberOfShFsAttended | number:'1.2'}}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Status" field="status">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Status" class="headers-color">Status</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <mat-chip class="mt-05 allgoals_process text-center mat-chip-color-text" mat-sm-chip
                            style="width:80px !important" [style.backgroundColor]="dataItem.isVerified == true ? 'rgb(37, 211, 102)' : 'rgb(217, 217, 217)'">
                            {{ dataItem.isVerified == true ? 'Verified' : 'Not Verified' }}
                        </mat-chip>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Actions">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Actions"
                            class="headers-color">Actions</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <button mat-icon-button [matMenuTriggerFor]="menu" #menuTrigger="matMenuTrigger"
                            (click)="openOptionsMenu(dataItem);$event.stopPropagation();">
                            <fa-icon icon="ellipsis-v" class="action-icon-color"></fa-icon>
                        </button>
                    </ng-template>
                </kendo-grid-column>
            </kendo-grid>
        </div>

    </div>
</div>

<mat-menu #menu="matMenu" xPosition="before" yPosition="above">
    <button class="text-center" mat-menu-item [satPopoverAnchorFor]="verifyProgressPopover"
    #verifyProgressPopup="satPopoverAnchor" (click)="verifyProgressPoupOpen(verifyProgressPopup);closePopup();$event.stopPropagation();"
        *ngIf="!isArchived && !selectedItem.isVerified">
        <span>Verify</span>
    </button>
    <button class="text-center" mat-menu-item (click)="editProgressPoup();closePopup();$event.stopPropagation();"
        *ngIf="!isArchived">
        <span>Edit</span>
    </button>
    <button class="text-center" mat-menu-item [satPopoverAnchorFor]="archiveBudgetPopover"
        #archiveBudgetPopup="satPopoverAnchor"
        (click)="archivePopUpOpen(archiveBudgetPopup);closePopup();$event.stopPropagation();">
        <span *ngIf="!isArchived">Archive</span>
        <span *ngIf="isArchived">Unarchive</span>
    </button>
</mat-menu>

<ng-template #AddProgressDialogComponent let-data>
    <app-progress-dialog [data]=[data]></app-progress-dialog>
</ng-template>


<sat-popover backdropClass="backdrop-color" #archiveBudgetPopover hasBackdrop backdropClass="backdrop-color"
    verticalAlign="below" horizontalAlign="end">
    <mat-card class="p-0">
        <mat-card-title class="text-center mat-bg-primary">
            <div class="card-title-text mb-1" *ngIf="!isArchived">
                Archive Progress</div>
            <div class="card-title-text mb-1" *ngIf="isArchived">
                Unarchive Progress</div>
        </mat-card-title>
        <mat-card-content>
            <div class="card-content mb-1" *ngIf="!isArchived">
                Are you sure want to archive this Progress
            </div>
            <div class="card-content mb-1" *ngIf="isArchived">
                Are you sure want to unarchive this Progress
            </div>
            <div class="text-center p-05">
                <button mat-button mat-raised-button class="m-1" (click)="cancelPopUp();">
                    Cancel
                </button>
                <button class="m-1 glossy-button-button" mat-button mat-raised-button color="primary"
                    (click)="deleteProgress();">
                    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="isArchiveLoading">
                    </mat-progress-bar>
                    <span *ngIf="isArchived">Unarchive</span>
                    <span *ngIf="!isArchived">Archive</span>
                </button>
            </div>
        </mat-card-content>
    </mat-card>
</sat-popover>
<sat-popover backdropClass="backdrop-color" #verifyProgressPopover hasBackdrop backdropClass="backdrop-color"
    verticalAlign="below" horizontalAlign="end">
    <mat-card class="p-0">
        <mat-card-title class="text-center mat-bg-primary">
            <div class="card-title-text mb-1">
                Verify Progress</div>
        </mat-card-title>
        <mat-card-content>
            <div class="card-content mb-1">
                Are you sure want to verify this Progress
            </div>
            <div class="text-center p-05">
                <button mat-button mat-raised-button class="m-1" (click)="cancelVerifyPopUp();">
                    Cancel
                </button>
                <button class="m-1 glossy-button-button" mat-button mat-raised-button color="primary"
                    (click)="verifyProgress();">
                    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="isVerifyLoading">
                    </mat-progress-bar>
                    <span>Verify</span>
                </button>
            </div>
        </mat-card-content>
    </mat-card>
</sat-popover>