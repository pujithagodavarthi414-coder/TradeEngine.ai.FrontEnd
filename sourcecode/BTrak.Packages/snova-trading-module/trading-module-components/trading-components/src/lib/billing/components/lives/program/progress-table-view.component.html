<div fxLayout="row wrap" fxLayout.xs="column">
    <div fxFlex fxLayout="row" fxLayout.xs="column">
        <div fxFlex fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
            <button mat-icon-button (click)="fileInput.click()">
                <fa-icon icon="file-excel" class="action-icon-color"
                    style="font-size: 33px !important;color:#f44336 !important"></fa-icon>
                <input type="file" id="file" (change)="uploadEventHandler($event.target.files,$event)" #fileInput hidden
                    accept=".xlsx, .xls, .csv">
            </button>

            <button mat-raised-button class="live-button m-2" matTooltipClass="tooltipClass-mat"
                matTooltip="Click here to add progress detail" (click)="openProgressDialog()">
                <div style="word-wrap: break-word;">
                    <b style="color :#f44336 !important">ADD PROGRESS</b>
                </div>
            </button>
        </div>
    </div>
</div>
<div fxLayout="row">
    <div fxFlex>
        <mat-card class="p-0 m-0">
            <mat-card-title class="full-width data-table-header">
                <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="0" fxLayoutGap.xs="5px">
                    <div fxFlex="40px" fxFlex.xs="35px" fxLayoutAlign="start center" id="client-3">
                        <button type="submit" mat-icon-button class="pull-right" (click)="filterClick()"
                            matTooltipClass="tooltipClass-mat" matTooltip=" Search">
                            <fa-icon icon="filter" class="filter mat-color-accent" style="color:#002060 !important">
                            </fa-icon>
                        </button>
                        <div fxShow.xs="true" fxShow.gt-xs="false" class="p-03 mt-02">
                        </div>
                    </div>
                    <div fxFlex fxLayoutAlign="start center">
                        <div class="filter-section" [hidden]="!isFilterVisible">
                            <ul>
                                <li>
                                    <span class="archive-label">Archive:</span>
                                    <mat-slide-toggle class="mr-1 archive-switch" [(ngModel)]="isArchived"
                                        [checked]="isArchived" (change)="archive()" matTooltipClass="tooltipClass-mat"
                                        matTooltip="Click here for kpi list" id="client-7">
                                    </mat-slide-toggle>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </mat-card-title>
        </mat-card>
        <div class="activity-data kpi-table-height">
            <kendo-grid [data]="progressListData" [filterable]="false" [pageSize]="state.take" [skip]="state.skip"
                [pageSize]="state.take" [sort]="state.sort" [sortable]="true" [pageable]="true"
                (cellClick)="selectedRow($event)" (dataStateChange)="dataStateChange($event)">
                <kendo-grid-column title="SI" [width]="50">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="SI" class="headers-color">SI</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-rowIndex="rowIndex">
                        {{rowIndex+1}}
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Program Name" field="programName">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Program Name" class="headers-color">Program
                            Name</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div>
                            {{ dataItem.programName}}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Phase" field="phase">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Phase" class="headers-color">Phase</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div>
                            {{ dataItem.phase}}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="KPI" field="kpi">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="KPI" class="headers-color">KPI</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div>
                            {{ dataItem.kpi}}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Date(From - To)" field="Date">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Date(From -To)" class="headers-color">Date(From -
                            To)</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        {{ dataItem.dateFrom | date: 'MMM yyyy'}} - {{ dataItem.dateTo | date: 'MMM yyyy'}}
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Number of Certified SHF" field="sHFCount">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Number of Certified SHF" class="headers-color">Number of
                            Certified SHF</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        {{dataItem.sHFCount}}
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column title="Actions">
                    <ng-template kendoGridHeaderTemplate let-column="col">
                        <span matTooltipClass="tooltipClass-mat" matTooltip="Actions" class="headers-color">Actions</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <button mat-icon-button [matMenuTriggerFor]="menu" #menuTrigger="matMenuTrigger"
                            (click)="openOptionsMenu(dataItem);$event.stopPropagation();">
                            <fa-icon icon="ellipsis-v" class="action-icon-color"></fa-icon>
                        </button>
                    </ng-template>
                </kendo-grid-column>
            </kendo-grid>
        </div>

    </div>
</div>

<mat-menu #menu="matMenu" xPosition="before" yPosition="above">
    <button class="text-center" mat-menu-item (click)="editProgressPoup();closePopup();$event.stopPropagation();"
        *ngIf="!isArchived">
        <span>Edit Progress</span>
    </button>
    <button class="text-center" mat-menu-item [satPopoverAnchorFor]="archiveBudgetPopover"
        #archiveBudgetPopup="satPopoverAnchor"
        (click)="archivePopUpOpen(archiveBudgetPopup);closePopup();$event.stopPropagation();">
        <span *ngIf="!isArchived">Archive Progress</span>
        <span *ngIf="isArchived">Unarchive Progress</span>
    </button>
</mat-menu>

<ng-template #AddProgressDialogComponent let-data>
    <app-progress-dialog [data]=[data]></app-progress-dialog>
</ng-template>

<sat-popover backdropClass="backdrop-color" #archiveBudgetPopover hasBackdrop backdropClass="backdrop-color"
    verticalAlign="below" horizontalAlign="end">
    <mat-card class="p-0">
        <mat-card-title class="text-center mat-bg-primary">
            <div class="card-title-text mb-1" *ngIf="!isArchived">
                Archive Progress</div>
            <div class="card-title-text mb-1" *ngIf="isArchived">
                Unarchive Progress</div>
        </mat-card-title>
        <mat-card-content>
            <div class="card-content mb-1" *ngIf="!isArchived">
                Are you sure want to archive this Progress
            </div>
            <div class="card-content mb-1" *ngIf="isArchived">
                Are you sure want to unarchive this Progress
            </div>
            <div class="text-center p-05">
                <button mat-button mat-raised-button class="m-1" (click)="cancelPopUp();">
                    Cancel
                </button>
                <button class="m-1 glossy-button-button" mat-button mat-raised-button color="primary"
                    (click)=" deleteBudget();">
                    <span *ngIf="isArchived">Unarchive</span>
                    <span *ngIf="!isArchived">Archive</span>
                </button>
            </div>
        </mat-card-content>
    </mat-card>
</sat-popover>