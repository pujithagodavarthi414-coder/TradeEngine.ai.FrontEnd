<div fxLayout="column" *ngIf="canAccess_feature_ManageClientSettings">
    <mat-card class="p-0 canteen-manage m-0">
        <mat-card-title class="full-width data-table-header drag-handler">
            <div fxLayout="row wrap" fxLayout.xs="column">
                <div class="card-title-text p-05 ml-05" fxFlex="30" fxLayoutAlign="start center">
                    <span fxFlex="100" class="hide-content-overflow" matTooltipClass="tooltipClass-mat"
                        matTooltip="{{'CLIENTSETTINGS.CLIENTSETTINGS' | translate | softLabelsPipe : softLabels}}">{{'CLIENTSETTINGS.CLIENTSETTINGS'
                        | translate | softLabelsPipe : softLabels}}</span>
                </div>
                <div fxFlex fxLayout="row" fxLayout.xs="column">
                    <div fxFlex="calc(100% - 220px)" fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
                    </div>
                    <!-- <div fxFlex="210px" fxFlex.xs="60px" class="search_goalinput ml-1" fxLayoutAlign="end center"
                        style="right:10px;" fxLayoutAlign.xs="start center">
                        <div fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
                            <mat-form-field class="full-width">
                                <input class="search_goal" matInput placeholder="{{'HRMANAGAMENT.SEARCH' | translate}}"
                                    [(ngModel)]="searchText" (input)="filterByName($event)">
                            </mat-form-field>
                        </div>
                        <span class="softlabels-close" fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
                            <span *ngIf="!searchText"></span>
                            <mat-icon *ngIf="searchText" class="icon-button mr-05" aria-hidden="false"
                                (click)="closeSearch()" style="cursor:pointer">
                                close</mat-icon>
                        </span>
                    </div> -->
                </div>
            </div>
            <mat-divider></mat-divider>
        </mat-card-title>
    </mat-card>

    <div *ngIf="clientModel">
        <button mat-button mat-raised-button (click)="goToClients()" color="primary"
            class="mt-05 ml-05 dark-blue-button">
            <fa-icon class="mr-05" icon="arrow-left"></fa-icon>{{'CLIENTS.BACK' | translate}}
        </button>
        <div class="project-select-container" style="float: right; margin-right:9px;margin-top:5px;">
            <div class="project-value-container">
                <div class="chip">
                    <app-avatar class="chip-avatar" [src]="clientModel.profileImage | fetchSizedAndCachedImage: '25':''"
                        [name]="clientModel?.fullName | removeSpecialCharacters" [isRound]="true"
                        avatarClass="select-avatar" [size]="25">
                    </app-avatar>
                </div> &nbsp;
                <span class="select-label" matTooltip="{{clientModel.fullName}}"
                    style="font-size:20px;">{{clientModel.fullName}}</span>
            </div>
        </div>
    </div>
    <div fxFlex="row wrap">
        <mat-card style="height: calc(100vh - 100px);" class="p-0">
            <mat-card fxFlex="20" class="pl-0 pr-0 pt-0 mt-02">
                <mat-card-content class="listof_roles tag-card pt-1">
                    <mat-list class="compact-list">
                        <!-- <div fxLayout="column" fxLayoutGap="5px" fxLayoutAlign="space-around" class="pt-02">
                            <div fxLayout="row" fxLayoutGap="5px" fxLayoutAlign="space-between center"
                                class="role-card entity-role" (click)="emailSelect()"
                                [ngClass]="{ active: isEmail == true }">
                                <fa-icon class="caret-size" icon="caret-right" *ngIf="!isTreeStructure"
                                    (click)="$event.stopPropagation(); enableTreeStructure()"></fa-icon>
                                <fa-icon class="caret-size" icon="caret-down" *ngIf="isTreeStructure"
                                    (click)="$event.stopPropagation(); enableTreeStructure()"></fa-icon>
                                <i class="fa fa-history mat-accent-color" style="font-size: 19px;"></i>
                                <span fxFlex class="hide-content-overflow" style="margin-left: 5px !important;"
                                    matTooltipClass="tooltipClass-mat tooltip-overflow">
                                    Settings
                                </span>
                            </div>
                            <div fxFlex fxFlexOffset="1.5%" fxLayoutGap="15px" fxLayoutAlign="space-around"
                                *ngIf="isTreeStructure">
                                <div fxFlex="row wrap">
                                    <div fxLayout="column" fxLayoutGap="15px" fxLayoutAlign="space-around"
                                        class="role-card" [ngClass]="{ active: isKycTemplateSelect == true }"
                                        (click)="kycConfigurationTemplateSelect()">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" class="entity-role">
                                            <div style="margin-right:20px">

                                            </div>
                                            <span fxFlex class="hide-content-overflow"
                                                style="margin-left: 5px !important;"
                                                matTooltipClass="tooltipClass-mat tooltip-overflow"
                                                matTooltip="Contract Template Configuration">
                                                KYC Configuration</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                        <div fxLayout="column" fxLayoutGap="5px" fxLayoutAlign="space-around" class="role-card"
                            [ngClass]="{ active: isKycTemplateSelect == true }"
                            (click)="kycConfigurationTemplateSelect()">
                            <div fxLayout="row" fxLayoutGap="5px" fxLayoutAlign="space-between center"
                                class="entity-role">
                                <i class="fa fa-history mat-accent-color" style="font-size: 19px;"></i>
                                <span fxFlex class="hide-content-overflow" style="margin-left: 5px !important;"
                                    matTooltipClass="tooltipClass-mat tooltip-overflow" matTooltip="KYC Configuration">
                                    KYC Configuration</span>
                            </div>
                        </div>
                        <div fxLayout="column" fxLayoutGap="5px" fxLayoutAlign="space-around" class="role-card"
                            [ngClass]="{ active: isEmailTemplate == true }" (click)="emailTemplateSelect()"
                            *ngIf="canAccess_feature_ViewEmailTemplates">
                            <div fxLayout="row" fxLayoutGap="5px" fxLayoutAlign="space-between center"
                                class="entity-role">
                                <i class="fa fa-history mat-accent-color" style="font-size: 19px;"></i>
                                <span fxFlex class="hide-content-overflow" style="margin-left: 5px !important;"
                                    matTooltipClass="tooltipClass-mat tooltip-overflow"
                                    matTooltip="Email Template Configuration">
                                    Email Template Configuration</span>
                            </div>
                        </div>

                    </mat-list>
                </mat-card-content>
            </mat-card>
            <mat-card fxFlex class="p-0 mb-md-1" fxFlex="row wrap" *ngIf="isEmail">
                <div fxFlex="49" class="m-1">
                    <mat-card-title class="text-center mat-bg-primary">
                        <div class="card-title-text p-05">Letter Head
                        </div>
                    </mat-card-title>
                    <mat-card-content class="p-05" style="width: 100%;">
                        <app-dropzone [referenceTypeId]="referenceTypeId"
                            [getFilesByReferenceId]="getFilesByReferenceId" class="full-width"
                            [moduleTypeId]="moduleTypeId" [removeFiles]="removeFiles" [referenceId]="clientId"
                            [isAcceptSingleFile]=true [selectedParentFolderId]="selectedParentFolderId"
                            [selectedStoreId]="selectedStoreId" [isButtonVisible]="true"
                            [placeHolder]="'Upload letter head'">
                        </app-dropzone>
                    </mat-card-content>
                </div>

                <div fxFlex="49" class="m-1">
                    <mat-card-title class="text-center mat-bg-primary">
                        <div class="card-title-text p-05"> Stamp
                        </div>
                    </mat-card-title>
                    <mat-card-content class="p-05" style="width: 100%;">
                        <app-dropzone [referenceTypeId]="stampReferenceTypeId"
                            [getFilesByReferenceId]="getFilesByReferenceId" class="full-width" [isAcceptSingleFile]=true
                            [moduleTypeId]="stampModuleTypeId" [removeFiles]="removeFiles" [referenceId]="clientId"
                            [selectedParentFolderId]="selectedParentFolderId" [selectedStoreId]="selectedStoreId"
                            [isButtonVisible]="true" [placeHolder]="'Upload stamp'">
                        </app-dropzone>
                    </mat-card-content>
                </div>

            </mat-card>
            <div class="p-0 mb-md-1 full-width" *ngIf="isEmailTemplate">
                <app-trading-component-email-template [clientId]="clientId"></app-trading-component-email-template>
            </div>
            <div class="p-0 mb-md-1 full-width" *ngIf="isContractTemplate">
                <app-trading-contract-template></app-trading-contract-template>
            </div>
            <div class="p-0 mb-md-1 full-width" *ngIf="isTradeTemplate">
                <div class="trade-templates-list" id="style-1">
                    <div fxLayout="row wrap">
                        <div *ngFor="let template of templateTypes">
                            <div class="ml-15 mr-15 mb-15">
                                <div fxFlex="100" fxFlex.lt-sm="100" fxFlex.sm="50" fxFlex.md="33">
                                    <app-trading-trade-template [clientId]="clientId"
                                        [contractTemplatesList]="templatesList" [templateId]="template.templateTypeId"
                                        [templateName]="getTemplateTypeName(template)" [keyName]="getKeyName(template)">
                                    </app-trading-trade-template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



            </div>
            <div class="p-0 mb-md-1 full-width" *ngIf="isInvoiceTemplate">
                <div fxFlex="30" class="m-1">
                    <mat-card-title class="text-center mat-bg-primary">
                        <div class="card-title-text p-05">Invoice Template Configuration
                        </div>
                    </mat-card-title>
                    <mat-card-content class="p-05">
                        <div>

                            <mat-form-field class="full-width">
                                <mat-select [(ngModel)]="invoiceTemplateId" placeholder="select template" required>
                                    <mat-option [value]="template.tradeTemplateId"
                                        *ngFor="let template of templatesList | tradeTemplateTypeFilterPipe : templateTypeId">
                                        {{ template.tradeTemplateName }}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                            <mat-form-field class="full-width">
                                <input matInput placeholder="{{ 'COMPANYSETTINGS.DESCRIPTION' | translate }}"
                                    [(ngModel)]="invoiceTemplateDescription">
                                <mat-error *ngIf="!invoiceTemplateDescription">
                                    Description is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="mt-1 text-center">
                            <button mat-raised-button color="primary" class="mr-1 glossy-button-button"
                                [disabled]="loadingInProgress" (click)="saveSettings('InvoiceTemplate')">
                                <mat-progress-bar color="primary" mode="indeterminate" *ngIf="loadingInProgress">
                                </mat-progress-bar>
                                <fa-icon class="mr-05" icon="check"></fa-icon> {{ 'SAVE' | translate }}
                            </button>
                            <button mat-button mat-raised-button (click)="resetKyc()" type="button">
                                <fa-icon class="mr-05" icon="times"></fa-icon>
                                {{ 'CANCEL' | translate }}
                            </button>
                        </div>
                    </mat-card-content>
                </div>
            </div>
            <div class="p-0 mb-md-1 full-width" *ngIf="isKycTemplateSelect">
                <div fxFlex="49" class="m-1">
                    <mat-card-title class="text-center mat-bg-primary">
                        <div class="card-title-text p-05">Emails
                        </div>
                    </mat-card-title>
                    <mat-card-content class="p-05" style="width: 100%;">
                        <div fxLayout="row wrap">
                            <mat-form-field class="full-width tags-popup mb-1"
                                hintLabel="{{ 'EXPENSEMANAGEMENT.PLEASEPRESSCOMMAORENTERFORNEXTMAIL' | translate }}">
                                <mat-chip-list #tagsList1>
                                    <mat-chip *ngFor="let tags of toMailsList" [selectable]="selectable"
                                        [removable]="removable" (removed)="removeToMailId(tags)" class="userstory-tags">
                                        <span class="hide-content-overflow" matTooltip="{{ tags }}"
                                            matTooltipClass="tooltipClass-mat tooltip-overflow">
                                            {{tags}}
                                        </span>
                                        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                                    </mat-chip>
                                    <input placeholder="KYC submission emails *" [matChipInputFor]="tagsList1"
                                        [(ngModel)]="toMail" [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                        required (matChipInputTokenEnd)="addToMailIds($event)">
                                    <!-- <fa-icon icon="spinner" *ngIf="(tagsOperationInProgress$ | async)"></fa-icon> -->
                                </mat-chip-list>
                                <mat-error *ngIf="count == 0">
                                    Please atleast one email
                                </mat-error>

                            </mat-form-field>
                            <mat-form-field class="full-width">
                                <input matInput placeholder="{{ 'COMPANYSETTINGS.DESCRIPTION' | translate }}" required
                                    [(ngModel)]="description">
                                <mat-error *ngIf="!description">
                                    Description is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="text-center">
                            <button class="mr-1 glossy-button-button" mat-button mat-raised-button color="primary"
                                [disabled]="loadingInProgress || (count == 0) || !description"
                                (click)="saveSettings('KYCSubmissionEmails')">
                                <mat-progress-bar color="primary" mode="indeterminate" *ngIf="loadingInProgress">
                                </mat-progress-bar>
                                <fa-icon class="mr-05" icon="check"></fa-icon>{{ 'SAVE' | translate }}
                            </button>
                            <button mat-button mat-raised-button (click)="resetEmails()">
                                <fa-icon class="mr-05" icon="times"></fa-icon> {{'TESTMANAGEMENT.CANCEL' |
                                translate}}
                            </button>
                        </div>
                    </mat-card-content>
                </div>
                <!-- <div fxFlex="49" class="m-1">
                    <mat-card-title class="text-center mat-bg-primary">
                        <div class="card-title-text p-05">KYC Duration
                        </div>
                    </mat-card-title>
                    <mat-card-content class="p-05">
                        <form [formGroup]="kycForm" #formDirective="ngForm" novalidate
                            (submit)="kycForm.valid && saveSettings('KYCDuration')">
                            <div>
                                <mat-form-field class="full-width">
                                    <input type="number" matInput formControlName="settingValue"
                                        placeholder="KYC duration" required>
                                    <mat-error>
                                        <span *ngIf="kycForm.get('settingValue').hasError('min')">KYC expiry days
                                            should
                                            be
                                            minimun of one day </span>
                                        <span *ngIf="kycForm.get('settingValue').hasError('max')">KYC expiry days
                                            should
                                            be
                                            less than two years</span>
                                        <span *ngIf="kycForm.get('settingValue').hasError('required')">KYC duration
                                            is
                                            required</span>
                                    </mat-error>
                                </mat-form-field>
                                <mat-form-field class="full-width">
                                    <input matInput formControlName="description"
                                        placeholder="{{ 'COMPANYSETTINGS.DESCRIPTION' | translate }}" required>
                                    <mat-error
                                        *ngIf="kycForm.get('description').hasError('required') && kycForm.get('description').touched">
                                        Description is required
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="mt-1 text-center">
                                <button mat-raised-button color="primary" class="mr-1 glossy-button-button"
                                    [disabled]="!kycForm.valid||loadingInProgress">
                                    <mat-progress-bar color="primary" mode="indeterminate" *ngIf="loadingInProgress">
                                    </mat-progress-bar>
                                    <fa-icon class="mr-05" icon="check"></fa-icon> {{ 'SAVE' | translate }}
                                </button>
                                <button mat-button mat-raised-button (click)="resetKyc()" type="button">
                                    <fa-icon class="mr-05" icon="times"></fa-icon>
                                    {{ 'CANCEL' | translate }}
                                </button>
                            </div>
                        </form>
                    </mat-card-content>
                </div> -->
            </div>
        </mat-card>
    </div>
</div>

<app-common-message-box *ngIf="!(canAccess_feature_ManageClientSettings)"
    textToDisplay="{{ 'PERMISSIONMESSAGE' | translate}}">
</app-common-message-box>