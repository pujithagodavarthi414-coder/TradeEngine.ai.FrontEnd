<div class="custom-dialog">
    <div class="custom-close" mat-dialog-close (click)="onNoClick()">
        <fa-icon icon="times" class="project-dialog"></fa-icon>
    </div>
</div>

<div mat-dialog-content class="project-dialogContent">
    <mat-card class="p-0">
        <form [formGroup]="templateForm" #formDirective="ngForm" novalidate (submit)="templateForm.valid" *ngIf="!isPreview">
            <div fxLayout="row wrap" fxLayout.xs="column" fxLayoutGap.xs="0" fxLayoutGap="10px">
                <div fxFlex="25" fxFlex.lt-md="100" class="pl-1">
                    <mat-form-field class="full-width">
                        <input matInput formControlName="tradeTemplateName" required
                            placeholder="Trade template name">
                    </mat-form-field>
                </div>
                <div fxFlex="25" fxFlex.lt-md="100">
                    <mat-form-field class="full-width">
                        <mat-select placeholder="Trade template type" formControlName="templateTypeId" required
                            (selectionChange)="changeFormView($event.value)">
                            <mat-option *ngFor="let type of templateTypes" [value]="type.templateTypeId">
                                {{type.templateTypeName}}
                            </mat-option>
                        </mat-select>
                        <mat-error
                            *ngIf="templateForm.get('templateTypeId').hasError('required') && templateForm.get('templateTypeId').touched">
                            Please select trade template type</mat-error>
                    </mat-form-field>
                </div>
                <!-- color picker -->
                <div fxFlex="25" fxFlex.lt-md="100">
                <mat-form-field class="full-width status-color mb-05">
                    <!-- <mat-label>Choose Color</mat-label>
                    <input matInput type="color" ejs-colorpicker formControlName="formBgColor"  > -->                    
                        <input formControlName="formBgColor" matInput
                            placeholder="choose color" [(colorPicker)]="color"
                            [cpPosition]="'bottom'" [style.background]="color"
                            (colorPickerClose)="onChangeColor($event)"
                            [value]="color"/>
                        <!-- <mat-error
                            *ngIf="contractStatusForm.get('contractStatusColor').hasError('required') && contractStatusForm.get('contractStatusColor').touched">
                            {{ 'CONTRACTSTATUS.PLEASESELECTCONTRACTSTATUSCOLOR' |  translate }}
                        </mat-error> -->
                  </mat-form-field>
                </div>
                <!--  -->
            </div>
        </form>
        <div>
        

        <div [ngStyle]="{'background-color': formBgColor}">
            <div class="performance" id="style-1" *ngIf="isFormView && isPreview">
                <app-form-builder-component [form]="tradeTemplateFormJson" (change)="onChange($event)" [submissionData]="submission" [preview]="disable"></app-form-builder-component>
            </div>
            <div class="performance" id="style-1" *ngIf="isFormView && !isPreview">
                <app-form-builder-component [form]="tradeTemplateFormJson" (change)="onChange($event)"></app-form-builder-component>
            </div>
        </div>
        
        <button mat-button mat-raised-button *ngIf="!tradeTemplateId" class="glossy-button-button m-1 pull-right" color="primary"
            type="button" [disabled]="(isAddInProgress || !templateForm.valid)"
            (click)="upsertTradeTemplate()">
            <fa-icon class="mr-05" icon="save"></fa-icon>{{ 'SAVE' | translate }}
        </button>
        <button *ngIf="tradeTemplateId && !isPreview" mat-button mat-raised-button class="m-1 pull-right glossy-button-button" color="primary"
            type="button" [disabled]="(isAddInProgress || !templateForm.valid)"
            (click)="upsertTradeTemplate()">
            <fa-icon class="mr-05" icon="file"></fa-icon>{{ 'UPDATE' | translate }}
        </button>
        </div>
    </mat-card>
</div>