<app-common-message-box *ngIf="!(canAccess_feature_EmployeeWorkItems)"
  textToDisplay="{{ 'PRODUCTIVITYDASHBOARD.PERMISSION' | translate }}">
</app-common-message-box>
<div fxLayout="column">
<mat-card class="p-0 m-0" *ngIf="(canAccess_feature_EmployeeWorkItems)" fxLayout="column">
  <mat-card-title class="data-table-header">
    <div fxLayout="row wrap">
      <div fxFlex="50" fxFlex.xs="100">
        <div class="card-title-text pt-1">{{'MYPROFILE.PREVIOUSUSERSTORIES' | translate | softLabelsPipe : softLabels | titlecase}}
        </div>
      </div>
      <div class="mr-05 search_goalinput" fxFlex="48" fxFlex.xs="100" fxFlexOffset.xs="20px">
        <mat-form-field fxLayoutAlign="end center" fxLayoutAlign.xs="start center">
          <input class="search_goal" matInput placeholder="{{'SEARCH' | translate}}" [(ngModel)]="searchText"
            (input)="search()">
        </mat-form-field>
        <span class="close_icon" style="right: 5px !important;">
          <span *ngIf="!searchText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          <mat-icon *ngIf="searchText" class="icon-button" aria-hidden="false" (click)="closeSearch()"
            style="cursor:pointer">
            close</mat-icon>
        </span>
      </div>
    </div>
    <mat-divider></mat-divider>
  </mat-card-title>
  <div fxFlex class="p-05" fxLayout="row" *ngIf="searchText">
    <mat-chip disableRipple matRipple class="mr-08" *ngIf="searchText">
      <b>{{'SEARCH' | translate}}:&nbsp;</b>
      {{ searchText }}
      <fa-icon icon="times" class="ml-05 mat-color-accent cursor-pointer" (click)="closeSearch()">
      </fa-icon>
    </mat-chip>
  </div>
  <mat-card-content class="p-0" fxLayout="column">
    <div class="activity-data profile-table-height pagination-move-left">
      <ngx-datatable class="btrak" [columnMode]="'force'" [headerHeight]="35" [footerHeight]="50" [rowHeight]="35"
        [limit]="10" [rows]="previousDeadLineDataDetails" [count]="totalCount" [externalPaging]="true"
        [offset]="pageNumber" (sort)="onSort($event)" [loadingIndicator]="anyOperationInProgress"
        (page)='setPage($event)'
        [messages]="{emptyMessage:('NODATATODISPLAY' | translate), totalMessage: 'TOTAL' | translate}">
        <ngx-datatable-column name="{{'MYPROFILE.USERNAME' | translate}}" [flexGrow]="1" prop="ownerName">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <div class="icon-button" fxLayout="row"
              (click)="navigateToOwnerPage(row.ownerUserId); $event.stopPropagation();">
              <div *ngIf="row.profileImage != null && row.profileImage != ''">
                <app-avatar [src]="row.profileImage | fetchSizedAndCachedImage: '30':''" [isRound]="true" size="30">
                </app-avatar>
              </div>
              <div *ngIf="row.profileImage == null || row.profileImage == ''">
                <app-avatar [name]="row.ownerName | removeSpecialCharacters" [isRound]="true" size="30"></app-avatar>
              </div>
              <span class="ml-05 mt-02 hide-content-overflow" matTooltip="{{row.ownerName}}" matTooltipShowDelay="400"
                fxFlex>
                {{row?.ownerName}}
              </span>
            </div>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="{{'MYPROFILE.USERSTORY' | translate | softLabelsPipe : softLabels}}" [flexGrow]="1"
          prop="userStoryName">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.userStoryName }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="{{'MYPROFILE.ESTIMATEDTIME' | translate}}" [flexGrow]="1" prop="estimatedTime">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.estimatedTime }}
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>
    </div>
  </mat-card-content>
</mat-card>
</div>