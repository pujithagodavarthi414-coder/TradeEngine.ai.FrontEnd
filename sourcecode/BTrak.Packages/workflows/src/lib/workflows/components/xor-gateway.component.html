<div class="custom-dialog">
    <div class="custom-close" mat-dialog-close (click)="onNoClick()">
        <fa-icon icon="times" class="project-dialog"></fa-icon>
    </div>
</div>
<mat-card class="filter-data p-0">
    <mat-card-title class="text-center">
        <div class="card-title-text mat-bg-primary p-05">
            Xor gateway</div>
    </mat-card-title>
    <form [formGroup]="fieldForm" novalidate (submit)="fieldForm.valid && upsertFieldUpdate()">
        <div id="style-1" class="goal-create-height p-1">
            <div fxLayout="row wrap" class="p-05 ">
                <div fxFlex="98">
                    <div fxFlex fxLayout="row wrap">
                        <div fxFlex="30">
                            <div class="pt-1">Form Name</div>
                        </div>
                        <div fxFlex="50" class="pt-1">
                            <mat-label>{{formname}}</mat-label>
                        </div>
                        <!-- <mat-form-field class="full-width" fxFlex="50">
                        <input matInput formControlName="formtypeName">
                      </mat-form-field> -->
                    </div>
                </div>
                <div fxFlex="98">
                    <div fxFlex fxLayout="row wrap">
                        <div fxFlex="30">
                            <div class="pt-1">Gateway Name *</div>
                        </div>
                        <mat-form-field class="full-width" fxFlex="50">
                            <input matInput formControlName="name">
                            <mat-error>
                                <span
                                  *ngIf="fieldForm.get('name').hasError('required')">
                                Gateway name is required</span>
                              </mat-error> 
                        </mat-form-field>
                    </div>
                </div>
                <div fxFlex="98">
                    <div fxFlex fxLayout="row wrap">
                        <div fxFlex="30">
                            <div class="pt-1">Gateway type *</div>
                        </div>
                        <mat-form-field class="full-width" fxFlex="50">
                            <mat-select formControlName="orGateWayType" required autocomplete="off">
                                <mat-option [value]="'Fork'">
                                    Fork
                                </mat-option>
                                <mat-option [value]="'Join'">
                                    Join
                                </mat-option>
                            </mat-select>
                            <mat-error>
                                <span
                                  *ngIf="fieldForm.get('orGateWayType').hasError('required')">
                                Gateway type is required</span>
                              </mat-error> 
                        </mat-form-field>
                    </div>
                </div>
                <div fxFlex="98">
                    <div fxFlex fxLayout="row wrap">
                        <div fxFlex="30">
                            <div class="pt-1">Else condition</div>
                        </div>
                        <mat-form-field class="full-width" fxFlex="50">
                            <mat-select formControlName="elseCond" autocomplete="off">
                          <mat-option [value]=""
                          >select</mat-option>
                                <mat-option [value]="a.name" *ngFor="let a of actions">
                                    {{ a.name }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
                <div fxFlex="98" class="workflowsubheader">
                    Add Conditions and Tasks
                </div>
                <div fxFlex="98">
                    <div fxFlex fxLayout="row wrap">
                        Add the conditions for gateway </div>
                </div>
                <div fxFlex="98">
                    <div fxFlex fxLayout="row wrap">
                    <div class="mr-08 text-left workflowlink" fxflex="100" fxflex.gt-sm="100">
                        <a (click)="getControlsLength()" class="custom-link">+ Add Condition</a>
                      </div>

                    <div *ngIf="conditionShow" fxFlex="100" fxFlex.gt-sm="100">
                        <div formArrayName="conditionSteps"
                          *ngFor="let item of fieldForm.get('conditionSteps')['controls']; let i = index;">
                          <mat-card-content class="Step-description mt-1" fxFlex="100" fxFlex.gt-sm="100">
                            <div [formGroupName]="i" style="display: flex">
                              <div class="align-center" fxFlex="30px" class="mr-05">
                                <span class="test-case-step-count count-padding">{{i + 1}}</span>
                              </div>
                              <mat-form-field class="full-width" fxFlex="15" *ngIf="item.contains('fieldName1')">
                                <mat-select formControlName="fieldName1" required autocomplete="off" (selectionChange)="onChangeField($event, i)">
                                    <mat-option [value]="forms.key" *ngFor="let forms of formFieldsDropDown">
                                        {{ forms.key }}
                                    </mat-option>
                                </mat-select>
                                <mat-error>
                                    <span
                                      *ngIf="item.get('fieldName1').hasError('required') && item.get('fieldName1').touched">
                                      Field name required</span>
                                  </mat-error>
                            </mat-form-field>
                            <div fxFlex="5"></div>
                            <mat-form-field class="full-width" fxFlex="15" *ngIf="item.contains('functionName')">
                                <mat-select formControlName="functionName" required autocomplete="off">
                                    <mat-optgroup *ngFor="let group of functions" [label]="group.name"
                                        [disabled]="group.disabled">
                                        <mat-option *ngFor="let f of group.fns" [value]="f">
                                            {{f}}
                                        </mat-option>
                                    </mat-optgroup>
                                </mat-select>
                                <mat-error>
                                    <span
                                      *ngIf="item.get('functionName').hasError('required') && item.get('functionName').touched">
                                      Function name required</span>
                                  </mat-error>
                            </mat-form-field>
                       
                        <div fxFlex="10" *ngIf="fieldForm.get('orGateWayType').value == 'Fork'">
                            <div class="fieldequal">=</div>
                        </div>
                              <!-- <div fxFlex="100" fxFlex.gt-xs="22" fxFlex.xs="36" class="mr-05">
                                <mat-form-field class="full-width">
                                  <input matInput formControlName="criteriaValue" required autocomplete="off">
                                  <mat-error>
                                    <span
                                      *ngIf="item.get('criteriaValue').hasError('required') && item.get('criteriaValue').touched">
                                      value required</span>
                                  </mat-error>
                                </mat-form-field>
                              </div> -->

                              <mat-form-field class="full-width" fxFlex="15" *ngIf="item.contains('fieldValue')">
                                <input matInput formControlName="fieldValue" required autocomplete="off">
                                <mat-error>
                                    <span
                                      *ngIf="item.get('fieldValue').hasError('required') && item.get('fieldValue').touched">
                                      Field value required</span>
                                  </mat-error>
                            </mat-form-field>
                            <div fxFlex="10" *ngIf="fieldForm.get('orGateWayType').value == 'Fork'">
                                <div class="fieldequal"> => </div>
                            </div>
                            <mat-form-field class="full-width" fxFlex="15" *ngIf="item.contains('taskName')">
                                <mat-select formControlName="taskName" required autocomplete="off">
                                    <mat-option [value]="a.name" *ngFor="let a of actions">
                                        {{ a.name }}
                                    </mat-option>
                                </mat-select>
                                <mat-error>
                                    <span
                                      *ngIf="item.get('taskName').hasError('required') && item.get('taskName').touched">
                                      Field name required</span>
                                  </mat-error>
                            </mat-form-field>

                              <div fxFlex="40px" fxLayout="column" fxLayoutAlign="space-around center" class="ml-05"
                                fxLayoutGap="8px">
                                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px">
                                  <a class="icon-hover" matTooltip="Add" (click)="addItem(i)">
                                    <fa-icon icon="plus" class="mat-color-accent"></fa-icon>
                                  </a>
                                  <a class="icon-hover" matTooltip="Delete" (click)="removeItem(i)">
                                    <fa-icon icon="minus" class="mat-color-accent"></fa-icon>
                                  </a>
                                </div>
        
                              </div>
                            </div>
                          </mat-card-content>
                        </div>
                      </div>

                </div>
            </div>
        </div>
        </div>
        <div class="mt-05">
            <button class="pull-right mr-1" mat-raised-button type="submit" color="primary"
                [disabled]="!fieldForm.valid">
                <fa-icon class="mr-05" icon="check"></fa-icon>
                Save
            </button>
            <button class="pull-right mr-1" mat-raised-button (click)="cancelFiledUpdate()"
                [disabled]="!fieldForm.valid " type="button">
                Cancel
            </button>
        </div>
    </form>
</mat-card>