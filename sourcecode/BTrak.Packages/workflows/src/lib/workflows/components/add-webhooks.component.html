<div class="custom-dialog">
  <div class="custom-close" mat-dialog-close (click)="onNoClick()">
    <fa-icon icon="times" class="project-dialog"></fa-icon>
  </div>
</div>
<mat-card class="filter-data p-0">
  <mat-card-title class="text-center">
    <div class="card-title-text mat-bg-primary p-05">
      Add Webhook</div>

  </mat-card-title>
  <form [formGroup]="webhookForm" novalidate>
    <div id="style-1" class="goal-create-height p-1">
      <div fxLayout="row wrap" class="p-05 ">
        <div fxFlex="98">
          <div fxFlex fxLayout="row wrap">
            <div fxFlex="30">
              <div class="pt-1">Form Name</div>
            </div>
            <div fxFlex="50" class="pt-1"> <mat-label>{{formname}}</mat-label></div>

            <!-- <mat-form-field class="full-width" fxFlex="50">
                        <input matInput formControlName="formtypeName">
                      </mat-form-field> -->
          </div>
        </div>


        <input matInput hidden formControlName="id" />

        <div fxFlex="98">
          <div fxFlex fxLayout="row wrap">
            <div fxFlex="30">
              <div class="pt-1">Webhook Name</div>
            </div>
            <mat-form-field class="full-width" fxFlex="50">
              <input matInput formControlName="webhookName">
            </mat-form-field>
          </div>
        </div>

        <div fxFlex="98">
          <div fxFlex fxLayout="row wrap">
            <div fxFlex="30">
              <div class="pt-1">URL to Notify</div>
            </div>
            <mat-form-field class="full-width" fxFlex="50">
              <input matInput formControlName="urltoNotify">
            </mat-form-field>
          </div>
        </div>


        <div fxFlex="98">
          <div fxFlex fxLayout="row wrap">
            <div fxFlex="30">
              <div class="pt-1">Method</div>
            </div>
            <mat-radio-group class="consider_radio" formControlName="method" (change)="onChange($event)">
              <div fxLayout="row" fxFlex="80">
                <mat-radio-button value="Post" class="
                MR20">
                  Post

                </mat-radio-button>
              </div>
              <div fxLayout="row" fxFlex="80">
                <mat-radio-button value="Get">
                  Get</mat-radio-button>
              </div>
            </mat-radio-group>
          </div>
        </div>

        <div fxFlex="98">
          <div fxFlex fxLayout="row wrap">
            <div fxFlex="30">
              <div class="pt-1">Description</div>
            </div>
            <mat-form-field class="full-width" fxFlex="50">
              <input matInput formControlName="description">
            </mat-form-field>
          </div>
        </div>
        <div fxFlex="98" class="workflowsubheader">
          URL Parameters
        </div>
        <div fxLayout="row" style="padding-top: 15px;">
          Append Entity Parameters</div>
        <div *ngIf="entityStepsShow" fxFlex="98" class="dvCriteria" style="padding-top: 15px;">
          <div fxLayout="row">Parameters in Standard Format(Name = Value)</div>
          <div formArrayName="entityparamSteps"
            *ngFor="let item of webhookForm.get('entityparamSteps')['controls']; let i = index;">
            <mat-card-content class="Step-description mt-1" fxFlex="98" fxFlex.gt-sm="98">
              <div [formGroupName]="i" style="display: flex">
                <div class="align-center" fxFlex="30px" class="mr-05">
                  <span class="test-case-step-count count-padding">{{i + 1}}</span>
                </div>

                <div fxFlex="100" fxFlex.gt-xs="22" fxFlex.xs="36" class="mr-05">
                  <mat-form-field class="full-width">
                    <input matInput formControlName="entityName" required autocomplete="off">
                    <mat-error>
                      <span *ngIf="item.get('entityName').hasError('required') && item.get('entityName').touched">
                        Name required</span>
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex="20">
                  <div class="fieldequal">=</div>
                </div>
                <div fxFlex="100" fxFlex.gt-xs="22" fxFlex.xs="36" class="mr-05">
                  <mat-form-field class="full-width">
                    <input matInput formControlName="entityValue" required autocomplete="off">
                    <mat-error>
                      <span *ngIf="item.get('entityValue').hasError('required') && item.get('entityValue').touched">
                        value required</span>
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex="40px" fxLayout="column" fxLayoutAlign="space-around center" class="ml-05"
                  fxLayoutGap="8px">
                  <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px">
                    <a class="icon-hover" matTooltip="Add" (click)="addItem(i)">
                      <fa-icon icon="plus" class="mat-color-accent"></fa-icon>
                    </a>
                    <a class="icon-hover" matTooltip="Delete" (click)="removeItem(i)">
                      <fa-icon icon="minus" class="mat-color-accent"></fa-icon>
                    </a>
                  </div>

                </div>
              </div>
            </mat-card-content>
          </div>
          <div class="mr-08 text-left workflowlink" fxflex="100" fxflex.gt-sm="100">
            <a (click)="getControlsLength()" class="custom-link">+ Add New</a>
          </div>
        </div>
        <!-- <div fxFlex="98" 
          <div fxLayout="row" class="dvCriteria">
            Parameters in the User Defined Format(XML, JSON, etc.)
          </div>
            </div> -->
        <div fxFlex="98" class="dvCriteria" style="padding-top: 15px;">
          <div fxFlex fxLayout="row wrap" fxFlex="100">
            Parameters in the User Defined Format(XML, JSON, etc.)


            <div fxFlex="98">
              <div fxFlex fxLayout="row wrap">
                <div fxFlex="30">
                  <div class="pt-1">Parameter Name</div>
                </div>
                <mat-form-field class="full-width" fxFlex="50">
                  <input matInput formControlName="parameterName">
                </mat-form-field>
              </div>
            </div>

            <div fxFlex="98">
              <div fxFlex fxLayout="row wrap">
                <div fxFlex="30">
                  <div class="pt-1">Value Description(XML, JSON, etc.)</div>
                </div>
                <mat-form-field class="full-width" fxFlex="50">
                  <input matInput formControlName="valuedescription">
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>

        <div fxLayout="row" style="padding-top: 15px;">
          Append Custom Parameters(Like API Key, Auth Token, etc.)</div>
        <div *ngIf="customStepsShow" fxFlex="100" fxFlex.gt-sm="100" class="dvCriteria">
          <div fxLayout="row">Parameters in Standard Format(Name = Value)</div>
          <div formArrayName="customparamSteps"
            *ngFor="let item of webhookForm.get('customparamSteps')['controls']; let j = index;">
            <mat-card-content class="Step-description mt-1" fxFlex="100" fxFlex.gt-sm="100">
              <div [formGroupName]="j" style="display: flex">
                <div class="align-center" fxFlex="30px" class="mr-05">
                  <span class="test-case-step-count count-padding">{{j + 1}}</span>
                </div>

                <div fxFlex="100" fxFlex.gt-xs="22" fxFlex.xs="36" class="mr-05">
                  <mat-form-field class="full-width">
                    <input matInput formControlName="customentityName" required autocomplete="off">
                    <mat-error>
                      <span
                        *ngIf="item.get('customentityName').hasError('required') && item.get('customentityName').touched">
                        Name required</span>
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex="20">
                  <div class="fieldequal">=</div>
                </div>
                <div fxFlex="100" fxFlex.gt-xs="22" fxFlex.xs="36" class="mr-05">
                  <mat-form-field class="full-width">
                    <input matInput formControlName="customentityValue" required autocomplete="off">
                    <mat-error>
                      <span
                        *ngIf="item.get('customentityValue').hasError('required') && item.get('customentityValue').touched">
                        value required</span>
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex="40px" fxLayout="column" fxLayoutAlign="space-around center" class="ml-05"
                  fxLayoutGap="8px">
                  <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px">
                    <a class="icon-hover" matTooltip="Add" (click)="addCustomItem(j)">
                      <fa-icon icon="plus" class="mat-color-accent"></fa-icon>
                    </a>
                    <a class="icon-hover" matTooltip="Delete" (click)="removeCustomItem(j)">
                      <fa-icon icon="minus" class="mat-color-accent"></fa-icon>
                    </a>
                  </div>

                </div>
              </div>
            </mat-card-content>
          </div>
          <div class="mr-08 text-left workflowlink" fxflex="100" fxflex.gt-sm="100">
            <a (click)="getCustomControlsLength()" class="custom-link">+ Add New</a>
          </div>
        </div>

        <div fxFlex="98">
          <div fxFlex fxLayout="row wrap">
            <div fxFlex="30">
              <div class="pt-1">Preview URL</div>
            </div>
            <mat-form-field class="full-width" fxFlex="40">
              <input matInput formControlName="previewURL">
            </mat-form-field>
            <div fxFlex="20" class="workflowlink">
              <a (click)="refreshURL()" class="custom-link ">Refresh URL</a>
            </div>
          </div>
        </div>

      </div>
    </div>
    <div class="mt-05">

      <button class="pull-right mr-1" mat-raised-button (click)="upsertFieldUpdate()" color="primary"
        [disabled]="!webhookForm.valid">
        <fa-icon class="mr-05" icon="check"></fa-icon>
        Save </button>
      <button class="pull-right mr-1" mat-raised-button (click)="cancelFiledUpdate()" [disabled]="!webhookForm.valid "
        type="button">

        Cancel
      </button>
    </div>
  </form>
</mat-card>