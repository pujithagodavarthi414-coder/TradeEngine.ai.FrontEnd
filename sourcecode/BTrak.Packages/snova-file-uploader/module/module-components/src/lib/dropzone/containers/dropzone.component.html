<div fxLayout="column">
  <mat-form-field class="mr-05" [hidden]="!isQuestionDocuments">
    <input matInput [(ngModel)]="customFileName" placeholder="{{ 'ACTIVITYTRACKER.NAME' | translate }}">
  </mat-form-field>
  
  
    <div class="custom-dropzone" ngx-dropzone (change)="filesSelected($event)" [accept]="fileExtensions"
    [maxFileSize]="maxFileSize" [disabled]="(anyOperationInProgress)" [multiple]="isMultiple">
    <ngx-dropzone-label>
      <span>{{placeholder}}</span>
    </ngx-dropzone-label>
    <ngx-dropzone-preview class="custom-dropzone-preview" *ngFor="let f of files" [removable]="true"
      (removed)="onRemove(f)">
      <ngx-dropzone-label class="custom-dropzone-label" [attr.data-tip]="f.name">{{ f.name }} ({{ f.type }})
      </ngx-dropzone-label>
    </ngx-dropzone-preview>
  </div>
  <div class="m-05 text-muted" style="text-align: center;">
    <span>Allowed file extensions : {{setAllowedFileExtensions()}}</span>
  </div>
  

  <mat-progress-bar color="primary" mode="determinate" [value]="progressValue" *ngIf="progressValue > 0">
  </mat-progress-bar>
  <div *ngIf="progressValue > 0">
    {{progressValue}}% {{'DOCUMENTMANAGEMENT.COMPLETED' | translate}} (Uploading {{fileCounter}}
    {{'DOCUMENTMANAGEMENT.OF' | translate}} {{fileNames.length}} {{'DOCUMENTMANAGEMENT.FILES' | translate}})
  </div>
  <div class="mt-05" fxLayoutAlign="center end">
    <!-- <button class="mr-1" color="primary" *ngIf="enableDrive" mat-button mat-raised-button (click)="selectFromDrive();" [disabled]="(anyOperationInProgress)">
      Drive
    </button> -->
    <button mat-button mat-raised-button color="primary" (click)="saveFiles()" *ngIf="isButtonVisible && filesPresent"
      [disabled]="((anyOperationInProgress) || progressValue > 0)">
      <mat-progress-bar color="primary" mode="indeterminate" *ngIf="(anyOperationInProgress)">
      </mat-progress-bar>
      <fa-icon class="mr-05" icon="save"></fa-icon>{{'UPLOAD' | translate}}
    </button>
    <button class="ml-1" mat-button mat-raised-button (click)="removeAllFiles();" [disabled]="(anyOperationInProgress)"
      *ngIf="isButtonVisible && filesPresent">
      <fa-icon class="mr-05" icon="times"></fa-icon>{{'DOCUMENTMANAGEMENT.CLEARFILES' | translate}}
    </button>
  </div>
  <mat-progress-bar color="primary" mode="indeterminate" *ngIf="(getFilesInProgress)">
  </mat-progress-bar>
  <ng-container *ngIf="uploadedFilesLength && getFilesByReferenceId">
    <div *ngIf="(uploadedFiles) != null && (uploadedFiles).length > 0">
      <div class="mt-05">
        <mat-label><b>{{'USERSTORY.UPLOADEDFILES' | translate}}: ({{uploadedFilesLength}})</b>
        </mat-label>
      </div>
      <div class="fileupload-text mb-05" id="style-1">
        <mat-list-item *ngFor="let file of (uploadedFiles)">
          <mat-label class="userstory-filepath">
            <ng-container
              *ngIf="(file.fileExtension == '.jpeg') || (file.fileExtension == '.jpg') || (file.fileExtension == '.png') || (file.fileExtension == '.gif') || (file.fileExtension == '.JPEG') || (file.fileExtension == '.JPG') || (file.fileExtension == '.PNG') || (file.fileExtension == '.GIF')">
              <!-- <a [href]="file.filePath"
                                target="blank">{{file.fileName? file.fileName : file.filePath}}</a> -->
              <span class="icon-button" (click)="openPreview(file)">{{file.fileName? file.fileName :
                file.filePath}}</span>
            </ng-container>
            <ng-container
              *ngIf="!((file.fileExtension == '.jpeg') || (file.fileExtension == '.jpg') || (file.fileExtension == '.png') || (file.fileExtension == '.gif') || (file.fileExtension == '.JPEG') || (file.fileExtension == '.JPG') || (file.fileExtension == '.PNG') || (file.fileExtension == '.GIF'))">
              <span class="icon-button" (click)="downloadFile(file)">{{file.fileName? file.fileName :
                file.filePath}}</span>
            </ng-container>
            <ng-container *ngIf="galleryImages && galleryImages.length > 0">
              <ngx-gallery [options]="galleryOptions" [images]="galleryImages" #onlyPreviewGallery>
              </ngx-gallery>
            </ng-container>
          </mat-label>
          <fa-icon icon="trash" class="mat-color-accent pull-right mr-05 goal-cursor"
            matTooltip="{{'DOCUMENTMANAGEMENT.DELETEFILE' | translate}}" (click)="deleteSelectedFile(file)">
          </fa-icon>
        </mat-list-item>
      </div>
    </div>
  </ng-container>
</div>